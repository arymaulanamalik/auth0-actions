{"/home/circleci/repo/src/logger.ts":{"path":"/home/circleci/repo/src/logger.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":18},"end":{"line":3,"column":36}},"2":{"start":{"line":4,"column":41},"end":{"line":4,"column":57}},"3":{"start":{"line":5,"column":15},"end":{"line":10,"column":2}},"4":{"start":{"line":7,"column":79},"end":{"line":7,"column":131}},"5":{"start":{"line":11,"column":0},"end":{"line":11,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":7,"column":69},"end":{"line":7,"column":70}},"loc":{"start":{"line":7,"column":79},"end":{"line":7,"column":131}},"line":7}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":11},"end":{"line":6,"column":42}},"type":"binary-expr","locations":[{"start":{"line":6,"column":11},"end":{"line":6,"column":32}},{"start":{"line":6,"column":36},"end":{"line":6,"column":42}}],"line":6}},"s":{"0":1,"1":1,"2":1,"3":1,"4":818,"5":1},"f":{"0":818},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/logger.ts","sources":["/home/circleci/repo/src/logger.ts"],"names":[],"mappings":";;AAAA,qCAA2D;AAE3D,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,gBAAM,CAAC;AAEhD,MAAM,MAAM,GAAG,IAAA,sBAAY,EAAC;IAC1B,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,SAAS,IAAI,MAAM;IACtC,MAAM,EAAE,OAAO,CACb,QAAQ,EAAE,EACV,SAAS,EAAE,EACX,gBAAM,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS,MAAM,IAAI,CAAC,KAAK,KAAK,IAAI,CAAC,OAAO,EAAE,CAAC,CAC9E;IACD,UAAU,EAAE,CAAC,IAAI,oBAAU,CAAC,OAAO,EAAE,CAAC;IACtC,WAAW,EAAE,KAAK;CACnB,CAAC,CAAC;AAEH,kBAAe,MAAM,CAAC","sourcesContent":["import { format, createLogger, transports } from 'winston';\n\nconst { combine, timestamp, colorize } = format;\n\nconst logger = createLogger({\n  level: process.env.AUTH0_LOG || 'info',\n  format: combine(\n    colorize(),\n    timestamp(),\n    format.printf((info) => `${info.timestamp} - ${info.level}: ${info.message}`)\n  ),\n  transports: [new transports.Console()],\n  exitOnError: false,\n});\n\nexport default logger;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"287b3cf880e642acefbf64fee7948bdbe4284148","contentHash":"8fe74d36206c1e17ae0bec05fadeb171b99fb0ffd3cbf1326f4fc522021f5fe6"},"/home/circleci/repo/src/context/index.ts":{"path":"/home/circleci/repo/src/context/index.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":72}},"16":{"start":{"line":16,"column":13},"end":{"line":16,"column":26}},"17":{"start":{"line":17,"column":15},"end":{"line":17,"column":47}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":32}},"19":{"start":{"line":19,"column":15},"end":{"line":19,"column":49}},"20":{"start":{"line":20,"column":20},"end":{"line":20,"column":59}},"21":{"start":{"line":21,"column":16},"end":{"line":21,"column":35}},"22":{"start":{"line":22,"column":17},"end":{"line":22,"column":54}},"23":{"start":{"line":23,"column":36},"end":{"line":23,"column":65}},"24":{"start":{"line":24,"column":26},"end":{"line":38,"column":1}},"25":{"start":{"line":39,"column":21},"end":{"line":177,"column":2}},"26":{"start":{"line":39,"column":42},"end":{"line":177,"column":2}},"27":{"start":{"line":40,"column":26},"end":{"line":40,"column":28}},"28":{"start":{"line":41,"column":4},"end":{"line":42,"column":43}},"29":{"start":{"line":42,"column":8},"end":{"line":42,"column":43}},"30":{"start":{"line":43,"column":4},"end":{"line":48,"column":5}},"31":{"start":{"line":44,"column":8},"end":{"line":45,"column":50}},"32":{"start":{"line":45,"column":12},"end":{"line":45,"column":50}},"33":{"start":{"line":46,"column":8},"end":{"line":47,"column":109}},"34":{"start":{"line":47,"column":12},"end":{"line":47,"column":109}},"35":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"36":{"start":{"line":50,"column":8},"end":{"line":50,"column":166}},"37":{"start":{"line":52,"column":4},"end":{"line":63,"column":15}},"38":{"start":{"line":53,"column":8},"end":{"line":54,"column":19}},"39":{"start":{"line":54,"column":12},"end":{"line":54,"column":19}},"40":{"start":{"line":55,"column":8},"end":{"line":57,"column":9}},"41":{"start":{"line":56,"column":12},"end":{"line":56,"column":225}},"42":{"start":{"line":58,"column":37},"end":{"line":58,"column":108}},"43":{"start":{"line":59,"column":37},"end":{"line":59,"column":74}},"44":{"start":{"line":60,"column":8},"end":{"line":62,"column":9}},"45":{"start":{"line":61,"column":12},"end":{"line":61,"column":240}},"46":{"start":{"line":64,"column":4},"end":{"line":89,"column":15}},"47":{"start":{"line":65,"column":8},"end":{"line":66,"column":19}},"48":{"start":{"line":66,"column":12},"end":{"line":66,"column":19}},"49":{"start":{"line":69,"column":8},"end":{"line":69,"column":92}},"50":{"start":{"line":70,"column":8},"end":{"line":71,"column":19}},"51":{"start":{"line":71,"column":12},"end":{"line":71,"column":19}},"52":{"start":{"line":72,"column":39},"end":{"line":73,"column":75}},"53":{"start":{"line":74,"column":8},"end":{"line":76,"column":9}},"54":{"start":{"line":75,"column":12},"end":{"line":75,"column":279}},"55":{"start":{"line":77,"column":34},"end":{"line":85,"column":12}},"56":{"start":{"line":78,"column":12},"end":{"line":79,"column":29}},"57":{"start":{"line":79,"column":16},"end":{"line":79,"column":29}},"58":{"start":{"line":80,"column":32},"end":{"line":80,"column":90}},"59":{"start":{"line":81,"column":12},"end":{"line":83,"column":13}},"60":{"start":{"line":82,"column":16},"end":{"line":82,"column":81}},"61":{"start":{"line":84,"column":12},"end":{"line":84,"column":65}},"62":{"start":{"line":86,"column":8},"end":{"line":88,"column":9}},"63":{"start":{"line":87,"column":12},"end":{"line":87,"column":218}},"64":{"start":{"line":90,"column":4},"end":{"line":107,"column":15}},"65":{"start":{"line":92,"column":42},"end":{"line":99,"column":9}},"66":{"start":{"line":100,"column":37},"end":{"line":103,"column":10}},"67":{"start":{"line":101,"column":42},"end":{"line":101,"column":65}},"68":{"start":{"line":102,"column":12},"end":{"line":102,"column":79}},"69":{"start":{"line":104,"column":8},"end":{"line":106,"column":9}},"70":{"start":{"line":105,"column":12},"end":{"line":105,"column":327}},"71":{"start":{"line":108,"column":24},"end":{"line":138,"column":9}},"72":{"start":{"line":108,"column":37},"end":{"line":138,"column":6}},"73":{"start":{"line":109,"column":155},"end":{"line":109,"column":161}},"74":{"start":{"line":110,"column":8},"end":{"line":111,"column":38}},"75":{"start":{"line":111,"column":12},"end":{"line":111,"column":38}},"76":{"start":{"line":112,"column":8},"end":{"line":114,"column":9}},"77":{"start":{"line":113,"column":12},"end":{"line":113,"column":132}},"78":{"start":{"line":115,"column":27},"end":{"line":131,"column":12}},"79":{"start":{"line":116,"column":12},"end":{"line":122,"column":13}},"80":{"start":{"line":117,"column":16},"end":{"line":121,"column":19}},"81":{"start":{"line":123,"column":12},"end":{"line":130,"column":15}},"82":{"start":{"line":132,"column":34},"end":{"line":136,"column":10}},"83":{"start":{"line":137,"column":8},"end":{"line":137,"column":46}},"84":{"start":{"line":139,"column":23},"end":{"line":146,"column":6}},"85":{"start":{"line":147,"column":22},"end":{"line":147,"column":45}},"86":{"start":{"line":148,"column":25},"end":{"line":159,"column":5}},"87":{"start":{"line":149,"column":8},"end":{"line":157,"column":9}},"88":{"start":{"line":150,"column":12},"end":{"line":156,"column":13}},"89":{"start":{"line":151,"column":16},"end":{"line":151,"column":41}},"90":{"start":{"line":154,"column":16},"end":{"line":154,"column":105}},"91":{"start":{"line":155,"column":16},"end":{"line":155,"column":29}},"92":{"start":{"line":158,"column":8},"end":{"line":158,"column":21}},"93":{"start":{"line":160,"column":4},"end":{"line":165,"column":7}},"94":{"start":{"line":161,"column":8},"end":{"line":164,"column":9}},"95":{"start":{"line":163,"column":12},"end":{"line":163,"column":57}},"96":{"start":{"line":166,"column":4},"end":{"line":168,"column":5}},"97":{"start":{"line":167,"column":8},"end":{"line":167,"column":54}},"98":{"start":{"line":169,"column":4},"end":{"line":171,"column":5}},"99":{"start":{"line":170,"column":8},"end":{"line":170,"column":59}},"100":{"start":{"line":172,"column":16},"end":{"line":172,"column":49}},"101":{"start":{"line":173,"column":4},"end":{"line":175,"column":5}},"102":{"start":{"line":174,"column":8},"end":{"line":174,"column":54}},"103":{"start":{"line":176,"column":4},"end":{"line":176,"column":108}},"104":{"start":{"line":178,"column":0},"end":{"line":178,"column":36}},"105":{"start":{"line":179,"column":40},"end":{"line":183,"column":1}},"106":{"start":{"line":179,"column":64},"end":{"line":183,"column":1}},"107":{"start":{"line":180,"column":4},"end":{"line":181,"column":20}},"108":{"start":{"line":181,"column":8},"end":{"line":181,"column":20}},"109":{"start":{"line":182,"column":4},"end":{"line":182,"column":52}},"110":{"start":{"line":184,"column":0},"end":{"line":184,"column":74}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":39,"column":21},"end":{"line":39,"column":22}},"loc":{"start":{"line":39,"column":42},"end":{"line":177,"column":2}},"line":39},"9":{"name":"(anonymous_9)","decl":{"start":{"line":39,"column":76},"end":{"line":39,"column":77}},"loc":{"start":{"line":39,"column":89},"end":{"line":177,"column":1}},"line":39},"10":{"name":"(anonymous_10)","decl":{"start":{"line":52,"column":5},"end":{"line":52,"column":6}},"loc":{"start":{"line":52,"column":17},"end":{"line":63,"column":5}},"line":52},"11":{"name":"(anonymous_11)","decl":{"start":{"line":64,"column":5},"end":{"line":64,"column":6}},"loc":{"start":{"line":64,"column":17},"end":{"line":89,"column":5}},"line":64},"12":{"name":"(anonymous_12)","decl":{"start":{"line":77,"column":35},"end":{"line":77,"column":36}},"loc":{"start":{"line":77,"column":41},"end":{"line":85,"column":9}},"line":77},"13":{"name":"(anonymous_13)","decl":{"start":{"line":90,"column":5},"end":{"line":90,"column":6}},"loc":{"start":{"line":90,"column":17},"end":{"line":107,"column":5}},"line":90},"14":{"name":"(anonymous_14)","decl":{"start":{"line":100,"column":70},"end":{"line":100,"column":71}},"loc":{"start":{"line":100,"column":91},"end":{"line":103,"column":9}},"line":100},"15":{"name":"(anonymous_15)","decl":{"start":{"line":108,"column":31},"end":{"line":108,"column":32}},"loc":{"start":{"line":108,"column":37},"end":{"line":138,"column":6}},"line":108},"16":{"name":"(anonymous_16)","decl":{"start":{"line":108,"column":71},"end":{"line":108,"column":72}},"loc":{"start":{"line":108,"column":84},"end":{"line":138,"column":5}},"line":108},"17":{"name":"(anonymous_17)","decl":{"start":{"line":115,"column":28},"end":{"line":115,"column":29}},"loc":{"start":{"line":115,"column":34},"end":{"line":131,"column":9}},"line":115},"18":{"name":"(anonymous_18)","decl":{"start":{"line":148,"column":25},"end":{"line":148,"column":26}},"loc":{"start":{"line":148,"column":41},"end":{"line":159,"column":5}},"line":148},"19":{"name":"(anonymous_19)","decl":{"start":{"line":160,"column":30},"end":{"line":160,"column":31}},"loc":{"start":{"line":160,"column":39},"end":{"line":165,"column":5}},"line":160},"20":{"name":"(anonymous_20)","decl":{"start":{"line":179,"column":40},"end":{"line":179,"column":41}},"loc":{"start":{"line":179,"column":64},"end":{"line":183,"column":1}},"line":179},"21":{"name":"(anonymous_21)","decl":{"start":{"line":179,"column":64},"end":{"line":179,"column":65}},"loc":{"start":{"line":179,"column":86},"end":{"line":183,"column":1}},"line":179}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":41,"column":4},"end":{"line":42,"column":43}},"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":42,"column":43}},{"start":{"line":41,"column":4},"end":{"line":42,"column":43}}],"line":41},"9":{"loc":{"start":{"line":43,"column":4},"end":{"line":48,"column":5}},"type":"if","locations":[{"start":{"line":43,"column":4},"end":{"line":48,"column":5}},{"start":{"line":43,"column":4},"end":{"line":48,"column":5}}],"line":43},"10":{"loc":{"start":{"line":44,"column":8},"end":{"line":45,"column":50}},"type":"if","locations":[{"start":{"line":44,"column":8},"end":{"line":45,"column":50}},{"start":{"line":44,"column":8},"end":{"line":45,"column":50}}],"line":44},"11":{"loc":{"start":{"line":46,"column":8},"end":{"line":47,"column":109}},"type":"if","locations":[{"start":{"line":46,"column":8},"end":{"line":47,"column":109}},{"start":{"line":46,"column":8},"end":{"line":47,"column":109}}],"line":46},"12":{"loc":{"start":{"line":46,"column":12},"end":{"line":46,"column":80}},"type":"binary-expr","locations":[{"start":{"line":46,"column":12},"end":{"line":46,"column":39}},{"start":{"line":46,"column":43},"end":{"line":46,"column":80}}],"line":46},"13":{"loc":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},{"start":{"line":49,"column":4},"end":{"line":51,"column":5}}],"line":49},"14":{"loc":{"start":{"line":53,"column":8},"end":{"line":54,"column":19}},"type":"if","locations":[{"start":{"line":53,"column":8},"end":{"line":54,"column":19}},{"start":{"line":53,"column":8},"end":{"line":54,"column":19}}],"line":53},"15":{"loc":{"start":{"line":55,"column":8},"end":{"line":57,"column":9}},"type":"if","locations":[{"start":{"line":55,"column":8},"end":{"line":57,"column":9}},{"start":{"line":55,"column":8},"end":{"line":57,"column":9}}],"line":55},"16":{"loc":{"start":{"line":58,"column":37},"end":{"line":58,"column":108}},"type":"binary-expr","locations":[{"start":{"line":58,"column":37},"end":{"line":58,"column":72}},{"start":{"line":58,"column":76},"end":{"line":58,"column":108}}],"line":58},"17":{"loc":{"start":{"line":60,"column":8},"end":{"line":62,"column":9}},"type":"if","locations":[{"start":{"line":60,"column":8},"end":{"line":62,"column":9}},{"start":{"line":60,"column":8},"end":{"line":62,"column":9}}],"line":60},"18":{"loc":{"start":{"line":60,"column":12},"end":{"line":60,"column":56}},"type":"binary-expr","locations":[{"start":{"line":60,"column":12},"end":{"line":60,"column":32}},{"start":{"line":60,"column":36},"end":{"line":60,"column":56}}],"line":60},"19":{"loc":{"start":{"line":65,"column":8},"end":{"line":66,"column":19}},"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":66,"column":19}},{"start":{"line":65,"column":8},"end":{"line":66,"column":19}}],"line":65},"20":{"loc":{"start":{"line":69,"column":8},"end":{"line":69,"column":92}},"type":"binary-expr","locations":[{"start":{"line":69,"column":8},"end":{"line":69,"column":49}},{"start":{"line":69,"column":53},"end":{"line":69,"column":92}}],"line":69},"21":{"loc":{"start":{"line":70,"column":8},"end":{"line":71,"column":19}},"type":"if","locations":[{"start":{"line":70,"column":8},"end":{"line":71,"column":19}},{"start":{"line":70,"column":8},"end":{"line":71,"column":19}}],"line":70},"22":{"loc":{"start":{"line":72,"column":39},"end":{"line":73,"column":75}},"type":"binary-expr","locations":[{"start":{"line":72,"column":39},"end":{"line":72,"column":90}},{"start":{"line":73,"column":12},"end":{"line":73,"column":75}}],"line":72},"23":{"loc":{"start":{"line":74,"column":8},"end":{"line":76,"column":9}},"type":"if","locations":[{"start":{"line":74,"column":8},"end":{"line":76,"column":9}},{"start":{"line":74,"column":8},"end":{"line":76,"column":9}}],"line":74},"24":{"loc":{"start":{"line":78,"column":12},"end":{"line":79,"column":29}},"type":"if","locations":[{"start":{"line":78,"column":12},"end":{"line":79,"column":29}},{"start":{"line":78,"column":12},"end":{"line":79,"column":29}}],"line":78},"25":{"loc":{"start":{"line":81,"column":12},"end":{"line":83,"column":13}},"type":"if","locations":[{"start":{"line":81,"column":12},"end":{"line":83,"column":13}},{"start":{"line":81,"column":12},"end":{"line":83,"column":13}}],"line":81},"26":{"loc":{"start":{"line":86,"column":8},"end":{"line":88,"column":9}},"type":"if","locations":[{"start":{"line":86,"column":8},"end":{"line":88,"column":9}},{"start":{"line":86,"column":8},"end":{"line":88,"column":9}}],"line":86},"27":{"loc":{"start":{"line":102,"column":19},"end":{"line":102,"column":78}},"type":"binary-expr","locations":[{"start":{"line":102,"column":19},"end":{"line":102,"column":42}},{"start":{"line":102,"column":46},"end":{"line":102,"column":78}}],"line":102},"28":{"loc":{"start":{"line":104,"column":8},"end":{"line":106,"column":9}},"type":"if","locations":[{"start":{"line":104,"column":8},"end":{"line":106,"column":9}},{"start":{"line":104,"column":8},"end":{"line":106,"column":9}}],"line":104},"29":{"loc":{"start":{"line":105,"column":95},"end":{"line":105,"column":154}},"type":"cond-expr","locations":[{"start":{"line":105,"column":129},"end":{"line":105,"column":141}},{"start":{"line":105,"column":144},"end":{"line":105,"column":154}}],"line":105},"30":{"loc":{"start":{"line":110,"column":8},"end":{"line":111,"column":38}},"type":"if","locations":[{"start":{"line":110,"column":8},"end":{"line":111,"column":38}},{"start":{"line":110,"column":8},"end":{"line":111,"column":38}}],"line":110},"31":{"loc":{"start":{"line":112,"column":8},"end":{"line":114,"column":9}},"type":"if","locations":[{"start":{"line":112,"column":8},"end":{"line":114,"column":9}},{"start":{"line":112,"column":8},"end":{"line":114,"column":9}}],"line":112},"32":{"loc":{"start":{"line":112,"column":12},"end":{"line":112,"column":66}},"type":"binary-expr","locations":[{"start":{"line":112,"column":12},"end":{"line":112,"column":32}},{"start":{"line":112,"column":36},"end":{"line":112,"column":66}}],"line":112},"33":{"loc":{"start":{"line":116,"column":12},"end":{"line":122,"column":13}},"type":"if","locations":[{"start":{"line":116,"column":12},"end":{"line":122,"column":13}},{"start":{"line":116,"column":12},"end":{"line":122,"column":13}}],"line":116},"34":{"loc":{"start":{"line":127,"column":43},"end":{"line":129,"column":31}},"type":"cond-expr","locations":[{"start":{"line":128,"column":22},"end":{"line":128,"column":52}},{"start":{"line":129,"column":22},"end":{"line":129,"column":31}}],"line":127},"35":{"loc":{"start":{"line":133,"column":22},"end":{"line":135,"column":58}},"type":"cond-expr","locations":[{"start":{"line":134,"column":18},"end":{"line":134,"column":39}},{"start":{"line":135,"column":18},"end":{"line":135,"column":58}}],"line":133},"36":{"loc":{"start":{"line":142,"column":29},"end":{"line":142,"column":63}},"type":"binary-expr","locations":[{"start":{"line":142,"column":29},"end":{"line":142,"column":57}},{"start":{"line":142,"column":61},"end":{"line":142,"column":63}}],"line":142},"37":{"loc":{"start":{"line":149,"column":8},"end":{"line":157,"column":9}},"type":"if","locations":[{"start":{"line":149,"column":8},"end":{"line":157,"column":9}},{"start":{"line":149,"column":8},"end":{"line":157,"column":9}}],"line":149},"38":{"loc":{"start":{"line":161,"column":8},"end":{"line":164,"column":9}},"type":"if","locations":[{"start":{"line":161,"column":8},"end":{"line":164,"column":9}},{"start":{"line":161,"column":8},"end":{"line":164,"column":9}}],"line":161},"39":{"loc":{"start":{"line":166,"column":4},"end":{"line":168,"column":5}},"type":"if","locations":[{"start":{"line":166,"column":4},"end":{"line":168,"column":5}},{"start":{"line":166,"column":4},"end":{"line":168,"column":5}}],"line":166},"40":{"loc":{"start":{"line":169,"column":4},"end":{"line":171,"column":5}},"type":"if","locations":[{"start":{"line":169,"column":4},"end":{"line":171,"column":5}},{"start":{"line":169,"column":4},"end":{"line":171,"column":5}}],"line":169},"41":{"loc":{"start":{"line":173,"column":4},"end":{"line":175,"column":5}},"type":"if","locations":[{"start":{"line":173,"column":4},"end":{"line":175,"column":5}},{"start":{"line":173,"column":4},"end":{"line":175,"column":5}}],"line":173},"42":{"loc":{"start":{"line":173,"column":8},"end":{"line":173,"column":41}},"type":"binary-expr","locations":[{"start":{"line":173,"column":8},"end":{"line":173,"column":23}},{"start":{"line":173,"column":27},"end":{"line":173,"column":41}}],"line":173},"43":{"loc":{"start":{"line":180,"column":4},"end":{"line":181,"column":20}},"type":"if","locations":[{"start":{"line":180,"column":4},"end":{"line":181,"column":20}},{"start":{"line":180,"column":4},"end":{"line":181,"column":20}}],"line":180}},"s":{"0":1,"1":12,"2":0,"3":25,"4":8,"5":8,"6":1,"7":4,"8":4,"9":4,"10":27,"11":25,"12":1,"13":4,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":14,"27":14,"28":14,"29":0,"30":14,"31":4,"32":0,"33":4,"34":1,"35":14,"36":1,"37":13,"38":13,"39":10,"40":3,"41":1,"42":2,"43":2,"44":2,"45":1,"46":11,"47":11,"48":7,"49":4,"50":4,"51":4,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":11,"65":11,"66":11,"67":66,"68":66,"69":11,"70":1,"71":11,"72":11,"73":11,"74":11,"75":8,"76":3,"77":0,"78":3,"79":3,"80":1,"81":2,"82":3,"83":0,"84":8,"85":8,"86":8,"87":2,"88":0,"89":0,"90":0,"91":0,"92":2,"93":8,"94":88,"95":2,"96":8,"97":0,"98":8,"99":1,"100":7,"101":7,"102":6,"103":1,"104":1,"105":1,"106":74,"107":2073,"108":1947,"109":126,"110":1},"f":{"0":25,"1":12,"2":0,"3":25,"4":8,"5":4,"6":27,"7":4,"8":14,"9":14,"10":13,"11":11,"12":0,"13":11,"14":66,"15":11,"16":11,"17":3,"18":2,"19":88,"20":74,"21":2073},"b":{"0":[1,1,1],"1":[12,0],"2":[25,25],"3":[15,12],"4":[25,25],"5":[1,1,1],"6":[3,1],"7":[4,4],"8":[0,14],"9":[4,10],"10":[0,4],"11":[1,3],"12":[4,3],"13":[1,13],"14":[10,3],"15":[1,2],"16":[2,1],"17":[1,1],"18":[2,1],"19":[7,4],"20":[4,4],"21":[4,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[66,1],"28":[1,10],"29":[0,1],"30":[8,3],"31":[0,3],"32":[3,2],"33":[1,2],"34":[1,1],"35":[0,3],"36":[8,8],"37":[0,2],"38":[2,86],"39":[0,8],"40":[1,7],"41":[6,1],"42":[7,2],"43":[1947,126]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/index.ts","sources":["/home/circleci/repo/src/context/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { lstatSync, readdirSync, readFileSync, existsSync } from 'fs';\nimport path from 'path';\nimport { AuthenticationClient, ManagementClient } from 'auth0';\nimport YAMLContext from './yaml';\nimport DirectoryContext from './directory';\n\nimport { isDirectory } from '../utils';\nimport log from '../logger';\nimport { AssetTypes, Config } from '../types';\n\nconst { version: packageVersion } = require('../../package.json');\n\nconst nonPrimitiveProps: (keyof Config)[] = [\n  // List of properties that are arrays or objects. This list\n  // enables decoding of string env variables for these configurations.\n  'AUTH0_KEYWORD_REPLACE_MAPPINGS',\n  'AUTH0_EXCLUDED_RULES',\n  'AUTH0_EXCLUDED_CLIENTS',\n  'AUTH0_EXCLUDED_DATABASES',\n  'AUTH0_EXCLUDED_CONNECTIONS',\n  'AUTH0_EXCLUDED_RESOURCE_SERVERS',\n  'AUTH0_EXCLUDED_DEFAULTS',\n  'AUTH0_EXCLUDED',\n  'AUTH0_INCLUDED_ONLY',\n  'EXCLUDED_PROPS',\n  'INCLUDED_PROPS',\n];\n\nexport const setupContext = async (\n  config: Config,\n  command: 'import' | 'export'\n): Promise<DirectoryContext | YAMLContext> => {\n  const missingParams: (\n    | 'AUTH0_DOMAIN'\n    | 'AUTH0_CLIENT_ID'\n    | 'AUTH0_CLIENT_SECRET or AUTH0_CLIENT_SIGNING_KEY_PATH or AUTH0_ACCESS_TOKEN'\n  )[] = [];\n\n  if (!config.AUTH0_DOMAIN) missingParams.push('AUTH0_DOMAIN');\n  if (!config.AUTH0_ACCESS_TOKEN) {\n    if (!config.AUTH0_CLIENT_ID) missingParams.push('AUTH0_CLIENT_ID');\n    if (!config.AUTH0_CLIENT_SECRET && !config.AUTH0_CLIENT_SIGNING_KEY_PATH)\n      missingParams.push(\n        'AUTH0_CLIENT_SECRET or AUTH0_CLIENT_SIGNING_KEY_PATH or AUTH0_ACCESS_TOKEN'\n      );\n  }\n\n  if (missingParams.length > 0) {\n    throw new Error(\n      `The following parameters were missing. Please add them to your config.json or as an environment variable. ${JSON.stringify(\n        missingParams\n      )}`\n    );\n  }\n\n  ((config: Config) => {\n    if (config.AUTH0_INCLUDED_ONLY === undefined) return;\n\n    if (config.AUTH0_INCLUDED_ONLY.length === 0) {\n      throw new Error(\n        'Need to define at least one resource type in AUTH0_INCLUDED_ONLY configuration. See: https://github.com/auth0/auth0-deploy-cli/blob/master/docs/configuring-the-deploy-cli.md#auth0_included_only'\n      );\n    }\n\n    const hasExcludedResources =\n      config.AUTH0_EXCLUDED !== undefined && config.AUTH0_EXCLUDED.length > 0;\n    const hasIncludedResources = config.AUTH0_INCLUDED_ONLY.length > 0;\n\n    if (hasExcludedResources && hasIncludedResources) {\n      throw new Error(\n        'Both AUTH0_EXCLUDED and AUTH0_INCLUDED_ONLY configuration values are defined, only one can be configured at a time. See: https://github.com/auth0/auth0-deploy-cli/blob/master/docs/excluding-from-management.md'\n      );\n    }\n  })(config);\n\n  ((config: Config) => {\n    if (command === 'import') return;\n\n    const shouldPreserveKeywords =\n      //@ts-ignore because the string=>boolean conversion may not have happened if passed-in as env var\n      config.AUTH0_PRESERVE_KEYWORDS === 'true' || config.AUTH0_PRESERVE_KEYWORDS === true;\n\n    if (!shouldPreserveKeywords) return;\n\n    const isKeywordMappingsEmpty =\n      config.AUTH0_KEYWORD_REPLACE_MAPPINGS === undefined ||\n      Object.keys(config.AUTH0_KEYWORD_REPLACE_MAPPINGS).length === 0;\n\n    if (isKeywordMappingsEmpty) {\n      throw new Error(\n        'Attempting to preserve keywords without defining keyword mappings. Doing so could result in unintentional overwriting of resource configurations. Either define keyword mappings via AUTH0_KEYWORD_REPLACE_MAPPINGS or disable AUTH0_PRESERVE_KEYWORDS.'\n      );\n    }\n\n    const doLocalFilesExist = (() => {\n      if (!existsSync(config.AUTH0_INPUT_FILE)) return false;\n\n      const isDirectory = lstatSync(config.AUTH0_INPUT_FILE).isDirectory();\n      if (isDirectory) {\n        return readdirSync(config.AUTH0_INPUT_FILE).length > 0;\n      }\n      return existsSync(config.AUTH0_INPUT_FILE);\n    })();\n\n    if (!doLocalFilesExist) {\n      throw new Error(\n        'Attempting to preserve keywords for local resource configuration files that do not exist. Ensure that there are resource files in the output directory or disable AUTH0_PRESERVE_KEYWORDS.'\n      );\n    }\n  })(config);\n\n  ((config: Config) => {\n    // Detect and warn on usage of deprecated exclusion params. See: https://github.com/auth0/auth0-deploy-cli/issues/451#user-content-deprecated-exclusion-props\n    const deprecatedExclusionParams: (keyof Config)[] = [\n      'AUTH0_EXCLUDED_RULES',\n      'AUTH0_EXCLUDED_CLIENTS',\n      'AUTH0_EXCLUDED_DATABASES',\n      'AUTH0_EXCLUDED_CONNECTIONS',\n      'AUTH0_EXCLUDED_RESOURCE_SERVERS',\n      'AUTH0_EXCLUDED_DEFAULTS',\n    ];\n    const usedDeprecatedParams = deprecatedExclusionParams.filter((deprecatedParam) => {\n      const deprecatedConfigValue = config[deprecatedParam] as string[] | undefined;\n      return !!deprecatedConfigValue && deprecatedConfigValue.length > 0;\n    });\n    if (usedDeprecatedParams.length > 0) {\n      log.warn(\n        `Usage of the ${usedDeprecatedParams.join(', ')} exclusion ${\n          usedDeprecatedParams.length > 1 ? 'params are' : 'param is'\n        } deprecated and may be removed from future major versions. See: https://github.com/auth0/auth0-deploy-cli/issues/451#user-content-deprecated-exclusion-props for details.`\n      );\n    }\n  })(config);\n\n  const accessToken = await (async (): Promise<string> => {\n    const {\n      AUTH0_DOMAIN,\n      AUTH0_CLIENT_ID,\n      AUTH0_ACCESS_TOKEN,\n      AUTH0_CLIENT_SECRET,\n      AUTH0_CLIENT_SIGNING_KEY_PATH,\n      AUTH0_CLIENT_SIGNING_ALGORITHM,\n    } = config;\n\n    if (!!AUTH0_ACCESS_TOKEN) return AUTH0_ACCESS_TOKEN;\n    if (!AUTH0_CLIENT_SECRET && !AUTH0_CLIENT_SIGNING_KEY_PATH) {\n      throw new Error(\n        'need to supply either `AUTH0_ACCESS_TOKEN`, `AUTH0_CLIENT_SECRET` or `AUTH0_CLIENT_SIGNING_KEY_PATH`'\n      );\n    }\n\n    const authClient: AuthenticationClient = (() => {\n      if (!!AUTH0_CLIENT_SECRET) {\n        return new AuthenticationClient({\n          domain: AUTH0_DOMAIN,\n          clientId: AUTH0_CLIENT_ID,\n          clientSecret: AUTH0_CLIENT_SECRET,\n        });\n      }\n\n      return new AuthenticationClient({\n        domain: AUTH0_DOMAIN,\n        clientId: AUTH0_CLIENT_ID,\n        clientAssertionSigningKey: readFileSync(AUTH0_CLIENT_SIGNING_KEY_PATH),\n        clientAssertionSigningAlg: !!AUTH0_CLIENT_SIGNING_ALGORITHM\n          ? AUTH0_CLIENT_SIGNING_ALGORITHM\n          : undefined,\n      });\n    })();\n\n    const clientCredentials = await authClient.clientCredentialsGrant({\n      audience: config.AUTH0_AUDIENCE\n        ? config.AUTH0_AUDIENCE\n        : `https://${config.AUTH0_DOMAIN}/api/v2/`,\n    });\n    return clientCredentials.access_token;\n  })();\n\n  const mgmtClient = new ManagementClient({\n    domain: config.AUTH0_DOMAIN,\n    token: accessToken,\n    retry: { maxRetries: config.AUTH0_API_MAX_RETRIES || 10, enabled: true },\n    headers: {\n      'User-agent': `deploy-cli/${packageVersion} (node.js/${process.version.replace('v', '')})`,\n    },\n  });\n\n  const inputFile = config.AUTH0_INPUT_FILE;\n\n  const ensureObject = (key: keyof Config, value: any): any => {\n    if (typeof value === 'string') {\n      try {\n        return JSON.parse(value);\n      } catch (e) {\n        log.debug(`Cannot convert config.${key} to an object. Error: ${e.message}`);\n        return value;\n      }\n    }\n\n    return value;\n  };\n\n  nonPrimitiveProps.forEach((key) => {\n    if (config[key]) {\n      //@ts-ignore because this method of config overwriting technically functions\n      config[key] = ensureObject(key, config[key]);\n    }\n  });\n\n  if (typeof inputFile === 'object') {\n    return new YAMLContext(config, mgmtClient);\n  }\n\n  if (isDirectory(inputFile)) {\n    return new DirectoryContext(config, mgmtClient);\n  }\n\n  const ext = path.extname(inputFile);\n  if (ext === '.yaml' || ext === '.yml') {\n    return new YAMLContext(config, mgmtClient);\n  }\n\n  throw new Error(\n    `Unable to determine context processor to load for file ${inputFile}, does it exist? `\n  );\n};\n\nexport const filterOnlyIncludedResourceTypes =\n  (includedAssetTypes: AssetTypes[] | undefined) =>\n  ([handlerName, _]: [AssetTypes, any]) => {\n    if (includedAssetTypes === undefined) return true;\n    return includedAssetTypes.includes(handlerName);\n  };\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3a92590ba58153fdd674c2e942908979184ab575","contentHash":"055266cebf5e7615f4dcbf575a2e33e4508fa101b5c79c460bc8244b1c4c2036"},"/home/circleci/repo/src/context/yaml/index.ts":{"path":"/home/circleci/repo/src/context/yaml/index.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":19},"end":{"line":15,"column":55}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":53}},"17":{"start":{"line":17,"column":15},"end":{"line":17,"column":47}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":38}},"19":{"start":{"line":19,"column":17},"end":{"line":19,"column":57}},"20":{"start":{"line":20,"column":16},"end":{"line":20,"column":38}},"21":{"start":{"line":21,"column":19},"end":{"line":21,"column":57}},"22":{"start":{"line":22,"column":19},"end":{"line":22,"column":61}},"23":{"start":{"line":23,"column":12},"end":{"line":23,"column":25}},"24":{"start":{"line":24,"column":30},"end":{"line":24,"column":66}},"25":{"start":{"line":27,"column":8},"end":{"line":27,"column":50}},"26":{"start":{"line":28,"column":8},"end":{"line":28,"column":29}},"27":{"start":{"line":29,"column":8},"end":{"line":29,"column":68}},"28":{"start":{"line":30,"column":8},"end":{"line":30,"column":37}},"29":{"start":{"line":31,"column":8},"end":{"line":31,"column":47}},"30":{"start":{"line":33,"column":8},"end":{"line":33,"column":25}},"31":{"start":{"line":35,"column":8},"end":{"line":42,"column":10}},"32":{"start":{"line":43,"column":8},"end":{"line":48,"column":13}},"33":{"start":{"line":44,"column":12},"end":{"line":45,"column":46}},"34":{"start":{"line":45,"column":16},"end":{"line":45,"column":46}},"35":{"start":{"line":47,"column":12},"end":{"line":47,"column":108}},"36":{"start":{"line":51,"column":21},"end":{"line":51,"column":58}},"37":{"start":{"line":52,"column":8},"end":{"line":55,"column":9}},"38":{"start":{"line":54,"column":12},"end":{"line":54,"column":23}},"39":{"start":{"line":56,"column":8},"end":{"line":59,"column":11}},"40":{"start":{"line":62,"column":8},"end":{"line":110,"column":11}},"41":{"start":{"line":64,"column":12},"end":{"line":64,"column":76}},"42":{"start":{"line":65,"column":12},"end":{"line":80,"column":13}},"43":{"start":{"line":66,"column":16},"end":{"line":66,"column":46}},"44":{"start":{"line":69,"column":16},"end":{"line":79,"column":17}},"45":{"start":{"line":70,"column":34},"end":{"line":70,"column":73}},"46":{"start":{"line":71,"column":20},"end":{"line":71,"column":73}},"47":{"start":{"line":72,"column":20},"end":{"line":74,"column":125}},"48":{"start":{"line":77,"column":20},"end":{"line":77,"column":54}},"49":{"start":{"line":78,"column":20},"end":{"line":78,"column":82}},"50":{"start":{"line":81,"column":12},"end":{"line":86,"column":19}},"51":{"start":{"line":82,"column":43},"end":{"line":82,"column":75}},"52":{"start":{"line":83,"column":16},"end":{"line":84,"column":31}},"53":{"start":{"line":84,"column":20},"end":{"line":84,"column":31}},"54":{"start":{"line":85,"column":16},"end":{"line":85,"column":90}},"55":{"start":{"line":87,"column":12},"end":{"line":92,"column":19}},"56":{"start":{"line":88,"column":43},"end":{"line":88,"column":74}},"57":{"start":{"line":89,"column":16},"end":{"line":90,"column":31}},"58":{"start":{"line":90,"column":20},"end":{"line":90,"column":31}},"59":{"start":{"line":91,"column":16},"end":{"line":91,"column":90}},"60":{"start":{"line":94,"column":26},"end":{"line":94,"column":111}},"61":{"start":{"line":95,"column":12},"end":{"line":96,"column":39}},"62":{"start":{"line":96,"column":16},"end":{"line":96,"column":39}},"63":{"start":{"line":98,"column":12},"end":{"line":109,"column":17}},"64":{"start":{"line":98,"column":90},"end":{"line":109,"column":14}},"65":{"start":{"line":99,"column":16},"end":{"line":108,"column":17}},"66":{"start":{"line":100,"column":35},"end":{"line":100,"column":60}},"67":{"start":{"line":101,"column":20},"end":{"line":103,"column":23}},"68":{"start":{"line":102,"column":24},"end":{"line":102,"column":43}},"69":{"start":{"line":106,"column":20},"end":{"line":106,"column":54}},"70":{"start":{"line":107,"column":20},"end":{"line":107,"column":73}},"71":{"start":{"line":113,"column":8},"end":{"line":181,"column":11}},"72":{"start":{"line":114,"column":26},"end":{"line":114,"column":111}},"73":{"start":{"line":115,"column":12},"end":{"line":115,"column":63}},"74":{"start":{"line":116,"column":12},"end":{"line":144,"column":13}},"75":{"start":{"line":117,"column":16},"end":{"line":117,"column":50}},"76":{"start":{"line":120,"column":16},"end":{"line":121,"column":64}},"77":{"start":{"line":122,"column":16},"end":{"line":136,"column":17}},"78":{"start":{"line":123,"column":20},"end":{"line":123,"column":88}},"79":{"start":{"line":124,"column":40},"end":{"line":124,"column":70}},"80":{"start":{"line":126,"column":20},"end":{"line":126,"column":42}},"81":{"start":{"line":127,"column":20},"end":{"line":132,"column":23}},"82":{"start":{"line":135,"column":20},"end":{"line":135,"column":47}},"83":{"start":{"line":139,"column":31},"end":{"line":139,"column":163}},"84":{"start":{"line":140,"column":37},"end":{"line":142,"column":24}},"85":{"start":{"line":143,"column":16},"end":{"line":143,"column":96}},"86":{"start":{"line":145,"column":12},"end":{"line":168,"column":17}},"87":{"start":{"line":147,"column":43},"end":{"line":147,"column":75}},"88":{"start":{"line":148,"column":16},"end":{"line":148,"column":65}},"89":{"start":{"line":151,"column":42},"end":{"line":168,"column":14}},"90":{"start":{"line":152,"column":16},"end":{"line":167,"column":17}},"91":{"start":{"line":153,"column":33},"end":{"line":153,"column":57}},"92":{"start":{"line":154,"column":20},"end":{"line":162,"column":21}},"93":{"start":{"line":155,"column":24},"end":{"line":156,"column":71}},"94":{"start":{"line":156,"column":28},"end":{"line":156,"column":71}},"95":{"start":{"line":157,"column":24},"end":{"line":161,"column":27}},"96":{"start":{"line":158,"column":28},"end":{"line":160,"column":64}},"97":{"start":{"line":165,"column":20},"end":{"line":165,"column":54}},"98":{"start":{"line":166,"column":20},"end":{"line":166,"column":65}},"99":{"start":{"line":170,"column":26},"end":{"line":170,"column":75}},"100":{"start":{"line":172,"column":12},"end":{"line":172,"column":35}},"101":{"start":{"line":174,"column":12},"end":{"line":176,"column":13}},"102":{"start":{"line":175,"column":16},"end":{"line":175,"column":72}},"103":{"start":{"line":178,"column":24},"end":{"line":178,"column":55}},"104":{"start":{"line":179,"column":12},"end":{"line":179,"column":64}},"105":{"start":{"line":180,"column":12},"end":{"line":180,"column":67}},"106":{"start":{"line":184,"column":0},"end":{"line":184,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":36},"end":{"line":49,"column":5}},"line":26},"9":{"name":"(anonymous_9)","decl":{"start":{"line":43,"column":25},"end":{"line":43,"column":26}},"loc":{"start":{"line":43,"column":31},"end":{"line":48,"column":9}},"line":43},"10":{"name":"(anonymous_10)","decl":{"start":{"line":50,"column":4},"end":{"line":50,"column":5}},"loc":{"start":{"line":50,"column":16},"end":{"line":60,"column":5}},"line":50},"11":{"name":"(anonymous_11)","decl":{"start":{"line":61,"column":4},"end":{"line":61,"column":5}},"loc":{"start":{"line":61,"column":69},"end":{"line":111,"column":5}},"line":61},"12":{"name":"(anonymous_12)","decl":{"start":{"line":62,"column":47},"end":{"line":62,"column":48}},"loc":{"start":{"line":62,"column":60},"end":{"line":110,"column":9}},"line":62},"13":{"name":"(anonymous_13)","decl":{"start":{"line":81,"column":58},"end":{"line":81,"column":59}},"loc":{"start":{"line":81,"column":72},"end":{"line":86,"column":13}},"line":81},"14":{"name":"(anonymous_14)","decl":{"start":{"line":87,"column":58},"end":{"line":87,"column":59}},"loc":{"start":{"line":87,"column":72},"end":{"line":92,"column":13}},"line":87},"15":{"name":"(anonymous_15)","decl":{"start":{"line":98,"column":69},"end":{"line":98,"column":70}},"loc":{"start":{"line":98,"column":90},"end":{"line":109,"column":14}},"line":98},"16":{"name":"(anonymous_16)","decl":{"start":{"line":98,"column":122},"end":{"line":98,"column":123}},"loc":{"start":{"line":98,"column":135},"end":{"line":109,"column":13}},"line":98},"17":{"name":"(anonymous_17)","decl":{"start":{"line":101,"column":51},"end":{"line":101,"column":52}},"loc":{"start":{"line":101,"column":63},"end":{"line":103,"column":21}},"line":101},"18":{"name":"(anonymous_18)","decl":{"start":{"line":112,"column":4},"end":{"line":112,"column":5}},"loc":{"start":{"line":112,"column":11},"end":{"line":182,"column":5}},"line":112},"19":{"name":"(anonymous_19)","decl":{"start":{"line":113,"column":47},"end":{"line":113,"column":48}},"loc":{"start":{"line":113,"column":60},"end":{"line":181,"column":9}},"line":113},"20":{"name":"(anonymous_20)","decl":{"start":{"line":146,"column":24},"end":{"line":146,"column":25}},"loc":{"start":{"line":146,"column":43},"end":{"line":149,"column":13}},"line":146},"21":{"name":"(anonymous_21)","decl":{"start":{"line":151,"column":21},"end":{"line":151,"column":22}},"loc":{"start":{"line":151,"column":42},"end":{"line":168,"column":14}},"line":151},"22":{"name":"(anonymous_22)","decl":{"start":{"line":151,"column":74},"end":{"line":151,"column":75}},"loc":{"start":{"line":151,"column":87},"end":{"line":168,"column":13}},"line":151},"23":{"name":"(anonymous_23)","decl":{"start":{"line":157,"column":53},"end":{"line":157,"column":54}},"loc":{"start":{"line":157,"column":65},"end":{"line":161,"column":25}},"line":157}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":67}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":61}},{"start":{"line":29,"column":65},"end":{"line":29,"column":67}}],"line":29},"9":{"loc":{"start":{"line":36,"column":19},"end":{"line":36,"column":52}},"type":"binary-expr","locations":[{"start":{"line":36,"column":19},"end":{"line":36,"column":46}},{"start":{"line":36,"column":50},"end":{"line":36,"column":52}}],"line":36},"10":{"loc":{"start":{"line":37,"column":21},"end":{"line":37,"column":56}},"type":"binary-expr","locations":[{"start":{"line":37,"column":21},"end":{"line":37,"column":50}},{"start":{"line":37,"column":54},"end":{"line":37,"column":56}}],"line":37},"11":{"loc":{"start":{"line":38,"column":23},"end":{"line":38,"column":60}},"type":"binary-expr","locations":[{"start":{"line":38,"column":23},"end":{"line":38,"column":54}},{"start":{"line":38,"column":58},"end":{"line":38,"column":60}}],"line":38},"12":{"loc":{"start":{"line":39,"column":25},"end":{"line":39,"column":64}},"type":"binary-expr","locations":[{"start":{"line":39,"column":25},"end":{"line":39,"column":58}},{"start":{"line":39,"column":62},"end":{"line":39,"column":64}}],"line":39},"13":{"loc":{"start":{"line":40,"column":29},"end":{"line":40,"column":73}},"type":"binary-expr","locations":[{"start":{"line":40,"column":29},"end":{"line":40,"column":67}},{"start":{"line":40,"column":71},"end":{"line":40,"column":73}}],"line":40},"14":{"loc":{"start":{"line":41,"column":22},"end":{"line":41,"column":58}},"type":"binary-expr","locations":[{"start":{"line":41,"column":22},"end":{"line":41,"column":52}},{"start":{"line":41,"column":56},"end":{"line":41,"column":58}}],"line":41},"15":{"loc":{"start":{"line":44,"column":12},"end":{"line":45,"column":46}},"type":"if","locations":[{"start":{"line":44,"column":12},"end":{"line":45,"column":46}},{"start":{"line":44,"column":12},"end":{"line":45,"column":46}}],"line":44},"16":{"loc":{"start":{"line":47,"column":19},"end":{"line":47,"column":107}},"type":"cond-expr","locations":[{"start":{"line":47,"column":52},"end":{"line":47,"column":65}},{"start":{"line":47,"column":68},"end":{"line":47,"column":107}}],"line":47},"17":{"loc":{"start":{"line":52,"column":8},"end":{"line":55,"column":9}},"type":"if","locations":[{"start":{"line":52,"column":8},"end":{"line":55,"column":9}},{"start":{"line":52,"column":8},"end":{"line":55,"column":9}}],"line":52},"18":{"loc":{"start":{"line":61,"column":24},"end":{"line":61,"column":67}},"type":"default-arg","locations":[{"start":{"line":61,"column":31},"end":{"line":61,"column":67}}],"line":61},"19":{"loc":{"start":{"line":65,"column":12},"end":{"line":80,"column":13}},"type":"if","locations":[{"start":{"line":65,"column":12},"end":{"line":80,"column":13}},{"start":{"line":65,"column":12},"end":{"line":80,"column":13}}],"line":65},"20":{"loc":{"start":{"line":72,"column":47},"end":{"line":74,"column":123}},"type":"binary-expr","locations":[{"start":{"line":72,"column":47},"end":{"line":74,"column":117}},{"start":{"line":74,"column":121},"end":{"line":74,"column":123}}],"line":72},"21":{"loc":{"start":{"line":72,"column":70},"end":{"line":74,"column":116}},"type":"cond-expr","locations":[{"start":{"line":73,"column":26},"end":{"line":73,"column":133}},{"start":{"line":74,"column":26},"end":{"line":74,"column":116}}],"line":72},"22":{"loc":{"start":{"line":82,"column":43},"end":{"line":82,"column":75}},"type":"binary-expr","locations":[{"start":{"line":82,"column":43},"end":{"line":82,"column":69}},{"start":{"line":82,"column":73},"end":{"line":82,"column":75}}],"line":82},"23":{"loc":{"start":{"line":83,"column":16},"end":{"line":84,"column":31}},"type":"if","locations":[{"start":{"line":83,"column":16},"end":{"line":84,"column":31}},{"start":{"line":83,"column":16},"end":{"line":84,"column":31}}],"line":83},"24":{"loc":{"start":{"line":89,"column":16},"end":{"line":90,"column":31}},"type":"if","locations":[{"start":{"line":89,"column":16},"end":{"line":90,"column":31}},{"start":{"line":89,"column":16},"end":{"line":90,"column":31}}],"line":89},"25":{"loc":{"start":{"line":89,"column":20},"end":{"line":89,"column":89}},"type":"binary-expr","locations":[{"start":{"line":89,"column":20},"end":{"line":89,"column":52}},{"start":{"line":89,"column":56},"end":{"line":89,"column":89}}],"line":89},"26":{"loc":{"start":{"line":95,"column":12},"end":{"line":96,"column":39}},"type":"if","locations":[{"start":{"line":95,"column":12},"end":{"line":96,"column":39}},{"start":{"line":95,"column":12},"end":{"line":96,"column":39}}],"line":95},"27":{"loc":{"start":{"line":120,"column":16},"end":{"line":121,"column":64}},"type":"binary-expr","locations":[{"start":{"line":120,"column":16},"end":{"line":120,"column":62}},{"start":{"line":121,"column":20},"end":{"line":121,"column":64}}],"line":120},"28":{"loc":{"start":{"line":122,"column":16},"end":{"line":136,"column":17}},"type":"if","locations":[{"start":{"line":122,"column":16},"end":{"line":136,"column":17}},{"start":{"line":122,"column":16},"end":{"line":136,"column":17}}],"line":122},"29":{"loc":{"start":{"line":130,"column":41},"end":{"line":130,"column":89}},"type":"binary-expr","locations":[{"start":{"line":130,"column":41},"end":{"line":130,"column":83}},{"start":{"line":130,"column":87},"end":{"line":130,"column":89}}],"line":130},"30":{"loc":{"start":{"line":140,"column":37},"end":{"line":142,"column":24}},"type":"cond-expr","locations":[{"start":{"line":141,"column":22},"end":{"line":141,"column":60}},{"start":{"line":142,"column":22},"end":{"line":142,"column":24}}],"line":140},"31":{"loc":{"start":{"line":147,"column":43},"end":{"line":147,"column":75}},"type":"binary-expr","locations":[{"start":{"line":147,"column":43},"end":{"line":147,"column":69}},{"start":{"line":147,"column":73},"end":{"line":147,"column":75}}],"line":147},"32":{"loc":{"start":{"line":154,"column":20},"end":{"line":162,"column":21}},"type":"if","locations":[{"start":{"line":154,"column":20},"end":{"line":162,"column":21}},{"start":{"line":154,"column":20},"end":{"line":162,"column":21}}],"line":154},"33":{"loc":{"start":{"line":155,"column":24},"end":{"line":156,"column":71}},"type":"if","locations":[{"start":{"line":155,"column":24},"end":{"line":156,"column":71}},{"start":{"line":155,"column":24},"end":{"line":156,"column":71}}],"line":155},"34":{"loc":{"start":{"line":158,"column":45},"end":{"line":160,"column":63}},"type":"cond-expr","locations":[{"start":{"line":159,"column":34},"end":{"line":159,"column":90}},{"start":{"line":160,"column":34},"end":{"line":160,"column":63}}],"line":158},"35":{"loc":{"start":{"line":174,"column":12},"end":{"line":176,"column":13}},"type":"if","locations":[{"start":{"line":174,"column":12},"end":{"line":176,"column":13}},{"start":{"line":174,"column":12},"end":{"line":176,"column":13}}],"line":174}},"s":{"0":1,"1":1400,"2":0,"3":1355,"4":1397,"5":1397,"6":1,"7":3,"8":3,"9":3,"10":2750,"11":1355,"12":1,"13":6,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":96,"26":96,"27":96,"28":96,"29":96,"30":96,"31":96,"32":96,"33":96,"34":0,"35":96,"36":20,"37":20,"38":20,"39":20,"40":43,"41":43,"42":43,"43":0,"44":43,"45":43,"46":43,"47":43,"48":1,"49":1,"50":42,"51":95,"52":95,"53":2,"54":93,"55":42,"56":93,"57":93,"58":4,"59":89,"60":42,"61":42,"62":41,"63":41,"64":1189,"65":1189,"66":1189,"67":1188,"68":1188,"69":1,"70":1,"71":5,"72":5,"73":5,"74":5,"75":5,"76":5,"77":5,"78":1,"79":1,"80":1,"81":1,"82":4,"83":0,"84":0,"85":0,"86":5,"87":145,"88":145,"89":118,"90":118,"91":118,"92":118,"93":118,"94":118,"95":118,"96":118,"97":0,"98":0,"99":5,"100":4,"101":4,"102":4,"103":4,"104":4,"105":4,"106":1},"f":{"0":1355,"1":1400,"2":0,"3":1355,"4":1397,"5":3,"6":2750,"7":6,"8":96,"9":96,"10":20,"11":43,"12":43,"13":95,"14":93,"15":1189,"16":1189,"17":1188,"18":5,"19":5,"20":145,"21":118,"22":118,"23":118},"b":{"0":[1,1,1],"1":[1400,0],"2":[1355,1355],"3":[1350,1400],"4":[1355,1355],"5":[1,1,1],"6":[3,3],"7":[6,6],"8":[96,68],"9":[96,95],"10":[96,94],"11":[96,95],"12":[96,95],"13":[96,95],"14":[96,94],"15":[0,96],"16":[0,96],"17":[20,0],"18":[42],"19":[0,43],"20":[43,2],"21":[1,42],"22":[95,87],"23":[2,93],"24":[4,89],"25":[93,7],"26":[41,1],"27":[5,5],"28":[1,4],"29":[1,0],"30":[0,0],"31":[145,145],"32":[118,0],"33":[118,0],"34":[81,37],"35":[4,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/index.ts","sources":["/home/circleci/repo/src/context/yaml/index.ts"],"names":[],"mappings":"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","sourcesContent":["import fs from 'fs-extra';\nimport yaml from 'js-yaml';\nimport path from 'path';\nimport {\n  loadFileAndReplaceKeywords,\n  keywordReplace,\n  wrapArrayReplaceMarkersInQuotes,\n  Auth0,\n} from '../../tools';\n\nimport log from '../../logger';\nimport { isFile, toConfigFn, stripIdentifiers, formatResults, recordsSorter } from '../../utils';\nimport handlers, { YAMLHandler } from './handlers';\nimport cleanAssets from '../../readonly';\nimport { Assets, Config, Auth0APIClient, AssetTypes, KeywordMappings } from '../../types';\nimport { filterOnlyIncludedResourceTypes } from '..';\nimport { preserveKeywords } from '../../keywordPreservation';\n\nexport default class YAMLContext {\n  basePath: string;\n  configFile: string;\n  config: Config;\n  mappings: KeywordMappings;\n  mgmtClient: Auth0APIClient;\n  assets: Assets;\n  disableKeywordReplacement: boolean;\n\n  constructor(config: Config, mgmtClient) {\n    this.configFile = config.AUTH0_INPUT_FILE;\n    this.config = config;\n    this.mappings = config.AUTH0_KEYWORD_REPLACE_MAPPINGS || {};\n    this.mgmtClient = mgmtClient;\n    this.disableKeywordReplacement = false;\n\n    //@ts-ignore because the assets property gets filled out throughout\n    this.assets = {};\n    // Get excluded rules\n    this.assets.exclude = {\n      rules: config.AUTH0_EXCLUDED_RULES || [],\n      clients: config.AUTH0_EXCLUDED_CLIENTS || [],\n      databases: config.AUTH0_EXCLUDED_DATABASES || [],\n      connections: config.AUTH0_EXCLUDED_CONNECTIONS || [],\n      resourceServers: config.AUTH0_EXCLUDED_RESOURCE_SERVERS || [],\n      defaults: config.AUTH0_EXCLUDED_DEFAULTS || [],\n    };\n\n    this.basePath = (() => {\n      if (!!config.AUTH0_BASE_PATH) return config.AUTH0_BASE_PATH;\n      //@ts-ignore because this looks to be a bug, but do not want to introduce regression; more investigation needed\n      return typeof configFile === 'object' ? process.cwd() : path.dirname(this.configFile);\n    })();\n  }\n\n  loadFile(f) {\n    let toLoad = path.join(this.basePath, f);\n    if (!isFile(toLoad)) {\n      // try load not relative to yaml file\n      toLoad = f;\n    }\n    return loadFileAndReplaceKeywords(path.resolve(toLoad), {\n      mappings: this.mappings,\n      disableKeywordReplacement: this.disableKeywordReplacement,\n    });\n  }\n\n  async loadAssetsFromLocal(opts = { disableKeywordReplacement: false }) {\n    // Allow to send object/json directly\n    this.disableKeywordReplacement = opts.disableKeywordReplacement;\n    if (typeof this.configFile === 'object') {\n      this.assets = this.configFile;\n    } else {\n      try {\n        const fPath = path.resolve(this.configFile);\n        log.debug(`Loading YAML from ${fPath}`);\n        Object.assign(\n          this.assets,\n          yaml.load(\n            opts.disableKeywordReplacement\n              ? wrapArrayReplaceMarkersInQuotes(fs.readFileSync(fPath, 'utf8'), this.mappings)\n              : keywordReplace(fs.readFileSync(fPath, 'utf8'), this.mappings)\n          ) || {}\n        );\n      } catch (err) {\n        log.debug(err.stack);\n        throw new Error(`Problem loading ${this.configFile}\\n${err}`);\n      }\n    }\n\n    this.assets = Object.keys(this.assets).reduce((acc: Assets, key: AssetTypes) => {\n      const excludedAssetTypes = this.config.AUTH0_EXCLUDED || [];\n      if (excludedAssetTypes.includes(key)) return acc;\n\n      return {\n        ...acc,\n        [key]: this.assets[key],\n      };\n    }, {});\n\n    this.assets = Object.keys(this.assets).reduce((acc: Assets, key: AssetTypes) => {\n      const includedAssetTypes = this.config.AUTH0_INCLUDED_ONLY;\n\n      if (includedAssetTypes !== undefined && !includedAssetTypes.includes(key)) return acc;\n\n      return {\n        ...acc,\n        [key]: this.assets[key],\n      };\n    }, {});\n\n    // Run initial schema check to ensure valid YAML\n    const auth0 = new Auth0(this.mgmtClient, this.assets, toConfigFn(this.config));\n    if (!opts.disableKeywordReplacement) await auth0.validate(); //The schema validation needs to be disabled during keyword-preserved export because a field may be enforced as an array but will be expressed with an array replace marker (string).\n\n    // Allow handlers to process the assets such as loading files etc\n    await Promise.all(\n      Object.entries(handlers).map(async ([name, handler]) => {\n        try {\n          const parsed = await handler.parse(this);\n          Object.entries(parsed).forEach(([k, v]) => {\n            this.assets[k] = v;\n          });\n        } catch (err) {\n          log.debug(err.stack);\n          throw new Error(`Problem deploying ${name}, ${err}`);\n        }\n      })\n    );\n  }\n\n  async dump(): Promise<void> {\n    const auth0 = new Auth0(this.mgmtClient, this.assets, toConfigFn(this.config));\n    log.info('Loading Auth0 Tenant Data');\n    try {\n      await auth0.loadAssetsFromAuth0();\n\n      const shouldPreserveKeywords =\n        //@ts-ignore because the string=>boolean conversion may not have happened if passed-in as env var\n        this.config.AUTH0_PRESERVE_KEYWORDS === 'true' ||\n        this.config.AUTH0_PRESERVE_KEYWORDS === true;\n      if (shouldPreserveKeywords) {\n        await this.loadAssetsFromLocal({ disableKeywordReplacement: true }); //Need to disable keyword replacement to retrieve the raw keyword markers (ex: ##KEYWORD##)\n        const localAssets = { ...this.assets };\n        //@ts-ignore\n        delete this['assets'];\n\n        this.assets = preserveKeywords({\n          localAssets,\n          remoteAssets: auth0.assets,\n          keywordMappings: this.config.AUTH0_KEYWORD_REPLACE_MAPPINGS || {},\n          auth0Handlers: auth0.handlers,\n        });\n      } else {\n        this.assets = auth0.assets;\n      }\n    } catch (err) {\n      const docUrl =\n        'https://auth0.com/docs/deploy/deploy-cli-tool/create-and-configure-the-deploy-cli-application#modify-deploy-cli-application-scopes';\n      const extraMessage = err.message.startsWith('Insufficient scope')\n        ? `\\nSee ${docUrl} for more information`\n        : '';\n      throw new Error(`Problem loading tenant data from Auth0 ${err}${extraMessage}`);\n    }\n\n    await Promise.all(\n      Object.entries(handlers)\n        .filter(([handlerName]: [AssetTypes, YAMLHandler<any>]) => {\n          const excludedAssetTypes = this.config.AUTH0_EXCLUDED || [];\n          return !excludedAssetTypes.includes(handlerName);\n        })\n        .filter(filterOnlyIncludedResourceTypes(this.config.AUTH0_INCLUDED_ONLY))\n        .map(async ([name, handler]) => {\n          try {\n            const data = await handler.dump(this);\n            if (data) {\n              if (data[name] !== null) log.info(`Exporting ${name}`);\n              Object.entries(data).forEach(([k, v]) => {\n                this.assets[k] = Array.isArray(v)\n                  ? v.map(formatResults).sort(recordsSorter)\n                  : formatResults(v);\n              });\n            }\n          } catch (err) {\n            log.debug(err.stack);\n            throw new Error(`Problem exporting ${name}`);\n          }\n        })\n    );\n\n    // Clean known read only fields\n    let cleaned = cleanAssets(this.assets, this.config);\n\n    // Delete exclude as it's not part of the auth0 tenant config\n    delete cleaned.exclude;\n\n    // Optionally Strip identifiers\n    if (!this.config.AUTH0_EXPORT_IDENTIFIERS) {\n      cleaned = stripIdentifiers(auth0, cleaned);\n    }\n\n    // Write YAML File\n    const raw = yaml.dump(cleaned);\n    log.info(`Writing ${this.configFile}`);\n    fs.writeFileSync(this.configFile, raw);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8825017bc72d561843920004958f177318e61d4d","contentHash":"7e0e28f8ce2ab43f5208c524bf35456c53834a724f6279da82f9618d4e5b0394"},"/home/circleci/repo/src/tools/index.ts":{"path":"/home/circleci/repo/src/tools/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":164}},"4":{"start":{"line":7,"column":20},"end":{"line":7,"column":59}},"5":{"start":{"line":8,"column":0},"end":{"line":8,"column":40}},"6":{"start":{"line":9,"column":17},"end":{"line":9,"column":53}},"7":{"start":{"line":10,"column":0},"end":{"line":10,"column":34}},"8":{"start":{"line":11,"column":16},"end":{"line":11,"column":51}},"9":{"start":{"line":12,"column":0},"end":{"line":12,"column":32}},"10":{"start":{"line":13,"column":16},"end":{"line":13,"column":34}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":124}},"12":{"start":{"line":14,"column":88},"end":{"line":14,"column":118}},"13":{"start":{"line":15,"column":0},"end":{"line":15,"column":148}},"14":{"start":{"line":15,"column":100},"end":{"line":15,"column":142}},"15":{"start":{"line":16,"column":0},"end":{"line":16,"column":158}},"16":{"start":{"line":16,"column":105},"end":{"line":16,"column":152}},"17":{"start":{"line":17,"column":0},"end":{"line":24,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":14,"column":74},"end":{"line":14,"column":75}},"loc":{"start":{"line":14,"column":86},"end":{"line":14,"column":120}},"line":14},"2":{"name":"(anonymous_2)","decl":{"start":{"line":15,"column":86},"end":{"line":15,"column":87}},"loc":{"start":{"line":15,"column":98},"end":{"line":15,"column":144}},"line":15},"3":{"name":"(anonymous_3)","decl":{"start":{"line":16,"column":91},"end":{"line":16,"column":92}},"loc":{"start":{"line":16,"column":103},"end":{"line":16,"column":154}},"line":16}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":3,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":42,"13":1,"14":201,"15":1,"16":1,"17":1},"f":{"0":3,"1":42,"2":201,"3":1},"b":{"0":[1,1,1],"1":[3,0],"2":[3,3]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/index.ts","sources":["/home/circleci/repo/src/tools/index.ts"],"names":[],"mappings":";;;;;;AAAA,4DAAoC;AAmBlC,oBAnBK,mBAAS,CAmBL;AAlBX,sDAA8B;AAmB5B,iBAnBK,gBAAM,CAmBL;AAlBR,oDAA4B;AAsB1B,gBAtBK,eAAK,CAsBL;AArBP,mCAIiB;AAcf,+FAjBA,sBAAc,OAiBA;AACd,2GAjBA,kCAA0B,OAiBA;AAC1B,gHAjBA,uCAA+B,OAiBA;AAdjC,kBAAe;IACb,SAAS,EAAT,mBAAS;IACT,MAAM,EAAN,gBAAM;IACN,cAAc,EAAd,sBAAc;IACd,0BAA0B,EAA1B,kCAA0B;IAC1B,+BAA+B,EAA/B,uCAA+B;IAC/B,KAAK,EAAL,eAAK;CACN,CAAC","sourcesContent":["import constants from './constants';\nimport deploy from './deploy';\nimport Auth0 from './auth0';\nimport {\n  keywordReplace,\n  loadFileAndReplaceKeywords,\n  wrapArrayReplaceMarkersInQuotes,\n} from './utils';\n\nexport default {\n  constants,\n  deploy,\n  keywordReplace,\n  loadFileAndReplaceKeywords,\n  wrapArrayReplaceMarkersInQuotes,\n  Auth0,\n};\n\nexport {\n  constants,\n  deploy,\n  keywordReplace,\n  loadFileAndReplaceKeywords,\n  wrapArrayReplaceMarkersInQuotes,\n  Auth0,\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5a8b86dc5eb749ff4c25a9e39acbdb84fac16363","contentHash":"a5a98659569cb35a018e6716bb8ad433ddc0eebafa9d6a2d87477662c8e8e664"},"/home/circleci/repo/src/tools/constants.ts":{"path":"/home/circleci/repo/src/tools/constants.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":34},"end":{"line":3,"column":56}},"2":{"start":{"line":4,"column":28},"end":{"line":4,"column":44}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":26}},"4":{"start":{"line":6,"column":19},"end":{"line":6,"column":31}},"5":{"start":{"line":7,"column":21},"end":{"line":7,"column":38}},"6":{"start":{"line":8,"column":34},"end":{"line":8,"column":44}},"7":{"start":{"line":9,"column":38},"end":{"line":9,"column":52}},"8":{"start":{"line":10,"column":21},"end":{"line":10,"column":35}},"9":{"start":{"line":11,"column":29},"end":{"line":11,"column":51}},"10":{"start":{"line":12,"column":20},"end":{"line":12,"column":33}},"11":{"start":{"line":13,"column":22},"end":{"line":13,"column":37}},"12":{"start":{"line":14,"column":22},"end":{"line":14,"column":39}},"13":{"start":{"line":15,"column":33},"end":{"line":15,"column":53}},"14":{"start":{"line":16,"column":25},"end":{"line":16,"column":43}},"15":{"start":{"line":17,"column":30},"end":{"line":17,"column":47}},"16":{"start":{"line":18,"column":29},"end":{"line":18,"column":45}},"17":{"start":{"line":19,"column":27},"end":{"line":19,"column":41}},"18":{"start":{"line":20,"column":30},"end":{"line":20,"column":47}},"19":{"start":{"line":21,"column":33},"end":{"line":21,"column":50}},"20":{"start":{"line":22,"column":32},"end":{"line":22,"column":51}},"21":{"start":{"line":23,"column":18},"end":{"line":172,"column":1}},"22":{"start":{"line":173,"column":0},"end":{"line":173,"column":28}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/constants.ts","sources":["/home/circleci/repo/src/tools/constants.ts"],"names":[],"mappings":"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","sourcesContent":["const PAGE_GUARDIAN_MULTIFACTOR = 'guardian_multifactor';\nconst PAGE_PASSWORD_RESET = 'password_reset';\nconst PAGE_LOGIN = 'login';\nconst PAGE_ERROR = 'error_page';\nconst RULES_STAGES = ['login_success'];\nconst DATABASE_SCRIPTS_GET_USER = 'get_user';\nconst DATABASE_SCRIPTS_CHANGE_EMAIL = 'change_email';\n\nconst EMAIL_VERIFY = 'verify_email';\nconst EMAIL_VERIFY_BY_CODE = 'verify_email_by_code';\nconst EMAIL_RESET = 'reset_email';\nconst EMAIL_WELCOME = 'welcome_email';\nconst EMAIL_BLOCKED = 'blocked_account';\nconst EMAIL_STOLEN_CREDENTIALS = 'stolen_credentials';\nconst EMAIL_ENROLLMENT = 'enrollment_email';\nconst EMAIL_CHANGE_PASSWORD = 'change_password';\nconst EMAIL_PASSWORD_RESET = 'password_reset';\nconst EMAIL_MFA_OOB_CODE = 'mfa_oob_code';\nconst EMAIL_USER_INVITATION = 'user_invitation';\n\nconst UNIVERSAL_LOGIN_TEMPLATE = 'universal_login';\n\nconst OBFUSCATED_SECRET_VALUE = '_VALUE_NOT_SHOWN_';\n\nconst constants = {\n  CONCURRENT_CALLS: 5,\n  RULES_DIRECTORY: 'rules',\n  RULES_STAGES,\n  DEFAULT_RULE_STAGE: RULES_STAGES[0],\n  HOOKS_HIDDEN_SECRET_VALUE: OBFUSCATED_SECRET_VALUE,\n  OBFUSCATED_SECRET_VALUE,\n  HOOKS_DIRECTORY: 'hooks',\n  ACTIONS_DIRECTORY: 'actions',\n  TRIGGERS_DIRECTORY: 'triggers',\n  RULES_CONFIGS_DIRECTORY: 'rules-configs',\n  PAGES_DIRECTORY: 'pages',\n  PAGE_LOGIN,\n  PAGE_GUARDIAN_MULTIFACTOR,\n  PAGE_PASSWORD_RESET,\n  PAGE_ERROR,\n  DATABASE_CONNECTIONS_DIRECTORY: 'database-connections',\n  DATABASE_SCRIPTS_CHANGE_EMAIL,\n  DATABASE_SCRIPTS_GET_USER,\n  EMAIL_TEMPLATES_TYPES: [\n    'verify_email',\n    'verify_email_by_code',\n    'reset_email',\n    'welcome_email',\n    'blocked_account',\n    'stolen_credentials',\n    'enrollment_email',\n    'mfa_oob_code',\n    'change_password',\n    'password_reset',\n    'user_invitation',\n  ],\n  ACTIONS_TRIGGERS: [\n    'post-login',\n    'credentials-exchange',\n    'pre-user-registration',\n    'post-user-registration',\n    'post-change-password',\n    'send-phone-message',\n    'password-reset-post-challenge'\n  ],\n  EMAIL_TEMPLATES_DIRECTORY: 'emails',\n  EMAIL_VERIFY,\n  EMAIL_VERIFY_BY_CODE,\n  EMAIL_RESET,\n  EMAIL_WELCOME,\n  EMAIL_BLOCKED,\n  EMAIL_STOLEN_CREDENTIALS,\n  EMAIL_ENROLLMENT,\n  EMAIL_CHANGE_PASSWORD,\n  EMAIL_PASSWORD_RESET,\n  EMAIL_MFA_OOB_CODE,\n  EMAIL_USER_INVITATION,\n  GUARDIAN_DIRECTORY: 'guardian',\n  GUARDIAN_FACTORS_DIRECTORY: 'factors',\n  GUARDIAN_PROVIDERS_DIRECTORY: 'providers',\n  GUARDIAN_TEMPLATES_DIRECTORY: 'templates',\n  UNIVERSAL_LOGIN_TEMPLATE,\n  RESOURCE_SERVERS_DIRECTORY: 'resource-servers',\n  RESOURCE_SERVERS_CLIENT_NAME: 'resourceServers',\n  RESOURCE_SERVERS_MANAGEMENT_API_NAME: 'Auth0 Management API',\n  RESOURCE_SERVERS_ID_NAME: 'id',\n  CLIENTS_DIRECTORY: 'clients',\n  CLIENTS_GRANTS_DIRECTORY: 'grants',\n  BRANDING_DIRECTORY: 'branding',\n  BRANDING_TEMPLATES_DIRECTORY: 'templates',\n  BRANDING_TEMPLATES_YAML_DIRECTORY: 'branding_templates',\n  CLIENTS_CLIENT_NAME: 'clients',\n  CLIENTS_CLIENT_ID_NAME: 'client_id',\n  CONNECTIONS_DIRECTORY: 'connections',\n  CONNECTIONS_CLIENT_NAME: 'connections',\n  CONNECTIONS_ID_NAME: 'id',\n  ROLES_DIRECTORY: 'roles',\n  ATTACK_PROTECTION_DIRECTORY: 'attack-protection',\n  GUARDIAN_FACTORS: [\n    'sms',\n    'push-notification',\n    'otp',\n    'email',\n    'duo',\n    'webauthn-roaming',\n    'webauthn-platform',\n    'recovery-code',\n  ],\n  GUARDIAN_POLICIES: ['all-applications', 'confidence-score'],\n  GUARDIAN_PHONE_PROVIDERS: ['auth0', 'twilio', 'phone-message-hook'],\n  GUARDIAN_PHONE_MESSAGE_TYPES: ['sms', 'voice'],\n  GUARDIAN_FACTOR_TEMPLATES: ['sms'],\n  GUARDIAN_FACTOR_PROVIDERS: {\n    sms: ['twilio'],\n    'push-notification': ['sns'],\n  },\n  PAGE_NAMES: [\n    `${PAGE_GUARDIAN_MULTIFACTOR}.html`,\n    `${PAGE_GUARDIAN_MULTIFACTOR}.json`,\n    `${PAGE_PASSWORD_RESET}.html`,\n    `${PAGE_PASSWORD_RESET}.json`,\n    `${PAGE_LOGIN}.html`,\n    `${PAGE_LOGIN}.json`,\n    `${PAGE_ERROR}.html`,\n    `${PAGE_ERROR}.json`,\n  ],\n  DATABASE_SCRIPTS: [\n    DATABASE_SCRIPTS_GET_USER,\n    'create',\n    'verify',\n    'login',\n    'change_password',\n    'delete',\n    DATABASE_SCRIPTS_CHANGE_EMAIL,\n  ],\n  DATABASE_SCRIPTS_NO_IMPORT: [\n    DATABASE_SCRIPTS_GET_USER,\n    'create',\n    'verify',\n    'login',\n    'change_password',\n    'delete',\n  ],\n  DATABASE_SCRIPTS_IMPORT: [DATABASE_SCRIPTS_GET_USER, 'login'],\n  EMAIL_TEMPLATES_NAMES: [\n    `${EMAIL_VERIFY}.json`,\n    `${EMAIL_VERIFY}.html`,\n    `${EMAIL_VERIFY_BY_CODE}.json`,\n    `${EMAIL_VERIFY_BY_CODE}.html`,\n    `${EMAIL_RESET}.json`,\n    `${EMAIL_RESET}.html`,\n    `${EMAIL_WELCOME}.json`,\n    `${EMAIL_WELCOME}.html`,\n    `${EMAIL_BLOCKED}.json`,\n    `${EMAIL_BLOCKED}.html`,\n    `${EMAIL_STOLEN_CREDENTIALS}.json`,\n    `${EMAIL_STOLEN_CREDENTIALS}.html`,\n    `${EMAIL_ENROLLMENT}.json`,\n    `${EMAIL_ENROLLMENT}.html`,\n    `${EMAIL_CHANGE_PASSWORD}.json`,\n    `${EMAIL_CHANGE_PASSWORD}.html`,\n    `${EMAIL_PASSWORD_RESET}.json`,\n    `${EMAIL_PASSWORD_RESET}.html`,\n    `${EMAIL_MFA_OOB_CODE}.json`,\n    `${EMAIL_MFA_OOB_CODE}.html`,\n    `${EMAIL_USER_INVITATION}.json`,\n    `${EMAIL_USER_INVITATION}.html`,\n  ],\n  SUPPORTED_BRANDING_TEMPLATES: [UNIVERSAL_LOGIN_TEMPLATE],\n  LOG_STREAMS_DIRECTORY: 'log-streams',\n  PROMPTS_DIRECTORY: 'prompts',\n  CUSTOM_DOMAINS_DIRECTORY: 'custom-domains',\n  THEMES_DIRECTORY: 'themes',\n};\n\nexport default constants;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7ef711db5ef3a777ff5cc81e44631b5cca5caf32","contentHash":"8af16cd8a8bd650cd7e68a796a6369fcfa4b3b7754e051af017c3f4c02d64465"},"/home/circleci/repo/src/tools/deploy.ts":{"path":"/home/circleci/repo/src/tools/deploy.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":16},"end":{"line":15,"column":51}},"16":{"start":{"line":16,"column":17},"end":{"line":16,"column":54}},"17":{"start":{"line":18,"column":4},"end":{"line":35,"column":7}},"18":{"start":{"line":20,"column":8},"end":{"line":20,"column":87}},"19":{"start":{"line":21,"column":8},"end":{"line":21,"column":165}},"20":{"start":{"line":22,"column":22},"end":{"line":22,"column":65}},"21":{"start":{"line":24,"column":8},"end":{"line":24,"column":31}},"22":{"start":{"line":26,"column":8},"end":{"line":26,"column":37}},"23":{"start":{"line":27,"column":8},"end":{"line":34,"column":15}},"24":{"start":{"line":28,"column":12},"end":{"line":32,"column":14}},"25":{"start":{"line":33,"column":12},"end":{"line":33,"column":25}},"26":{"start":{"line":37,"column":0},"end":{"line":37,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"deploy","decl":{"start":{"line":17,"column":9},"end":{"line":17,"column":15}},"loc":{"start":{"line":17,"column":40},"end":{"line":36,"column":1}},"line":17},"9":{"name":"(anonymous_9)","decl":{"start":{"line":18,"column":43},"end":{"line":18,"column":44}},"loc":{"start":{"line":18,"column":56},"end":{"line":35,"column":5}},"line":18},"10":{"name":"(anonymous_10)","decl":{"start":{"line":27,"column":37},"end":{"line":27,"column":38}},"loc":{"start":{"line":27,"column":51},"end":{"line":34,"column":9}},"line":27}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":20,"column":33},"end":{"line":20,"column":86}},"type":"cond-expr","locations":[{"start":{"line":20,"column":70},"end":{"line":20,"column":77}},{"start":{"line":20,"column":80},"end":{"line":20,"column":86}}],"line":20},"9":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":136}},"type":"cond-expr","locations":[{"start":{"line":21,"column":100},"end":{"line":21,"column":131}},{"start":{"line":21,"column":134},"end":{"line":21,"column":136}}],"line":21}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":2,"14":1,"15":1,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":2,"8":0,"9":0,"10":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/deploy.ts","sources":["/home/circleci/repo/src/tools/deploy.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,oDAA4B;AAC5B,uDAA4B;AAI5B,SAA8B,MAAM,CAClC,MAAc,EACd,MAAsB,EACtB,MAAsB;;QAEtB,kBAAkB;QAClB,gBAAG,CAAC,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,WAAW,KAAK,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC;QAElE,gBAAG,CAAC,IAAI,CACN,4BACE,MAAM,CAAC,iBAAiB,CAAC,KAAK,SAAS,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,CAAC,EAC9E,GAAG,MAAM,CAAC,cAAc,CAAC,EAAE,CAC5B,CAAC;QAEF,MAAM,KAAK,GAAG,IAAI,eAAK,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;QAEhD,kBAAkB;QAClB,MAAM,KAAK,CAAC,QAAQ,EAAE,CAAC;QAEvB,kBAAkB;QAClB,MAAM,KAAK,CAAC,cAAc,EAAE,CAAC;QAE7B,OAAO,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE;YACxC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG;gBACd,OAAO,EAAE,CAAC,CAAC,OAAO;gBAClB,OAAO,EAAE,CAAC,CAAC,OAAO;gBAClB,OAAO,EAAE,CAAC,CAAC,OAAO;aACnB,CAAC;YACF,OAAO,KAAK,CAAC;QACf,CAAC,EAAE,EAAE,CAAC,CAAC;IACT,CAAC;CAAA;AA9BD,yBA8BC","sourcesContent":["import Auth0 from './auth0';\nimport log from '../logger';\nimport { ConfigFunction } from '../configFactory';\nimport { Assets, Auth0APIClient } from '../types';\n\nexport default async function deploy(\n  assets: Assets,\n  client: Auth0APIClient,\n  config: ConfigFunction\n) {\n  // Setup log level\n  log.level = process.env.AUTH0_DEBUG === 'true' ? 'debug' : 'info';\n\n  log.info(\n    `Getting access token for ${\n      config('AUTH0_CLIENT_ID') !== undefined ? `${config('AUTH0_CLIENT_ID')}/` : ''\n    }${config('AUTH0_DOMAIN')}`\n  );\n\n  const auth0 = new Auth0(client, assets, config);\n\n  // Validate Assets\n  await auth0.validate();\n\n  // Process changes\n  await auth0.processChanges();\n\n  return auth0.handlers.reduce((accum, h) => {\n    accum[h.type] = {\n      deleted: h.deleted,\n      created: h.created,\n      updated: h.updated,\n    };\n    return accum;\n  }, {});\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8b59ab3bc7cc67791443a9c4435bd78cb6b2d115","contentHash":"d822115d7670d6bac5b4944707a7c3df3d973b7980d4bf2ca8fb23b2b8c76a6d"},"/home/circleci/repo/src/tools/auth0/index.ts":{"path":"/home/circleci/repo/src/tools/auth0/index.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":14},"end":{"line":15,"column":53}},"16":{"start":{"line":16,"column":17},"end":{"line":16,"column":53}},"17":{"start":{"line":17,"column":17},"end":{"line":17,"column":53}},"18":{"start":{"line":18,"column":19},"end":{"line":18,"column":57}},"19":{"start":{"line":20,"column":25},"end":{"line":20,"column":27}},"20":{"start":{"line":21,"column":19},"end":{"line":21,"column":30}},"21":{"start":{"line":22,"column":4},"end":{"line":28,"column":7}},"22":{"start":{"line":24,"column":23},"end":{"line":24,"column":53}},"23":{"start":{"line":26,"column":23},"end":{"line":26,"column":53}},"24":{"start":{"line":27,"column":8},"end":{"line":27,"column":31}},"25":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"26":{"start":{"line":33,"column":8},"end":{"line":33,"column":52}},"27":{"start":{"line":34,"column":8},"end":{"line":34,"column":29}},"28":{"start":{"line":35,"column":8},"end":{"line":35,"column":29}},"29":{"start":{"line":36,"column":8},"end":{"line":52,"column":11}},"30":{"start":{"line":39,"column":12},"end":{"line":39,"column":85}},"31":{"start":{"line":42,"column":39},"end":{"line":42,"column":63}},"32":{"start":{"line":43,"column":12},"end":{"line":44,"column":28}},"33":{"start":{"line":44,"column":16},"end":{"line":44,"column":28}},"34":{"start":{"line":45,"column":12},"end":{"line":45,"column":62}},"35":{"start":{"line":48,"column":43},"end":{"line":48,"column":72}},"36":{"start":{"line":49,"column":12},"end":{"line":50,"column":28}},"37":{"start":{"line":50,"column":16},"end":{"line":50,"column":28}},"38":{"start":{"line":51,"column":12},"end":{"line":51,"column":65}},"39":{"start":{"line":55,"column":8},"end":{"line":69,"column":11}},"40":{"start":{"line":57,"column":12},"end":{"line":68,"column":13}},"41":{"start":{"line":59,"column":16},"end":{"line":67,"column":17}},"42":{"start":{"line":60,"column":36},"end":{"line":60,"column":73}},"43":{"start":{"line":61,"column":20},"end":{"line":61,"column":135}},"44":{"start":{"line":64,"column":20},"end":{"line":64,"column":44}},"45":{"start":{"line":65,"column":20},"end":{"line":65,"column":38}},"46":{"start":{"line":66,"column":20},"end":{"line":66,"column":30}},"47":{"start":{"line":72,"column":8},"end":{"line":82,"column":11}},"48":{"start":{"line":73,"column":24},"end":{"line":73,"column":80}},"49":{"start":{"line":74,"column":34},"end":{"line":76,"column":101}},"50":{"start":{"line":75,"column":31},"end":{"line":75,"column":53}},"51":{"start":{"line":76,"column":35},"end":{"line":76,"column":95}},"52":{"start":{"line":77,"column":26},"end":{"line":77,"column":71}},"53":{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},"54":{"start":{"line":79,"column":16},"end":{"line":79,"column":107}},"55":{"start":{"line":81,"column":12},"end":{"line":81,"column":44}},"56":{"start":{"line":85,"column":8},"end":{"line":88,"column":11}},"57":{"start":{"line":87,"column":12},"end":{"line":87,"column":40}},"58":{"start":{"line":91,"column":8},"end":{"line":93,"column":11}},"59":{"start":{"line":92,"column":12},"end":{"line":92,"column":50}},"60":{"start":{"line":96,"column":0},"end":{"line":96,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"sortByOrder","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":20}},"loc":{"start":{"line":19,"column":36},"end":{"line":30,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":22,"column":16},"end":{"line":22,"column":17}},"loc":{"start":{"line":22,"column":26},"end":{"line":28,"column":5}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":32,"column":4},"end":{"line":32,"column":5}},"loc":{"start":{"line":32,"column":40},"end":{"line":53,"column":5}},"line":32},"11":{"name":"(anonymous_11)","decl":{"start":{"line":37,"column":17},"end":{"line":37,"column":18}},"loc":{"start":{"line":37,"column":30},"end":{"line":40,"column":9}},"line":37},"12":{"name":"(anonymous_12)","decl":{"start":{"line":41,"column":20},"end":{"line":41,"column":21}},"loc":{"start":{"line":41,"column":33},"end":{"line":46,"column":9}},"line":41},"13":{"name":"(anonymous_13)","decl":{"start":{"line":47,"column":20},"end":{"line":47,"column":21}},"loc":{"start":{"line":47,"column":33},"end":{"line":52,"column":9}},"line":47},"14":{"name":"(anonymous_14)","decl":{"start":{"line":54,"column":4},"end":{"line":54,"column":5}},"loc":{"start":{"line":54,"column":20},"end":{"line":70,"column":5}},"line":54},"15":{"name":"(anonymous_15)","decl":{"start":{"line":55,"column":47},"end":{"line":55,"column":48}},"loc":{"start":{"line":55,"column":60},"end":{"line":69,"column":9}},"line":55},"16":{"name":"(anonymous_16)","decl":{"start":{"line":71,"column":4},"end":{"line":71,"column":5}},"loc":{"start":{"line":71,"column":15},"end":{"line":83,"column":5}},"line":71},"17":{"name":"(anonymous_17)","decl":{"start":{"line":72,"column":47},"end":{"line":72,"column":48}},"loc":{"start":{"line":72,"column":60},"end":{"line":82,"column":9}},"line":72},"18":{"name":"(anonymous_18)","decl":{"start":{"line":75,"column":24},"end":{"line":75,"column":25}},"loc":{"start":{"line":75,"column":31},"end":{"line":75,"column":53}},"line":75},"19":{"name":"(anonymous_19)","decl":{"start":{"line":76,"column":24},"end":{"line":76,"column":25}},"loc":{"start":{"line":76,"column":35},"end":{"line":76,"column":95}},"line":76},"20":{"name":"(anonymous_20)","decl":{"start":{"line":84,"column":4},"end":{"line":84,"column":5}},"loc":{"start":{"line":84,"column":26},"end":{"line":89,"column":5}},"line":84},"21":{"name":"(anonymous_21)","decl":{"start":{"line":85,"column":47},"end":{"line":85,"column":48}},"loc":{"start":{"line":85,"column":60},"end":{"line":88,"column":9}},"line":85},"22":{"name":"(anonymous_22)","decl":{"start":{"line":90,"column":4},"end":{"line":90,"column":5}},"loc":{"start":{"line":90,"column":21},"end":{"line":94,"column":5}},"line":90},"23":{"name":"(anonymous_23)","decl":{"start":{"line":91,"column":47},"end":{"line":91,"column":48}},"loc":{"start":{"line":91,"column":60},"end":{"line":93,"column":9}},"line":91}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":24,"column":23},"end":{"line":24,"column":53}},"type":"binary-expr","locations":[{"start":{"line":24,"column":23},"end":{"line":24,"column":37}},{"start":{"line":24,"column":41},"end":{"line":24,"column":53}}],"line":24},"9":{"loc":{"start":{"line":26,"column":23},"end":{"line":26,"column":53}},"type":"binary-expr","locations":[{"start":{"line":26,"column":23},"end":{"line":26,"column":37}},{"start":{"line":26,"column":41},"end":{"line":26,"column":53}}],"line":26},"10":{"loc":{"start":{"line":43,"column":12},"end":{"line":44,"column":28}},"type":"if","locations":[{"start":{"line":43,"column":12},"end":{"line":44,"column":28}},{"start":{"line":43,"column":12},"end":{"line":44,"column":28}}],"line":43},"11":{"loc":{"start":{"line":49,"column":12},"end":{"line":50,"column":28}},"type":"if","locations":[{"start":{"line":49,"column":12},"end":{"line":50,"column":28}},{"start":{"line":49,"column":12},"end":{"line":50,"column":28}}],"line":49},"12":{"loc":{"start":{"line":61,"column":81},"end":{"line":61,"column":132}},"type":"binary-expr","locations":[{"start":{"line":61,"column":82},"end":{"line":61,"column":125}},{"start":{"line":61,"column":130},"end":{"line":61,"column":132}}],"line":61},"13":{"loc":{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},"type":"if","locations":[{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},{"start":{"line":78,"column":12},"end":{"line":80,"column":13}}],"line":78}},"s":{"0":1,"1":2254,"2":0,"3":201,"4":2254,"5":2254,"6":0,"7":0,"8":0,"9":0,"10":2410,"11":201,"12":1,"13":4,"14":1,"15":1,"16":1,"17":1,"18":1,"19":78,"20":78,"21":78,"22":2098,"23":2098,"24":2098,"25":78,"26":130,"27":130,"28":130,"29":130,"30":3770,"31":3770,"32":3770,"33":3654,"34":116,"35":3764,"36":3764,"37":3619,"38":145,"39":78,"40":78,"41":2176,"42":2176,"43":2176,"44":0,"45":0,"46":0,"47":117,"48":117,"49":117,"50":163,"51":163,"52":117,"53":117,"54":45,"55":72,"56":6,"57":6,"58":0,"59":0,"60":1},"f":{"0":201,"1":2254,"2":0,"3":201,"4":2254,"5":0,"6":2410,"7":4,"8":78,"9":2098,"10":130,"11":3770,"12":3770,"13":3764,"14":78,"15":78,"16":117,"17":117,"18":163,"19":163,"20":6,"21":6,"22":0,"23":0},"b":{"0":[1,1,1],"1":[2254,0],"2":[201,201],"3":[156,2254],"4":[201,201],"5":[1,1,1],"6":[3,1],"7":[4,4],"8":[2098,2098],"9":[2098,2098],"10":[3654,116],"11":[3619,145],"12":[2176,2057],"13":[45,72]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/index.ts","sources":["/home/circleci/repo/src/tools/auth0/index.ts"],"names":[],"mappings":"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","sourcesContent":["import Ajv from 'ajv/lib/ajv';\n\nimport pagedClient from './client';\nimport schema from './schema';\nimport handlers from './handlers';\n\nimport { Assets, AssetTypes, Auth0APIClient, BaseAuth0APIClient } from '../../types';\nimport APIHandler from './handlers/default';\nimport { ConfigFunction } from '../../configFactory';\n\nexport type Stage = 'load' | 'validate' | 'processChanges';\n\ntype StageFunction = APIHandler['load']; // Using `load` method as a template for what type stage functions resemble\n\nfunction sortByOrder(toSort: APIHandler[], stage: Stage): APIHandler[] {\n  const defaultOrder = 50;\n\n  const sorted = [...toSort];\n  sorted.sort((a, b) => {\n    //@ts-ignore because this doesn't actually work. TODO: apply stage order\n    const aOrder = a[stage].order || defaultOrder;\n    //@ts-ignore because this doesn't actually work. TODO: apply stage order\n    const bOrder = b[stage].order || defaultOrder;\n    return aOrder - bOrder;\n  });\n  return sorted;\n}\n\nexport default class Auth0 {\n  client: Auth0APIClient;\n  config: ConfigFunction;\n  assets: Assets;\n  handlers: APIHandler[];\n\n  constructor(client: BaseAuth0APIClient, assets: Assets, config: ConfigFunction) {\n    this.client = pagedClient(client);\n    this.config = config;\n    this.assets = assets;\n\n    this.handlers = Object.values(handlers)\n      .map((handler) => {\n        //@ts-ignore because class expects `type` property but gets directly injected into class constructors\n        return new handler.default({ client: this.client, config: this.config });\n      })\n      .filter((handler) => {\n        const excludedAssetTypes: undefined | AssetTypes[] = config('AUTH0_EXCLUDED');\n\n        if (excludedAssetTypes === undefined) return true;\n\n        return !excludedAssetTypes.includes(handler.type as AssetTypes);\n      })\n      .filter((handler) => {\n        const onlyIncludedAssetTypes: undefined | AssetTypes[] = config('AUTH0_INCLUDED_ONLY');\n\n        if (onlyIncludedAssetTypes === undefined) return true;\n\n        return onlyIncludedAssetTypes.includes(handler.type as AssetTypes);\n      });\n  }\n\n  async runStage(stage: Stage): Promise<void> {\n    // Sort by priority\n    for (const handler of sortByOrder(this.handlers, stage)) {\n      // eslint-disable-line\n      try {\n        const stageFn: StageFunction = Object.getPrototypeOf(handler)[stage];\n        this.assets = {\n          ...this.assets,\n          ...((await stageFn.apply(handler, [this.assets])) || {}),\n        };\n      } catch (err) {\n        err.type = handler.type;\n        err.stage = stage;\n        throw err;\n      }\n    }\n  }\n\n  async validate(): Promise<void> {\n    const ajv = new Ajv({ useDefaults: true, nullable: true });\n    const nonNullAssets = Object.keys(this.assets)\n      .filter((k) => this.assets[k] != null)\n      .reduce((a, k) => ({ ...a, [k]: this.assets[k] }), {});\n    const valid = ajv.validate(schema, nonNullAssets);\n    if (!valid) {\n      throw new Error(`Schema validation failed loading ${JSON.stringify(ajv.errors, null, 4)}`);\n    }\n\n    await this.runStage('validate');\n  }\n\n  async loadAssetsFromAuth0(): Promise<void> {\n    // Populate assets from auth0 tenant\n    await this.runStage('load');\n  }\n\n  async processChanges(): Promise<void> {\n    await this.runStage('processChanges');\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"388d015a595d98af9b5e6292bcddbf92f711ffa5","contentHash":"b28a8581b79eb724e8d2b77d1db9207f4c681963c2fcc46555833e903e2dcddd"},"/home/circleci/repo/src/tools/auth0/client.ts":{"path":"/home/circleci/repo/src/tools/auth0/client.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":14}},"14":{"start":{"line":13,"column":4},"end":{"line":14,"column":20}},"15":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"16":{"start":{"line":14,"column":8},"end":{"line":14,"column":20}},"17":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"18":{"start":{"line":16,"column":8},"end":{"line":19,"column":9}},"19":{"start":{"line":16,"column":21},"end":{"line":16,"column":22}},"20":{"start":{"line":16,"column":28},"end":{"line":16,"column":59}},"21":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"22":{"start":{"line":18,"column":16},"end":{"line":18,"column":34}},"23":{"start":{"line":20,"column":4},"end":{"line":20,"column":13}},"24":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"25":{"start":{"line":23,"column":4},"end":{"line":23,"column":62}},"26":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"27":{"start":{"line":26,"column":32},"end":{"line":26,"column":64}},"28":{"start":{"line":27,"column":17},"end":{"line":27,"column":51}},"29":{"start":{"line":28,"column":16},"end":{"line":28,"column":35}},"30":{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},"31":{"start":{"line":32,"column":33},"end":{"line":32,"column":34}},"32":{"start":{"line":33,"column":22},"end":{"line":33,"column":25}},"33":{"start":{"line":35,"column":18},"end":{"line":35,"column":68}},"34":{"start":{"line":35,"column":51},"end":{"line":35,"column":67}},"35":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"36":{"start":{"line":37,"column":8},"end":{"line":37,"column":24}},"37":{"start":{"line":39,"column":4},"end":{"line":39,"column":84}},"38":{"start":{"line":42,"column":4},"end":{"line":77,"column":6}},"39":{"start":{"line":43,"column":8},"end":{"line":76,"column":11}},"40":{"start":{"line":44,"column":25},"end":{"line":44,"column":27}},"41":{"start":{"line":46,"column":23},"end":{"line":46,"column":58}},"42":{"start":{"line":46,"column":77},"end":{"line":46,"column":79}},"43":{"start":{"line":46,"column":91},"end":{"line":46,"column":117}},"44":{"start":{"line":48,"column":30},"end":{"line":53,"column":26}},"45":{"start":{"line":51,"column":44},"end":{"line":51,"column":69}},"46":{"start":{"line":54,"column":23},"end":{"line":54,"column":28}},"47":{"start":{"line":56,"column":12},"end":{"line":56,"column":30}},"48":{"start":{"line":57,"column":12},"end":{"line":71,"column":13}},"49":{"start":{"line":58,"column":28},"end":{"line":63,"column":30}},"50":{"start":{"line":61,"column":48},"end":{"line":61,"column":73}},"51":{"start":{"line":64,"column":16},"end":{"line":64,"column":45}},"52":{"start":{"line":65,"column":16},"end":{"line":70,"column":17}},"53":{"start":{"line":66,"column":20},"end":{"line":66,"column":32}},"54":{"start":{"line":69,"column":20},"end":{"line":69,"column":44}},"55":{"start":{"line":72,"column":12},"end":{"line":74,"column":13}},"56":{"start":{"line":73,"column":16},"end":{"line":73,"column":65}},"57":{"start":{"line":75,"column":12},"end":{"line":75,"column":24}},"58":{"start":{"line":80,"column":4},"end":{"line":120,"column":6}},"59":{"start":{"line":81,"column":8},"end":{"line":119,"column":11}},"60":{"start":{"line":83,"column":25},"end":{"line":83,"column":27}},"61":{"start":{"line":85,"column":28},"end":{"line":85,"column":37}},"62":{"start":{"line":86,"column":12},"end":{"line":86,"column":83}},"63":{"start":{"line":88,"column":28},"end":{"line":88,"column":64}},"64":{"start":{"line":89,"column":12},"end":{"line":89,"column":42}},"65":{"start":{"line":90,"column":12},"end":{"line":90,"column":39}},"66":{"start":{"line":92,"column":24},"end":{"line":97,"column":26}},"67":{"start":{"line":95,"column":41},"end":{"line":95,"column":66}},"68":{"start":{"line":98,"column":12},"end":{"line":98,"column":41}},"69":{"start":{"line":99,"column":26},"end":{"line":99,"column":40}},"70":{"start":{"line":100,"column":30},"end":{"line":100,"column":60}},"71":{"start":{"line":102,"column":12},"end":{"line":117,"column":13}},"72":{"start":{"line":103,"column":30},"end":{"line":112,"column":30}},"73":{"start":{"line":107,"column":41},"end":{"line":107,"column":76}},"74":{"start":{"line":108,"column":24},"end":{"line":108,"column":52}},"75":{"start":{"line":109,"column":24},"end":{"line":109,"column":83}},"76":{"start":{"line":109,"column":69},"end":{"line":109,"column":81}},"77":{"start":{"line":113,"column":16},"end":{"line":113,"column":58}},"78":{"start":{"line":114,"column":16},"end":{"line":116,"column":17}},"79":{"start":{"line":115,"column":20},"end":{"line":115,"column":69}},"80":{"start":{"line":118,"column":12},"end":{"line":118,"column":24}},"81":{"start":{"line":124,"column":4},"end":{"line":146,"column":7}},"82":{"start":{"line":126,"column":12},"end":{"line":139,"column":13}},"83":{"start":{"line":127,"column":16},"end":{"line":138,"column":18}},"84":{"start":{"line":128,"column":20},"end":{"line":137,"column":23}},"85":{"start":{"line":129,"column":24},"end":{"line":136,"column":25}},"86":{"start":{"line":131,"column":32},"end":{"line":131,"column":90}},"87":{"start":{"line":133,"column":32},"end":{"line":133,"column":84}},"88":{"start":{"line":135,"column":32},"end":{"line":135,"column":61}},"89":{"start":{"line":140,"column":34},"end":{"line":140,"column":69}},"90":{"start":{"line":141,"column":12},"end":{"line":143,"column":13}},"91":{"start":{"line":142,"column":16},"end":{"line":142,"column":59}},"92":{"start":{"line":144,"column":12},"end":{"line":144,"column":33}},"93":{"start":{"line":150,"column":30},"end":{"line":154,"column":13}},"94":{"start":{"line":155,"column":4},"end":{"line":155,"column":62}},"95":{"start":{"line":157,"column":0},"end":{"line":157,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":38},"end":{"line":11,"column":39}},"loc":{"start":{"line":11,"column":54},"end":{"line":21,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":22,"column":56},"end":{"line":22,"column":57}},"loc":{"start":{"line":22,"column":71},"end":{"line":24,"column":1}},"line":22},"9":{"name":"getEntity","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":18}},"loc":{"start":{"line":34,"column":24},"end":{"line":40,"column":1}},"line":34},"10":{"name":"(anonymous_10)","decl":{"start":{"line":35,"column":44},"end":{"line":35,"column":45}},"loc":{"start":{"line":35,"column":51},"end":{"line":35,"column":67}},"line":35},"11":{"name":"checkpointPaginator","decl":{"start":{"line":41,"column":9},"end":{"line":41,"column":28}},"loc":{"start":{"line":41,"column":51},"end":{"line":78,"column":1}},"line":41},"12":{"name":"(anonymous_12)","decl":{"start":{"line":42,"column":11},"end":{"line":42,"column":12}},"loc":{"start":{"line":42,"column":30},"end":{"line":77,"column":5}},"line":42},"13":{"name":"(anonymous_13)","decl":{"start":{"line":43,"column":47},"end":{"line":43,"column":48}},"loc":{"start":{"line":43,"column":60},"end":{"line":76,"column":9}},"line":43},"14":{"name":"(anonymous_14)","decl":{"start":{"line":51,"column":27},"end":{"line":51,"column":28}},"loc":{"start":{"line":51,"column":44},"end":{"line":51,"column":69}},"line":51},"15":{"name":"(anonymous_15)","decl":{"start":{"line":61,"column":31},"end":{"line":61,"column":32}},"loc":{"start":{"line":61,"column":48},"end":{"line":61,"column":73}},"line":61},"16":{"name":"pagePaginator","decl":{"start":{"line":79,"column":9},"end":{"line":79,"column":22}},"loc":{"start":{"line":79,"column":45},"end":{"line":121,"column":1}},"line":79},"17":{"name":"(anonymous_17)","decl":{"start":{"line":80,"column":11},"end":{"line":80,"column":12}},"loc":{"start":{"line":80,"column":30},"end":{"line":120,"column":5}},"line":80},"18":{"name":"(anonymous_18)","decl":{"start":{"line":81,"column":47},"end":{"line":81,"column":48}},"loc":{"start":{"line":81,"column":60},"end":{"line":119,"column":9}},"line":81},"19":{"name":"(anonymous_19)","decl":{"start":{"line":95,"column":27},"end":{"line":95,"column":28}},"loc":{"start":{"line":95,"column":41},"end":{"line":95,"column":66}},"line":95},"20":{"name":"(anonymous_20)","decl":{"start":{"line":106,"column":31},"end":{"line":106,"column":32}},"loc":{"start":{"line":106,"column":41},"end":{"line":110,"column":21}},"line":106},"21":{"name":"(anonymous_21)","decl":{"start":{"line":109,"column":62},"end":{"line":109,"column":63}},"loc":{"start":{"line":109,"column":69},"end":{"line":109,"column":81}},"line":109},"22":{"name":"pagedManager","decl":{"start":{"line":123,"column":9},"end":{"line":123,"column":21}},"loc":{"start":{"line":123,"column":39},"end":{"line":147,"column":1}},"line":123},"23":{"name":"(anonymous_23)","decl":{"start":{"line":125,"column":13},"end":{"line":125,"column":14}},"loc":{"start":{"line":125,"column":47},"end":{"line":145,"column":9}},"line":125},"24":{"name":"(anonymous_24)","decl":{"start":{"line":127,"column":23},"end":{"line":127,"column":24}},"loc":{"start":{"line":127,"column":42},"end":{"line":138,"column":17}},"line":127},"25":{"name":"(anonymous_25)","decl":{"start":{"line":128,"column":59},"end":{"line":128,"column":60}},"loc":{"start":{"line":128,"column":72},"end":{"line":137,"column":21}},"line":128},"26":{"name":"pagedClient","decl":{"start":{"line":149,"column":9},"end":{"line":149,"column":20}},"loc":{"start":{"line":149,"column":29},"end":{"line":156,"column":1}},"line":149}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":14},"end":{"line":11,"column":18}},{"start":{"line":11,"column":22},"end":{"line":11,"column":33}},{"start":{"line":11,"column":38},"end":{"line":21,"column":1}}],"line":11},"6":{"loc":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"type":"if","locations":[{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},{"start":{"line":13,"column":21},"end":{"line":14,"column":20}}],"line":13},"7":{"loc":{"start":{"line":13,"column":25},"end":{"line":13,"column":87}},"type":"binary-expr","locations":[{"start":{"line":13,"column":25},"end":{"line":13,"column":67}},{"start":{"line":13,"column":71},"end":{"line":13,"column":87}}],"line":13},"8":{"loc":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"type":"if","locations":[{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},{"start":{"line":15,"column":4},"end":{"line":19,"column":9}}],"line":15},"9":{"loc":{"start":{"line":15,"column":8},"end":{"line":15,"column":71}},"type":"binary-expr","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":17}},{"start":{"line":15,"column":21},"end":{"line":15,"column":71}}],"line":15},"10":{"loc":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},{"start":{"line":17,"column":12},"end":{"line":18,"column":34}}],"line":17},"11":{"loc":{"start":{"line":17,"column":16},"end":{"line":17,"column":90}},"type":"binary-expr","locations":[{"start":{"line":17,"column":16},"end":{"line":17,"column":35}},{"start":{"line":17,"column":39},"end":{"line":17,"column":90}}],"line":17},"12":{"loc":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":22,"column":23},"end":{"line":22,"column":27}},{"start":{"line":22,"column":31},"end":{"line":22,"column":51}},{"start":{"line":22,"column":56},"end":{"line":24,"column":1}}],"line":22},"13":{"loc":{"start":{"line":23,"column":11},"end":{"line":23,"column":61}},"type":"cond-expr","locations":[{"start":{"line":23,"column":37},"end":{"line":23,"column":40}},{"start":{"line":23,"column":43},"end":{"line":23,"column":61}}],"line":23},"14":{"loc":{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},"type":"binary-expr","locations":[{"start":{"line":23,"column":12},"end":{"line":23,"column":15}},{"start":{"line":23,"column":19},"end":{"line":23,"column":33}}],"line":23},"15":{"loc":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},{"start":{"line":36,"column":4},"end":{"line":38,"column":5}}],"line":36},"16":{"loc":{"start":{"line":36,"column":8},"end":{"line":36,"column":50}},"type":"binary-expr","locations":[{"start":{"line":36,"column":8},"end":{"line":36,"column":28}},{"start":{"line":36,"column":32},"end":{"line":36,"column":50}}],"line":36},"17":{"loc":{"start":{"line":65,"column":16},"end":{"line":70,"column":17}},"type":"if","locations":[{"start":{"line":65,"column":16},"end":{"line":70,"column":17}},{"start":{"line":65,"column":16},"end":{"line":70,"column":17}}],"line":65},"18":{"loc":{"start":{"line":72,"column":12},"end":{"line":74,"column":13}},"type":"if","locations":[{"start":{"line":72,"column":12},"end":{"line":74,"column":13}},{"start":{"line":72,"column":12},"end":{"line":74,"column":13}}],"line":72},"19":{"loc":{"start":{"line":88,"column":28},"end":{"line":88,"column":64}},"type":"binary-expr","locations":[{"start":{"line":88,"column":28},"end":{"line":88,"column":47}},{"start":{"line":88,"column":51},"end":{"line":88,"column":64}}],"line":88},"20":{"loc":{"start":{"line":99,"column":26},"end":{"line":99,"column":40}},"type":"binary-expr","locations":[{"start":{"line":99,"column":26},"end":{"line":99,"column":35}},{"start":{"line":99,"column":39},"end":{"line":99,"column":40}}],"line":99},"21":{"loc":{"start":{"line":102,"column":12},"end":{"line":117,"column":13}},"type":"if","locations":[{"start":{"line":102,"column":12},"end":{"line":117,"column":13}},{"start":{"line":102,"column":12},"end":{"line":117,"column":13}}],"line":102},"22":{"loc":{"start":{"line":114,"column":16},"end":{"line":116,"column":17}},"type":"if","locations":[{"start":{"line":114,"column":16},"end":{"line":116,"column":17}},{"start":{"line":114,"column":16},"end":{"line":116,"column":17}}],"line":114},"23":{"loc":{"start":{"line":126,"column":12},"end":{"line":139,"column":13}},"type":"if","locations":[{"start":{"line":126,"column":12},"end":{"line":139,"column":13}},{"start":{"line":126,"column":12},"end":{"line":139,"column":13}}],"line":126},"24":{"loc":{"start":{"line":129,"column":24},"end":{"line":136,"column":25}},"type":"switch","locations":[{"start":{"line":130,"column":28},"end":{"line":131,"column":90}},{"start":{"line":132,"column":28},"end":{"line":133,"column":84}},{"start":{"line":134,"column":28},"end":{"line":135,"column":61}}],"line":129},"25":{"loc":{"start":{"line":130,"column":33},"end":{"line":130,"column":93}},"type":"binary-expr","locations":[{"start":{"line":130,"column":33},"end":{"line":130,"column":40}},{"start":{"line":130,"column":44},"end":{"line":130,"column":71}},{"start":{"line":130,"column":75},"end":{"line":130,"column":93}}],"line":130},"26":{"loc":{"start":{"line":132,"column":33},"end":{"line":132,"column":91}},"type":"binary-expr","locations":[{"start":{"line":132,"column":33},"end":{"line":132,"column":40}},{"start":{"line":132,"column":44},"end":{"line":132,"column":71}},{"start":{"line":132,"column":75},"end":{"line":132,"column":91}}],"line":132},"27":{"loc":{"start":{"line":141,"column":12},"end":{"line":143,"column":13}},"type":"if","locations":[{"start":{"line":141,"column":12},"end":{"line":143,"column":13}},{"start":{"line":141,"column":12},"end":{"line":143,"column":13}}],"line":141},"28":{"loc":{"start":{"line":141,"column":16},"end":{"line":141,"column":75}},"type":"binary-expr","locations":[{"start":{"line":141,"column":16},"end":{"line":141,"column":49}},{"start":{"line":141,"column":53},"end":{"line":141,"column":75}}],"line":141}},"s":{"0":1,"1":54,"2":0,"3":120,"4":54,"5":54,"6":0,"7":0,"8":0,"9":0,"10":174,"11":120,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":63,"34":105,"35":63,"36":63,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":52,"59":52,"60":52,"61":52,"62":52,"63":52,"64":52,"65":52,"66":52,"67":52,"68":52,"69":52,"70":52,"71":52,"72":2,"73":11,"74":11,"75":11,"76":11,"77":2,"78":2,"79":0,"80":52,"81":5620,"82":17285,"83":84,"84":68,"85":68,"86":0,"87":52,"88":16,"89":17201,"90":17201,"91":5377,"92":11824,"93":243,"94":243,"95":1},"f":{"0":120,"1":54,"2":0,"3":120,"4":54,"5":0,"6":174,"7":0,"8":1,"9":63,"10":105,"11":0,"12":0,"13":0,"14":0,"15":0,"16":52,"17":52,"18":52,"19":52,"20":11,"21":11,"22":5620,"23":17285,"24":68,"25":68,"26":243},"b":{"0":[1,1,1],"1":[54,0],"2":[120,120],"3":[120,54],"4":[120,120],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[1,1,1],"13":[0,1],"14":[1,1],"15":[63,0],"16":[63,63],"17":[0,0],"18":[0,0],"19":[52,52],"20":[52,42],"21":[2,50],"22":[0,2],"23":[84,17201],"24":[0,52,16],"25":[68,60,60],"26":[68,60,60],"27":[5377,11824],"28":[17201,5577]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/client.ts","sources":["/home/circleci/repo/src/tools/auth0/client.ts"],"names":[],"mappings":"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","sourcesContent":["import { PromisePoolExecutor } from 'promise-pool-executor';\nimport _ from 'lodash';\n\nimport { flatten } from '../utils';\nimport {\n  Asset,\n  ApiResponse,\n  Auth0APIClient,\n  CheckpointPaginationParams,\n  PagePaginationParams,\n  BaseAuth0APIClient,\n} from '../../types';\n\nconst API_CONCURRENCY = 3;\n// To ensure a complete deployment, limit the API requests generated to be 80% of the capacity\n// https://auth0.com/docs/policies/rate-limits#management-api-v2\nconst API_FREQUENCY_PER_SECOND = 8;\n\nconst MAX_PAGE_SIZE = 100;\n\nfunction getEntity(rsp: ApiResponse): Asset[] {\n  const found = Object.values(rsp).filter((a) => Array.isArray(a));\n  if (Array.isArray(found) && found.length === 1) {\n    return found[0] as Asset[];\n  }\n  throw new Error('There was an error trying to find the entity within paginate');\n}\n\nfunction checkpointPaginator(\n  client: Auth0APIClient,\n  target,\n  name: 'getAll'\n): (arg0: CheckpointPaginationParams) => Promise<Asset[]> {\n  return async function (...args: [CheckpointPaginationParams]) {\n    const data: Asset[] = [];\n\n    // remove the _checkpoint_ flag\n    const { checkpoint, ...newArgs } = _.cloneDeep(args[0]);\n\n    // fetch the total to validate records match\n    const { total } = await client.pool\n      .addSingleTask({\n        data: newArgs,\n        generator: (requestArgs) => target[name](requestArgs),\n      })\n      .promise();\n\n    let done = false;\n    // use checkpoint pagination to allow fetching 1000+ results\n    newArgs.take = 50;\n\n    while (!done) {\n      const rsp = await client.pool\n        .addSingleTask({\n          data: newArgs,\n          generator: (requestArgs) => target[name](requestArgs),\n        })\n        .promise();\n\n      data.push(...getEntity(rsp));\n      if (!rsp.next) {\n        done = true;\n      } else {\n        newArgs.from = rsp.next;\n      }\n    }\n\n    if (data.length !== total) {\n      throw new Error('Fail to load data from tenant');\n    }\n\n    return data;\n  };\n}\n\nfunction pagePaginator(\n  client: Auth0APIClient,\n  target,\n  name: 'getAll'\n): (arg0: PagePaginationParams) => Promise<Asset[]> {\n  return async function (...args: [PagePaginationParams]): Promise<Asset[]> {\n    // Where the entity data will be collected\n    const data: Asset[] = [];\n\n    // Create new args and inject the properties we require for pagination automation\n    const newArgs = [...args];\n    newArgs[0] = { ...newArgs[0], page: 0 };\n\n    // Grab data we need from the request then delete the keys as they are only needed for this automation function to work\n    const perPage = newArgs[0].per_page || MAX_PAGE_SIZE;\n    newArgs[0].per_page = perPage;\n    delete newArgs[0].paginate;\n\n    // Run the first request to get the total number of entity items\n    const rsp = await client.pool\n      .addSingleTask({\n        data: _.cloneDeep(newArgs),\n        generator: (pageArgs) => target[name](...pageArgs),\n      })\n      .promise();\n\n    data.push(...getEntity(rsp));\n    const total = rsp.total || 0;\n    const pagesLeft = Math.ceil(total / perPage) - 1;\n    // Setup pool to get the rest of the pages\n    if (pagesLeft > 0) {\n      const pages = await client.pool\n        .addEachTask({\n          data: Array.from(Array(pagesLeft).keys()),\n          generator: (page) => {\n            const pageArgs = _.cloneDeep(newArgs);\n            pageArgs[0].page = page + 1;\n\n            return target[name](...pageArgs).then((r) => getEntity(r));\n          },\n        })\n        .promise();\n\n      data.push(...flatten(pages));\n\n      if (data.length !== total) {\n        throw new Error('Fail to load data from tenant');\n      }\n    }\n    return data;\n  };\n}\n\n// Warp around a <resource>Manager and detect when requesting specific pages to return all\nfunction pagedManager(client: Auth0APIClient, manager: Auth0APIClient) {\n  return new Proxy<Auth0APIClient>(manager, {\n    get: function (target: Auth0APIClient, name: string, receiver: unknown) {\n      if (name === 'getAll') {\n        return async function (...args: [CheckpointPaginationParams | PagePaginationParams]) {\n          switch (true) {\n            case args[0] && typeof args[0] === 'object' && args[0].checkpoint:\n              return checkpointPaginator(\n                client,\n                target,\n                name\n              )(...(args as [CheckpointPaginationParams]));\n            case args[0] && typeof args[0] === 'object' && args[0].paginate:\n              return pagePaginator(client, target, name)(...(args as [PagePaginationParams]));\n            default:\n              return target[name](...args);\n          }\n        };\n      }\n\n      const nestedManager = Reflect.get(target, name, receiver);\n\n      if (typeof nestedManager === 'object' && nestedManager !== null) {\n        return pagedManager(client, nestedManager);\n      }\n\n      return nestedManager;\n    },\n  });\n}\n\n// Warp around the ManagementClient and detect when requesting specific pages to return all\nexport default function pagedClient(client: BaseAuth0APIClient): Auth0APIClient {\n  const clientWithPooling: Auth0APIClient = {\n    ...client,\n    pool: new PromisePoolExecutor({\n      concurrencyLimit: API_CONCURRENCY,\n      frequencyLimit: API_FREQUENCY_PER_SECOND,\n      frequencyWindow: 1000, // 1 sec\n    }),\n  };\n\n  return pagedManager(clientWithPooling, clientWithPooling);\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a921ce50399adc0b724a52bbac43156ae5224e6b","contentHash":"fc86ac03e1dcfa5237c20329a9c3d8ebb8f6f7a1af40ddeb0b797638c0e40c1a"},"/home/circleci/repo/src/tools/utils.ts":{"path":"/home/circleci/repo/src/tools/utils.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":16},"end":{"line":33,"column":1}},"25":{"start":{"line":26,"column":28},"end":{"line":26,"column":110}},"26":{"start":{"line":26,"column":91},"end":{"line":26,"column":106}},"27":{"start":{"line":27,"column":4},"end":{"line":32,"column":7}},"28":{"start":{"line":28,"column":36},"end":{"line":28,"column":97}},"29":{"start":{"line":28,"column":42},"end":{"line":28,"column":70}},"30":{"start":{"line":28,"column":85},"end":{"line":28,"column":95}},"31":{"start":{"line":29,"column":35},"end":{"line":29,"column":100}},"32":{"start":{"line":29,"column":41},"end":{"line":29,"column":73}},"33":{"start":{"line":29,"column":88},"end":{"line":29,"column":98}},"34":{"start":{"line":30,"column":32},"end":{"line":30,"column":116}},"35":{"start":{"line":31,"column":8},"end":{"line":31,"column":78}},"36":{"start":{"line":34,"column":22},"end":{"line":36,"column":1}},"37":{"start":{"line":35,"column":4},"end":{"line":35,"column":62}},"38":{"start":{"line":37,"column":0},"end":{"line":37,"column":62}},"39":{"start":{"line":38,"column":0},"end":{"line":38,"column":646}},"40":{"start":{"line":39,"column":15},"end":{"line":39,"column":47}},"41":{"start":{"line":40,"column":13},"end":{"line":40,"column":40}},"42":{"start":{"line":41,"column":19},"end":{"line":41,"column":55}},"43":{"start":{"line":42,"column":17},"end":{"line":42,"column":51}},"44":{"start":{"line":43,"column":17},"end":{"line":43,"column":54}},"45":{"start":{"line":44,"column":20},"end":{"line":44,"column":59}},"46":{"start":{"line":45,"column":34},"end":{"line":51,"column":1}},"47":{"start":{"line":46,"column":20},"end":{"line":46,"column":32}},"48":{"start":{"line":48,"column":36},"end":{"line":48,"column":50}},"49":{"start":{"line":49,"column":36},"end":{"line":49,"column":50}},"50":{"start":{"line":50,"column":4},"end":{"line":50,"column":95}},"51":{"start":{"line":52,"column":0},"end":{"line":52,"column":62}},"52":{"start":{"line":53,"column":35},"end":{"line":55,"column":1}},"53":{"start":{"line":54,"column":4},"end":{"line":54,"column":41}},"54":{"start":{"line":56,"column":0},"end":{"line":56,"column":64}},"55":{"start":{"line":58,"column":4},"end":{"line":62,"column":7}},"56":{"start":{"line":60,"column":22},"end":{"line":60,"column":65}},"57":{"start":{"line":61,"column":8},"end":{"line":61,"column":68}},"58":{"start":{"line":63,"column":4},"end":{"line":63,"column":17}},"59":{"start":{"line":65,"column":0},"end":{"line":65,"column":50}},"60":{"start":{"line":67,"column":4},"end":{"line":71,"column":7}},"61":{"start":{"line":68,"column":22},"end":{"line":68,"column":66}},"62":{"start":{"line":70,"column":8},"end":{"line":70,"column":52}},"63":{"start":{"line":72,"column":4},"end":{"line":72,"column":17}},"64":{"start":{"line":74,"column":0},"end":{"line":74,"column":52}},"65":{"start":{"line":77,"column":4},"end":{"line":80,"column":5}},"66":{"start":{"line":78,"column":8},"end":{"line":78,"column":53}},"67":{"start":{"line":79,"column":8},"end":{"line":79,"column":54}},"68":{"start":{"line":81,"column":4},"end":{"line":81,"column":17}},"69":{"start":{"line":83,"column":0},"end":{"line":83,"column":40}},"70":{"start":{"line":88,"column":18},"end":{"line":88,"column":22}},"71":{"start":{"line":89,"column":4},"end":{"line":91,"column":7}},"72":{"start":{"line":90,"column":8},"end":{"line":90,"column":113}},"73":{"start":{"line":92,"column":4},"end":{"line":92,"column":19}},"74":{"start":{"line":94,"column":0},"end":{"line":94,"column":74}},"75":{"start":{"line":96,"column":18},"end":{"line":96,"column":54}},"76":{"start":{"line":96,"column":38},"end":{"line":96,"column":53}},"77":{"start":{"line":97,"column":4},"end":{"line":97,"column":46}},"78":{"start":{"line":99,"column":0},"end":{"line":99,"column":54}},"79":{"start":{"line":101,"column":26},"end":{"line":101,"column":74}},"80":{"start":{"line":101,"column":47},"end":{"line":101,"column":72}},"81":{"start":{"line":102,"column":19},"end":{"line":109,"column":10}},"82":{"start":{"line":103,"column":8},"end":{"line":107,"column":9}},"83":{"start":{"line":104,"column":26},"end":{"line":104,"column":86}},"84":{"start":{"line":104,"column":60},"end":{"line":104,"column":85}},"85":{"start":{"line":105,"column":12},"end":{"line":105,"column":49}},"86":{"start":{"line":106,"column":12},"end":{"line":106,"column":46}},"87":{"start":{"line":108,"column":8},"end":{"line":108,"column":24}},"88":{"start":{"line":110,"column":23},"end":{"line":110,"column":94}},"89":{"start":{"line":110,"column":54},"end":{"line":110,"column":68}},"90":{"start":{"line":110,"column":84},"end":{"line":110,"column":93}},"91":{"start":{"line":112,"column":4},"end":{"line":112,"column":38}},"92":{"start":{"line":114,"column":0},"end":{"line":114,"column":58}},"93":{"start":{"line":117,"column":14},"end":{"line":117,"column":42}},"94":{"start":{"line":118,"column":4},"end":{"line":127,"column":5}},"95":{"start":{"line":119,"column":8},"end":{"line":119,"column":56}},"96":{"start":{"line":120,"column":8},"end":{"line":122,"column":9}},"97":{"start":{"line":121,"column":12},"end":{"line":121,"column":82}},"98":{"start":{"line":123,"column":8},"end":{"line":123,"column":52}},"99":{"start":{"line":126,"column":8},"end":{"line":126,"column":68}},"100":{"start":{"line":129,"column":0},"end":{"line":129,"column":64}},"101":{"start":{"line":132,"column":4},"end":{"line":132,"column":82}},"102":{"start":{"line":132,"column":33},"end":{"line":132,"column":76}},"103":{"start":{"line":134,"column":0},"end":{"line":134,"column":26}},"104":{"start":{"line":136,"column":4},"end":{"line":136,"column":46}},"105":{"start":{"line":138,"column":0},"end":{"line":138,"column":50}},"106":{"start":{"line":141,"column":21},"end":{"line":141,"column":23}},"107":{"start":{"line":142,"column":19},"end":{"line":142,"column":41}},"108":{"start":{"line":143,"column":4},"end":{"line":148,"column":7}},"109":{"start":{"line":144,"column":8},"end":{"line":147,"column":9}},"110":{"start":{"line":145,"column":12},"end":{"line":145,"column":49}},"111":{"start":{"line":146,"column":12},"end":{"line":146,"column":29}},"112":{"start":{"line":149,"column":4},"end":{"line":152,"column":5}},"113":{"start":{"line":150,"column":21},"end":{"line":150,"column":97}},"114":{"start":{"line":150,"column":78},"end":{"line":150,"column":92}},"115":{"start":{"line":151,"column":8},"end":{"line":151,"column":99}},"116":{"start":{"line":153,"column":4},"end":{"line":153,"column":18}},"117":{"start":{"line":155,"column":0},"end":{"line":155,"column":34}},"118":{"start":{"line":158,"column":4},"end":{"line":159,"column":25}},"119":{"start":{"line":159,"column":8},"end":{"line":159,"column":25}},"120":{"start":{"line":160,"column":35},"end":{"line":160,"column":83}},"121":{"start":{"line":161,"column":28},"end":{"line":161,"column":84}},"122":{"start":{"line":162,"column":27},"end":{"line":164,"column":5}},"123":{"start":{"line":163,"column":95},"end":{"line":163,"column":158}},"124":{"start":{"line":167,"column":4},"end":{"line":175,"column":7}},"125":{"start":{"line":168,"column":8},"end":{"line":174,"column":9}},"126":{"start":{"line":169,"column":12},"end":{"line":173,"column":15}},"127":{"start":{"line":170,"column":16},"end":{"line":172,"column":17}},"128":{"start":{"line":171,"column":20},"end":{"line":171,"column":56}},"129":{"start":{"line":176,"column":4},"end":{"line":176,"column":26}},"130":{"start":{"line":178,"column":0},"end":{"line":178,"column":46}},"131":{"start":{"line":181,"column":23},"end":{"line":189,"column":10}},"132":{"start":{"line":182,"column":25},"end":{"line":182,"column":33}},"133":{"start":{"line":183,"column":8},"end":{"line":187,"column":9}},"134":{"start":{"line":184,"column":12},"end":{"line":185,"column":37}},"135":{"start":{"line":185,"column":16},"end":{"line":185,"column":37}},"136":{"start":{"line":186,"column":12},"end":{"line":186,"column":38}},"137":{"start":{"line":188,"column":8},"end":{"line":188,"column":21}},"138":{"start":{"line":190,"column":4},"end":{"line":190,"column":65}},"139":{"start":{"line":190,"column":51},"end":{"line":190,"column":63}},"140":{"start":{"line":192,"column":0},"end":{"line":192,"column":40}},"141":{"start":{"line":194,"column":47},"end":{"line":194,"column":54}},"142":{"start":{"line":195,"column":4},"end":{"line":197,"column":5}},"143":{"start":{"line":196,"column":8},"end":{"line":196,"column":23}},"144":{"start":{"line":198,"column":19},"end":{"line":198,"column":80}},"145":{"start":{"line":198,"column":29},"end":{"line":198,"column":80}},"146":{"start":{"line":198,"column":51},"end":{"line":198,"column":79}},"147":{"start":{"line":199,"column":4},"end":{"line":204,"column":6}},"148":{"start":{"line":206,"column":0},"end":{"line":206,"column":40}},"149":{"start":{"line":208,"column":4},"end":{"line":208,"column":66}},"150":{"start":{"line":210,"column":0},"end":{"line":210,"column":42}},"151":{"start":{"line":211,"column":33},"end":{"line":224,"column":1}},"152":{"start":{"line":212,"column":4},"end":{"line":213,"column":20}},"153":{"start":{"line":213,"column":8},"end":{"line":213,"column":20}},"154":{"start":{"line":214,"column":4},"end":{"line":216,"column":5}},"155":{"start":{"line":215,"column":8},"end":{"line":215,"column":109}},"156":{"start":{"line":215,"column":35},"end":{"line":215,"column":107}},"157":{"start":{"line":217,"column":21},"end":{"line":217,"column":44}},"158":{"start":{"line":218,"column":4},"end":{"line":222,"column":7}},"159":{"start":{"line":219,"column":8},"end":{"line":221,"column":9}},"160":{"start":{"line":220,"column":12},"end":{"line":220,"column":106}},"161":{"start":{"line":223,"column":4},"end":{"line":223,"column":20}},"162":{"start":{"line":225,"column":0},"end":{"line":225,"column":60}},"163":{"start":{"line":227,"column":41},"end":{"line":241,"column":1}},"164":{"start":{"line":228,"column":4},"end":{"line":229,"column":20}},"165":{"start":{"line":229,"column":8},"end":{"line":229,"column":20}},"166":{"start":{"line":230,"column":4},"end":{"line":232,"column":5}},"167":{"start":{"line":231,"column":8},"end":{"line":231,"column":107}},"168":{"start":{"line":231,"column":35},"end":{"line":231,"column":105}},"169":{"start":{"line":233,"column":21},"end":{"line":233,"column":44}},"170":{"start":{"line":234,"column":4},"end":{"line":239,"column":7}},"171":{"start":{"line":235,"column":37},"end":{"line":235,"column":85}},"172":{"start":{"line":236,"column":8},"end":{"line":238,"column":9}},"173":{"start":{"line":237,"column":12},"end":{"line":237,"column":64}},"174":{"start":{"line":240,"column":4},"end":{"line":240,"column":20}},"175":{"start":{"line":242,"column":0},"end":{"line":242,"column":76}},"176":{"start":{"line":243,"column":37},"end":{"line":264,"column":2}},"177":{"start":{"line":243,"column":45},"end":{"line":264,"column":2}},"178":{"start":{"line":245,"column":4},"end":{"line":263,"column":5}},"179":{"start":{"line":246,"column":21},"end":{"line":246,"column":31}},"180":{"start":{"line":247,"column":8},"end":{"line":251,"column":10}},"181":{"start":{"line":254,"column":8},"end":{"line":261,"column":9}},"182":{"start":{"line":255,"column":35},"end":{"line":255,"column":196}},"183":{"start":{"line":256,"column":12},"end":{"line":260,"column":14}},"184":{"start":{"line":262,"column":8},"end":{"line":262,"column":18}},"185":{"start":{"line":265,"column":0},"end":{"line":265,"column":68}},"186":{"start":{"line":267,"column":4},"end":{"line":267,"column":61}},"187":{"start":{"line":267,"column":36},"end":{"line":267,"column":59}},"188":{"start":{"line":269,"column":0},"end":{"line":269,"column":22}},"189":{"start":{"line":270,"column":26},"end":{"line":275,"column":1}},"190":{"start":{"line":272,"column":4},"end":{"line":273,"column":21}},"191":{"start":{"line":273,"column":8},"end":{"line":273,"column":21}},"192":{"start":{"line":274,"column":4},"end":{"line":274,"column":133}},"193":{"start":{"line":276,"column":0},"end":{"line":276,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":44},"end":{"line":25,"column":45}},"loc":{"start":{"line":25,"column":89},"end":{"line":33,"column":1}},"line":25},"7":{"name":"adopt","decl":{"start":{"line":26,"column":13},"end":{"line":26,"column":18}},"loc":{"start":{"line":26,"column":26},"end":{"line":26,"column":112}},"line":26},"8":{"name":"(anonymous_8)","decl":{"start":{"line":26,"column":70},"end":{"line":26,"column":71}},"loc":{"start":{"line":26,"column":89},"end":{"line":26,"column":108}},"line":26},"9":{"name":"(anonymous_9)","decl":{"start":{"line":27,"column":36},"end":{"line":27,"column":37}},"loc":{"start":{"line":27,"column":63},"end":{"line":32,"column":5}},"line":27},"10":{"name":"fulfilled","decl":{"start":{"line":28,"column":17},"end":{"line":28,"column":26}},"loc":{"start":{"line":28,"column":34},"end":{"line":28,"column":99}},"line":28},"11":{"name":"rejected","decl":{"start":{"line":29,"column":17},"end":{"line":29,"column":25}},"loc":{"start":{"line":29,"column":33},"end":{"line":29,"column":102}},"line":29},"12":{"name":"step","decl":{"start":{"line":30,"column":17},"end":{"line":30,"column":21}},"loc":{"start":{"line":30,"column":30},"end":{"line":30,"column":118}},"line":30},"13":{"name":"(anonymous_13)","decl":{"start":{"line":34,"column":56},"end":{"line":34,"column":57}},"loc":{"start":{"line":34,"column":71},"end":{"line":36,"column":1}},"line":34},"14":{"name":"(anonymous_14)","decl":{"start":{"line":45,"column":34},"end":{"line":45,"column":35}},"loc":{"start":{"line":45,"column":43},"end":{"line":51,"column":1}},"line":45},"15":{"name":"(anonymous_15)","decl":{"start":{"line":53,"column":35},"end":{"line":53,"column":36}},"loc":{"start":{"line":53,"column":44},"end":{"line":55,"column":1}},"line":53},"16":{"name":"keywordArrayReplace","decl":{"start":{"line":57,"column":9},"end":{"line":57,"column":28}},"loc":{"start":{"line":57,"column":46},"end":{"line":64,"column":1}},"line":57},"17":{"name":"(anonymous_17)","decl":{"start":{"line":58,"column":34},"end":{"line":58,"column":35}},"loc":{"start":{"line":58,"column":49},"end":{"line":62,"column":5}},"line":58},"18":{"name":"keywordStringReplace","decl":{"start":{"line":66,"column":9},"end":{"line":66,"column":29}},"loc":{"start":{"line":66,"column":47},"end":{"line":73,"column":1}},"line":66},"19":{"name":"(anonymous_19)","decl":{"start":{"line":67,"column":34},"end":{"line":67,"column":35}},"loc":{"start":{"line":67,"column":49},"end":{"line":71,"column":5}},"line":67},"20":{"name":"keywordReplace","decl":{"start":{"line":75,"column":9},"end":{"line":75,"column":23}},"loc":{"start":{"line":75,"column":41},"end":{"line":82,"column":1}},"line":75},"21":{"name":"wrapArrayReplaceMarkersInQuotes","decl":{"start":{"line":87,"column":9},"end":{"line":87,"column":40}},"loc":{"start":{"line":87,"column":57},"end":{"line":93,"column":1}},"line":87},"22":{"name":"(anonymous_22)","decl":{"start":{"line":89,"column":34},"end":{"line":89,"column":35}},"loc":{"start":{"line":89,"column":47},"end":{"line":91,"column":5}},"line":89},"23":{"name":"convertClientNameToId","decl":{"start":{"line":95,"column":9},"end":{"line":95,"column":30}},"loc":{"start":{"line":95,"column":46},"end":{"line":98,"column":1}},"line":95},"24":{"name":"(anonymous_24)","decl":{"start":{"line":96,"column":31},"end":{"line":96,"column":32}},"loc":{"start":{"line":96,"column":38},"end":{"line":96,"column":53}},"line":96},"25":{"name":"convertClientNamesToIds","decl":{"start":{"line":100,"column":9},"end":{"line":100,"column":32}},"loc":{"start":{"line":100,"column":49},"end":{"line":113,"column":1}},"line":100},"26":{"name":"(anonymous_26)","decl":{"start":{"line":101,"column":36},"end":{"line":101,"column":37}},"loc":{"start":{"line":101,"column":47},"end":{"line":101,"column":72}},"line":101},"27":{"name":"(anonymous_27)","decl":{"start":{"line":102,"column":34},"end":{"line":102,"column":35}},"loc":{"start":{"line":102,"column":51},"end":{"line":109,"column":5}},"line":102},"28":{"name":"(anonymous_28)","decl":{"start":{"line":104,"column":50},"end":{"line":104,"column":51}},"loc":{"start":{"line":104,"column":60},"end":{"line":104,"column":85}},"line":104},"29":{"name":"(anonymous_29)","decl":{"start":{"line":110,"column":44},"end":{"line":110,"column":45}},"loc":{"start":{"line":110,"column":54},"end":{"line":110,"column":68}},"line":110},"30":{"name":"(anonymous_30)","decl":{"start":{"line":110,"column":74},"end":{"line":110,"column":75}},"loc":{"start":{"line":110,"column":84},"end":{"line":110,"column":93}},"line":110},"31":{"name":"loadFileAndReplaceKeywords","decl":{"start":{"line":115,"column":9},"end":{"line":115,"column":35}},"loc":{"start":{"line":115,"column":92},"end":{"line":128,"column":1}},"line":115},"32":{"name":"flatten","decl":{"start":{"line":130,"column":9},"end":{"line":130,"column":16}},"loc":{"start":{"line":130,"column":23},"end":{"line":133,"column":1}},"line":130},"33":{"name":"(anonymous_33)","decl":{"start":{"line":132,"column":23},"end":{"line":132,"column":24}},"loc":{"start":{"line":132,"column":33},"end":{"line":132,"column":76}},"line":132},"34":{"name":"convertJsonToString","decl":{"start":{"line":135,"column":9},"end":{"line":135,"column":28}},"loc":{"start":{"line":135,"column":47},"end":{"line":137,"column":1}},"line":135},"35":{"name":"stripFields","decl":{"start":{"line":139,"column":9},"end":{"line":139,"column":20}},"loc":{"start":{"line":139,"column":34},"end":{"line":154,"column":1}},"line":139},"36":{"name":"(anonymous_36)","decl":{"start":{"line":143,"column":19},"end":{"line":143,"column":20}},"loc":{"start":{"line":143,"column":26},"end":{"line":148,"column":5}},"line":143},"37":{"name":"(anonymous_37)","decl":{"start":{"line":150,"column":68},"end":{"line":150,"column":69}},"loc":{"start":{"line":150,"column":78},"end":{"line":150,"column":92}},"line":150},"38":{"name":"getEnabledClients","decl":{"start":{"line":156,"column":9},"end":{"line":156,"column":26}},"loc":{"start":{"line":156,"column":66},"end":{"line":177,"column":1}},"line":156},"39":{"name":"(anonymous_39)","decl":{"start":{"line":163,"column":85},"end":{"line":163,"column":86}},"loc":{"start":{"line":163,"column":95},"end":{"line":163,"column":158}},"line":163},"40":{"name":"(anonymous_40)","decl":{"start":{"line":167,"column":21},"end":{"line":167,"column":22}},"loc":{"start":{"line":167,"column":31},"end":{"line":175,"column":5}},"line":167},"41":{"name":"(anonymous_41)","decl":{"start":{"line":169,"column":36},"end":{"line":169,"column":37}},"loc":{"start":{"line":169,"column":56},"end":{"line":173,"column":13}},"line":169},"42":{"name":"duplicateItems","decl":{"start":{"line":179,"column":9},"end":{"line":179,"column":23}},"loc":{"start":{"line":179,"column":34},"end":{"line":191,"column":1}},"line":179},"43":{"name":"(anonymous_43)","decl":{"start":{"line":181,"column":34},"end":{"line":181,"column":35}},"loc":{"start":{"line":181,"column":50},"end":{"line":189,"column":5}},"line":181},"44":{"name":"(anonymous_44)","decl":{"start":{"line":190,"column":44},"end":{"line":190,"column":45}},"loc":{"start":{"line":190,"column":51},"end":{"line":190,"column":63}},"line":190},"45":{"name":"filterExcluded","decl":{"start":{"line":193,"column":9},"end":{"line":193,"column":23}},"loc":{"start":{"line":193,"column":42},"end":{"line":205,"column":1}},"line":193},"46":{"name":"(anonymous_46)","decl":{"start":{"line":198,"column":19},"end":{"line":198,"column":20}},"loc":{"start":{"line":198,"column":29},"end":{"line":198,"column":80}},"line":198},"47":{"name":"(anonymous_47)","decl":{"start":{"line":198,"column":41},"end":{"line":198,"column":42}},"loc":{"start":{"line":198,"column":51},"end":{"line":198,"column":79}},"line":198},"48":{"name":"areArraysEquals","decl":{"start":{"line":207,"column":9},"end":{"line":207,"column":24}},"loc":{"start":{"line":207,"column":31},"end":{"line":209,"column":1}},"line":207},"49":{"name":"(anonymous_49)","decl":{"start":{"line":211,"column":33},"end":{"line":211,"column":34}},"loc":{"start":{"line":211,"column":71},"end":{"line":224,"column":1}},"line":211},"50":{"name":"(anonymous_50)","decl":{"start":{"line":215,"column":24},"end":{"line":215,"column":25}},"loc":{"start":{"line":215,"column":35},"end":{"line":215,"column":107}},"line":215},"51":{"name":"(anonymous_51)","decl":{"start":{"line":218,"column":39},"end":{"line":218,"column":40}},"loc":{"start":{"line":218,"column":59},"end":{"line":222,"column":5}},"line":218},"52":{"name":"(anonymous_52)","decl":{"start":{"line":227,"column":41},"end":{"line":227,"column":42}},"loc":{"start":{"line":227,"column":69},"end":{"line":241,"column":1}},"line":227},"53":{"name":"(anonymous_53)","decl":{"start":{"line":231,"column":24},"end":{"line":231,"column":25}},"loc":{"start":{"line":231,"column":35},"end":{"line":231,"column":105}},"line":231},"54":{"name":"(anonymous_54)","decl":{"start":{"line":234,"column":29},"end":{"line":234,"column":30}},"loc":{"start":{"line":234,"column":49},"end":{"line":239,"column":5}},"line":234},"55":{"name":"(anonymous_55)","decl":{"start":{"line":243,"column":37},"end":{"line":243,"column":38}},"loc":{"start":{"line":243,"column":45},"end":{"line":264,"column":2}},"line":243},"56":{"name":"(anonymous_56)","decl":{"start":{"line":243,"column":79},"end":{"line":243,"column":80}},"loc":{"start":{"line":243,"column":92},"end":{"line":264,"column":1}},"line":243},"57":{"name":"sleep","decl":{"start":{"line":266,"column":9},"end":{"line":266,"column":14}},"loc":{"start":{"line":266,"column":19},"end":{"line":268,"column":1}},"line":266},"58":{"name":"(anonymous_58)","decl":{"start":{"line":267,"column":23},"end":{"line":267,"column":24}},"loc":{"start":{"line":267,"column":36},"end":{"line":267,"column":59}},"line":267},"59":{"name":"(anonymous_59)","decl":{"start":{"line":270,"column":26},"end":{"line":270,"column":27}},"loc":{"start":{"line":270,"column":35},"end":{"line":275,"column":1}},"line":270}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":25,"column":16},"end":{"line":33,"column":1}},"type":"binary-expr","locations":[{"start":{"line":25,"column":17},"end":{"line":25,"column":21}},{"start":{"line":25,"column":25},"end":{"line":25,"column":39}},{"start":{"line":25,"column":44},"end":{"line":33,"column":1}}],"line":25},"17":{"loc":{"start":{"line":26,"column":35},"end":{"line":26,"column":109}},"type":"cond-expr","locations":[{"start":{"line":26,"column":56},"end":{"line":26,"column":61}},{"start":{"line":26,"column":64},"end":{"line":26,"column":109}}],"line":26},"18":{"loc":{"start":{"line":27,"column":16},"end":{"line":27,"column":34}},"type":"binary-expr","locations":[{"start":{"line":27,"column":16},"end":{"line":27,"column":17}},{"start":{"line":27,"column":22},"end":{"line":27,"column":33}}],"line":27},"19":{"loc":{"start":{"line":30,"column":32},"end":{"line":30,"column":115}},"type":"cond-expr","locations":[{"start":{"line":30,"column":46},"end":{"line":30,"column":67}},{"start":{"line":30,"column":70},"end":{"line":30,"column":115}}],"line":30},"20":{"loc":{"start":{"line":31,"column":51},"end":{"line":31,"column":67}},"type":"binary-expr","locations":[{"start":{"line":31,"column":51},"end":{"line":31,"column":61}},{"start":{"line":31,"column":65},"end":{"line":31,"column":67}}],"line":31},"21":{"loc":{"start":{"line":34,"column":22},"end":{"line":36,"column":1}},"type":"binary-expr","locations":[{"start":{"line":34,"column":23},"end":{"line":34,"column":27}},{"start":{"line":34,"column":31},"end":{"line":34,"column":51}},{"start":{"line":34,"column":56},"end":{"line":36,"column":1}}],"line":34},"22":{"loc":{"start":{"line":35,"column":11},"end":{"line":35,"column":61}},"type":"cond-expr","locations":[{"start":{"line":35,"column":37},"end":{"line":35,"column":40}},{"start":{"line":35,"column":43},"end":{"line":35,"column":61}}],"line":35},"23":{"loc":{"start":{"line":35,"column":12},"end":{"line":35,"column":33}},"type":"binary-expr","locations":[{"start":{"line":35,"column":12},"end":{"line":35,"column":15}},{"start":{"line":35,"column":19},"end":{"line":35,"column":33}}],"line":35},"24":{"loc":{"start":{"line":77,"column":4},"end":{"line":80,"column":5}},"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":80,"column":5}},{"start":{"line":77,"column":4},"end":{"line":80,"column":5}}],"line":77},"25":{"loc":{"start":{"line":77,"column":8},"end":{"line":77,"column":52}},"type":"binary-expr","locations":[{"start":{"line":77,"column":8},"end":{"line":77,"column":16}},{"start":{"line":77,"column":20},"end":{"line":77,"column":52}}],"line":77},"26":{"loc":{"start":{"line":97,"column":11},"end":{"line":97,"column":45}},"type":"binary-expr","locations":[{"start":{"line":97,"column":12},"end":{"line":97,"column":17}},{"start":{"line":97,"column":21},"end":{"line":97,"column":36}},{"start":{"line":97,"column":41},"end":{"line":97,"column":45}}],"line":97},"27":{"loc":{"start":{"line":103,"column":8},"end":{"line":107,"column":9}},"type":"if","locations":[{"start":{"line":103,"column":8},"end":{"line":107,"column":9}},{"start":{"line":103,"column":8},"end":{"line":107,"column":9}}],"line":103},"28":{"loc":{"start":{"line":115,"column":54},"end":{"line":115,"column":87}},"type":"default-arg","locations":[{"start":{"line":115,"column":82},"end":{"line":115,"column":87}}],"line":115},"29":{"loc":{"start":{"line":120,"column":8},"end":{"line":122,"column":9}},"type":"if","locations":[{"start":{"line":120,"column":8},"end":{"line":122,"column":9}},{"start":{"line":120,"column":8},"end":{"line":122,"column":9}}],"line":120},"30":{"loc":{"start":{"line":120,"column":12},"end":{"line":120,"column":50}},"type":"binary-expr","locations":[{"start":{"line":120,"column":12},"end":{"line":120,"column":20}},{"start":{"line":120,"column":24},"end":{"line":120,"column":50}}],"line":120},"31":{"loc":{"start":{"line":132,"column":42},"end":{"line":132,"column":75}},"type":"cond-expr","locations":[{"start":{"line":132,"column":61},"end":{"line":132,"column":71}},{"start":{"line":132,"column":74},"end":{"line":132,"column":75}}],"line":132},"32":{"loc":{"start":{"line":135,"column":34},"end":{"line":135,"column":45}},"type":"default-arg","locations":[{"start":{"line":135,"column":44},"end":{"line":135,"column":45}}],"line":135},"33":{"loc":{"start":{"line":144,"column":8},"end":{"line":147,"column":9}},"type":"if","locations":[{"start":{"line":144,"column":8},"end":{"line":147,"column":9}},{"start":{"line":144,"column":8},"end":{"line":147,"column":9}}],"line":144},"34":{"loc":{"start":{"line":149,"column":4},"end":{"line":152,"column":5}},"type":"if","locations":[{"start":{"line":149,"column":4},"end":{"line":152,"column":5}},{"start":{"line":149,"column":4},"end":{"line":152,"column":5}}],"line":149},"35":{"loc":{"start":{"line":150,"column":78},"end":{"line":150,"column":92}},"type":"binary-expr","locations":[{"start":{"line":150,"column":78},"end":{"line":150,"column":87}},{"start":{"line":150,"column":91},"end":{"line":150,"column":92}}],"line":150},"36":{"loc":{"start":{"line":158,"column":4},"end":{"line":159,"column":25}},"type":"if","locations":[{"start":{"line":158,"column":4},"end":{"line":159,"column":25}},{"start":{"line":158,"column":4},"end":{"line":159,"column":25}}],"line":158},"37":{"loc":{"start":{"line":160,"column":35},"end":{"line":160,"column":83}},"type":"binary-expr","locations":[{"start":{"line":160,"column":36},"end":{"line":160,"column":50}},{"start":{"line":160,"column":54},"end":{"line":160,"column":76}},{"start":{"line":160,"column":81},"end":{"line":160,"column":83}}],"line":160},"38":{"loc":{"start":{"line":163,"column":35},"end":{"line":163,"column":67}},"type":"binary-expr","locations":[{"start":{"line":163,"column":35},"end":{"line":163,"column":61}},{"start":{"line":163,"column":65},"end":{"line":163,"column":67}}],"line":163},"39":{"loc":{"start":{"line":168,"column":8},"end":{"line":174,"column":9}},"type":"if","locations":[{"start":{"line":168,"column":8},"end":{"line":174,"column":9}},{"start":{"line":168,"column":8},"end":{"line":174,"column":9}}],"line":168},"40":{"loc":{"start":{"line":170,"column":16},"end":{"line":172,"column":17}},"type":"if","locations":[{"start":{"line":170,"column":16},"end":{"line":172,"column":17}},{"start":{"line":170,"column":16},"end":{"line":172,"column":17}}],"line":170},"41":{"loc":{"start":{"line":183,"column":8},"end":{"line":187,"column":9}},"type":"if","locations":[{"start":{"line":183,"column":8},"end":{"line":187,"column":9}},{"start":{"line":183,"column":8},"end":{"line":187,"column":9}}],"line":183},"42":{"loc":{"start":{"line":184,"column":12},"end":{"line":185,"column":37}},"type":"if","locations":[{"start":{"line":184,"column":12},"end":{"line":185,"column":37}},{"start":{"line":184,"column":12},"end":{"line":185,"column":37}}],"line":184},"43":{"loc":{"start":{"line":195,"column":4},"end":{"line":197,"column":5}},"type":"if","locations":[{"start":{"line":195,"column":4},"end":{"line":197,"column":5}},{"start":{"line":195,"column":4},"end":{"line":197,"column":5}}],"line":195},"44":{"loc":{"start":{"line":208,"column":36},"end":{"line":208,"column":49}},"type":"binary-expr","locations":[{"start":{"line":208,"column":36},"end":{"line":208,"column":37}},{"start":{"line":208,"column":41},"end":{"line":208,"column":49}}],"line":208},"45":{"loc":{"start":{"line":208,"column":51},"end":{"line":208,"column":64}},"type":"binary-expr","locations":[{"start":{"line":208,"column":51},"end":{"line":208,"column":52}},{"start":{"line":208,"column":56},"end":{"line":208,"column":64}}],"line":208},"46":{"loc":{"start":{"line":212,"column":4},"end":{"line":213,"column":20}},"type":"if","locations":[{"start":{"line":212,"column":4},"end":{"line":213,"column":20}},{"start":{"line":212,"column":4},"end":{"line":213,"column":20}}],"line":212},"47":{"loc":{"start":{"line":214,"column":4},"end":{"line":216,"column":5}},"type":"if","locations":[{"start":{"line":214,"column":4},"end":{"line":216,"column":5}},{"start":{"line":214,"column":4},"end":{"line":216,"column":5}}],"line":214},"48":{"loc":{"start":{"line":219,"column":8},"end":{"line":221,"column":9}},"type":"if","locations":[{"start":{"line":219,"column":8},"end":{"line":221,"column":9}},{"start":{"line":219,"column":8},"end":{"line":221,"column":9}}],"line":219},"49":{"loc":{"start":{"line":228,"column":4},"end":{"line":229,"column":20}},"type":"if","locations":[{"start":{"line":228,"column":4},"end":{"line":229,"column":20}},{"start":{"line":228,"column":4},"end":{"line":229,"column":20}}],"line":228},"50":{"loc":{"start":{"line":230,"column":4},"end":{"line":232,"column":5}},"type":"if","locations":[{"start":{"line":230,"column":4},"end":{"line":232,"column":5}},{"start":{"line":230,"column":4},"end":{"line":232,"column":5}}],"line":230},"51":{"loc":{"start":{"line":236,"column":8},"end":{"line":238,"column":9}},"type":"if","locations":[{"start":{"line":236,"column":8},"end":{"line":238,"column":9}},{"start":{"line":236,"column":8},"end":{"line":238,"column":9}}],"line":236},"52":{"loc":{"start":{"line":254,"column":8},"end":{"line":261,"column":9}},"type":"if","locations":[{"start":{"line":254,"column":8},"end":{"line":261,"column":9}},{"start":{"line":254,"column":8},"end":{"line":261,"column":9}}],"line":254},"53":{"loc":{"start":{"line":254,"column":12},"end":{"line":254,"column":80}},"type":"binary-expr","locations":[{"start":{"line":254,"column":12},"end":{"line":254,"column":34}},{"start":{"line":254,"column":38},"end":{"line":254,"column":80}}],"line":254},"54":{"loc":{"start":{"line":255,"column":35},"end":{"line":255,"column":196}},"type":"cond-expr","locations":[{"start":{"line":255,"column":176},"end":{"line":255,"column":182}},{"start":{"line":255,"column":185},"end":{"line":255,"column":196}}],"line":255},"55":{"loc":{"start":{"line":255,"column":35},"end":{"line":255,"column":173}},"type":"binary-expr","locations":[{"start":{"line":255,"column":35},"end":{"line":255,"column":156}},{"start":{"line":255,"column":160},"end":{"line":255,"column":173}}],"line":255},"56":{"loc":{"start":{"line":255,"column":41},"end":{"line":255,"column":146}},"type":"cond-expr","locations":[{"start":{"line":255,"column":88},"end":{"line":255,"column":94}},{"start":{"line":255,"column":97},"end":{"line":255,"column":146}}],"line":255},"57":{"loc":{"start":{"line":255,"column":41},"end":{"line":255,"column":85}},"type":"binary-expr","locations":[{"start":{"line":255,"column":41},"end":{"line":255,"column":68}},{"start":{"line":255,"column":72},"end":{"line":255,"column":85}}],"line":255},"58":{"loc":{"start":{"line":272,"column":4},"end":{"line":273,"column":21}},"type":"if","locations":[{"start":{"line":272,"column":4},"end":{"line":273,"column":21}},{"start":{"line":272,"column":4},"end":{"line":273,"column":21}}],"line":272},"59":{"loc":{"start":{"line":274,"column":14},"end":{"line":274,"column":131}},"type":"binary-expr","locations":[{"start":{"line":274,"column":14},"end":{"line":274,"column":36}},{"start":{"line":274,"column":41},"end":{"line":274,"column":130}}],"line":274},"60":{"loc":{"start":{"line":274,"column":41},"end":{"line":274,"column":130}},"type":"cond-expr","locations":[{"start":{"line":274,"column":88},"end":{"line":274,"column":94}},{"start":{"line":274,"column":97},"end":{"line":274,"column":130}}],"line":274},"61":{"loc":{"start":{"line":274,"column":41},"end":{"line":274,"column":85}},"type":"binary-expr","locations":[{"start":{"line":274,"column":41},"end":{"line":274,"column":68}},{"start":{"line":274,"column":72},"end":{"line":274,"column":85}}],"line":274}},"s":{"0":1,"1":103,"2":103,"3":103,"4":103,"5":98,"6":0,"7":103,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":1,"15":1,"16":0,"17":1,"18":1,"19":1,"20":103,"21":103,"22":1,"23":1,"24":1,"25":124,"26":1,"27":126,"28":124,"29":124,"30":0,"31":0,"32":0,"33":0,"34":249,"35":126,"36":1,"37":5,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":485,"48":485,"49":485,"50":485,"51":1,"52":1,"53":483,"54":1,"55":204,"56":295,"57":295,"58":204,"59":1,"60":203,"61":293,"62":293,"63":203,"64":1,"65":291,"66":200,"67":200,"68":291,"69":1,"70":4,"71":4,"72":5,"73":4,"74":1,"75":4,"76":7,"77":4,"78":1,"79":30,"80":25,"81":30,"82":54,"83":23,"84":37,"85":23,"86":23,"87":31,"88":30,"89":25,"90":3,"91":30,"92":1,"93":204,"94":204,"95":204,"96":202,"97":198,"98":4,"99":2,"100":1,"101":16,"102":996,"103":1,"104":151,"105":1,"106":50,"107":50,"108":50,"109":70,"110":55,"111":55,"112":50,"113":50,"114":200,"115":50,"116":50,"117":1,"118":15,"119":5,"120":10,"121":10,"122":10,"123":14,"124":10,"125":10,"126":6,"127":4,"128":2,"129":10,"130":1,"131":145,"132":204,"133":204,"134":130,"135":114,"136":130,"137":204,"138":145,"139":114,"140":1,"141":20,"142":20,"143":17,"144":3,"145":12,"146":14,"147":3,"148":1,"149":0,"150":1,"151":1,"152":190,"153":1,"154":189,"155":80,"156":65,"157":109,"158":109,"159":21,"160":10,"161":109,"162":1,"163":1,"164":54,"165":0,"166":54,"167":1,"168":3,"169":53,"170":53,"171":23,"172":23,"173":12,"174":53,"175":1,"176":1,"177":126,"178":126,"179":126,"180":124,"181":2,"182":1,"183":1,"184":1,"185":1,"186":3,"187":3,"188":1,"189":1,"190":10,"191":1,"192":9,"193":1},"f":{"0":103,"1":0,"2":0,"3":1,"4":0,"5":1,"6":126,"7":124,"8":1,"9":126,"10":124,"11":0,"12":249,"13":5,"14":485,"15":483,"16":204,"17":295,"18":203,"19":293,"20":291,"21":4,"22":5,"23":4,"24":7,"25":30,"26":25,"27":54,"28":37,"29":25,"30":3,"31":204,"32":16,"33":996,"34":151,"35":50,"36":70,"37":200,"38":15,"39":14,"40":10,"41":4,"42":145,"43":204,"44":114,"45":20,"46":12,"47":14,"48":0,"49":190,"50":65,"51":21,"52":54,"53":3,"54":23,"55":126,"56":126,"57":3,"58":3,"59":10},"b":{"0":[1,1,1],"1":[1,0],"2":[103,0],"3":[98,5],"4":[103,103],"5":[5,98],"6":[98,5],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,1],"13":[1,0],"14":[103,0],"15":[103,103],"16":[1,1,1],"17":[123,1],"18":[126,126],"19":[125,124],"20":[126,126],"21":[1,1,1],"22":[2,3],"23":[5,5],"24":[200,91],"25":[291,291],"26":[4,2,2],"27":[23,31],"28":[4],"29":[198,4],"30":[202,200],"31":[13,983],"32":[150],"33":[55,15],"34":[50,0],"35":[200,165],"36":[5,10],"37":[10,2,8],"38":[10,0],"39":[6,4],"40":[2,2],"41":[130,74],"42":[114,16],"43":[17,3],"44":[0,0],"45":[0,0],"46":[1,189],"47":[80,109],"48":[10,11],"49":[0,54],"50":[1,53],"51":[12,11],"52":[1,1],"53":[2,2],"54":[0,1],"55":[1,1],"56":[0,1],"57":[1,1],"58":[1,9],"59":[9,3],"60":[1,2],"61":[3,3]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/utils.ts","sources":["/home/circleci/repo/src/tools/utils.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs, { constants as fsConstants } from 'fs';\nimport dotProp from 'dot-prop';\nimport _ from 'lodash';\nimport log from '../logger';\nimport { Asset, Assets, CalculatedChanges, KeywordMappings } from '../types';\nimport constants from './constants';\n\nexport const keywordReplaceArrayRegExp = (key) => {\n  const pattern = `@@${key}@@`;\n  //YAML format supports both single and double quotes for strings\n  const patternWithSingleQuotes = `'${pattern}'`;\n  const patternWithDoubleQuotes = `\"${pattern}\"`;\n\n  return new RegExp(`${patternWithSingleQuotes}|${patternWithDoubleQuotes}|${pattern}`, 'g');\n};\n\nexport const keywordReplaceStringRegExp = (key) => {\n  return new RegExp(`##${key}##`, 'g');\n};\n\nexport function keywordArrayReplace(input: string, mappings: KeywordMappings): string {\n  Object.keys(mappings).forEach(function (key) {\n    // Matching against two sets of patterns because a developer may provide their array replacement keyword with or without wrapping quotes. It is not obvious to the developer which to do depending if they're operating in YAML or JSON.\n    const regex = keywordReplaceArrayRegExp(key);\n\n    input = input.replace(regex, JSON.stringify(mappings[key]));\n  });\n  return input;\n}\n\nexport function keywordStringReplace(input: string, mappings: KeywordMappings): string {\n  Object.keys(mappings).forEach(function (key) {\n    const regex = keywordReplaceStringRegExp(key);\n    // @ts-ignore TODO: come back and distinguish strings vs array replacement.\n    input = input.replace(regex, mappings[key]);\n  });\n  return input;\n}\n\nexport function keywordReplace(input: string, mappings: KeywordMappings): string {\n  // Replace keywords with mappings within input.\n  if (mappings && Object.keys(mappings).length > 0) {\n    input = keywordArrayReplace(input, mappings);\n    input = keywordStringReplace(input, mappings);\n  }\n  return input;\n}\n\n// wrapArrayReplaceMarkersInQuotes will wrap array replacement markers in quotes.\n// This is necessary for YAML format in the context of keyword replacement\n// to preserve the keyword markers while also maintaining valid YAML syntax.\nexport function wrapArrayReplaceMarkersInQuotes(body: string, mappings: KeywordMappings): string {\n  let newBody = body;\n  Object.keys(mappings).forEach((keyword) => {\n    newBody = newBody.replace(\n      new RegExp('(?<![\\'\"])@@' + keyword + '@@(?![\\'\"])', 'g'),\n      `\"@@${keyword}@@\"`\n    );\n  });\n  return newBody;\n}\n\nexport function convertClientNameToId(name: string, clients: Asset[]): string {\n  const found = clients.find((c) => c.name === name);\n  return (found && found.client_id) || name;\n}\n\nexport function convertClientNamesToIds(names: string[], clients: Asset[]): string[] {\n  const resolvedNames = names.map((name) => ({ name, resolved: false }));\n  const result = clients.reduce((acc: string[], client): string[] => {\n    if (names.includes(client.name)) {\n      const index = resolvedNames.findIndex((item) => item.name === client.name);\n      resolvedNames[index].resolved = true;\n      return [...acc, client.client_id];\n    }\n    return [...acc];\n  }, []);\n  const unresolved = resolvedNames.filter((item) => !item.resolved).map((item) => item.name);\n  // @ts-ignore TODO: come back and refactor to use map instead of reduce.\n  return [...unresolved, ...result];\n}\n\nexport function loadFileAndReplaceKeywords(\n  file: string,\n  {\n    mappings,\n    disableKeywordReplacement = false,\n  }: { mappings: KeywordMappings; disableKeywordReplacement: boolean }\n): string {\n  // Load file and replace keyword mappings\n  const f = path.resolve(file);\n  try {\n    fs.accessSync(f, fsConstants.F_OK);\n    if (mappings && !disableKeywordReplacement) {\n      return keywordReplace(fs.readFileSync(f, 'utf8'), mappings);\n    }\n    return fs.readFileSync(f, 'utf8');\n  } catch (error) {\n    throw new Error(`Unable to load file ${f} due to ${error}`);\n  }\n}\n\nexport function flatten(list: any[]): any[] {\n  // Flatten an multiple arrays to single array\n  return list.reduce((a, b) => a.concat(Array.isArray(b) ? flatten(b) : b), []);\n}\n\nexport function convertJsonToString(obj: { [key: string]: any }, spacing = 0): string {\n  return JSON.stringify(obj, null, spacing);\n}\n\nexport function stripFields(obj: Asset, fields: string[]): Asset {\n  // Strip object fields supporting dot notation (ie: a.deep.field)\n  const stripped: string[] = [];\n\n  const newObj = { ...obj };\n  fields.forEach((f) => {\n    if (dotProp.get(newObj, f) !== undefined) {\n      dotProp.delete(newObj, f);\n      stripped.push(f);\n    }\n  });\n\n  if (stripped) {\n    const name = ['id', 'client_id', 'template', 'name'].reduce((n, k) => newObj[k] || n, '');\n    log.debug(`Stripping \"${name}\" read-only fields ${JSON.stringify(stripped)}`);\n  }\n  return newObj;\n}\n\nexport function getEnabledClients(\n  assets: Assets,\n  connection: Asset,\n  existing: Asset[],\n  clients: Asset[]\n): string[] | undefined {\n  // Convert enabled_clients by name to the id\n\n  if (connection.enabled_clients === undefined) return undefined; // If no enabled clients passed in, explicitly ignore from management, preventing unintentional disabling of connection.\n\n  const excludedClientsByNames = (assets.exclude && assets.exclude.clients) || [];\n  const excludedClients = convertClientNamesToIds(excludedClientsByNames, clients);\n  const enabledClients = [\n    ...convertClientNamesToIds(connection.enabled_clients || [], clients).filter(\n      (item) => ![...excludedClientsByNames, ...excludedClients].includes(item)\n    ),\n  ];\n  // If client is excluded and in the existing connection this client is enabled, it should keep enabled\n  // If client is excluded and in the existing connection this client is disabled, it should keep disabled\n  existing.forEach((conn) => {\n    if (conn.name === connection.name) {\n      excludedClients.forEach((excludedClient) => {\n        if (conn.enabled_clients.includes(excludedClient)) {\n          enabledClients.push(excludedClient);\n        }\n      });\n    }\n  });\n  return enabledClients;\n}\n\nexport function duplicateItems(arr: Asset[], key: string): Asset[] {\n  // Find duplicates objects within array that have the same key value\n  const duplicates = arr.reduce(\n    (accum: { [key: string]: Asset[] }, obj): { [key: string]: Asset[] } => {\n      const keyValue = obj[key];\n      if (keyValue) {\n        if (!(keyValue in accum)) accum[keyValue] = [];\n        accum[keyValue].push(obj);\n      }\n      return accum;\n    },\n    {}\n  );\n  return Object.values(duplicates).filter((g) => g.length > 1);\n}\n\nexport function filterExcluded(changes: CalculatedChanges, exclude: string[]): CalculatedChanges {\n  const { del, update, create, conflicts } = changes;\n\n  if (!exclude.length) {\n    return changes;\n  }\n\n  const filter = (list: Asset[]) => list.filter((item) => !exclude.includes(item.name));\n\n  return {\n    del: filter(del),\n    update: filter(update),\n    create: filter(create),\n    conflicts: filter(conflicts),\n  };\n}\n\nexport function areArraysEquals(x: any[], y: any[]): boolean {\n  return _.isEqual(x && x.sort(), y && y.sort());\n}\n\nexport const obfuscateSensitiveValues = (\n  data: Asset | Asset[] | null,\n  sensitiveFieldsToObfuscate: string[]\n): Asset | Asset[] | null => {\n  if (data === null) return data;\n  if (Array.isArray(data)) {\n    return data.map((asset) => obfuscateSensitiveValues(asset, sensitiveFieldsToObfuscate));\n  }\n\n  const newAsset = { ...data };\n  sensitiveFieldsToObfuscate.forEach((sensitiveField) => {\n    if (dotProp.get(newAsset, sensitiveField) !== undefined) {\n      dotProp.set(newAsset, sensitiveField, constants.OBFUSCATED_SECRET_VALUE);\n    }\n  });\n\n  return newAsset;\n};\n\n// The reverse of `obfuscateSensitiveValues()`, preventing an obfuscated value from being passed to the API\nexport const stripObfuscatedFieldsFromPayload = (\n  data: Asset | Asset[] | null,\n  obfuscatedFields: string[]\n): Asset | Asset[] | null => {\n  if (data === null) return data;\n  if (Array.isArray(data)) {\n    return data.map((asset) => stripObfuscatedFieldsFromPayload(asset, obfuscatedFields));\n  }\n\n  const newAsset = { ...data };\n  obfuscatedFields.forEach((sensitiveField) => {\n    const obfuscatedFieldValue = dotProp.get(newAsset, sensitiveField);\n    if (obfuscatedFieldValue === constants.OBFUSCATED_SECRET_VALUE) {\n      dotProp.delete(newAsset, sensitiveField);\n    }\n  });\n\n  return newAsset;\n};\n\nexport const detectInsufficientScopeError = async <T>(\n  fn: Function\n): Promise<\n  | {\n      hadSufficientScopes: true;\n      data: T;\n      requiredScopes: [];\n    }\n  | { hadSufficientScopes: false; requiredScopes: string[]; data: null }\n> => {\n  try {\n    const data = await fn();\n    return {\n      hadSufficientScopes: true,\n      data,\n      requiredScopes: [],\n    };\n  } catch (err) {\n    if (err.statusCode === 403 && err.message.includes('Insufficient scope')) {\n      const requiredScopes = err.message?.split('Insufficient scope, expected any of: ')?.slice(1);\n      return {\n        hadSufficientScopes: false,\n        requiredScopes,\n        data: null,\n      };\n    }\n    throw err;\n  }\n};\n\nexport function sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nexport const isDeprecatedError = (err: { message: string; statusCode: number }): boolean => {\n  if (!err) return false;\n  return !!(err.statusCode === 403 || err.message?.includes('deprecated feature'));\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"01082dbb938100387d22132e6ab7a4eec3555856","contentHash":"3e57cecd402149e7eb4bf0890af42e11e15a1c690eb567414d3add42dc93a83f"},"/home/circleci/repo/src/tools/auth0/schema.ts":{"path":"/home/circleci/repo/src/tools/auth0/schema.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":19},"end":{"line":6,"column":57}},"4":{"start":{"line":7,"column":20},"end":{"line":10,"column":6}},"5":{"start":{"line":8,"column":4},"end":{"line":8,"column":27}},"6":{"start":{"line":9,"column":4},"end":{"line":9,"column":15}},"7":{"start":{"line":11,"column":22},"end":{"line":16,"column":6}},"8":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"9":{"start":{"line":13,"column":8},"end":{"line":13,"column":38}},"10":{"start":{"line":15,"column":4},"end":{"line":15,"column":15}},"11":{"start":{"line":17,"column":0},"end":{"line":26,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":62},"end":{"line":7,"column":63}},"loc":{"start":{"line":7,"column":84},"end":{"line":10,"column":1}},"line":7},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":64},"end":{"line":11,"column":65}},"loc":{"start":{"line":11,"column":86},"end":{"line":16,"column":1}},"line":11}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},{"start":{"line":12,"column":4},"end":{"line":14,"column":5}}],"line":12}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":29,"6":29,"7":1,"8":29,"9":3,"10":29,"11":1},"f":{"0":1,"1":29,"2":29},"b":{"0":[1,1,1],"1":[1,0],"2":[1,1],"3":[3,26]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/schema.ts","sources":["/home/circleci/repo/src/tools/auth0/schema.ts"],"names":[],"mappings":";;;;;AAAA,0DAAkC;AAElC,MAAM,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,kBAAQ,CAAC,CAAC,MAAM,CACjD,CAAC,GAA8B,EAAE,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE;IAC9C,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,qBAAqB;IAC7C,OAAO,GAAG,CAAC;AACb,CAAC,EACD,EAAE,CACH,CAAC;AAEF,MAAM,aAAa,GAAG,MAAM,CAAC,OAAO,CAAC,kBAAQ,CAAC,CAAC,MAAM,CACnD,CAAC,GAA8B,EAAE,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE;IAC9C,IAAI,GAAG,CAAC,aAAa,EAAE;QACrB,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,aAAa,CAAC;KAC/B;IACD,OAAO,GAAG,CAAC;AACb,CAAC,EACD,EAAE,CACH,CAAC;AAEF,kBAAe;IACb,IAAI,EAAE,QAAQ;IACd,OAAO,EAAE,yCAAyC;IAClD,UAAU,kCACL,WAAW,KACd,OAAO,EAAE;YACP,IAAI,EAAE,QAAQ;YACd,UAAU,oBAAO,aAAa,CAAE;YAChC,OAAO,EAAE,EAAE;SACZ,GACF;IACD,oBAAoB,EAAE,KAAK;CAC5B,CAAC","sourcesContent":["import handlers from './handlers';\n\nconst typesSchema = Object.entries(handlers).reduce(\n  (map: { [key: string]: Object }, [name, obj]) => {\n    map[name] = obj.schema; //eslint-disable-line\n    return map;\n  },\n  {}\n);\n\nconst excludeSchema = Object.entries(handlers).reduce(\n  (map: { [key: string]: Object }, [name, obj]) => {\n    if (obj.excludeSchema) {\n      map[name] = obj.excludeSchema;\n    }\n    return map;\n  },\n  {}\n);\n\nexport default {\n  type: 'object',\n  $schema: 'http://json-schema.org/draft-07/schema#',\n  properties: {\n    ...typesSchema,\n    exclude: {\n      type: 'object',\n      properties: { ...excludeSchema },\n      default: {},\n    },\n  },\n  additionalProperties: false,\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5f0f332973d893476ec5e8aa98762a327fc6e9f8","contentHash":"f9d107ed8dfa7958adee4d9ba854ae8063c5d3299d1e214c28e699e9256ac483"},"/home/circleci/repo/src/tools/auth0/handlers/index.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":27,"column":14},"end":{"line":27,"column":46}},"26":{"start":{"line":28,"column":21},"end":{"line":28,"column":60}},"27":{"start":{"line":29,"column":14},"end":{"line":29,"column":46}},"28":{"start":{"line":30,"column":14},"end":{"line":30,"column":46}},"29":{"start":{"line":31,"column":24},"end":{"line":31,"column":66}},"30":{"start":{"line":32,"column":18},"end":{"line":32,"column":54}},"31":{"start":{"line":33,"column":20},"end":{"line":33,"column":58}},"32":{"start":{"line":34,"column":16},"end":{"line":34,"column":50}},"33":{"start":{"line":35,"column":15},"end":{"line":35,"column":48}},"34":{"start":{"line":36,"column":22},"end":{"line":36,"column":62}},"35":{"start":{"line":37,"column":23},"end":{"line":37,"column":64}},"36":{"start":{"line":38,"column":21},"end":{"line":38,"column":60}},"37":{"start":{"line":39,"column":24},"end":{"line":39,"column":66}},"38":{"start":{"line":40,"column":32},"end":{"line":40,"column":82}},"39":{"start":{"line":41,"column":32},"end":{"line":41,"column":82}},"40":{"start":{"line":42,"column":25},"end":{"line":42,"column":68}},"41":{"start":{"line":43,"column":44},"end":{"line":43,"column":106}},"42":{"start":{"line":44,"column":40},"end":{"line":44,"column":98}},"43":{"start":{"line":45,"column":14},"end":{"line":45,"column":46}},"44":{"start":{"line":46,"column":17},"end":{"line":46,"column":52}},"45":{"start":{"line":47,"column":16},"end":{"line":47,"column":50}},"46":{"start":{"line":48,"column":19},"end":{"line":48,"column":56}},"47":{"start":{"line":49,"column":16},"end":{"line":49,"column":50}},"48":{"start":{"line":50,"column":17},"end":{"line":50,"column":52}},"49":{"start":{"line":51,"column":22},"end":{"line":51,"column":62}},"50":{"start":{"line":52,"column":25},"end":{"line":52,"column":68}},"51":{"start":{"line":53,"column":19},"end":{"line":53,"column":56}},"52":{"start":{"line":54,"column":22},"end":{"line":54,"column":62}},"53":{"start":{"line":55,"column":15},"end":{"line":55,"column":48}},"54":{"start":{"line":56,"column":25},"end":{"line":87,"column":1}},"55":{"start":{"line":88,"column":0},"end":{"line":88,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":29,"16":29,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":29},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[29,0],"12":[29,29],"13":[0,0],"14":[0,0],"15":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/index.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO;AACP,+CAAiC;AACjC,6DAA+C;AAC/C,+CAAiC;AACjC,+CAAiC;AACjC,mEAAqD;AACrD,uDAAyC;AACzC,2DAA6C;AAC7C,mDAAqC;AACrC,iDAAmC;AACnC,+DAAiD;AACjD,iEAAmD;AACnD,6DAA+C;AAC/C,mEAAqD;AACrD,mFAAqE;AACrE,mFAAqE;AACrE,qEAAuD;AACvD,2GAA6F;AAC7F,mGAAqF;AACrF,+CAAiC;AACjC,qDAAuC;AACvC,mDAAqC;AACrC,yDAA2C;AAC3C,mDAAqC;AACrC,qDAAuC;AACvC,+DAAiD;AACjD,qEAAuD;AACvD,yDAA2C;AAC3C,+DAAiD;AACjD,iDAAmC;AAKnC,MAAM,gBAAgB,GAAiC;IACrD,KAAK;IACL,YAAY;IACZ,KAAK;IACL,KAAK;IACL,eAAe;IACf,OAAO;IACP,SAAS;IACT,WAAW;IACX,MAAM;IACN,aAAa;IACb,cAAc;IACd,YAAY;IACZ,eAAe;IACf,uBAAuB;IACvB,uBAAuB;IACvB,gBAAgB;IAChB,mCAAmC;IACnC,+BAA+B;IAC/B,KAAK;IACL,QAAQ;IACR,sEAAsE;IACtE,OAAO;IACP,UAAU;IACV,OAAO;IACP,QAAQ;IACR,aAAa;IACb,gBAAgB;IAChB,UAAU;IACV,aAAa;IACb,MAAM;CACP,CAAC;AAEF,kBAAe,gBAEd,CAAC,CAAC,kDAAkD","sourcesContent":["//TODO:\nimport * as rules from './rules';\nimport * as rulesConfigs from './rulesConfigs';\nimport * as hooks from './hooks';\nimport * as pages from './pages';\nimport * as resourceServers from './resourceServers';\nimport * as databases from './databases';\nimport * as connections from './connections';\nimport * as clients from './clients';\nimport * as tenant from './tenant';\nimport * as emailProvider from './emailProvider';\nimport * as emailTemplates from './emailTemplates';\nimport * as clientGrants from './clientGrants';\nimport * as guardianFactors from './guardianFactors';\nimport * as guardianFactorProviders from './guardianFactorProviders';\nimport * as guardianFactorTemplates from './guardianFactorTemplates';\nimport * as guardianPolicies from './guardianPolicies';\nimport * as guardianPhoneFactorSelectedProvider from './guardianPhoneFactorSelectedProvider';\nimport * as guardianPhoneFactorMessageTypes from './guardianPhoneFactorMessageTypes';\nimport * as roles from './roles';\nimport * as branding from './branding';\nimport * as prompts from './prompts';\nimport * as migrations from './migrations';\nimport * as actions from './actions';\nimport * as triggers from './triggers';\nimport * as organizations from './organizations';\nimport * as attackProtection from './attackProtection';\nimport * as logStreams from './logStreams';\nimport * as customDomains from './customDomains';\nimport * as themes from './themes';\n\nimport { AssetTypes } from '../../../types';\nimport APIHandler from './default';\n\nconst auth0ApiHandlers: { [key in AssetTypes]: any } = {\n  rules,\n  rulesConfigs,\n  hooks,\n  pages,\n  resourceServers,\n  clients,\n  databases,\n  connections,\n  tenant,\n  emailProvider,\n  emailTemplates,\n  clientGrants,\n  guardianFactors,\n  guardianFactorProviders,\n  guardianFactorTemplates,\n  guardianPolicies,\n  guardianPhoneFactorSelectedProvider,\n  guardianPhoneFactorMessageTypes,\n  roles,\n  branding,\n  //@ts-ignore because prompts have not been universally implemented yet\n  prompts,\n  migrations,\n  actions,\n  triggers,\n  organizations,\n  attackProtection,\n  logStreams,\n  customDomains,\n  themes,\n};\n\nexport default auth0ApiHandlers as {\n  [key in AssetTypes]: { default: typeof APIHandler; excludeSchema?: any; schema: any };\n}; // TODO: apply stronger types to schema properties\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"63683fcf0a02100cc9773259ef69acc2dca0a06a","contentHash":"caa98516531d037dc74dccddf1d3f8288b2eba40d465489fed5b2a9512c6971e"},"/home/circleci/repo/src/tools/auth0/handlers/rules.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/rules.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":48}},"16":{"start":{"line":16,"column":26},"end":{"line":16,"column":75}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":38}},"18":{"start":{"line":18,"column":18},"end":{"line":18,"column":55}},"19":{"start":{"line":19,"column":17},"end":{"line":19,"column":60}},"20":{"start":{"line":20,"column":27},"end":{"line":20,"column":60}},"21":{"start":{"line":21,"column":0},"end":{"line":24,"column":2}},"22":{"start":{"line":25,"column":0},"end":{"line":60,"column":2}},"23":{"start":{"line":63,"column":8},"end":{"line":63,"column":106}},"24":{"start":{"line":66,"column":8},"end":{"line":79,"column":11}},"25":{"start":{"line":67,"column":12},"end":{"line":78,"column":13}},"26":{"start":{"line":68,"column":16},"end":{"line":69,"column":41}},"27":{"start":{"line":69,"column":20},"end":{"line":69,"column":41}},"28":{"start":{"line":70,"column":16},"end":{"line":70,"column":105}},"29":{"start":{"line":71,"column":16},"end":{"line":71,"column":37}},"30":{"start":{"line":74,"column":16},"end":{"line":76,"column":17}},"31":{"start":{"line":75,"column":20},"end":{"line":75,"column":32}},"32":{"start":{"line":77,"column":16},"end":{"line":77,"column":26}},"33":{"start":{"line":82,"column":8},"end":{"line":82,"column":71}},"34":{"start":{"line":85,"column":8},"end":{"line":137,"column":11}},"35":{"start":{"line":86,"column":28},"end":{"line":86,"column":34}},"36":{"start":{"line":87,"column":34},"end":{"line":87,"column":80}},"37":{"start":{"line":88,"column":27},"end":{"line":88,"column":47}},"38":{"start":{"line":89,"column":12},"end":{"line":97,"column":13}},"39":{"start":{"line":90,"column":16},"end":{"line":96,"column":18}},"40":{"start":{"line":99,"column":12},"end":{"line":102,"column":13}},"41":{"start":{"line":100,"column":16},"end":{"line":100,"column":77}},"42":{"start":{"line":100,"column":44},"end":{"line":100,"column":75}},"43":{"start":{"line":101,"column":16},"end":{"line":101,"column":83}},"44":{"start":{"line":101,"column":50},"end":{"line":101,"column":81}},"45":{"start":{"line":104,"column":55},"end":{"line":110,"column":14}},"46":{"start":{"line":112,"column":32},"end":{"line":112,"column":54}},"47":{"start":{"line":113,"column":35},"end":{"line":113,"column":79}},"48":{"start":{"line":113,"column":70},"end":{"line":113,"column":77}},"49":{"start":{"line":114,"column":37},"end":{"line":114,"column":78}},"50":{"start":{"line":114,"column":69},"end":{"line":114,"column":76}},"51":{"start":{"line":115,"column":30},"end":{"line":115,"column":72}},"52":{"start":{"line":117,"column":28},"end":{"line":129,"column":18}},"53":{"start":{"line":118,"column":16},"end":{"line":119,"column":33}},"54":{"start":{"line":119,"column":20},"end":{"line":119,"column":33}},"55":{"start":{"line":120,"column":33},"end":{"line":120,"column":95}},"56":{"start":{"line":120,"column":54},"end":{"line":120,"column":94}},"57":{"start":{"line":121,"column":16},"end":{"line":127,"column":17}},"58":{"start":{"line":122,"column":20},"end":{"line":122,"column":37}},"59":{"start":{"line":123,"column":20},"end":{"line":126,"column":22}},"60":{"start":{"line":128,"column":16},"end":{"line":128,"column":29}},"61":{"start":{"line":130,"column":12},"end":{"line":136,"column":14}},"62":{"start":{"line":140,"column":23},"end":{"line":142,"column":10}},"63":{"start":{"line":141,"column":35},"end":{"line":141,"column":49}},"64":{"start":{"line":143,"column":8},"end":{"line":182,"column":11}},"65":{"start":{"line":144,"column":30},"end":{"line":144,"column":36}},"66":{"start":{"line":146,"column":12},"end":{"line":147,"column":23}},"67":{"start":{"line":147,"column":16},"end":{"line":147,"column":23}},"68":{"start":{"line":148,"column":34},"end":{"line":148,"column":80}},"69":{"start":{"line":150,"column":44},"end":{"line":150,"column":80}},"70":{"start":{"line":153,"column":32},"end":{"line":157,"column":13}},"71":{"start":{"line":156,"column":37},"end":{"line":156,"column":67}},"72":{"start":{"line":159,"column":35},"end":{"line":159,"column":84}},"73":{"start":{"line":160,"column":12},"end":{"line":165,"column":13}},"74":{"start":{"line":161,"column":34},"end":{"line":161,"column":92}},"75":{"start":{"line":161,"column":63},"end":{"line":161,"column":91}},"76":{"start":{"line":161,"column":79},"end":{"line":161,"column":90}},"77":{"start":{"line":162,"column":16},"end":{"line":164,"column":77}},"78":{"start":{"line":167,"column":29},"end":{"line":167,"column":49}},"79":{"start":{"line":168,"column":12},"end":{"line":169,"column":23}},"80":{"start":{"line":169,"column":16},"end":{"line":169,"column":23}},"81":{"start":{"line":170,"column":33},"end":{"line":175,"column":35}},"82":{"start":{"line":171,"column":43},"end":{"line":174,"column":13}},"83":{"start":{"line":173,"column":42},"end":{"line":173,"column":116}},"84":{"start":{"line":175,"column":28},"end":{"line":175,"column":34}},"85":{"start":{"line":176,"column":12},"end":{"line":180,"column":13}},"86":{"start":{"line":177,"column":16},"end":{"line":179,"column":64}},"87":{"start":{"line":181,"column":12},"end":{"line":181,"column":53}},"88":{"start":{"line":185,"column":23},"end":{"line":187,"column":10}},"89":{"start":{"line":186,"column":41},"end":{"line":186,"column":61}},"90":{"start":{"line":188,"column":8},"end":{"line":228,"column":11}},"91":{"start":{"line":189,"column":30},"end":{"line":189,"column":36}},"92":{"start":{"line":191,"column":12},"end":{"line":192,"column":23}},"93":{"start":{"line":192,"column":16},"end":{"line":192,"column":23}},"94":{"start":{"line":193,"column":12},"end":{"line":193,"column":199}},"95":{"start":{"line":194,"column":12},"end":{"line":227,"column":13}},"96":{"start":{"line":196,"column":32},"end":{"line":196,"column":62}},"97":{"start":{"line":198,"column":16},"end":{"line":213,"column":31}},"98":{"start":{"line":201,"column":41},"end":{"line":211,"column":22}},"99":{"start":{"line":204,"column":40},"end":{"line":209,"column":25}},"100":{"start":{"line":210,"column":24},"end":{"line":210,"column":119}},"101":{"start":{"line":214,"column":16},"end":{"line":219,"column":19}},"102":{"start":{"line":222,"column":16},"end":{"line":225,"column":17}},"103":{"start":{"line":223,"column":20},"end":{"line":223,"column":237}},"104":{"start":{"line":224,"column":20},"end":{"line":224,"column":27}},"105":{"start":{"line":226,"column":16},"end":{"line":226,"column":26}},"106":{"start":{"line":231,"column":0},"end":{"line":231,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":62,"column":4},"end":{"line":62,"column":5}},"loc":{"start":{"line":62,"column":25},"end":{"line":64,"column":5}},"line":62},"9":{"name":"(anonymous_9)","decl":{"start":{"line":65,"column":4},"end":{"line":65,"column":5}},"loc":{"start":{"line":65,"column":14},"end":{"line":80,"column":5}},"line":65},"10":{"name":"(anonymous_10)","decl":{"start":{"line":66,"column":47},"end":{"line":66,"column":48}},"loc":{"start":{"line":66,"column":60},"end":{"line":79,"column":9}},"line":66},"11":{"name":"(anonymous_11)","decl":{"start":{"line":81,"column":4},"end":{"line":81,"column":5}},"loc":{"start":{"line":81,"column":20},"end":{"line":83,"column":5}},"line":81},"12":{"name":"(anonymous_12)","decl":{"start":{"line":84,"column":4},"end":{"line":84,"column":5}},"loc":{"start":{"line":84,"column":49},"end":{"line":138,"column":5}},"line":84},"13":{"name":"(anonymous_13)","decl":{"start":{"line":85,"column":47},"end":{"line":85,"column":48}},"loc":{"start":{"line":85,"column":60},"end":{"line":137,"column":9}},"line":85},"14":{"name":"(anonymous_14)","decl":{"start":{"line":100,"column":37},"end":{"line":100,"column":38}},"loc":{"start":{"line":100,"column":44},"end":{"line":100,"column":75}},"line":100},"15":{"name":"(anonymous_15)","decl":{"start":{"line":101,"column":43},"end":{"line":101,"column":44}},"loc":{"start":{"line":101,"column":50},"end":{"line":101,"column":81}},"line":101},"16":{"name":"(anonymous_16)","decl":{"start":{"line":113,"column":63},"end":{"line":113,"column":64}},"loc":{"start":{"line":113,"column":70},"end":{"line":113,"column":77}},"line":113},"17":{"name":"(anonymous_17)","decl":{"start":{"line":114,"column":62},"end":{"line":114,"column":63}},"loc":{"start":{"line":114,"column":69},"end":{"line":114,"column":76}},"line":114},"18":{"name":"(anonymous_18)","decl":{"start":{"line":117,"column":47},"end":{"line":117,"column":48}},"loc":{"start":{"line":117,"column":61},"end":{"line":129,"column":13}},"line":117},"19":{"name":"(anonymous_19)","decl":{"start":{"line":120,"column":47},"end":{"line":120,"column":48}},"loc":{"start":{"line":120,"column":54},"end":{"line":120,"column":94}},"line":120},"20":{"name":"(anonymous_20)","decl":{"start":{"line":139,"column":4},"end":{"line":139,"column":5}},"loc":{"start":{"line":139,"column":21},"end":{"line":183,"column":5}},"line":139},"21":{"name":"(anonymous_21)","decl":{"start":{"line":141,"column":29},"end":{"line":141,"column":30}},"loc":{"start":{"line":141,"column":35},"end":{"line":141,"column":49}},"line":141},"22":{"name":"(anonymous_22)","decl":{"start":{"line":143,"column":47},"end":{"line":143,"column":48}},"loc":{"start":{"line":143,"column":60},"end":{"line":182,"column":9}},"line":143},"23":{"name":"(anonymous_23)","decl":{"start":{"line":156,"column":30},"end":{"line":156,"column":31}},"loc":{"start":{"line":156,"column":37},"end":{"line":156,"column":67}},"line":156},"24":{"name":"(anonymous_24)","decl":{"start":{"line":161,"column":53},"end":{"line":161,"column":54}},"loc":{"start":{"line":161,"column":63},"end":{"line":161,"column":91}},"line":161},"25":{"name":"(anonymous_25)","decl":{"start":{"line":161,"column":72},"end":{"line":161,"column":73}},"loc":{"start":{"line":161,"column":79},"end":{"line":161,"column":90}},"line":161},"26":{"name":"(anonymous_26)","decl":{"start":{"line":171,"column":24},"end":{"line":171,"column":25}},"loc":{"start":{"line":171,"column":43},"end":{"line":174,"column":13}},"line":171},"27":{"name":"(anonymous_27)","decl":{"start":{"line":173,"column":35},"end":{"line":173,"column":36}},"loc":{"start":{"line":173,"column":42},"end":{"line":173,"column":116}},"line":173},"28":{"name":"(anonymous_28)","decl":{"start":{"line":175,"column":21},"end":{"line":175,"column":22}},"loc":{"start":{"line":175,"column":28},"end":{"line":175,"column":34}},"line":175},"29":{"name":"(anonymous_29)","decl":{"start":{"line":184,"column":4},"end":{"line":184,"column":5}},"loc":{"start":{"line":184,"column":27},"end":{"line":229,"column":5}},"line":184},"30":{"name":"(anonymous_30)","decl":{"start":{"line":186,"column":35},"end":{"line":186,"column":36}},"loc":{"start":{"line":186,"column":41},"end":{"line":186,"column":61}},"line":186},"31":{"name":"(anonymous_31)","decl":{"start":{"line":188,"column":47},"end":{"line":188,"column":48}},"loc":{"start":{"line":188,"column":60},"end":{"line":228,"column":9}},"line":188},"32":{"name":"(anonymous_32)","decl":{"start":{"line":201,"column":31},"end":{"line":201,"column":32}},"loc":{"start":{"line":201,"column":41},"end":{"line":211,"column":22}},"line":201},"33":{"name":"(anonymous_33)","decl":{"start":{"line":203,"column":30},"end":{"line":203,"column":31}},"loc":{"start":{"line":203,"column":36},"end":{"line":211,"column":21}},"line":203}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":68,"column":16},"end":{"line":69,"column":41}},"type":"if","locations":[{"start":{"line":68,"column":16},"end":{"line":69,"column":41}},{"start":{"line":68,"column":16},"end":{"line":69,"column":41}}],"line":68},"9":{"loc":{"start":{"line":74,"column":16},"end":{"line":76,"column":17}},"type":"if","locations":[{"start":{"line":74,"column":16},"end":{"line":76,"column":17}},{"start":{"line":74,"column":16},"end":{"line":76,"column":17}}],"line":74},"10":{"loc":{"start":{"line":84,"column":24},"end":{"line":84,"column":47}},"type":"default-arg","locations":[{"start":{"line":84,"column":42},"end":{"line":84,"column":47}}],"line":84},"11":{"loc":{"start":{"line":87,"column":34},"end":{"line":87,"column":80}},"type":"binary-expr","locations":[{"start":{"line":87,"column":35},"end":{"line":87,"column":49}},{"start":{"line":87,"column":53},"end":{"line":87,"column":73}},{"start":{"line":87,"column":78},"end":{"line":87,"column":80}}],"line":87},"12":{"loc":{"start":{"line":89,"column":12},"end":{"line":97,"column":13}},"type":"if","locations":[{"start":{"line":89,"column":12},"end":{"line":97,"column":13}},{"start":{"line":89,"column":12},"end":{"line":97,"column":13}}],"line":89},"13":{"loc":{"start":{"line":99,"column":12},"end":{"line":102,"column":13}},"type":"if","locations":[{"start":{"line":99,"column":12},"end":{"line":102,"column":13}},{"start":{"line":99,"column":12},"end":{"line":102,"column":13}}],"line":99},"14":{"loc":{"start":{"line":118,"column":16},"end":{"line":119,"column":33}},"type":"if","locations":[{"start":{"line":118,"column":16},"end":{"line":119,"column":33}},{"start":{"line":118,"column":16},"end":{"line":119,"column":33}}],"line":118},"15":{"loc":{"start":{"line":120,"column":54},"end":{"line":120,"column":94}},"type":"binary-expr","locations":[{"start":{"line":120,"column":54},"end":{"line":120,"column":73}},{"start":{"line":120,"column":77},"end":{"line":120,"column":94}}],"line":120},"16":{"loc":{"start":{"line":121,"column":16},"end":{"line":127,"column":17}},"type":"if","locations":[{"start":{"line":121,"column":16},"end":{"line":127,"column":17}},{"start":{"line":121,"column":16},"end":{"line":127,"column":17}}],"line":121},"17":{"loc":{"start":{"line":146,"column":12},"end":{"line":147,"column":23}},"type":"if","locations":[{"start":{"line":146,"column":12},"end":{"line":147,"column":23}},{"start":{"line":146,"column":12},"end":{"line":147,"column":23}}],"line":146},"18":{"loc":{"start":{"line":148,"column":34},"end":{"line":148,"column":80}},"type":"binary-expr","locations":[{"start":{"line":148,"column":35},"end":{"line":148,"column":49}},{"start":{"line":148,"column":53},"end":{"line":148,"column":73}},{"start":{"line":148,"column":78},"end":{"line":148,"column":80}}],"line":148},"19":{"loc":{"start":{"line":160,"column":12},"end":{"line":165,"column":13}},"type":"if","locations":[{"start":{"line":160,"column":12},"end":{"line":165,"column":13}},{"start":{"line":160,"column":12},"end":{"line":165,"column":13}}],"line":160},"20":{"loc":{"start":{"line":168,"column":12},"end":{"line":169,"column":23}},"type":"if","locations":[{"start":{"line":168,"column":12},"end":{"line":169,"column":23}},{"start":{"line":168,"column":12},"end":{"line":169,"column":23}}],"line":168},"21":{"loc":{"start":{"line":173,"column":42},"end":{"line":173,"column":116}},"type":"binary-expr","locations":[{"start":{"line":173,"column":42},"end":{"line":173,"column":90}},{"start":{"line":173,"column":94},"end":{"line":173,"column":116}}],"line":173},"22":{"loc":{"start":{"line":176,"column":12},"end":{"line":180,"column":13}},"type":"if","locations":[{"start":{"line":176,"column":12},"end":{"line":180,"column":13}},{"start":{"line":176,"column":12},"end":{"line":180,"column":13}}],"line":176},"23":{"loc":{"start":{"line":191,"column":12},"end":{"line":192,"column":23}},"type":"if","locations":[{"start":{"line":191,"column":12},"end":{"line":192,"column":23}},{"start":{"line":191,"column":12},"end":{"line":192,"column":23}}],"line":191},"24":{"loc":{"start":{"line":222,"column":16},"end":{"line":225,"column":17}},"type":"if","locations":[{"start":{"line":222,"column":16},"end":{"line":225,"column":17}},{"start":{"line":222,"column":16},"end":{"line":225,"column":17}}],"line":222}},"s":{"0":1,"1":75,"2":20,"3":125,"4":74,"5":74,"6":2,"7":1,"8":1,"9":1,"10":197,"11":125,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":145,"24":28,"25":28,"26":28,"27":6,"28":22,"29":20,"30":2,"31":2,"32":0,"33":6,"34":16,"35":16,"36":16,"37":16,"38":16,"39":1,"40":15,"41":8,"42":9,"43":8,"44":10,"45":15,"46":15,"47":15,"48":15,"49":15,"50":9,"51":15,"52":15,"53":15,"54":0,"55":15,"56":11,"57":15,"58":2,"59":2,"60":13,"61":15,"62":74,"63":5,"64":74,"65":74,"66":74,"67":67,"68":7,"69":7,"70":7,"71":0,"72":7,"73":7,"74":1,"75":1,"76":2,"77":1,"78":6,"79":6,"80":0,"81":6,"82":6,"83":1,"84":1,"85":6,"86":1,"87":5,"88":7,"89":7,"90":7,"91":7,"92":7,"93":0,"94":7,"95":7,"96":7,"97":7,"98":0,"99":0,"100":0,"101":7,"102":0,"103":0,"104":0,"105":0,"106":1},"f":{"0":125,"1":75,"2":20,"3":125,"4":74,"5":1,"6":197,"7":3,"8":145,"9":28,"10":28,"11":6,"12":16,"13":16,"14":9,"15":10,"16":15,"17":9,"18":15,"19":11,"20":74,"21":5,"22":74,"23":0,"24":1,"25":2,"26":6,"27":1,"28":1,"29":7,"30":7,"31":7,"32":0,"33":0},"b":{"0":[1,1,1],"1":[55,20],"2":[125,125],"3":[122,75],"4":[125,125],"5":[1,1,1],"6":[3,0],"7":[3,3],"8":[6,22],"9":[2,0],"10":[9],"11":[16,3,13],"12":[1,15],"13":[8,7],"14":[0,15],"15":[11,4],"16":[2,13],"17":[67,7],"18":[7,2,5],"19":[1,6],"20":[0,6],"21":[1,1],"22":[1,5],"23":[0,7],"24":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/rules.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/rules.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,4EAAoD;AACpD,uCAAkG;AAClG,wDAAuC;AACvC,6DAAkC;AAClC,6DAA0D;AAG7C,QAAA,aAAa,GAAG;IAC3B,IAAI,EAAE,OAAO;IACb,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE;CAC1B,CAAC;AAEW,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,OAAO;IACb,KAAK,EAAE;QACL,IAAI,EAAE,QAAQ;QACd,OAAO,EAAE,EAAE;QACX,UAAU,EAAE;YACV,MAAM,EAAE;gBACN,IAAI,EAAE,QAAQ;gBACd,WAAW,EAAE,wCAAwC;gBACrD,OAAO,EAAE,EAAE;aACZ;YACD,IAAI,EAAE;gBACJ,IAAI,EAAE,QAAQ;gBACd,WAAW,EACT,8HAA8H;gBAChI,OAAO,EAAE,kCAAkC;aAC5C;YACD,KAAK,EAAE;gBACL,IAAI,EAAE,CAAC,QAAQ,EAAE,MAAM,CAAC;gBACxB,WAAW,EACT,0GAA0G;gBAC5G,OAAO,EAAE,IAAI;aACd;YACD,OAAO,EAAE;gBACP,IAAI,EAAE,SAAS;gBACf,WAAW,EAAE,8CAA8C;gBAC3D,OAAO,EAAE,IAAI;aACd;YACD,KAAK,EAAE;gBACL,IAAI,EAAE,QAAQ;gBACd,WAAW,EAAE,4BAA4B;gBACzC,OAAO,EAAE,eAAe;gBACxB,IAAI,EAAE,CAAC,eAAe,EAAE,eAAe,EAAE,eAAe,CAAC;aAC1D;SACF;QACD,QAAQ,EAAE,CAAC,MAAM,CAAC;KACnB;CACF,CAAC;AAEF,MAAqB,YAAa,SAAQ,iBAAc;IAGtD,YAAY,OAAuB;QACjC,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,OAAO,EACb,iBAAiB,EAAE,CAAC,OAAO,CAAC,IAC5B,CAAC;IACL,CAAC;IAEK,OAAO;;YACX,IAAI;gBACF,IAAI,IAAI,CAAC,QAAQ;oBAAE,OAAO,IAAI,CAAC,QAAQ,CAAC;gBACxC,IAAI,CAAC,QAAQ,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC,CAAC;gBACzF,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,IAAA,yBAAiB,EAAC,GAAG,CAAC,EAAE;oBAC1B,OAAO,IAAI,CAAC;iBACb;gBACD,MAAM,GAAG,CAAC;aACX;QACH,CAAC;KAAA;IAED,SAAS,CAAC,IAAI;QACZ,OAAO,KAAK,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;IACjE,CAAC;IAEK,WAAW,CACf,MAAM,EACN,eAAe,GAAG,KAAK;;YAEvB,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,CAAC;YAEvB,MAAM,aAAa,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;YAErE,IAAI,QAAQ,GAAG,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC;YACpC,IAAI,QAAQ,KAAK,IAAI,EAAE;gBACrB,OAAO;oBACL,GAAG,EAAE,EAAE;oBACP,MAAM,EAAE,EAAE;oBACV,SAAS,EAAE,EAAE;oBACb,MAAM,EAAE,EAAE;oBACV,OAAO,EAAE,EAAE;iBACZ,CAAC;aACH;YAED,wBAAwB;YACxB,IAAI,CAAC,eAAe,EAAE;gBACpB,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;gBAC7D,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;aACpE;YAED,iDAAiD;YACjD,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,IAAA,mCAAgB,EAAC;gBAC1D,OAAO,EAAE,IAAI;gBACb,MAAM,EAAE,KAAK;gBACb,QAAQ;gBACR,WAAW,EAAE,IAAI,CAAC,WAAW;gBAC7B,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC;aACjD,CAAC,CAAC;YACH,kDAAkD;YAClD,MAAM,WAAW,GAAG,CAAC,GAAG,MAAM,EAAE,GAAG,MAAM,CAAC,CAAC;YAE3C,MAAM,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACpE,MAAM,gBAAgB,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACnE,IAAI,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,gBAAgB,CAAC,CAAC;YAE7D,+CAA+C;YAC/C,MAAM,OAAO,GAAY,WAAW,CAAC,MAAM,CAAC,CAAC,KAAc,EAAE,CAAQ,EAAE,EAAE;gBACvE,IAAI,QAAQ,KAAK,IAAI;oBAAE,OAAO,KAAK,CAAC;gBACpC,MAAM,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC;gBAChF,IAAI,QAAQ,KAAK,SAAS,EAAE;oBAC1B,WAAW,IAAI,CAAC,CAAC;oBACjB,OAAO;wBACL,GAAG,KAAK;wDAEH,QAAQ,KACX,KAAK,EAAE,WAAW;qBAErB,CAAC;iBACH;gBACD,OAAO,KAAK,CAAC;YACf,CAAC,EAAE,EAAE,CAAC,CAAC;YAEP,OAAO;gBACL,GAAG;gBACH,MAAM;gBACN,MAAM;gBACN,OAAO;gBACP,SAAS;aACV,CAAC;QACJ,CAAC;KAAA;IAEK,QAAQ,CAAC,MAAc;;;;;YAC3B,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,CAAC;YAEzB,wBAAwB;YACxB,IAAI,CAAC,KAAK;gBAAE,OAAO;YAEnB,MAAM,aAAa,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;YAErE,iDAAiD;YACjD,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YACrE,gFAAgF;YAChF,6EAA6E;YAC7E,MAAM,WAAW,GAAG;gBAClB,GAAG,MAAM;gBACT,GAAG,MAAM;gBACT,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;aACrD,CAAC;YAEF,mCAAmC;YACnC,MAAM,cAAc,GAAG,IAAA,sBAAc,EAAC,WAAW,EAAE,OAAO,CAAC,CAAC;YAC5D,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC7B,MAAM,SAAS,GAAG,cAAc,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;gBAC7E,MAAM,IAAI,yBAAe,CAAC;QACxB,IAAA,2BAAmB,EAAC,SAAS,CAAC;2EACqC,CAAC,CAAC;aACxE;YAED,4DAA4D;YAC5D,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC;YACtC,IAAI,QAAQ,KAAK,IAAI;gBAAE,OAAO;YAE9B,MAAM,YAAY,GAAG,WAAW;iBAC7B,MAAM,CACL,CAAC,OAAgB,EAAE,IAAI,EAAE,EAAE,CAAC;gBAC1B,GAAG,OAAO;gBACV,GAAG,QAAQ,CAAC,MAAM,CAChB,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,CAClF;aACF,EACD,EAAE,CACH;iBACA,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;YAEtB,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC3B,MAAM,IAAI,yBAAe,CAAC;QACxB,IAAA,2BAAmB,EAAC,YAAY,CAAC;8DACqB,CAAC,CAAC;aAC3D;YAED,MAAM,OAAM,QAAQ,YAAC,MAAM,CAAC,CAAC;QAC/B,CAAC;KAAA;IAEK,cAAc,CAAC,MAAc;;;;;YACjC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,CAAC;YAEzB,wBAAwB;YACxB,IAAI,CAAC,KAAK;gBAAE,OAAO;YAEnB,gBAAG,CAAC,IAAI,CACN,mKAAmK,CACpK,CAAC;YAEF,IAAI;gBACF,iDAAiD;gBACjD,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;gBAE/C,sDAAsD;gBACtD,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI;qBACnB,WAAW,CAAC;oBACX,IAAI,EAAE,OAAO,CAAC,OAAO;oBACrB,SAAS,EAAE,CAAC,IAAI,EAAE,EAAE,CAClB,IAAI,CAAC,MAAM,CAAC,KAAK;yBACd,MAAM,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,EAAE,IAAA,mBAAW,EAAC,IAAI,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;yBAClE,IAAI,CAAC,GAAG,EAAE;wBACT,MAAM,OAAO,GAAG;4BACd,IAAI,EAAE,IAAI,CAAC,IAAI;4BACf,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,KAAK,EAAE,IAAI,CAAC,KAAK;4BACjB,EAAE,EAAE,IAAI,CAAC,EAAE;yBACZ,CAAC;wBACF,gBAAG,CAAC,IAAI,CAAC,4BAA4B,IAAA,2BAAmB,EAAC,OAAO,CAAC,EAAE,CAAC,CAAC;oBACvE,CAAC,CAAC;iBACP,CAAC;qBACD,OAAO,EAAE,CAAC;gBAEb,MAAM,OAAM,cAAc,YAAC,MAAM,EAAE;oBACjC,GAAG,EAAE,OAAO,CAAC,GAAG;oBAChB,MAAM,EAAE,OAAO,CAAC,MAAM;oBACtB,MAAM,EAAE,OAAO,CAAC,MAAM;oBACtB,SAAS,EAAE,OAAO,CAAC,SAAS;iBAC7B,CAAC,CAAC;aACJ;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,IAAA,yBAAiB,EAAC,GAAG,CAAC,EAAE;oBAC1B,gBAAG,CAAC,IAAI,CACN,iMAAiM,CAClM,CAAC;oBACF,OAAO;iBACR;gBACD,MAAM,GAAG,CAAC;aACX;QACH,CAAC;KAAA;CACF;AAnMD,+BAmMC","sourcesContent":["import ValidationError from '../../validationError';\nimport { convertJsonToString, stripFields, duplicateItems, isDeprecatedError } from '../../utils';\nimport DefaultHandler from './default';\nimport log from '../../../logger';\nimport { calculateChanges } from '../../calculateChanges';\nimport { Asset, Assets, CalculatedChanges } from '../../../types';\n\nexport const excludeSchema = {\n  type: 'array',\n  items: { type: 'string' },\n};\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    default: [],\n    properties: {\n      script: {\n        type: 'string',\n        description: \"A script that contains the rule's code\",\n        default: '',\n      },\n      name: {\n        type: 'string',\n        description:\n          \"The name of the rule. Can only contain alphanumeric characters, spaces and '-'. Can neither start nor end with '-' or spaces\",\n        pattern: '^[^-\\\\s][a-zA-Z0-9-\\\\s]+[^-\\\\s]$',\n      },\n      order: {\n        type: ['number', 'null'],\n        description:\n          \"The rule's order in relation to other rules. A rule with a lower order than another rule executes first.\",\n        default: null,\n      },\n      enabled: {\n        type: 'boolean',\n        description: 'true if the rule is enabled, false otherwise',\n        default: true,\n      },\n      stage: {\n        type: 'string',\n        description: \"The rule's execution stage\",\n        default: 'login_success',\n        enum: ['login_success', 'login_failure', 'pre_authorize'],\n      },\n    },\n    required: ['name'],\n  },\n};\n\nexport default class RulesHandler extends DefaultHandler {\n  existing: Asset[];\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'rules',\n      stripUpdateFields: ['stage'], // Fields not allowed in updates\n    });\n  }\n\n  async getType(): Promise<Asset[] | null> {\n    try {\n      if (this.existing) return this.existing;\n      this.existing = await this.client.rules.getAll({ paginate: true, include_totals: true });\n      return this.existing;\n    } catch (err) {\n      if (isDeprecatedError(err)) {\n        return null;\n      }\n      throw err;\n    }\n  }\n\n  objString(rule): string {\n    return super.objString({ name: rule.name, order: rule.order });\n  }\n\n  async calcChanges(\n    assets,\n    includeExcluded = false\n  ): Promise<CalculatedChanges & { reOrder: Asset[] }> {\n    let { rules } = assets;\n\n    const excludedRules = (assets.exclude && assets.exclude.rules) || [];\n\n    let existing = await this.getType();\n    if (existing === null) {\n      return {\n        del: [],\n        update: [],\n        conflicts: [],\n        create: [],\n        reOrder: [],\n      };\n    }\n\n    // Filter excluded rules\n    if (!includeExcluded) {\n      rules = rules.filter((r) => !excludedRules.includes(r.name));\n      existing = existing.filter((r) => !excludedRules.includes(r.name));\n    }\n\n    // Figure out what needs to be updated vs created\n    const { del, update, create, conflicts } = calculateChanges({\n      handler: this,\n      assets: rules,\n      existing,\n      identifiers: this.identifiers,\n      allowDelete: !!this.config('AUTH0_ALLOW_DELETE'),\n    });\n    // Figure out the rules that need to be re-ordered\n    const futureRules = [...create, ...update];\n\n    const futureMaxOrder = Math.max(...futureRules.map((r) => r.order));\n    const existingMaxOrder = Math.max(...existing.map((r) => r.order));\n    let nextOrderNo = Math.max(futureMaxOrder, existingMaxOrder);\n\n    //@ts-ignore because we know reOrder is Asset[]\n    const reOrder: Asset[] = futureRules.reduce((accum: Asset[], r: Asset) => {\n      if (existing === null) return accum;\n      const conflict = existing.find((f) => r.order === f.order && r.name !== f.name);\n      if (conflict !== undefined) {\n        nextOrderNo += 1;\n        return [\n          ...accum,\n          {\n            ...conflict,\n            order: nextOrderNo,\n          },\n        ];\n      }\n      return accum;\n    }, []);\n\n    return {\n      del,\n      update,\n      create,\n      reOrder,\n      conflicts,\n    };\n  }\n\n  async validate(assets: Assets): Promise<void> {\n    const { rules } = assets;\n\n    // Do nothing if not set\n    if (!rules) return;\n\n    const excludedRules = (assets.exclude && assets.exclude.rules) || [];\n\n    // Figure out what needs to be updated vs created\n    const { update, create, del } = await this.calcChanges(assets, true);\n    // Include del rules which are actually not going to be deleted but are excluded\n    // they can still muck up the ordering so we must take it into consideration.\n    const futureRules = [\n      ...create,\n      ...update,\n      ...del.filter((r) => excludedRules.includes(r.name)),\n    ];\n\n    // Detect rules with the same order\n    const rulesSameOrder = duplicateItems(futureRules, 'order');\n    if (rulesSameOrder.length > 0) {\n      const formatted = rulesSameOrder.map((dups) => dups.map((d) => `${d.name}`));\n      throw new ValidationError(`There are multiple rules for the following stage-order combinations\n      ${convertJsonToString(formatted)}.\n       Only one rule must be defined for the same order number in a stage.`);\n    }\n\n    // Detect Rules that are changing stage as it's not allowed.\n    const existing = await this.getType();\n    if (existing === null) return;\n\n    const stateChanged = futureRules\n      .reduce(\n        (changed: Asset[], rule) => [\n          ...changed,\n          ...existing.filter(\n            (r) => rule.name.toLowerCase() === r.name.toLowerCase() && r.stage !== rule.stage\n          ),\n        ],\n        []\n      )\n      .map((r) => r.name);\n\n    if (stateChanged.length > 0) {\n      throw new ValidationError(`The following rules changed stage which is not allowed:\n      ${convertJsonToString(stateChanged)}.\n      Rename the rules to recreate them and avoid this error.`);\n    }\n\n    await super.validate(assets);\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    const { rules } = assets;\n\n    // Do nothing if not set\n    if (!rules) return;\n\n    log.warn(\n      'Rules are deprecated, migrate to using actions instead. See: https://auth0.com/docs/customize/actions/migrate/migrate-from-rules-to-actions for more information.'\n    );\n\n    try {\n      // Figure out what needs to be updated vs created\n      const changes = await this.calcChanges(assets);\n\n      // Temporally re-order rules with conflicting ordering\n      await this.client.pool\n        .addEachTask({\n          data: changes.reOrder,\n          generator: (rule) =>\n            this.client.rules\n              .update({ id: rule.id }, stripFields(rule, this.stripUpdateFields))\n              .then(() => {\n                const updated = {\n                  name: rule.name,\n                  stage: rule.stage,\n                  order: rule.order,\n                  id: rule.id,\n                };\n                log.info(`Temporally re-order Rule ${convertJsonToString(updated)}`);\n              }),\n        })\n        .promise();\n\n      await super.processChanges(assets, {\n        del: changes.del,\n        create: changes.create,\n        update: changes.update,\n        conflicts: changes.conflicts,\n      });\n    } catch (err) {\n      if (isDeprecatedError(err)) {\n        log.warn(\n          'Failed to update rules because functionality has been deprecated in favor of actions. See: https://auth0.com/docs/customize/actions/migrate/migrate-from-rules-to-actions for more information.'\n        );\n        return;\n      }\n      throw err;\n    }\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f54ec70569f76722b194d96361e5842657423de0","contentHash":"cf704a49b9f45f00ce27e202500a6bb7a894819f0654aef6b77a8aacbdc6bec8"},"/home/circleci/repo/src/tools/validationError.ts":{"path":"/home/circleci/repo/src/tools/validationError.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":4,"column":4},"end":{"line":4,"column":30}},"2":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"3":{"start":{"line":6,"column":8},"end":{"line":6,"column":56}},"4":{"start":{"line":8,"column":4},"end":{"line":8,"column":34}},"5":{"start":{"line":9,"column":4},"end":{"line":9,"column":27}},"6":{"start":{"line":10,"column":4},"end":{"line":10,"column":22}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":59}},"8":{"start":{"line":13,"column":0},"end":{"line":13,"column":56}},"9":{"start":{"line":14,"column":0},"end":{"line":14,"column":34}}},"fnMap":{"0":{"name":"ValidationError","decl":{"start":{"line":3,"column":9},"end":{"line":3,"column":24}},"loc":{"start":{"line":3,"column":34},"end":{"line":11,"column":1}},"line":3}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5}},"s":{"0":1,"1":18,"2":18,"3":18,"4":18,"5":18,"6":18,"7":1,"8":1,"9":1},"f":{"0":18},"b":{"0":[18,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/validationError.ts","sources":["/home/circleci/repo/src/tools/validationError.ts"],"names":[],"mappings":";;AAAA,SAAS,eAAe,CAAC,OAAe;IACtC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;IAC1B,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,EAAE;QACzC,KAAK,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;KACjD;IACD,IAAI,CAAC,IAAI,GAAG,iBAAiB,CAAC;IAC9B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IACvB,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC;AACpB,CAAC;AAED,eAAe,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;AAC3D,eAAe,CAAC,SAAS,CAAC,WAAW,GAAG,eAAe,CAAC;AAExD,kBAAe,eAAe,CAAC","sourcesContent":["function ValidationError(message: string) {\n  Error.call(this, message);\n  if (process.env.NODE_ENV !== 'production') {\n    Error.captureStackTrace(this, this.constructor);\n  }\n  this.name = 'ValidationError';\n  this.message = message;\n  this.status = 400;\n}\n\nValidationError.prototype = Object.create(Error.prototype);\nValidationError.prototype.constructor = ValidationError;\n\nexport default ValidationError;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e0dd5f5b25116b0b260f497754d1d8cb6248b3d7","contentHash":"15fc74e825c6ee15c6b4d5486ba01d770b1cd032613928627d39a85e9f3ff68b"},"/home/circleci/repo/src/tools/auth0/handlers/default.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/default.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":23}},"16":{"start":{"line":16,"column":26},"end":{"line":16,"column":75}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":38}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":27},"end":{"line":19,"column":60}},"20":{"start":{"line":21,"column":4},"end":{"line":24,"column":6}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":39}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":26}},"23":{"start":{"line":26,"column":0},"end":{"line":26,"column":22}},"24":{"start":{"line":29,"column":8},"end":{"line":29,"column":37}},"25":{"start":{"line":30,"column":8},"end":{"line":30,"column":33}},"26":{"start":{"line":31,"column":8},"end":{"line":31,"column":37}},"27":{"start":{"line":32,"column":8},"end":{"line":32,"column":37}},"28":{"start":{"line":33,"column":8},"end":{"line":33,"column":29}},"29":{"start":{"line":34,"column":8},"end":{"line":34,"column":65}},"30":{"start":{"line":35,"column":8},"end":{"line":35,"column":55}},"31":{"start":{"line":36,"column":8},"end":{"line":36,"column":81}},"32":{"start":{"line":37,"column":8},"end":{"line":37,"column":83}},"33":{"start":{"line":38,"column":8},"end":{"line":38,"column":65}},"34":{"start":{"line":39,"column":8},"end":{"line":39,"column":142}},"35":{"start":{"line":40,"column":8},"end":{"line":40,"column":25}},"36":{"start":{"line":41,"column":8},"end":{"line":41,"column":25}},"37":{"start":{"line":42,"column":8},"end":{"line":42,"column":25}},"38":{"start":{"line":45,"column":8},"end":{"line":48,"column":9}},"39":{"start":{"line":46,"column":27},"end":{"line":46,"column":49}},"40":{"start":{"line":47,"column":12},"end":{"line":47,"column":43}},"41":{"start":{"line":49,"column":8},"end":{"line":49,"column":18}},"42":{"start":{"line":52,"column":8},"end":{"line":52,"column":81}},"43":{"start":{"line":55,"column":8},"end":{"line":55,"column":81}},"44":{"start":{"line":58,"column":8},"end":{"line":58,"column":81}},"45":{"start":{"line":61,"column":8},"end":{"line":61,"column":54}},"46":{"start":{"line":64,"column":8},"end":{"line":67,"column":11}},"47":{"start":{"line":66,"column":12},"end":{"line":66,"column":76}},"48":{"start":{"line":70,"column":8},"end":{"line":83,"column":11}},"49":{"start":{"line":72,"column":25},"end":{"line":80,"column":17}},"50":{"start":{"line":72,"column":38},"end":{"line":80,"column":14}},"51":{"start":{"line":73,"column":70},"end":{"line":73,"column":142}},"52":{"start":{"line":74,"column":16},"end":{"line":77,"column":17}},"53":{"start":{"line":75,"column":20},"end":{"line":75,"column":115}},"54":{"start":{"line":76,"column":20},"end":{"line":76,"column":32}},"55":{"start":{"line":78,"column":16},"end":{"line":78,"column":81}},"56":{"start":{"line":79,"column":16},"end":{"line":79,"column":28}},"57":{"start":{"line":81,"column":12},"end":{"line":81,"column":105}},"58":{"start":{"line":82,"column":12},"end":{"line":82,"column":50}},"59":{"start":{"line":86,"column":8},"end":{"line":107,"column":11}},"60":{"start":{"line":87,"column":31},"end":{"line":87,"column":48}},"61":{"start":{"line":89,"column":12},"end":{"line":96,"column":13}},"62":{"start":{"line":90,"column":16},"end":{"line":95,"column":18}},"63":{"start":{"line":97,"column":29},"end":{"line":97,"column":49}},"64":{"start":{"line":99,"column":12},"end":{"line":106,"column":15}},"65":{"start":{"line":110,"column":8},"end":{"line":132,"column":11}},"66":{"start":{"line":112,"column":31},"end":{"line":112,"column":48}},"67":{"start":{"line":114,"column":12},"end":{"line":115,"column":23}},"68":{"start":{"line":115,"column":16},"end":{"line":115,"column":23}},"69":{"start":{"line":117,"column":35},"end":{"line":117,"column":82}},"70":{"start":{"line":118,"column":12},"end":{"line":123,"column":13}},"71":{"start":{"line":119,"column":34},"end":{"line":119,"column":92}},"72":{"start":{"line":119,"column":63},"end":{"line":119,"column":91}},"73":{"start":{"line":119,"column":79},"end":{"line":119,"column":90}},"74":{"start":{"line":120,"column":16},"end":{"line":122,"column":31}},"75":{"start":{"line":125,"column":33},"end":{"line":125,"column":81}},"76":{"start":{"line":126,"column":12},"end":{"line":131,"column":13}},"77":{"start":{"line":127,"column":34},"end":{"line":127,"column":94}},"78":{"start":{"line":127,"column":61},"end":{"line":127,"column":93}},"79":{"start":{"line":127,"column":77},"end":{"line":127,"column":92}},"80":{"start":{"line":128,"column":16},"end":{"line":130,"column":77}},"81":{"start":{"line":135,"column":8},"end":{"line":236,"column":11}},"82":{"start":{"line":136,"column":12},"end":{"line":138,"column":13}},"83":{"start":{"line":137,"column":16},"end":{"line":137,"column":57}},"84":{"start":{"line":139,"column":24},"end":{"line":139,"column":41}},"85":{"start":{"line":140,"column":27},"end":{"line":140,"column":47}},"86":{"start":{"line":141,"column":27},"end":{"line":141,"column":47}},"87":{"start":{"line":142,"column":30},"end":{"line":142,"column":53}},"88":{"start":{"line":143,"column":12},"end":{"line":143,"column":185}},"89":{"start":{"line":145,"column":12},"end":{"line":173,"column":13}},"90":{"start":{"line":146,"column":36},"end":{"line":146,"column":126}},"91":{"start":{"line":147,"column":36},"end":{"line":148,"column":78}},"92":{"start":{"line":149,"column":37},"end":{"line":149,"column":63}},"93":{"start":{"line":150,"column":16},"end":{"line":172,"column":17}},"94":{"start":{"line":151,"column":20},"end":{"line":153,"column":12}},"95":{"start":{"line":152,"column":35},"end":{"line":152,"column":52}},"96":{"start":{"line":156,"column":20},"end":{"line":171,"column":35}},"97":{"start":{"line":160,"column":48},"end":{"line":160,"column":87}},"98":{"start":{"line":161,"column":28},"end":{"line":168,"column":31}},"99":{"start":{"line":163,"column":32},"end":{"line":163,"column":56}},"100":{"start":{"line":164,"column":32},"end":{"line":164,"column":50}},"101":{"start":{"line":167,"column":32},"end":{"line":167,"column":116}},"102":{"start":{"line":175,"column":12},"end":{"line":192,"column":27}},"103":{"start":{"line":179,"column":37},"end":{"line":179,"column":76}},"104":{"start":{"line":180,"column":35},"end":{"line":180,"column":69}},"105":{"start":{"line":181,"column":42},"end":{"line":184,"column":24}},"106":{"start":{"line":182,"column":35},"end":{"line":182,"column":114}},"107":{"start":{"line":183,"column":24},"end":{"line":183,"column":116}},"108":{"start":{"line":185,"column":20},"end":{"line":189,"column":23}},"109":{"start":{"line":186,"column":40},"end":{"line":186,"column":60}},"110":{"start":{"line":188,"column":24},"end":{"line":188,"column":111}},"111":{"start":{"line":194,"column":12},"end":{"line":213,"column":27}},"112":{"start":{"line":198,"column":43},"end":{"line":198,"column":82}},"113":{"start":{"line":199,"column":42},"end":{"line":202,"column":24}},"114":{"start":{"line":200,"column":48},"end":{"line":200,"column":108}},"115":{"start":{"line":201,"column":24},"end":{"line":201,"column":127}},"116":{"start":{"line":203,"column":20},"end":{"line":210,"column":23}},"117":{"start":{"line":205,"column":24},"end":{"line":205,"column":45}},"118":{"start":{"line":206,"column":24},"end":{"line":206,"column":42}},"119":{"start":{"line":209,"column":24},"end":{"line":209,"column":111}},"120":{"start":{"line":215,"column":12},"end":{"line":235,"column":27}},"121":{"start":{"line":219,"column":37},"end":{"line":219,"column":76}},"122":{"start":{"line":220,"column":35},"end":{"line":220,"column":69}},"123":{"start":{"line":221,"column":42},"end":{"line":224,"column":24}},"124":{"start":{"line":222,"column":35},"end":{"line":222,"column":114}},"125":{"start":{"line":223,"column":24},"end":{"line":223,"column":116}},"126":{"start":{"line":225,"column":20},"end":{"line":232,"column":23}},"127":{"start":{"line":227,"column":24},"end":{"line":227,"column":45}},"128":{"start":{"line":228,"column":24},"end":{"line":228,"column":42}},"129":{"start":{"line":231,"column":24},"end":{"line":231,"column":111}},"130":{"start":{"line":239,"column":0},"end":{"line":239,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"order","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":22},"end":{"line":25,"column":1}},"line":20},"9":{"name":"decorator","decl":{"start":{"line":21,"column":20},"end":{"line":21,"column":29}},"loc":{"start":{"line":21,"column":48},"end":{"line":24,"column":5}},"line":21},"10":{"name":"(anonymous_10)","decl":{"start":{"line":28,"column":4},"end":{"line":28,"column":5}},"loc":{"start":{"line":28,"column":25},"end":{"line":43,"column":5}},"line":28},"11":{"name":"(anonymous_11)","decl":{"start":{"line":44,"column":4},"end":{"line":44,"column":5}},"loc":{"start":{"line":44,"column":20},"end":{"line":50,"column":5}},"line":44},"12":{"name":"(anonymous_12)","decl":{"start":{"line":51,"column":4},"end":{"line":51,"column":5}},"loc":{"start":{"line":51,"column":20},"end":{"line":53,"column":5}},"line":51},"13":{"name":"(anonymous_13)","decl":{"start":{"line":54,"column":4},"end":{"line":54,"column":5}},"loc":{"start":{"line":54,"column":20},"end":{"line":56,"column":5}},"line":54},"14":{"name":"(anonymous_14)","decl":{"start":{"line":57,"column":4},"end":{"line":57,"column":5}},"loc":{"start":{"line":57,"column":20},"end":{"line":59,"column":5}},"line":57},"15":{"name":"(anonymous_15)","decl":{"start":{"line":60,"column":4},"end":{"line":60,"column":5}},"loc":{"start":{"line":60,"column":20},"end":{"line":62,"column":5}},"line":60},"16":{"name":"(anonymous_16)","decl":{"start":{"line":63,"column":4},"end":{"line":63,"column":5}},"loc":{"start":{"line":63,"column":14},"end":{"line":68,"column":5}},"line":63},"17":{"name":"(anonymous_17)","decl":{"start":{"line":64,"column":47},"end":{"line":64,"column":48}},"loc":{"start":{"line":64,"column":60},"end":{"line":67,"column":9}},"line":64},"18":{"name":"(anonymous_18)","decl":{"start":{"line":69,"column":4},"end":{"line":69,"column":5}},"loc":{"start":{"line":69,"column":11},"end":{"line":84,"column":5}},"line":69},"19":{"name":"(anonymous_19)","decl":{"start":{"line":70,"column":47},"end":{"line":70,"column":48}},"loc":{"start":{"line":70,"column":60},"end":{"line":83,"column":9}},"line":70},"20":{"name":"(anonymous_20)","decl":{"start":{"line":72,"column":32},"end":{"line":72,"column":33}},"loc":{"start":{"line":72,"column":38},"end":{"line":80,"column":14}},"line":72},"21":{"name":"(anonymous_21)","decl":{"start":{"line":72,"column":70},"end":{"line":72,"column":71}},"loc":{"start":{"line":72,"column":83},"end":{"line":80,"column":13}},"line":72},"22":{"name":"(anonymous_22)","decl":{"start":{"line":85,"column":4},"end":{"line":85,"column":5}},"loc":{"start":{"line":85,"column":24},"end":{"line":108,"column":5}},"line":85},"23":{"name":"(anonymous_23)","decl":{"start":{"line":86,"column":47},"end":{"line":86,"column":48}},"loc":{"start":{"line":86,"column":60},"end":{"line":107,"column":9}},"line":86},"24":{"name":"(anonymous_24)","decl":{"start":{"line":109,"column":4},"end":{"line":109,"column":5}},"loc":{"start":{"line":109,"column":21},"end":{"line":133,"column":5}},"line":109},"25":{"name":"(anonymous_25)","decl":{"start":{"line":110,"column":47},"end":{"line":110,"column":48}},"loc":{"start":{"line":110,"column":60},"end":{"line":132,"column":9}},"line":110},"26":{"name":"(anonymous_26)","decl":{"start":{"line":119,"column":53},"end":{"line":119,"column":54}},"loc":{"start":{"line":119,"column":63},"end":{"line":119,"column":91}},"line":119},"27":{"name":"(anonymous_27)","decl":{"start":{"line":119,"column":72},"end":{"line":119,"column":73}},"loc":{"start":{"line":119,"column":79},"end":{"line":119,"column":90}},"line":119},"28":{"name":"(anonymous_28)","decl":{"start":{"line":127,"column":51},"end":{"line":127,"column":52}},"loc":{"start":{"line":127,"column":61},"end":{"line":127,"column":93}},"line":127},"29":{"name":"(anonymous_29)","decl":{"start":{"line":127,"column":70},"end":{"line":127,"column":71}},"loc":{"start":{"line":127,"column":77},"end":{"line":127,"column":92}},"line":127},"30":{"name":"(anonymous_30)","decl":{"start":{"line":134,"column":4},"end":{"line":134,"column":5}},"loc":{"start":{"line":134,"column":36},"end":{"line":237,"column":5}},"line":134},"31":{"name":"(anonymous_31)","decl":{"start":{"line":135,"column":47},"end":{"line":135,"column":48}},"loc":{"start":{"line":135,"column":60},"end":{"line":236,"column":9}},"line":135},"32":{"name":"(anonymous_32)","decl":{"start":{"line":152,"column":28},"end":{"line":152,"column":29}},"loc":{"start":{"line":152,"column":35},"end":{"line":152,"column":52}},"line":152},"33":{"name":"(anonymous_33)","decl":{"start":{"line":159,"column":35},"end":{"line":159,"column":36}},"loc":{"start":{"line":159,"column":48},"end":{"line":169,"column":25}},"line":159},"34":{"name":"(anonymous_34)","decl":{"start":{"line":162,"column":38},"end":{"line":162,"column":39}},"loc":{"start":{"line":162,"column":44},"end":{"line":165,"column":29}},"line":162},"35":{"name":"(anonymous_35)","decl":{"start":{"line":166,"column":39},"end":{"line":166,"column":40}},"loc":{"start":{"line":166,"column":48},"end":{"line":168,"column":29}},"line":166},"36":{"name":"(anonymous_36)","decl":{"start":{"line":178,"column":27},"end":{"line":178,"column":28}},"loc":{"start":{"line":178,"column":43},"end":{"line":190,"column":17}},"line":178},"37":{"name":"(anonymous_37)","decl":{"start":{"line":181,"column":43},"end":{"line":181,"column":44}},"loc":{"start":{"line":181,"column":49},"end":{"line":184,"column":21}},"line":181},"38":{"name":"(anonymous_38)","decl":{"start":{"line":186,"column":30},"end":{"line":186,"column":31}},"loc":{"start":{"line":186,"column":40},"end":{"line":186,"column":60}},"line":186},"39":{"name":"(anonymous_39)","decl":{"start":{"line":187,"column":31},"end":{"line":187,"column":32}},"loc":{"start":{"line":187,"column":40},"end":{"line":189,"column":21}},"line":187},"40":{"name":"(anonymous_40)","decl":{"start":{"line":197,"column":27},"end":{"line":197,"column":28}},"loc":{"start":{"line":197,"column":43},"end":{"line":211,"column":17}},"line":197},"41":{"name":"(anonymous_41)","decl":{"start":{"line":199,"column":43},"end":{"line":199,"column":44}},"loc":{"start":{"line":199,"column":49},"end":{"line":202,"column":21}},"line":199},"42":{"name":"(anonymous_42)","decl":{"start":{"line":204,"column":30},"end":{"line":204,"column":31}},"loc":{"start":{"line":204,"column":40},"end":{"line":207,"column":21}},"line":204},"43":{"name":"(anonymous_43)","decl":{"start":{"line":208,"column":31},"end":{"line":208,"column":32}},"loc":{"start":{"line":208,"column":40},"end":{"line":210,"column":21}},"line":208},"44":{"name":"(anonymous_44)","decl":{"start":{"line":218,"column":27},"end":{"line":218,"column":28}},"loc":{"start":{"line":218,"column":43},"end":{"line":233,"column":17}},"line":218},"45":{"name":"(anonymous_45)","decl":{"start":{"line":221,"column":43},"end":{"line":221,"column":44}},"loc":{"start":{"line":221,"column":49},"end":{"line":224,"column":21}},"line":221},"46":{"name":"(anonymous_46)","decl":{"start":{"line":226,"column":30},"end":{"line":226,"column":31}},"loc":{"start":{"line":226,"column":40},"end":{"line":229,"column":21}},"line":226},"47":{"name":"(anonymous_47)","decl":{"start":{"line":230,"column":31},"end":{"line":230,"column":32}},"loc":{"start":{"line":230,"column":40},"end":{"line":232,"column":21}},"line":230}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":31,"column":18},"end":{"line":31,"column":36}},"type":"binary-expr","locations":[{"start":{"line":31,"column":18},"end":{"line":31,"column":28}},{"start":{"line":31,"column":32},"end":{"line":31,"column":36}}],"line":31},"9":{"loc":{"start":{"line":34,"column":27},"end":{"line":34,"column":64}},"type":"binary-expr","locations":[{"start":{"line":34,"column":27},"end":{"line":34,"column":46}},{"start":{"line":34,"column":50},"end":{"line":34,"column":64}}],"line":34},"10":{"loc":{"start":{"line":35,"column":28},"end":{"line":35,"column":54}},"type":"binary-expr","locations":[{"start":{"line":35,"column":28},"end":{"line":35,"column":48}},{"start":{"line":35,"column":52},"end":{"line":35,"column":54}}],"line":35},"11":{"loc":{"start":{"line":36,"column":38},"end":{"line":36,"column":69}},"type":"binary-expr","locations":[{"start":{"line":36,"column":38},"end":{"line":36,"column":63}},{"start":{"line":36,"column":67},"end":{"line":36,"column":69}}],"line":36},"12":{"loc":{"start":{"line":37,"column":42},"end":{"line":37,"column":82}},"type":"binary-expr","locations":[{"start":{"line":37,"column":42},"end":{"line":37,"column":76}},{"start":{"line":37,"column":80},"end":{"line":37,"column":82}}],"line":37},"13":{"loc":{"start":{"line":38,"column":33},"end":{"line":38,"column":64}},"type":"binary-expr","locations":[{"start":{"line":38,"column":33},"end":{"line":38,"column":58}},{"start":{"line":38,"column":62},"end":{"line":38,"column":64}}],"line":38},"14":{"loc":{"start":{"line":39,"column":116},"end":{"line":39,"column":139}},"type":"binary-expr","locations":[{"start":{"line":39,"column":116},"end":{"line":39,"column":133}},{"start":{"line":39,"column":137},"end":{"line":39,"column":139}}],"line":39},"15":{"loc":{"start":{"line":45,"column":8},"end":{"line":48,"column":9}},"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":48,"column":9}},{"start":{"line":45,"column":8},"end":{"line":48,"column":9}}],"line":45},"16":{"loc":{"start":{"line":74,"column":16},"end":{"line":77,"column":17}},"type":"if","locations":[{"start":{"line":74,"column":16},"end":{"line":77,"column":17}},{"start":{"line":74,"column":16},"end":{"line":77,"column":17}}],"line":74},"17":{"loc":{"start":{"line":89,"column":12},"end":{"line":96,"column":13}},"type":"if","locations":[{"start":{"line":89,"column":12},"end":{"line":96,"column":13}},{"start":{"line":89,"column":12},"end":{"line":96,"column":13}}],"line":89},"18":{"loc":{"start":{"line":114,"column":12},"end":{"line":115,"column":23}},"type":"if","locations":[{"start":{"line":114,"column":12},"end":{"line":115,"column":23}},{"start":{"line":114,"column":12},"end":{"line":115,"column":23}}],"line":114},"19":{"loc":{"start":{"line":118,"column":12},"end":{"line":123,"column":13}},"type":"if","locations":[{"start":{"line":118,"column":12},"end":{"line":123,"column":13}},{"start":{"line":118,"column":12},"end":{"line":123,"column":13}}],"line":118},"20":{"loc":{"start":{"line":126,"column":12},"end":{"line":131,"column":13}},"type":"if","locations":[{"start":{"line":126,"column":12},"end":{"line":131,"column":13}},{"start":{"line":126,"column":12},"end":{"line":131,"column":13}}],"line":126},"21":{"loc":{"start":{"line":136,"column":12},"end":{"line":138,"column":13}},"type":"if","locations":[{"start":{"line":136,"column":12},"end":{"line":138,"column":13}},{"start":{"line":136,"column":12},"end":{"line":138,"column":13}}],"line":136},"22":{"loc":{"start":{"line":139,"column":24},"end":{"line":139,"column":41}},"type":"binary-expr","locations":[{"start":{"line":139,"column":24},"end":{"line":139,"column":35}},{"start":{"line":139,"column":39},"end":{"line":139,"column":41}}],"line":139},"23":{"loc":{"start":{"line":140,"column":27},"end":{"line":140,"column":47}},"type":"binary-expr","locations":[{"start":{"line":140,"column":27},"end":{"line":140,"column":41}},{"start":{"line":140,"column":45},"end":{"line":140,"column":47}}],"line":140},"24":{"loc":{"start":{"line":141,"column":27},"end":{"line":141,"column":47}},"type":"binary-expr","locations":[{"start":{"line":141,"column":27},"end":{"line":141,"column":41}},{"start":{"line":141,"column":45},"end":{"line":141,"column":47}}],"line":141},"25":{"loc":{"start":{"line":142,"column":30},"end":{"line":142,"column":53}},"type":"binary-expr","locations":[{"start":{"line":142,"column":30},"end":{"line":142,"column":47}},{"start":{"line":142,"column":51},"end":{"line":142,"column":53}}],"line":142},"26":{"loc":{"start":{"line":145,"column":12},"end":{"line":173,"column":13}},"type":"if","locations":[{"start":{"line":145,"column":12},"end":{"line":173,"column":13}},{"start":{"line":145,"column":12},"end":{"line":173,"column":13}}],"line":145},"27":{"loc":{"start":{"line":146,"column":36},"end":{"line":146,"column":126}},"type":"binary-expr","locations":[{"start":{"line":146,"column":36},"end":{"line":146,"column":80}},{"start":{"line":146,"column":84},"end":{"line":146,"column":126}}],"line":146},"28":{"loc":{"start":{"line":147,"column":36},"end":{"line":148,"column":78}},"type":"binary-expr","locations":[{"start":{"line":147,"column":36},"end":{"line":147,"column":67}},{"start":{"line":148,"column":21},"end":{"line":148,"column":42}},{"start":{"line":148,"column":46},"end":{"line":148,"column":77}}],"line":147},"29":{"loc":{"start":{"line":149,"column":37},"end":{"line":149,"column":63}},"type":"binary-expr","locations":[{"start":{"line":149,"column":37},"end":{"line":149,"column":48}},{"start":{"line":149,"column":52},"end":{"line":149,"column":63}}],"line":149},"30":{"loc":{"start":{"line":150,"column":16},"end":{"line":172,"column":17}},"type":"if","locations":[{"start":{"line":150,"column":16},"end":{"line":172,"column":17}},{"start":{"line":150,"column":16},"end":{"line":172,"column":17}}],"line":150},"31":{"loc":{"start":{"line":158,"column":30},"end":{"line":158,"column":39}},"type":"binary-expr","locations":[{"start":{"line":158,"column":30},"end":{"line":158,"column":33}},{"start":{"line":158,"column":37},"end":{"line":158,"column":39}}],"line":158},"32":{"loc":{"start":{"line":177,"column":22},"end":{"line":177,"column":37}},"type":"binary-expr","locations":[{"start":{"line":177,"column":22},"end":{"line":177,"column":31}},{"start":{"line":177,"column":35},"end":{"line":177,"column":37}}],"line":177},"33":{"loc":{"start":{"line":196,"column":22},"end":{"line":196,"column":34}},"type":"binary-expr","locations":[{"start":{"line":196,"column":22},"end":{"line":196,"column":28}},{"start":{"line":196,"column":32},"end":{"line":196,"column":34}}],"line":196},"34":{"loc":{"start":{"line":217,"column":22},"end":{"line":217,"column":34}},"type":"binary-expr","locations":[{"start":{"line":217,"column":22},"end":{"line":217,"column":28}},{"start":{"line":217,"column":32},"end":{"line":217,"column":34}}],"line":217}},"s":{"0":1,"1":533,"2":199,"3":2178,"4":533,"5":533,"6":1,"7":0,"8":0,"9":0,"10":2696,"11":2178,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":13,"21":13,"22":13,"23":1,"24":3999,"25":3999,"26":3999,"27":3999,"28":3999,"29":3999,"30":3999,"31":3999,"32":3999,"33":3999,"34":3999,"35":3999,"36":3999,"37":3999,"38":60,"39":49,"40":49,"41":11,"42":24,"43":34,"44":67,"45":133,"46":0,"47":0,"48":123,"49":123,"50":123,"51":123,"52":123,"53":0,"54":0,"55":123,"56":123,"57":123,"58":123,"59":52,"60":52,"61":52,"62":0,"63":52,"64":52,"65":1810,"66":1810,"67":1810,"68":1735,"69":75,"70":75,"71":13,"72":13,"73":26,"74":13,"75":62,"76":62,"77":1,"78":1,"79":2,"80":1,"81":70,"82":70,"83":8,"84":70,"85":70,"86":70,"87":70,"88":70,"89":70,"90":27,"91":27,"92":27,"93":27,"94":8,"95":9,"96":19,"97":19,"98":19,"99":19,"100":19,"101":0,"102":70,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":70,"112":28,"113":28,"114":28,"115":28,"116":28,"117":27,"118":27,"119":0,"120":69,"121":21,"122":21,"123":21,"124":21,"125":21,"126":21,"127":21,"128":21,"129":0,"130":1},"f":{"0":2178,"1":533,"2":199,"3":2178,"4":533,"5":0,"6":2696,"7":2,"8":13,"9":13,"10":3999,"11":60,"12":24,"13":34,"14":67,"15":133,"16":0,"17":0,"18":123,"19":123,"20":123,"21":123,"22":52,"23":52,"24":1810,"25":1810,"26":13,"27":26,"28":1,"29":2,"30":70,"31":70,"32":9,"33":19,"34":19,"35":0,"36":0,"37":0,"38":0,"39":0,"40":28,"41":28,"42":27,"43":0,"44":21,"45":21,"46":21,"47":0},"b":{"0":[1,1,1],"1":[334,199],"2":[2178,2178],"3":[2163,533],"4":[2178,2178],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[3999,2482],"9":[3999,3170],"10":[3999,3858],"11":[3999,2727],"12":[3999,3864],"13":[3999,3728],"14":[3999,3583],"15":[49,11],"16":[0,123],"17":[0,52],"18":[1735,75],"19":[13,62],"20":[1,61],"21":[8,62],"22":[70,0],"23":[70,0],"24":[70,0],"25":[70,0],"26":[27,43],"27":[27,27],"28":[27,6,5],"29":[27,10],"30":[8,19],"31":[19,0],"32":[70,0],"33":[70,0],"34":[69,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/default.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/default.ts"],"names":[],"mappings":"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","sourcesContent":["import ValidationError from '../../validationError';\n\nimport {\n  stripFields,\n  convertJsonToString,\n  duplicateItems,\n  obfuscateSensitiveValues,\n  stripObfuscatedFieldsFromPayload,\n  detectInsufficientScopeError,\n} from '../../utils';\nimport log from '../../../logger';\nimport { calculateChanges } from '../../calculateChanges';\nimport { Asset, Assets, Auth0APIClient, CalculatedChanges } from '../../../types';\nimport { ConfigFunction } from '../../../configFactory';\n\nexport function order(value) {\n  return function decorator(t, n, descriptor) {\n    descriptor.value.order = value; // eslint-disable-line\n    return descriptor;\n  };\n}\n\ntype ApiMethodOverride = string | Function;\n\nexport default class APIHandler {\n  config: ConfigFunction;\n  id: string;\n  type: string;\n  updated: number;\n  created: number;\n  deleted: number;\n  existing: null | Asset | Asset[];\n  client: Auth0APIClient; // TODO: apply stronger types to Auth0 API client\n  identifiers: string[];\n  objectFields: string[];\n  sensitiveFieldsToObfuscate: string[];\n  stripUpdateFields: string[]; //Fields to strip from payload when updating\n  stripCreateFields: string[]; //Fields to strip from payload when creating\n  name?: string; // TODO: understand if any handlers actually leverage `name` property\n  functions: {\n    getAll: ApiMethodOverride;\n    update: ApiMethodOverride;\n    create: ApiMethodOverride;\n    delete: ApiMethodOverride;\n  };\n\n  constructor(options: {\n    id?: APIHandler['id'];\n    config: ConfigFunction;\n    type: APIHandler['type'];\n    client: Auth0APIClient;\n    objectFields?: APIHandler['objectFields'];\n    identifiers?: APIHandler['identifiers'];\n    stripUpdateFields?: APIHandler['stripUpdateFields'];\n    sensitiveFieldsToObfuscate?: APIHandler['sensitiveFieldsToObfuscate'];\n    stripCreateFields?: APIHandler['stripCreateFields'];\n    functions: {\n      getAll?: ApiMethodOverride;\n      update?: ApiMethodOverride;\n      create?: ApiMethodOverride;\n      delete?: ApiMethodOverride;\n    };\n  }) {\n    this.config = options.config;\n    this.type = options.type;\n    this.id = options.id || 'id';\n    this.client = options.client;\n    this.existing = null;\n    this.identifiers = options.identifiers || ['id', 'name'];\n    this.objectFields = options.objectFields || [];\n    this.stripUpdateFields = [...(options.stripUpdateFields || []), this.id];\n    this.sensitiveFieldsToObfuscate = options.sensitiveFieldsToObfuscate || [];\n    this.stripCreateFields = options.stripCreateFields || [];\n\n    this.functions = {\n      getAll: 'getAll',\n      create: 'create',\n      delete: 'delete',\n      update: 'update',\n      ...(options.functions || {}),\n    };\n\n    this.updated = 0;\n    this.created = 0;\n    this.deleted = 0;\n  }\n\n  getClientFN(fn: ApiMethodOverride): Function {\n    if (typeof fn === 'string') {\n      const client = this.client[this.type];\n      return client[fn].bind(client);\n    }\n    return fn;\n  }\n\n  didDelete(item: Asset): void {\n    log.info(`Deleted [${this.type}]: ${this.objString(item)}`);\n  }\n\n  didCreate(item: Asset): void {\n    log.info(`Created [${this.type}]: ${this.objString(item)}`);\n  }\n\n  didUpdate(item: Asset): void {\n    log.info(`Updated [${this.type}]: ${this.objString(item)}`);\n  }\n\n  objString(item: Asset): string {\n    return convertJsonToString(item);\n  }\n\n  async getType(): Promise<Asset | Asset[] | null> {\n    // Each type to impl how to get the existing as its not consistent across the mgnt api.\n    throw new Error(`Must implement getType for type ${this.type}`);\n  }\n\n  async load(): Promise<{ [key: string]: Asset | Asset[] | null }> {\n    // Load Asset from Tenant\n    const data = await (async () => {\n      const { data, hadSufficientScopes, requiredScopes } = await detectInsufficientScopeError<\n        Asset | Asset[]\n      >(this.getType.bind(this));\n      if (!hadSufficientScopes) {\n        log.warn(`Cannot retrieve ${this.type} due to missing scopes: ${requiredScopes}`);\n        return null;\n      }\n      log.info(`Retrieving ${this.type} data from Auth0`);\n      return data;\n    })();\n\n    this.existing = obfuscateSensitiveValues(data, this.sensitiveFieldsToObfuscate);\n\n    return { [this.type]: this.existing };\n  }\n\n  async calcChanges(assets: Assets): Promise<CalculatedChanges> {\n    const typeAssets = assets[this.type];\n\n    // Do nothing if not set\n    if (!typeAssets) {\n      return {\n        del: [],\n        create: [],\n        conflicts: [],\n        update: [],\n      };\n    }\n\n    const existing = await this.getType();\n\n    // Figure out what needs to be updated vs created\n    return calculateChanges({\n      handler: this,\n      assets: typeAssets,\n      allowDelete: !!this.config('AUTH0_ALLOW_DELETE'),\n      //@ts-ignore TODO: investigate what happens when `existing` is null\n      existing,\n      identifiers: this.identifiers,\n    });\n  }\n\n  async validate(assets: Assets): Promise<void> {\n    // Ensure no duplication in id and name\n    const typeAssets = assets[this.type];\n\n    // Do nothing if not set\n    if (!Array.isArray(typeAssets)) return;\n\n    // Do not allow items with same name\n    const duplicateNames = duplicateItems(typeAssets, 'name');\n    if (duplicateNames.length > 0) {\n      const formatted = duplicateNames.map((dups) => dups.map((d) => `${d.name}`));\n      throw new ValidationError(`There are multiple ${this.type} with the same name combinations\n      ${convertJsonToString(formatted)}.\n       Names must be unique.`);\n    }\n\n    // Do not allow items with same id\n    const duplicateIDs = duplicateItems(typeAssets, this.id);\n    if (duplicateIDs.length > 0) {\n      const formatted = duplicateIDs.map((dups) => dups.map((d) => `${d[this.id]}`));\n      throw new ValidationError(`There are multiple ${\n        this.type\n      } for the following stage-order combinations\n      ${convertJsonToString(formatted)}.\n       Only one rule must be defined for the same order number in a stage.`);\n    }\n  }\n\n  async processChanges(assets: Assets, changes: CalculatedChanges): Promise<void> {\n    if (!changes) {\n      changes = await this.calcChanges(assets);\n    }\n\n    const del = changes.del || [];\n    const update = changes.update || [];\n    const create = changes.create || [];\n    const conflicts = changes.conflicts || [];\n\n    log.debug(\n      `Start processChanges for ${this.type} [delete:${del.length}] [update:${update.length}], [create:${create.length}], [conflicts:${conflicts.length}]`\n    );\n\n    // Process Deleted\n    if (del.length > 0) {\n      const allowDelete =\n        this.config('AUTH0_ALLOW_DELETE') === 'true' || this.config('AUTH0_ALLOW_DELETE') === true;\n      const byExtension =\n        this.config('EXTENSION_SECRET') &&\n        (this.type === 'rules' || this.type === 'resourceServers');\n      const shouldDelete = allowDelete || byExtension;\n      if (!shouldDelete) {\n        log.warn(`Detected the following ${\n          this.type\n        } should be deleted. Doing so may be destructive.\\nYou can enable deletes by setting 'AUTH0_ALLOW_DELETE' to true in the config\n        \\n${changes.del.map((i) => this.objString(i)).join('\\n')}\n         `);\n      } else {\n        await this.client.pool\n          .addEachTask({\n            data: del || [],\n            generator: (delItem) => {\n              const delFunction = this.getClientFN(this.functions.delete);\n              return delFunction({ [this.id]: delItem[this.id] })\n                .then(() => {\n                  this.didDelete(delItem);\n                  this.deleted += 1;\n                })\n                .catch((err) => {\n                  throw new Error(\n                    `Problem deleting ${this.type} ${this.objString(delItem)}\\n${err}`\n                  );\n                });\n            },\n          })\n          .promise();\n      }\n    }\n\n    // Process Renaming Entries Temp due to conflicts in names\n    await this.client.pool\n      .addEachTask({\n        data: conflicts || [],\n        generator: (updateItem) => {\n          const updateFN = this.getClientFN(this.functions.update);\n          const params = { [this.id]: updateItem[this.id] };\n          const updatePayload = (() => {\n            let data = stripFields({ ...updateItem }, this.stripUpdateFields);\n            return stripObfuscatedFieldsFromPayload(data, this.sensitiveFieldsToObfuscate);\n          })();\n          return updateFN(params, updatePayload)\n            .then((data) => this.didUpdate(data))\n            .catch((err) => {\n              throw new Error(\n                `Problem updating ${this.type} ${this.objString(updateItem)}\\n${err}`\n              );\n            });\n        },\n      })\n      .promise();\n\n    // Process Creations\n    await this.client.pool\n      .addEachTask({\n        data: create || [],\n        generator: (createItem) => {\n          const createFunction = this.getClientFN(this.functions.create);\n          const createPayload = (() => {\n            const strippedPayload = stripFields(createItem, this.stripCreateFields);\n            return stripObfuscatedFieldsFromPayload(\n              strippedPayload,\n              this.sensitiveFieldsToObfuscate\n            );\n          })();\n          return createFunction(createPayload)\n            .then((data) => {\n              this.didCreate(data);\n              this.created += 1;\n            })\n            .catch((err) => {\n              throw new Error(\n                `Problem creating ${this.type} ${this.objString(createItem)}\\n${err}`\n              );\n            });\n        },\n      })\n      .promise();\n\n    // Process Updates and strip fields not allowed in updates\n    await this.client.pool\n      .addEachTask({\n        data: update || [],\n        generator: (updateItem) => {\n          const updateFN = this.getClientFN(this.functions.update);\n          const params = { [this.id]: updateItem[this.id] };\n          const updatePayload = (() => {\n            let data = stripFields({ ...updateItem }, this.stripUpdateFields);\n            return stripObfuscatedFieldsFromPayload(data, this.sensitiveFieldsToObfuscate);\n          })();\n          return updateFN(params, updatePayload)\n            .then((data) => {\n              this.didUpdate(data);\n              this.updated += 1;\n            })\n            .catch((err) => {\n              throw new Error(\n                `Problem updating ${this.type} ${this.objString(updateItem)}\\n${err}`\n              );\n            });\n        },\n      })\n      .promise();\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a0ca29dbc34bc473f2fc7d3e0d0ed23811befcff","contentHash":"8c08b9eaf96ca344c9cd343b44e3ec878eacc2148199e8a69177a615314756bf"},"/home/circleci/repo/src/tools/calculateChanges.ts":{"path":"/home/circleci/repo/src/tools/calculateChanges.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":71}},"4":{"start":{"line":7,"column":17},"end":{"line":7,"column":54}},"5":{"start":{"line":18,"column":41},"end":{"line":18,"column":77}},"6":{"start":{"line":20,"column":4},"end":{"line":63,"column":5}},"7":{"start":{"line":21,"column":52},"end":{"line":22,"column":72}},"8":{"start":{"line":23,"column":8},"end":{"line":27,"column":9}},"9":{"start":{"line":26,"column":12},"end":{"line":26,"column":21}},"10":{"start":{"line":30,"column":8},"end":{"line":62,"column":9}},"11":{"start":{"line":35,"column":12},"end":{"line":50,"column":13}},"12":{"start":{"line":37,"column":16},"end":{"line":49,"column":17}},"13":{"start":{"line":39,"column":20},"end":{"line":48,"column":21}},"14":{"start":{"line":41,"column":24},"end":{"line":47,"column":25}},"15":{"start":{"line":42,"column":28},"end":{"line":42,"column":107}},"16":{"start":{"line":46,"column":28},"end":{"line":46,"column":304}},"17":{"start":{"line":52,"column":13},"end":{"line":62,"column":9}},"18":{"start":{"line":57,"column":12},"end":{"line":57,"column":57}},"19":{"start":{"line":60,"column":12},"end":{"line":60,"column":59}},"20":{"start":{"line":61,"column":12},"end":{"line":61,"column":288}},"21":{"start":{"line":64,"column":4},"end":{"line":64,"column":40}},"22":{"start":{"line":66,"column":0},"end":{"line":66,"column":64}},"23":{"start":{"line":69,"column":19},"end":{"line":69,"column":21}},"24":{"start":{"line":70,"column":14},"end":{"line":70,"column":35}},"25":{"start":{"line":71,"column":17},"end":{"line":71,"column":28}},"26":{"start":{"line":72,"column":22},"end":{"line":72,"column":24}},"27":{"start":{"line":73,"column":27},"end":{"line":81,"column":6}},"28":{"start":{"line":73,"column":48},"end":{"line":81,"column":6}},"29":{"start":{"line":74,"column":8},"end":{"line":79,"column":9}},"30":{"start":{"line":75,"column":27},"end":{"line":75,"column":47}},"31":{"start":{"line":75,"column":42},"end":{"line":75,"column":46}},"32":{"start":{"line":76,"column":12},"end":{"line":78,"column":13}},"33":{"start":{"line":76,"column":36},"end":{"line":76,"column":37}},"34":{"start":{"line":77,"column":16},"end":{"line":77,"column":50}},"35":{"start":{"line":80,"column":8},"end":{"line":80,"column":32}},"36":{"start":{"line":82,"column":26},"end":{"line":116,"column":5}},"37":{"start":{"line":83,"column":8},"end":{"line":115,"column":11}},"38":{"start":{"line":84,"column":33},"end":{"line":92,"column":16}},"39":{"start":{"line":85,"column":16},"end":{"line":90,"column":17}},"40":{"start":{"line":86,"column":35},"end":{"line":86,"column":58}},"41":{"start":{"line":86,"column":49},"end":{"line":86,"column":57}},"42":{"start":{"line":87,"column":20},"end":{"line":89,"column":21}},"43":{"start":{"line":87,"column":44},"end":{"line":87,"column":45}},"44":{"start":{"line":88,"column":24},"end":{"line":88,"column":48}},"45":{"start":{"line":91,"column":16},"end":{"line":91,"column":33}},"46":{"start":{"line":93,"column":12},"end":{"line":114,"column":13}},"47":{"start":{"line":94,"column":30},"end":{"line":94,"column":67}},"48":{"start":{"line":95,"column":16},"end":{"line":113,"column":17}},"49":{"start":{"line":97,"column":20},"end":{"line":97,"column":57}},"50":{"start":{"line":97,"column":44},"end":{"line":97,"column":55}},"51":{"start":{"line":99,"column":20},"end":{"line":99,"column":63}},"52":{"start":{"line":99,"column":50},"end":{"line":99,"column":61}},"53":{"start":{"line":101,"column":20},"end":{"line":112,"column":35}},"54":{"start":{"line":102,"column":24},"end":{"line":103,"column":46}},"55":{"start":{"line":103,"column":28},"end":{"line":103,"column":46}},"56":{"start":{"line":104,"column":24},"end":{"line":104,"column":35}},"57":{"start":{"line":120,"column":4},"end":{"line":123,"column":5}},"58":{"start":{"line":122,"column":8},"end":{"line":122,"column":39}},"59":{"start":{"line":127,"column":4},"end":{"line":141,"column":5}},"60":{"start":{"line":128,"column":25},"end":{"line":128,"column":39}},"61":{"start":{"line":129,"column":29},"end":{"line":129,"column":51}},"62":{"start":{"line":130,"column":8},"end":{"line":140,"column":11}},"63":{"start":{"line":132,"column":30},"end":{"line":132,"column":100}},"64":{"start":{"line":132,"column":48},"end":{"line":132,"column":96}},"65":{"start":{"line":133,"column":12},"end":{"line":139,"column":13}},"66":{"start":{"line":134,"column":33},"end":{"line":134,"column":116}},"67":{"start":{"line":134,"column":64},"end":{"line":134,"column":112}},"68":{"start":{"line":135,"column":16},"end":{"line":138,"column":17}},"69":{"start":{"line":136,"column":33},"end":{"line":136,"column":72}},"70":{"start":{"line":137,"column":20},"end":{"line":137,"column":117}},"71":{"start":{"line":142,"column":4},"end":{"line":147,"column":6}},"72":{"start":{"line":149,"column":0},"end":{"line":149,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"processChangedObjectFields","decl":{"start":{"line":17,"column":9},"end":{"line":17,"column":35}},"loc":{"start":{"line":17,"column":101},"end":{"line":65,"column":1}},"line":17},"2":{"name":"calculateChanges","decl":{"start":{"line":67,"column":9},"end":{"line":67,"column":25}},"loc":{"start":{"line":67,"column":101},"end":{"line":148,"column":1}},"line":67},"3":{"name":"(anonymous_3)","decl":{"start":{"line":73,"column":27},"end":{"line":73,"column":28}},"loc":{"start":{"line":73,"column":48},"end":{"line":81,"column":6}},"line":73},"4":{"name":"(anonymous_4)","decl":{"start":{"line":73,"column":57},"end":{"line":73,"column":58}},"loc":{"start":{"line":73,"column":64},"end":{"line":81,"column":5}},"line":73},"5":{"name":"(anonymous_5)","decl":{"start":{"line":75,"column":35},"end":{"line":75,"column":36}},"loc":{"start":{"line":75,"column":42},"end":{"line":75,"column":46}},"line":75},"6":{"name":"(anonymous_6)","decl":{"start":{"line":76,"column":29},"end":{"line":76,"column":30}},"loc":{"start":{"line":76,"column":36},"end":{"line":76,"column":37}},"line":76},"7":{"name":"(anonymous_7)","decl":{"start":{"line":82,"column":26},"end":{"line":82,"column":27}},"loc":{"start":{"line":82,"column":39},"end":{"line":116,"column":5}},"line":82},"8":{"name":"(anonymous_8)","decl":{"start":{"line":83,"column":20},"end":{"line":83,"column":21}},"loc":{"start":{"line":83,"column":31},"end":{"line":115,"column":9}},"line":83},"9":{"name":"(anonymous_9)","decl":{"start":{"line":84,"column":34},"end":{"line":84,"column":35}},"loc":{"start":{"line":84,"column":40},"end":{"line":92,"column":13}},"line":84},"10":{"name":"(anonymous_10)","decl":{"start":{"line":86,"column":42},"end":{"line":86,"column":43}},"loc":{"start":{"line":86,"column":49},"end":{"line":86,"column":57}},"line":86},"11":{"name":"(anonymous_11)","decl":{"start":{"line":87,"column":37},"end":{"line":87,"column":38}},"loc":{"start":{"line":87,"column":44},"end":{"line":87,"column":45}},"line":87},"12":{"name":"(anonymous_12)","decl":{"start":{"line":97,"column":37},"end":{"line":97,"column":38}},"loc":{"start":{"line":97,"column":44},"end":{"line":97,"column":55}},"line":97},"13":{"name":"(anonymous_13)","decl":{"start":{"line":99,"column":43},"end":{"line":99,"column":44}},"loc":{"start":{"line":99,"column":50},"end":{"line":99,"column":61}},"line":99},"14":{"name":"(anonymous_14)","decl":{"start":{"line":101,"column":83},"end":{"line":101,"column":84}},"loc":{"start":{"line":101,"column":95},"end":{"line":105,"column":21}},"line":101},"15":{"name":"(anonymous_15)","decl":{"start":{"line":130,"column":29},"end":{"line":130,"column":30}},"loc":{"start":{"line":130,"column":36},"end":{"line":140,"column":9}},"line":130},"16":{"name":"(anonymous_16)","decl":{"start":{"line":132,"column":41},"end":{"line":132,"column":42}},"loc":{"start":{"line":132,"column":48},"end":{"line":132,"column":96}},"line":132},"17":{"name":"(anonymous_17)","decl":{"start":{"line":134,"column":57},"end":{"line":134,"column":58}},"loc":{"start":{"line":134,"column":64},"end":{"line":134,"column":112}},"line":134}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":21,"column":52},"end":{"line":22,"column":72}},"type":"binary-expr","locations":[{"start":{"line":21,"column":52},"end":{"line":21,"column":112}},{"start":{"line":22,"column":12},"end":{"line":22,"column":72}}],"line":21},"4":{"loc":{"start":{"line":21,"column":64},"end":{"line":21,"column":98}},"type":"binary-expr","locations":[{"start":{"line":21,"column":64},"end":{"line":21,"column":92}},{"start":{"line":21,"column":96},"end":{"line":21,"column":98}}],"line":21},"5":{"loc":{"start":{"line":22,"column":24},"end":{"line":22,"column":58}},"type":"binary-expr","locations":[{"start":{"line":22,"column":24},"end":{"line":22,"column":52}},{"start":{"line":22,"column":56},"end":{"line":22,"column":58}}],"line":22},"6":{"loc":{"start":{"line":23,"column":8},"end":{"line":27,"column":9}},"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":27,"column":9}},{"start":{"line":23,"column":8},"end":{"line":27,"column":9}}],"line":23},"7":{"loc":{"start":{"line":30,"column":8},"end":{"line":62,"column":9}},"type":"if","locations":[{"start":{"line":30,"column":8},"end":{"line":62,"column":9}},{"start":{"line":30,"column":8},"end":{"line":62,"column":9}}],"line":30},"8":{"loc":{"start":{"line":30,"column":12},"end":{"line":30,"column":92}},"type":"binary-expr","locations":[{"start":{"line":30,"column":12},"end":{"line":30,"column":40}},{"start":{"line":30,"column":44},"end":{"line":30,"column":92}}],"line":30},"9":{"loc":{"start":{"line":35,"column":12},"end":{"line":50,"column":13}},"type":"if","locations":[{"start":{"line":35,"column":12},"end":{"line":50,"column":13}},{"start":{"line":35,"column":12},"end":{"line":50,"column":13}}],"line":35},"10":{"loc":{"start":{"line":39,"column":20},"end":{"line":48,"column":21}},"type":"if","locations":[{"start":{"line":39,"column":20},"end":{"line":48,"column":21}},{"start":{"line":39,"column":20},"end":{"line":48,"column":21}}],"line":39},"11":{"loc":{"start":{"line":41,"column":24},"end":{"line":47,"column":25}},"type":"if","locations":[{"start":{"line":41,"column":24},"end":{"line":47,"column":25}},{"start":{"line":41,"column":24},"end":{"line":47,"column":25}}],"line":41},"12":{"loc":{"start":{"line":46,"column":101},"end":{"line":46,"column":133}},"type":"binary-expr","locations":[{"start":{"line":46,"column":101},"end":{"line":46,"column":113}},{"start":{"line":46,"column":117},"end":{"line":46,"column":127}},{"start":{"line":46,"column":131},"end":{"line":46,"column":133}}],"line":46},"13":{"loc":{"start":{"line":52,"column":13},"end":{"line":62,"column":9}},"type":"if","locations":[{"start":{"line":52,"column":13},"end":{"line":62,"column":9}},{"start":{"line":52,"column":13},"end":{"line":62,"column":9}}],"line":52},"14":{"loc":{"start":{"line":61,"column":85},"end":{"line":61,"column":117}},"type":"binary-expr","locations":[{"start":{"line":61,"column":85},"end":{"line":61,"column":97}},{"start":{"line":61,"column":101},"end":{"line":61,"column":111}},{"start":{"line":61,"column":115},"end":{"line":61,"column":117}}],"line":61},"15":{"loc":{"start":{"line":67,"column":55},"end":{"line":67,"column":83}},"type":"default-arg","locations":[{"start":{"line":67,"column":69},"end":{"line":67,"column":83}}],"line":67},"16":{"loc":{"start":{"line":70,"column":19},"end":{"line":70,"column":33}},"type":"binary-expr","locations":[{"start":{"line":70,"column":19},"end":{"line":70,"column":27}},{"start":{"line":70,"column":31},"end":{"line":70,"column":33}}],"line":70},"17":{"loc":{"start":{"line":74,"column":8},"end":{"line":79,"column":9}},"type":"if","locations":[{"start":{"line":74,"column":8},"end":{"line":79,"column":9}},{"start":{"line":74,"column":8},"end":{"line":79,"column":9}}],"line":74},"18":{"loc":{"start":{"line":76,"column":12},"end":{"line":78,"column":13}},"type":"if","locations":[{"start":{"line":76,"column":12},"end":{"line":78,"column":13}},{"start":{"line":76,"column":12},"end":{"line":78,"column":13}}],"line":76},"19":{"loc":{"start":{"line":85,"column":16},"end":{"line":90,"column":17}},"type":"if","locations":[{"start":{"line":85,"column":16},"end":{"line":90,"column":17}},{"start":{"line":85,"column":16},"end":{"line":90,"column":17}}],"line":85},"20":{"loc":{"start":{"line":87,"column":20},"end":{"line":89,"column":21}},"type":"if","locations":[{"start":{"line":87,"column":20},"end":{"line":89,"column":21}},{"start":{"line":87,"column":20},"end":{"line":89,"column":21}}],"line":87},"21":{"loc":{"start":{"line":93,"column":12},"end":{"line":114,"column":13}},"type":"if","locations":[{"start":{"line":93,"column":12},"end":{"line":114,"column":13}},{"start":{"line":93,"column":12},"end":{"line":114,"column":13}}],"line":93},"22":{"loc":{"start":{"line":95,"column":16},"end":{"line":113,"column":17}},"type":"if","locations":[{"start":{"line":95,"column":16},"end":{"line":113,"column":17}},{"start":{"line":95,"column":16},"end":{"line":113,"column":17}}],"line":95},"23":{"loc":{"start":{"line":102,"column":24},"end":{"line":103,"column":46}},"type":"if","locations":[{"start":{"line":102,"column":24},"end":{"line":103,"column":46}},{"start":{"line":102,"column":24},"end":{"line":103,"column":46}}],"line":102},"24":{"loc":{"start":{"line":105,"column":30},"end":{"line":112,"column":31}},"type":"cond-expr","locations":[{"start":{"line":106,"column":26},"end":{"line":111,"column":26}},{"start":{"line":112,"column":26},"end":{"line":112,"column":31}}],"line":105},"25":{"loc":{"start":{"line":127,"column":4},"end":{"line":141,"column":5}},"type":"if","locations":[{"start":{"line":127,"column":4},"end":{"line":141,"column":5}},{"start":{"line":127,"column":4},"end":{"line":141,"column":5}}],"line":127},"26":{"loc":{"start":{"line":132,"column":48},"end":{"line":132,"column":96}},"type":"binary-expr","locations":[{"start":{"line":132,"column":48},"end":{"line":132,"column":65}},{"start":{"line":132,"column":69},"end":{"line":132,"column":96}}],"line":132},"27":{"loc":{"start":{"line":133,"column":12},"end":{"line":139,"column":13}},"type":"if","locations":[{"start":{"line":133,"column":12},"end":{"line":139,"column":13}},{"start":{"line":133,"column":12},"end":{"line":139,"column":13}}],"line":133},"28":{"loc":{"start":{"line":134,"column":34},"end":{"line":134,"column":48}},"type":"binary-expr","locations":[{"start":{"line":134,"column":34},"end":{"line":134,"column":42}},{"start":{"line":134,"column":46},"end":{"line":134,"column":48}}],"line":134},"29":{"loc":{"start":{"line":134,"column":64},"end":{"line":134,"column":112}},"type":"binary-expr","locations":[{"start":{"line":134,"column":64},"end":{"line":134,"column":81}},{"start":{"line":134,"column":85},"end":{"line":134,"column":112}}],"line":134},"30":{"loc":{"start":{"line":135,"column":16},"end":{"line":138,"column":17}},"type":"if","locations":[{"start":{"line":135,"column":16},"end":{"line":138,"column":17}},{"start":{"line":135,"column":16},"end":{"line":138,"column":17}}],"line":135}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":14,"6":14,"7":14,"8":14,"9":4,"10":10,"11":4,"12":4,"13":7,"14":2,"15":1,"16":1,"17":6,"18":3,"19":3,"20":3,"21":14,"22":1,"23":92,"24":92,"25":92,"26":92,"27":92,"28":91,"29":95,"30":31,"31":62,"32":31,"33":62,"34":31,"35":64,"36":92,"37":175,"38":165,"39":165,"40":14,"41":28,"42":14,"43":27,"44":12,"45":153,"46":165,"47":91,"48":91,"49":36,"50":48,"51":36,"52":49,"53":36,"54":66,"55":62,"56":66,"57":92,"58":175,"59":92,"60":65,"61":65,"62":65,"63":65,"64":27,"65":65,"66":65,"67":69,"68":65,"69":3,"70":3,"71":92,"72":1},"f":{"0":1,"1":14,"2":92,"3":91,"4":95,"5":62,"6":62,"7":175,"8":165,"9":165,"10":28,"11":27,"12":48,"13":49,"14":66,"15":65,"16":27,"17":69},"b":{"0":[1,1,1],"1":[1,0],"2":[1,1],"3":[14,10],"4":[14,6],"5":[10,4],"6":[4,10],"7":[4,6],"8":[10,8],"9":[4,0],"10":[2,5],"11":[1,1],"12":[1,1,0],"13":[3,3],"14":[3,3,0],"15":[0],"16":[92,2],"17":[31,64],"18":[31,0],"19":[14,151],"20":[12,2],"21":[91,74],"22":[36,55],"23":[62,4],"24":[8,28],"25":[65,27],"26":[27,0],"27":[65,0],"28":[65,1],"29":[69,26],"30":[3,62]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/calculateChanges.ts","sources":["/home/circleci/repo/src/tools/calculateChanges.ts"],"names":[],"mappings":"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","sourcesContent":["import log from '../logger';\nimport APIHandler from '../tools/auth0/handlers/default';\nimport { Asset, CalculatedChanges } from '../types';\n\n/**\n * @template T\n * @param {typeof import('./auth0/handlers/default').default} handler\n * @param {T} desiredAssetState\n * @param {T} currentAssetState\n * @param {string[]} [objectFields=[]]\n * @param {boolean} [allowDelete]\n * @returns T\n */\nexport function processChangedObjectFields({\n  handler,\n  desiredAssetState,\n  currentAssetState,\n  allowDelete,\n}: {\n  handler: APIHandler;\n  desiredAssetState: Asset;\n  currentAssetState: Asset;\n  allowDelete: boolean;\n}) {\n  const desiredAssetStateWithChanges = { ...desiredAssetState };\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (const fieldName of handler.objectFields) {\n    const areDesiredStateAndCurrentStateEmpty =\n      Object.keys(desiredAssetState[fieldName] || {}).length === 0 &&\n      Object.keys(currentAssetState[fieldName] || {}).length === 0;\n    if (areDesiredStateAndCurrentStateEmpty) {\n      // If both the desired state and current state for a given object is empty, it is a no-op and can skip\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    // A desired state that omits the objectField OR that has it as an empty object should\n    // signal that all fields should be removed (subject to ALLOW_DELETE).\n    if (desiredAssetState[fieldName] && Object.keys(desiredAssetState[fieldName]).length) {\n      // Both the current and desired state have the object field. Here's where we need to map\n      // to the APIv2 protocol of setting `null` values for deleted fields.\n      // For new and modified properties of the object field, we can just pass them through to\n      // APIv2.\n      if (currentAssetState[fieldName]) {\n        // eslint-disable-next-line no-restricted-syntax\n        for (const currentObjectFieldPropertyName of Object.keys(currentAssetState[fieldName])) {\n          // Loop through each object property that exists currently\n          if (desiredAssetState[fieldName][currentObjectFieldPropertyName] === undefined) {\n            // If the object has a property that exists now but doesn't exist in the proposed state\n            if (allowDelete) {\n              desiredAssetStateWithChanges[fieldName][currentObjectFieldPropertyName] = null;\n            } else {\n              // If deletes aren't allowed, do outright delete the property within the object\n              log.warn(\n                `Detected that the ${fieldName} of the following ${\n                  handler.name || handler.id || ''\n                } should be deleted. Doing so may be destructive.\\nYou can enable deletes by setting 'AUTH0_ALLOW_DELETE' to true in the config\\n${handler.objString(\n                  currentAssetState\n                )}`\n              );\n            }\n          }\n        }\n      }\n    } else if (allowDelete) {\n      // If the desired state does not have the object field and the current state does, we\n      // should mark *all* properties for deletion by specifying an empty object.\n      //\n      // See: https://auth0.com/docs/users/metadata/manage-metadata-api#delete-user-metadata\n      desiredAssetStateWithChanges[fieldName] = {};\n    } else {\n      delete desiredAssetStateWithChanges[fieldName];\n      log.warn(\n        `Detected that the ${fieldName} of the following ${\n          handler.name || handler.id || ''\n        } should be emptied. Doing so may be destructive.\\nYou can enable deletes by setting 'AUTH0_ALLOW_DELETE' to true in the config\\n${handler.objString(\n          currentAssetState\n        )}`\n      );\n    }\n  }\n\n  return desiredAssetStateWithChanges;\n}\n\nexport function calculateChanges({\n  handler,\n  assets,\n  existing,\n  identifiers = ['id', 'name'],\n  allowDelete,\n}: {\n  handler: APIHandler;\n  assets: Asset[];\n  existing: Asset[] | null;\n  identifiers: string[];\n  allowDelete: boolean;\n}): CalculatedChanges {\n  // Calculate the changes required between two sets of assets.\n  const update: Asset[] = [];\n  let del: Asset[] = [...(existing || [])];\n  let create: Asset[] = [...assets];\n  const conflicts: Asset[] = [];\n\n  const findByKeyValue = (key: string, value: string, arr: Asset[]): Asset | undefined =>\n    arr.find((e) => {\n      if (Array.isArray(key)) {\n        const values = key.map((k) => e[k]);\n        if (values.every((v) => v)) {\n          return value === values.join('-');\n        }\n      }\n      return e[key] === value;\n    });\n\n  const processAssets = (id: string, arr: Asset[]) => {\n    arr.forEach((asset) => {\n      const assetIdValue: string | undefined = (() => {\n        if (Array.isArray(id)) {\n          const values = id.map((i) => asset[i]);\n          if (values.every((v) => v)) {\n            return values.join('-');\n          }\n        }\n\n        return asset[id] as string;\n      })();\n\n      if (assetIdValue !== undefined) {\n        const found = findByKeyValue(id, assetIdValue, del);\n        if (found !== undefined) {\n          // Delete from existing\n          del = del.filter((e) => e !== found);\n\n          // Delete from create as it's an update\n          create = create.filter((e) => e !== asset);\n\n          // Append identifiers to asset\n          update.push({\n            ...identifiers.reduce((obj, i) => {\n              if (found[i]) obj[i] = found[i];\n              return obj;\n            }, {}),\n            // If we have any object fields, we need to make sure that they get\n            // special treatment. When different metadata objects are passed to APIv2\n            // properties must explicitly be marked for deletion by indicating a `null`\n            // value.\n            ...(handler.objectFields.length\n              ? processChangedObjectFields({\n                  handler,\n                  desiredAssetState: asset,\n                  currentAssetState: found,\n                  allowDelete,\n                })\n              : asset),\n          });\n        }\n      }\n    });\n  };\n\n  // Loop through identifiers (in order) to try match assets to existing\n  // If existing then update if not create\n  // The remainder will be deleted\n  for (const id of identifiers) {\n    // eslint-disable-line\n    processAssets(id, [...create]);\n  }\n\n  // Check if there are assets with names that will conflict with existing names during the update process\n  // This will rename those assets to a temp random name first\n  // This assumes the first identifiers is the unique identifier\n  if (identifiers.includes('name')) {\n    const uniqueID = identifiers[0];\n    const futureAssets: Asset[] = [...create, ...update];\n    futureAssets.forEach((a) => {\n      // If the conflicting item is going to be deleted then skip\n      const inDeleted = del.filter((e) => e.name === a.name && e[uniqueID] !== a[uniqueID])[0];\n      if (!inDeleted) {\n        const conflict = (existing || []).filter(\n          (e) => e.name === a.name && e[uniqueID] !== a[uniqueID]\n        )[0];\n        if (conflict) {\n          const temp = Math.random().toString(36).substr(2, 5);\n          conflicts.push({\n            ...conflict,\n            name: `${conflict.name}-${temp}`,\n          });\n        }\n      }\n    });\n  }\n\n  return {\n    del,\n    update,\n    conflicts,\n    create,\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4bf90c3c7da3d39deb16c6afc1043933577d6794","contentHash":"77c5c2a4df4f412ca5397abedf4d7bc4a1e9e63d427eb715d4a525e0fe4242ba"},"/home/circleci/repo/src/tools/auth0/handlers/rulesConfigs.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/rulesConfigs.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":17},"end":{"line":17,"column":60}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":38}},"19":{"start":{"line":19,"column":0},"end":{"line":30,"column":2}},"20":{"start":{"line":33,"column":8},"end":{"line":35,"column":18}},"21":{"start":{"line":38,"column":8},"end":{"line":47,"column":11}},"22":{"start":{"line":39,"column":12},"end":{"line":46,"column":13}},"23":{"start":{"line":40,"column":16},"end":{"line":40,"column":57}},"24":{"start":{"line":43,"column":16},"end":{"line":44,"column":32}},"25":{"start":{"line":44,"column":20},"end":{"line":44,"column":32}},"26":{"start":{"line":45,"column":16},"end":{"line":45,"column":26}},"27":{"start":{"line":50,"column":8},"end":{"line":50,"column":50}},"28":{"start":{"line":53,"column":8},"end":{"line":71,"column":11}},"29":{"start":{"line":54,"column":37},"end":{"line":54,"column":43}},"30":{"start":{"line":56,"column":12},"end":{"line":62,"column":18}},"31":{"start":{"line":57,"column":16},"end":{"line":62,"column":18}},"32":{"start":{"line":63,"column":12},"end":{"line":63,"column":199}},"33":{"start":{"line":65,"column":12},"end":{"line":70,"column":14}},"34":{"start":{"line":74,"column":0},"end":{"line":74,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":32,"column":4},"end":{"line":32,"column":5}},"loc":{"start":{"line":32,"column":25},"end":{"line":36,"column":5}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":37,"column":4},"end":{"line":37,"column":5}},"loc":{"start":{"line":37,"column":14},"end":{"line":48,"column":5}},"line":37},"10":{"name":"(anonymous_10)","decl":{"start":{"line":38,"column":47},"end":{"line":38,"column":48}},"loc":{"start":{"line":38,"column":60},"end":{"line":47,"column":9}},"line":38},"11":{"name":"(anonymous_11)","decl":{"start":{"line":49,"column":4},"end":{"line":49,"column":5}},"loc":{"start":{"line":49,"column":20},"end":{"line":51,"column":5}},"line":49},"12":{"name":"(anonymous_12)","decl":{"start":{"line":52,"column":4},"end":{"line":52,"column":5}},"loc":{"start":{"line":52,"column":24},"end":{"line":72,"column":5}},"line":52},"13":{"name":"(anonymous_13)","decl":{"start":{"line":53,"column":47},"end":{"line":53,"column":48}},"loc":{"start":{"line":53,"column":60},"end":{"line":71,"column":9}},"line":53}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":43,"column":16},"end":{"line":44,"column":32}},"type":"if","locations":[{"start":{"line":43,"column":16},"end":{"line":44,"column":32}},{"start":{"line":43,"column":16},"end":{"line":44,"column":32}}],"line":43},"9":{"loc":{"start":{"line":56,"column":12},"end":{"line":62,"column":18}},"type":"if","locations":[{"start":{"line":56,"column":12},"end":{"line":62,"column":18}},{"start":{"line":56,"column":12},"end":{"line":62,"column":18}}],"line":56},"10":{"loc":{"start":{"line":56,"column":16},"end":{"line":56,"column":53}},"type":"binary-expr","locations":[{"start":{"line":56,"column":16},"end":{"line":56,"column":29}},{"start":{"line":56,"column":33},"end":{"line":56,"column":53}}],"line":56}},"s":{"0":1,"1":0,"2":0,"3":6,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":6,"11":6,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":132,"21":5,"22":5,"23":5,"24":0,"25":0,"26":0,"27":1,"28":1,"29":1,"30":1,"31":0,"32":1,"33":1,"34":1},"f":{"0":6,"1":0,"2":0,"3":6,"4":0,"5":0,"6":6,"7":2,"8":132,"9":5,"10":5,"11":1,"12":1,"13":1},"b":{"0":[1,1,1],"1":[0,0],"2":[6,6],"3":[6,0],"4":[6,6],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[0,0],"9":[0,1],"10":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/rulesConfigs.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/rulesConfigs.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AACA,wDAAuC;AACvC,6DAAkC;AAClC,uCAAgD;AAEnC,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,OAAO;IACb,KAAK,EAAE;QACL,IAAI,EAAE,QAAQ;QACd,UAAU,EAAE;YACV,GAAG,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,kBAAkB,EAAE;YACpD,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE;SAC1B;QACD,QAAQ,EAAE,CAAC,KAAK,EAAE,OAAO,CAAC;KAC3B;IACD,oBAAoB,EAAE,KAAK;CAC5B,CAAC;AAEF,MAAqB,mBAAoB,SAAQ,iBAAc;IAC7D,YAAY,OAAuB;QACjC,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,cAAc,EACpB,EAAE,EAAE,KAAK,EACT,SAAS,EAAE;gBACT,MAAM,EAAE,KAAK,EAAE,2DAA2D;aAC3E,IACD,CAAC;IACL,CAAC;IAEK,OAAO;;YACX,IAAI;gBACF,OAAO,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC;aAC1C;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,IAAA,yBAAiB,EAAC,GAAG,CAAC;oBAAE,OAAO,IAAI,CAAC;gBACxC,MAAM,GAAG,CAAC;aACX;QACH,CAAC;KAAA;IAED,SAAS,CAAC,IAAI;QACZ,OAAO,KAAK,CAAC,SAAS,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;IAC5C,CAAC;IAEK,WAAW,CAAC,MAAc;;YAC9B,MAAM,EAAE,YAAY,EAAE,GAAG,MAAM,CAAC;YAEhC,wBAAwB;YACxB,IAAI,CAAC,YAAY,IAAI,CAAC,YAAY,CAAC,MAAM;gBACvC,OAAO;oBACL,GAAG,EAAE,EAAE;oBACP,MAAM,EAAE,EAAE;oBACV,MAAM,EAAE,EAAE;oBACV,SAAS,EAAE,EAAE;iBACd,CAAC;YAEJ,gBAAG,CAAC,IAAI,CACN,mKAAmK,CACpK,CAAC;YAEF,yFAAyF;YACzF,OAAO;gBACL,GAAG,EAAE,EAAE;gBACP,MAAM,EAAE,YAAY;gBACpB,MAAM,EAAE,EAAE;gBACV,SAAS,EAAE,EAAE;aACd,CAAC;QACJ,CAAC;KAAA;CACF;AAjDD,sCAiDC","sourcesContent":["import { Assets, Asset, CalculatedChanges } from '../../../types';\nimport DefaultHandler from './default';\nimport log from '../../../logger';\nimport { isDeprecatedError } from '../../utils';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      key: { type: 'string', pattern: '^[A-Za-z0-9_-]*$' },\n      value: { type: 'string' },\n    },\n    required: ['key', 'value'],\n  },\n  additionalProperties: false,\n};\n\nexport default class RulesConfigsHandler extends DefaultHandler {\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'rulesConfigs',\n      id: 'key',\n      functions: {\n        update: 'set', // Update or Creation of a ruleConfig is via set not update\n      },\n    });\n  }\n\n  async getType(): Promise<Asset[] | null> {\n    try {\n      return this.client.rulesConfigs.getAll();\n    } catch (err) {\n      if (isDeprecatedError(err)) return null;\n      throw err;\n    }\n  }\n\n  objString(item): string {\n    return super.objString({ key: item.key });\n  }\n\n  async calcChanges(assets: Assets): Promise<CalculatedChanges> {\n    const { rulesConfigs } = assets;\n\n    // Do nothing if not set\n    if (!rulesConfigs || !rulesConfigs.length)\n      return {\n        del: [],\n        update: [],\n        create: [],\n        conflicts: [],\n      };\n\n    log.warn(\n      'Rules are deprecated, migrate to using actions instead. See: https://auth0.com/docs/customize/actions/migrate/migrate-from-rules-to-actions for more information.'\n    );\n\n    // Intention is to not delete/cleanup old configRules, that needs to be handled manually.\n    return {\n      del: [],\n      update: rulesConfigs,\n      create: [],\n      conflicts: [],\n    };\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4669ff80302ef8182903dab711973dc13720a14e","contentHash":"17dd20ade96c7428d16088f4af2191d10c11cf87334b420ca00f7a744d5ae236"},"/home/circleci/repo/src/tools/auth0/handlers/hooks.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/hooks.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":48}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":20},"end":{"line":17,"column":63}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":38}},"20":{"start":{"line":20,"column":28},"end":{"line":26,"column":1}},"21":{"start":{"line":27,"column":0},"end":{"line":30,"column":2}},"22":{"start":{"line":31,"column":0},"end":{"line":70,"column":2}},"23":{"start":{"line":71,"column":23},"end":{"line":79,"column":1}},"24":{"start":{"line":72,"column":17},"end":{"line":72,"column":21}},"25":{"start":{"line":73,"column":4},"end":{"line":77,"column":7}},"26":{"start":{"line":74,"column":8},"end":{"line":76,"column":9}},"27":{"start":{"line":75,"column":12},"end":{"line":75,"column":26}},"28":{"start":{"line":78,"column":4},"end":{"line":78,"column":18}},"29":{"start":{"line":80,"column":18},"end":{"line":86,"column":1}},"30":{"start":{"line":81,"column":19},"end":{"line":81,"column":21}},"31":{"start":{"line":82,"column":4},"end":{"line":84,"column":7}},"32":{"start":{"line":83,"column":8},"end":{"line":83,"column":77}},"33":{"start":{"line":83,"column":43},"end":{"line":83,"column":75}},"34":{"start":{"line":85,"column":4},"end":{"line":85,"column":18}},"35":{"start":{"line":89,"column":8},"end":{"line":89,"column":116}},"36":{"start":{"line":92,"column":8},"end":{"line":92,"column":79}},"37":{"start":{"line":95,"column":8},"end":{"line":144,"column":11}},"38":{"start":{"line":96,"column":29},"end":{"line":96,"column":53}},"39":{"start":{"line":97,"column":12},"end":{"line":98,"column":23}},"40":{"start":{"line":98,"column":16},"end":{"line":98,"column":23}},"41":{"start":{"line":99,"column":28},"end":{"line":104,"column":13}},"42":{"start":{"line":105,"column":12},"end":{"line":134,"column":15}},"43":{"start":{"line":106,"column":32},"end":{"line":106,"column":83}},"44":{"start":{"line":107,"column":16},"end":{"line":133,"column":17}},"45":{"start":{"line":109,"column":39},"end":{"line":109,"column":60}},"46":{"start":{"line":110,"column":39},"end":{"line":110,"column":57}},"47":{"start":{"line":111,"column":35},"end":{"line":111,"column":37}},"48":{"start":{"line":112,"column":35},"end":{"line":112,"column":37}},"49":{"start":{"line":113,"column":32},"end":{"line":113,"column":34}},"50":{"start":{"line":114,"column":20},"end":{"line":121,"column":23}},"51":{"start":{"line":115,"column":24},"end":{"line":120,"column":25}},"52":{"start":{"line":116,"column":28},"end":{"line":116,"column":58}},"53":{"start":{"line":118,"column":29},"end":{"line":120,"column":25}},"54":{"start":{"line":119,"column":28},"end":{"line":119,"column":58}},"55":{"start":{"line":122,"column":20},"end":{"line":126,"column":23}},"56":{"start":{"line":123,"column":24},"end":{"line":125,"column":25}},"57":{"start":{"line":124,"column":28},"end":{"line":124,"column":42}},"58":{"start":{"line":127,"column":20},"end":{"line":128,"column":85}},"59":{"start":{"line":128,"column":24},"end":{"line":128,"column":85}},"60":{"start":{"line":129,"column":20},"end":{"line":130,"column":85}},"61":{"start":{"line":130,"column":24},"end":{"line":130,"column":85}},"62":{"start":{"line":131,"column":20},"end":{"line":132,"column":79}},"63":{"start":{"line":132,"column":24},"end":{"line":132,"column":79}},"64":{"start":{"line":135,"column":12},"end":{"line":137,"column":17}},"65":{"start":{"line":135,"column":56},"end":{"line":137,"column":14}},"66":{"start":{"line":136,"column":16},"end":{"line":136,"column":89}},"67":{"start":{"line":138,"column":12},"end":{"line":140,"column":17}},"68":{"start":{"line":138,"column":59},"end":{"line":140,"column":14}},"69":{"start":{"line":139,"column":16},"end":{"line":139,"column":89}},"70":{"start":{"line":141,"column":12},"end":{"line":143,"column":17}},"71":{"start":{"line":141,"column":59},"end":{"line":143,"column":14}},"72":{"start":{"line":142,"column":16},"end":{"line":142,"column":86}},"73":{"start":{"line":148,"column":8},"end":{"line":175,"column":11}},"74":{"start":{"line":149,"column":12},"end":{"line":151,"column":13}},"75":{"start":{"line":150,"column":16},"end":{"line":150,"column":37}},"76":{"start":{"line":153,"column":12},"end":{"line":155,"column":13}},"77":{"start":{"line":154,"column":16},"end":{"line":154,"column":26}},"78":{"start":{"line":156,"column":12},"end":{"line":174,"column":13}},"79":{"start":{"line":157,"column":30},"end":{"line":157,"column":102}},"80":{"start":{"line":159,"column":16},"end":{"line":163,"column":105}},"81":{"start":{"line":159,"column":70},"end":{"line":163,"column":102}},"82":{"start":{"line":161,"column":44},"end":{"line":163,"column":101}},"83":{"start":{"line":163,"column":40},"end":{"line":163,"column":99}},"84":{"start":{"line":164,"column":16},"end":{"line":164,"column":37}},"85":{"start":{"line":167,"column":16},"end":{"line":169,"column":17}},"86":{"start":{"line":168,"column":20},"end":{"line":168,"column":30}},"87":{"start":{"line":170,"column":16},"end":{"line":172,"column":17}},"88":{"start":{"line":171,"column":20},"end":{"line":171,"column":32}},"89":{"start":{"line":173,"column":16},"end":{"line":173,"column":26}},"90":{"start":{"line":178,"column":23},"end":{"line":180,"column":10}},"91":{"start":{"line":179,"column":38},"end":{"line":179,"column":55}},"92":{"start":{"line":181,"column":8},"end":{"line":191,"column":11}},"93":{"start":{"line":182,"column":55},"end":{"line":182,"column":98}},"94":{"start":{"line":184,"column":33},"end":{"line":184,"column":127}},"95":{"start":{"line":184,"column":43},"end":{"line":184,"column":127}},"96":{"start":{"line":184,"column":63},"end":{"line":184,"column":125}},"97":{"start":{"line":185,"column":12},"end":{"line":190,"column":14}},"98":{"start":{"line":194,"column":23},"end":{"line":196,"column":10}},"99":{"start":{"line":195,"column":35},"end":{"line":195,"column":49}},"100":{"start":{"line":197,"column":8},"end":{"line":214,"column":11}},"101":{"start":{"line":198,"column":30},"end":{"line":198,"column":36}},"102":{"start":{"line":200,"column":12},"end":{"line":201,"column":23}},"103":{"start":{"line":201,"column":16},"end":{"line":201,"column":23}},"104":{"start":{"line":202,"column":32},"end":{"line":202,"column":48}},"105":{"start":{"line":203,"column":12},"end":{"line":212,"column":15}},"106":{"start":{"line":204,"column":16},"end":{"line":211,"column":17}},"107":{"start":{"line":206,"column":37},"end":{"line":206,"column":84}},"108":{"start":{"line":206,"column":66},"end":{"line":206,"column":72}},"109":{"start":{"line":207,"column":32},"end":{"line":207,"column":139}},"110":{"start":{"line":209,"column":20},"end":{"line":209,"column":37}},"111":{"start":{"line":210,"column":20},"end":{"line":210,"column":30}},"112":{"start":{"line":213,"column":12},"end":{"line":213,"column":53}},"113":{"start":{"line":217,"column":23},"end":{"line":219,"column":10}},"114":{"start":{"line":218,"column":41},"end":{"line":218,"column":61}},"115":{"start":{"line":220,"column":8},"end":{"line":244,"column":11}},"116":{"start":{"line":221,"column":30},"end":{"line":221,"column":36}},"117":{"start":{"line":223,"column":12},"end":{"line":224,"column":23}},"118":{"start":{"line":224,"column":16},"end":{"line":224,"column":23}},"119":{"start":{"line":225,"column":12},"end":{"line":225,"column":199}},"120":{"start":{"line":226,"column":12},"end":{"line":243,"column":13}},"121":{"start":{"line":228,"column":32},"end":{"line":228,"column":62}},"122":{"start":{"line":229,"column":16},"end":{"line":234,"column":19}},"123":{"start":{"line":235,"column":16},"end":{"line":235,"column":49}},"124":{"start":{"line":238,"column":16},"end":{"line":241,"column":17}},"125":{"start":{"line":239,"column":20},"end":{"line":239,"column":237}},"126":{"start":{"line":240,"column":20},"end":{"line":240,"column":27}},"127":{"start":{"line":242,"column":16},"end":{"line":242,"column":26}},"128":{"start":{"line":247,"column":0},"end":{"line":247,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":71,"column":23},"end":{"line":71,"column":24}},"loc":{"start":{"line":71,"column":51},"end":{"line":79,"column":1}},"line":71},"9":{"name":"(anonymous_9)","decl":{"start":{"line":73,"column":18},"end":{"line":73,"column":19}},"loc":{"start":{"line":73,"column":28},"end":{"line":77,"column":5}},"line":73},"10":{"name":"(anonymous_10)","decl":{"start":{"line":80,"column":18},"end":{"line":80,"column":19}},"loc":{"start":{"line":80,"column":29},"end":{"line":86,"column":1}},"line":80},"11":{"name":"(anonymous_11)","decl":{"start":{"line":82,"column":32},"end":{"line":82,"column":33}},"loc":{"start":{"line":82,"column":42},"end":{"line":84,"column":5}},"line":82},"12":{"name":"(anonymous_12)","decl":{"start":{"line":83,"column":36},"end":{"line":83,"column":37}},"loc":{"start":{"line":83,"column":43},"end":{"line":83,"column":75}},"line":83},"13":{"name":"(anonymous_13)","decl":{"start":{"line":88,"column":4},"end":{"line":88,"column":5}},"loc":{"start":{"line":88,"column":25},"end":{"line":90,"column":5}},"line":88},"14":{"name":"(anonymous_14)","decl":{"start":{"line":91,"column":4},"end":{"line":91,"column":5}},"loc":{"start":{"line":91,"column":20},"end":{"line":93,"column":5}},"line":91},"15":{"name":"(anonymous_15)","decl":{"start":{"line":94,"column":4},"end":{"line":94,"column":5}},"loc":{"start":{"line":94,"column":26},"end":{"line":145,"column":5}},"line":94},"16":{"name":"(anonymous_16)","decl":{"start":{"line":95,"column":47},"end":{"line":95,"column":48}},"loc":{"start":{"line":95,"column":60},"end":{"line":144,"column":9}},"line":95},"17":{"name":"(anonymous_17)","decl":{"start":{"line":105,"column":26},"end":{"line":105,"column":27}},"loc":{"start":{"line":105,"column":36},"end":{"line":134,"column":13}},"line":105},"18":{"name":"(anonymous_18)","decl":{"start":{"line":114,"column":52},"end":{"line":114,"column":53}},"loc":{"start":{"line":114,"column":61},"end":{"line":121,"column":21}},"line":114},"19":{"name":"(anonymous_19)","decl":{"start":{"line":122,"column":52},"end":{"line":122,"column":53}},"loc":{"start":{"line":122,"column":61},"end":{"line":126,"column":21}},"line":122},"20":{"name":"(anonymous_20)","decl":{"start":{"line":135,"column":46},"end":{"line":135,"column":47}},"loc":{"start":{"line":135,"column":56},"end":{"line":137,"column":14}},"line":135},"21":{"name":"(anonymous_21)","decl":{"start":{"line":135,"column":88},"end":{"line":135,"column":89}},"loc":{"start":{"line":135,"column":101},"end":{"line":137,"column":13}},"line":135},"22":{"name":"(anonymous_22)","decl":{"start":{"line":138,"column":49},"end":{"line":138,"column":50}},"loc":{"start":{"line":138,"column":59},"end":{"line":140,"column":14}},"line":138},"23":{"name":"(anonymous_23)","decl":{"start":{"line":138,"column":91},"end":{"line":138,"column":92}},"loc":{"start":{"line":138,"column":104},"end":{"line":140,"column":13}},"line":138},"24":{"name":"(anonymous_24)","decl":{"start":{"line":141,"column":49},"end":{"line":141,"column":50}},"loc":{"start":{"line":141,"column":59},"end":{"line":143,"column":14}},"line":141},"25":{"name":"(anonymous_25)","decl":{"start":{"line":141,"column":91},"end":{"line":141,"column":92}},"loc":{"start":{"line":141,"column":104},"end":{"line":143,"column":13}},"line":141},"26":{"name":"(anonymous_26)","decl":{"start":{"line":147,"column":4},"end":{"line":147,"column":5}},"loc":{"start":{"line":147,"column":20},"end":{"line":176,"column":5}},"line":147},"27":{"name":"(anonymous_27)","decl":{"start":{"line":148,"column":47},"end":{"line":148,"column":48}},"loc":{"start":{"line":148,"column":60},"end":{"line":175,"column":9}},"line":148},"28":{"name":"(anonymous_28)","decl":{"start":{"line":159,"column":60},"end":{"line":159,"column":61}},"loc":{"start":{"line":159,"column":70},"end":{"line":163,"column":102}},"line":159},"29":{"name":"(anonymous_29)","decl":{"start":{"line":161,"column":26},"end":{"line":161,"column":27}},"loc":{"start":{"line":161,"column":44},"end":{"line":163,"column":101}},"line":161},"30":{"name":"(anonymous_30)","decl":{"start":{"line":163,"column":26},"end":{"line":163,"column":27}},"loc":{"start":{"line":163,"column":40},"end":{"line":163,"column":99}},"line":163},"31":{"name":"(anonymous_31)","decl":{"start":{"line":177,"column":4},"end":{"line":177,"column":5}},"loc":{"start":{"line":177,"column":24},"end":{"line":192,"column":5}},"line":177},"32":{"name":"(anonymous_32)","decl":{"start":{"line":179,"column":32},"end":{"line":179,"column":33}},"loc":{"start":{"line":179,"column":38},"end":{"line":179,"column":55}},"line":179},"33":{"name":"(anonymous_33)","decl":{"start":{"line":181,"column":47},"end":{"line":181,"column":48}},"loc":{"start":{"line":181,"column":60},"end":{"line":191,"column":9}},"line":181},"34":{"name":"(anonymous_34)","decl":{"start":{"line":184,"column":33},"end":{"line":184,"column":34}},"loc":{"start":{"line":184,"column":43},"end":{"line":184,"column":127}},"line":184},"35":{"name":"(anonymous_35)","decl":{"start":{"line":184,"column":52},"end":{"line":184,"column":53}},"loc":{"start":{"line":184,"column":63},"end":{"line":184,"column":125}},"line":184},"36":{"name":"(anonymous_36)","decl":{"start":{"line":193,"column":4},"end":{"line":193,"column":5}},"loc":{"start":{"line":193,"column":21},"end":{"line":215,"column":5}},"line":193},"37":{"name":"(anonymous_37)","decl":{"start":{"line":195,"column":29},"end":{"line":195,"column":30}},"loc":{"start":{"line":195,"column":35},"end":{"line":195,"column":49}},"line":195},"38":{"name":"(anonymous_38)","decl":{"start":{"line":197,"column":47},"end":{"line":197,"column":48}},"loc":{"start":{"line":197,"column":60},"end":{"line":214,"column":9}},"line":197},"39":{"name":"(anonymous_39)","decl":{"start":{"line":203,"column":40},"end":{"line":203,"column":41}},"loc":{"start":{"line":203,"column":50},"end":{"line":212,"column":13}},"line":203},"40":{"name":"(anonymous_40)","decl":{"start":{"line":206,"column":59},"end":{"line":206,"column":60}},"loc":{"start":{"line":206,"column":66},"end":{"line":206,"column":72}},"line":206},"41":{"name":"(anonymous_41)","decl":{"start":{"line":216,"column":4},"end":{"line":216,"column":5}},"loc":{"start":{"line":216,"column":27},"end":{"line":245,"column":5}},"line":216},"42":{"name":"(anonymous_42)","decl":{"start":{"line":218,"column":35},"end":{"line":218,"column":36}},"loc":{"start":{"line":218,"column":41},"end":{"line":218,"column":61}},"line":218},"43":{"name":"(anonymous_43)","decl":{"start":{"line":220,"column":47},"end":{"line":220,"column":48}},"loc":{"start":{"line":220,"column":60},"end":{"line":244,"column":9}},"line":220}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":74,"column":8},"end":{"line":76,"column":9}},"type":"if","locations":[{"start":{"line":74,"column":8},"end":{"line":76,"column":9}},{"start":{"line":74,"column":8},"end":{"line":76,"column":9}}],"line":74},"9":{"loc":{"start":{"line":74,"column":12},"end":{"line":74,"column":62}},"type":"binary-expr","locations":[{"start":{"line":74,"column":12},"end":{"line":74,"column":30}},{"start":{"line":74,"column":34},"end":{"line":74,"column":62}}],"line":74},"10":{"loc":{"start":{"line":83,"column":43},"end":{"line":83,"column":75}},"type":"binary-expr","locations":[{"start":{"line":83,"column":43},"end":{"line":83,"column":51}},{"start":{"line":83,"column":55},"end":{"line":83,"column":75}}],"line":83},"11":{"loc":{"start":{"line":97,"column":12},"end":{"line":98,"column":23}},"type":"if","locations":[{"start":{"line":97,"column":12},"end":{"line":98,"column":23}},{"start":{"line":97,"column":12},"end":{"line":98,"column":23}}],"line":97},"12":{"loc":{"start":{"line":107,"column":16},"end":{"line":133,"column":17}},"type":"if","locations":[{"start":{"line":107,"column":16},"end":{"line":133,"column":17}},{"start":{"line":107,"column":16},"end":{"line":133,"column":17}}],"line":107},"13":{"loc":{"start":{"line":109,"column":39},"end":{"line":109,"column":60}},"type":"binary-expr","locations":[{"start":{"line":109,"column":39},"end":{"line":109,"column":54}},{"start":{"line":109,"column":58},"end":{"line":109,"column":60}}],"line":109},"14":{"loc":{"start":{"line":110,"column":39},"end":{"line":110,"column":57}},"type":"binary-expr","locations":[{"start":{"line":110,"column":39},"end":{"line":110,"column":51}},{"start":{"line":110,"column":55},"end":{"line":110,"column":57}}],"line":110},"15":{"loc":{"start":{"line":115,"column":24},"end":{"line":120,"column":25}},"type":"if","locations":[{"start":{"line":115,"column":24},"end":{"line":120,"column":25}},{"start":{"line":115,"column":24},"end":{"line":120,"column":25}}],"line":115},"16":{"loc":{"start":{"line":118,"column":29},"end":{"line":120,"column":25}},"type":"if","locations":[{"start":{"line":118,"column":29},"end":{"line":120,"column":25}},{"start":{"line":118,"column":29},"end":{"line":120,"column":25}}],"line":118},"17":{"loc":{"start":{"line":123,"column":24},"end":{"line":125,"column":25}},"type":"if","locations":[{"start":{"line":123,"column":24},"end":{"line":125,"column":25}},{"start":{"line":123,"column":24},"end":{"line":125,"column":25}}],"line":123},"18":{"loc":{"start":{"line":127,"column":20},"end":{"line":128,"column":85}},"type":"if","locations":[{"start":{"line":127,"column":20},"end":{"line":128,"column":85}},{"start":{"line":127,"column":20},"end":{"line":128,"column":85}}],"line":127},"19":{"loc":{"start":{"line":129,"column":20},"end":{"line":130,"column":85}},"type":"if","locations":[{"start":{"line":129,"column":20},"end":{"line":130,"column":85}},{"start":{"line":129,"column":20},"end":{"line":130,"column":85}}],"line":129},"20":{"loc":{"start":{"line":131,"column":20},"end":{"line":132,"column":79}},"type":"if","locations":[{"start":{"line":131,"column":20},"end":{"line":132,"column":79}},{"start":{"line":131,"column":20},"end":{"line":132,"column":79}}],"line":131},"21":{"loc":{"start":{"line":149,"column":12},"end":{"line":151,"column":13}},"type":"if","locations":[{"start":{"line":149,"column":12},"end":{"line":151,"column":13}},{"start":{"line":149,"column":12},"end":{"line":151,"column":13}}],"line":149},"22":{"loc":{"start":{"line":149,"column":16},"end":{"line":149,"column":40}},"type":"binary-expr","locations":[{"start":{"line":149,"column":16},"end":{"line":149,"column":29}},{"start":{"line":149,"column":33},"end":{"line":149,"column":40}}],"line":149},"23":{"loc":{"start":{"line":153,"column":12},"end":{"line":155,"column":13}},"type":"if","locations":[{"start":{"line":153,"column":12},"end":{"line":155,"column":13}},{"start":{"line":153,"column":12},"end":{"line":155,"column":13}}],"line":153},"24":{"loc":{"start":{"line":153,"column":16},"end":{"line":153,"column":84}},"type":"binary-expr","locations":[{"start":{"line":153,"column":16},"end":{"line":153,"column":34}},{"start":{"line":153,"column":38},"end":{"line":153,"column":84}}],"line":153},"25":{"loc":{"start":{"line":167,"column":16},"end":{"line":169,"column":17}},"type":"if","locations":[{"start":{"line":167,"column":16},"end":{"line":169,"column":17}},{"start":{"line":167,"column":16},"end":{"line":169,"column":17}}],"line":167},"26":{"loc":{"start":{"line":167,"column":20},"end":{"line":167,"column":68}},"type":"binary-expr","locations":[{"start":{"line":167,"column":20},"end":{"line":167,"column":42}},{"start":{"line":167,"column":46},"end":{"line":167,"column":68}}],"line":167},"27":{"loc":{"start":{"line":170,"column":16},"end":{"line":172,"column":17}},"type":"if","locations":[{"start":{"line":170,"column":16},"end":{"line":172,"column":17}},{"start":{"line":170,"column":16},"end":{"line":172,"column":17}}],"line":170},"28":{"loc":{"start":{"line":200,"column":12},"end":{"line":201,"column":23}},"type":"if","locations":[{"start":{"line":200,"column":12},"end":{"line":201,"column":23}},{"start":{"line":200,"column":12},"end":{"line":201,"column":23}}],"line":200},"29":{"loc":{"start":{"line":204,"column":16},"end":{"line":211,"column":17}},"type":"if","locations":[{"start":{"line":204,"column":16},"end":{"line":211,"column":17}},{"start":{"line":204,"column":16},"end":{"line":211,"column":17}}],"line":204},"30":{"loc":{"start":{"line":223,"column":12},"end":{"line":224,"column":23}},"type":"if","locations":[{"start":{"line":223,"column":12},"end":{"line":224,"column":23}},{"start":{"line":223,"column":12},"end":{"line":224,"column":23}}],"line":223},"31":{"loc":{"start":{"line":238,"column":16},"end":{"line":241,"column":17}},"type":"if","locations":[{"start":{"line":238,"column":16},"end":{"line":241,"column":17}},{"start":{"line":238,"column":16},"end":{"line":241,"column":17}}],"line":238}},"s":{"0":1,"1":82,"2":9,"3":114,"4":80,"5":80,"6":0,"7":2,"8":2,"9":1,"10":193,"11":114,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":5,"25":5,"26":5,"27":4,"28":5,"29":1,"30":6,"31":6,"32":30,"33":65,"34":6,"35":144,"36":6,"37":5,"38":5,"39":5,"40":0,"41":5,"42":5,"43":5,"44":5,"45":4,"46":4,"47":4,"48":4,"49":4,"50":4,"51":6,"52":3,"53":3,"54":2,"55":4,"56":5,"57":2,"58":4,"59":2,"60":4,"61":1,"62":4,"63":1,"64":5,"65":1,"66":1,"67":5,"68":1,"69":1,"70":5,"71":2,"72":2,"73":20,"74":20,"75":0,"76":20,"77":0,"78":20,"79":20,"80":15,"81":11,"82":11,"83":11,"84":15,"85":5,"86":2,"87":3,"88":2,"89":1,"90":6,"91":6,"92":6,"93":6,"94":6,"95":18,"96":6,"97":6,"98":73,"99":5,"100":73,"101":73,"102":73,"103":67,"104":6,"105":6,"106":26,"107":1,"108":2,"109":1,"110":1,"111":1,"112":5,"113":6,"114":6,"115":6,"116":6,"117":6,"118":0,"119":6,"120":6,"121":6,"122":6,"123":5,"124":1,"125":1,"126":1,"127":0,"128":1},"f":{"0":114,"1":82,"2":9,"3":114,"4":80,"5":2,"6":193,"7":3,"8":5,"9":5,"10":6,"11":30,"12":65,"13":144,"14":6,"15":5,"16":5,"17":5,"18":6,"19":5,"20":1,"21":1,"22":1,"23":1,"24":2,"25":2,"26":20,"27":20,"28":11,"29":11,"30":11,"31":6,"32":6,"33":6,"34":18,"35":6,"36":73,"37":5,"38":73,"39":26,"40":2,"41":6,"42":6,"43":6},"b":{"0":[1,1,1],"1":[73,9],"2":[114,114],"3":[111,82],"4":[114,114],"5":[1,1,1],"6":[3,0],"7":[3,3],"8":[4,1],"9":[5,4],"10":[65,25],"11":[0,5],"12":[4,1],"13":[4,0],"14":[4,1],"15":[3,3],"16":[2,1],"17":[2,3],"18":[2,2],"19":[1,3],"20":[1,3],"21":[0,20],"22":[20,5],"23":[0,20],"24":[20,20],"25":[2,3],"26":[5,4],"27":[2,1],"28":[67,6],"29":[1,25],"30":[0,6],"31":[1,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/hooks.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/hooks.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,wDAAuC;AACvC,gEAAwC;AAExC,6DAAkC;AAClC,uCAAgD;AAEhD,MAAM,mBAAmB,GAAG;IAC1B,sBAAsB;IACtB,uBAAuB;IACvB,wBAAwB;IACxB,sBAAsB;IACtB,oBAAoB;CACrB,CAAC;AAEW,QAAA,aAAa,GAAG;IAC3B,IAAI,EAAE,OAAO;IACb,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE;CAC1B,CAAC;AAEW,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,OAAO;IACb,KAAK,EAAE;QACL,IAAI,EAAE,QAAQ;QACd,OAAO,EAAE,EAAE;QACX,UAAU,EAAE;YACV,MAAM,EAAE;gBACN,IAAI,EAAE,QAAQ;gBACd,WAAW,EAAE,wCAAwC;gBACrD,OAAO,EAAE,EAAE;aACZ;YACD,IAAI,EAAE;gBACJ,IAAI,EAAE,QAAQ;gBACd,WAAW,EACT,8HAA8H;gBAChI,OAAO,EAAE,kCAAkC;aAC5C;YACD,OAAO,EAAE;gBACP,IAAI,EAAE,SAAS;gBACf,WAAW,EAAE,6CAA6C;gBAC1D,OAAO,EAAE,KAAK;aACf;YACD,SAAS,EAAE;gBACT,IAAI,EAAE,QAAQ;gBACd,WAAW,EAAE,wBAAwB;gBACrC,IAAI,EAAE,mBAAmB;aAC1B;YACD,OAAO,EAAE;gBACP,IAAI,EAAE,QAAQ;gBACd,WAAW,EAAE,mEAAmE;gBAChF,OAAO,EAAE,EAAE;aACZ;YACD,YAAY,EAAE;gBACZ,IAAI,EAAE,QAAQ;gBACd,OAAO,EAAE,EAAE;gBACX,WAAW,EAAE,oEAAoE;aAClF;SACF;QACD,QAAQ,EAAE,CAAC,QAAQ,EAAE,MAAM,EAAE,WAAW,CAAC;KAC1C;CACF,CAAC;AAEF,MAAM,cAAc,GAAG,CAAC,KAAc,EAAE,IAAY,EAAE,SAAiB,EAAgB,EAAE;IACvF,IAAI,MAAM,GAAiB,IAAI,CAAC;IAEhC,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;QACrB,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,IAAI,IAAI,CAAC,SAAS,KAAK,SAAS,EAAE;YACtD,MAAM,GAAG,IAAI,CAAC;SACf;IACH,CAAC,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;AAChB,CAAC,CAAC;AAEF,MAAM,SAAS,GAAG,CAAC,KAAK,EAAE,EAAE;IAC1B,MAAM,MAAM,GAAG,EAAE,CAAC;IAElB,mBAAmB,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;QACnC,MAAM,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,SAAS,KAAK,IAAI,CAAC,CAAC;IACvE,CAAC,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;AAChB,CAAC,CAAC;AAEF,MAAqB,YAAa,SAAQ,iBAAc;IAGtD,YAAY,OAAuB;QACjC,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,OAAO,EACb,iBAAiB,EAAE,CAAC,IAAI,EAAE,WAAW,CAAC,IACtC,CAAC;IACL,CAAC;IAED,SAAS,CAAC,IAAI;QACZ,OAAO,KAAK,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC;IACzE,CAAC;IAEK,cAAc,CAAC,KAAK;;YACxB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAE1C,IAAI,QAAQ,KAAK,IAAI;gBAAE,OAAO;YAE9B,MAAM,OAAO,GAAsB;gBACjC,MAAM,EAAE,EAAE;gBACV,MAAM,EAAE,EAAE;gBACV,GAAG,EAAE,EAAE;gBACP,SAAS,EAAE,EAAE;aACd,CAAC;YAEF,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;gBACrB,MAAM,OAAO,GAAG,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;gBACpE,IAAI,OAAO,EAAE;oBACX,0DAA0D;oBAC1D,MAAM,UAAU,GAAG,OAAO,CAAC,OAAO,IAAI,EAAE,CAAC;oBACzC,MAAM,UAAU,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;oBACtC,MAAM,MAAM,GAAG,EAAE,CAAC;oBAClB,MAAM,MAAM,GAAG,EAAE,CAAC;oBAClB,MAAM,GAAG,GAAa,EAAE,CAAC;oBAEzB,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE;wBACtC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;4BACpB,MAAM,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,GAAG,CAAC,CAAC;yBAC/B;6BAAM,IAAI,UAAU,CAAC,GAAG,CAAC,KAAK,mBAAS,CAAC,yBAAyB,EAAE;4BAClE,MAAM,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,GAAG,CAAC,CAAC;yBAC/B;oBACH,CAAC,CAAC,CAAC;oBAEH,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE;wBACtC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;4BACpB,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;yBACf;oBACH,CAAC,CAAC,CAAC;oBAEH,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM;wBAC5B,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;oBAC/D,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM;wBAC5B,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC;oBAC/D,IAAI,GAAG,CAAC,MAAM;wBAAE,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC;iBACxE;YACH,CAAC,CAAC,CAAC;YAEH,MAAM,OAAO,CAAC,GAAG,CACf,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAO,IAAI,EAAE,EAAE;gBAC7B,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,MAAM,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAC3E,CAAC,CAAA,CAAC,CACH,CAAC;YAEF,MAAM,OAAO,CAAC,GAAG,CACf,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAO,IAAI,EAAE,EAAE;gBAChC,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,MAAM,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YAC3E,CAAC,CAAA,CAAC,CACH,CAAC;YAEF,MAAM,OAAO,CAAC,GAAG,CACf,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAO,IAAI,EAAE,EAAE;gBAChC,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,MAAM,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YACxE,CAAC,CAAA,CAAC,CACH,CAAC;QACJ,CAAC;KAAA;IAED,wDAAwD;IAClD,OAAO,CAAC,MAAe;;YAC3B,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,MAAM,EAAE;gBAC5B,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;YAED,gDAAgD;YAChD,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,KAAK,UAAU,EAAE;gBACxE,OAAO,EAAE,CAAC;aACX;YAED,IAAI;gBACF,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC,CAAC;gBAEvF,mFAAmF;gBACnF,IAAI,CAAC,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAC/B,KAAK,CAAC,GAAG,CAAC,CAAC,IAAoB,EAAE,EAAE,CACjC,IAAI,CAAC,MAAM,CAAC,KAAK;qBACd,GAAG,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC;qBACpB,IAAI,CAAC,CAAC,YAAY,EAAE,EAAE,CACrB,IAAI,CAAC,MAAM,CAAC,KAAK;qBACd,UAAU,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC;qBAC3B,IAAI,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,iCAAM,YAAY,KAAE,OAAO,IAAG,CAAC,CACrD,CACJ,CACF,CAAC;gBAEF,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,GAAG,CAAC,UAAU,KAAK,GAAG,IAAI,GAAG,CAAC,UAAU,KAAK,GAAG,EAAE;oBACpD,OAAO,EAAE,CAAC;iBACX;gBACD,IAAI,IAAA,yBAAiB,EAAC,GAAG,CAAC,EAAE;oBAC1B,OAAO,IAAI,CAAC;iBACb;gBACD,MAAM,GAAG,CAAC;aACX;QACH,CAAC;KAAA;IAEK,WAAW,CAAC,MAAc;;;;;YAC9B,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,OAAM,WAAW,YAAC,MAAM,CAAC,CAAC;YAE3E,sFAAsF;YACtF,MAAM,YAAY,GAAG,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,iCAAM,IAAI,KAAE,OAAO,EAAE,SAAS,IAAG,CAAC,CAAC;YAErF,OAAO;gBACL,GAAG;gBACH,MAAM,EAAE,YAAY,CAAC,MAAM,CAAC;gBAC5B,MAAM,EAAE,YAAY,CAAC,MAAM,CAAC;gBAC5B,SAAS,EAAE,YAAY,CAAC,SAAS,CAAC;aACnC,CAAC;QACJ,CAAC;KAAA;IAEK,QAAQ,CAAC,MAAM;;;;;YACnB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,CAAC;YAEzB,wBAAwB;YACxB,IAAI,CAAC,KAAK;gBAAE,OAAO;YAEnB,MAAM,WAAW,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;YAErC,mBAAmB,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;gBACnC,IAAI,WAAW,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;oBAChC,yBAAyB;oBACzB,MAAM,QAAQ,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACjE,MAAM,GAAG,GAAG,IAAI,KAAK,CACnB,qCAAqC,IAAI,6CAA6C,QAAQ,EAAE,CACjG,CAAC;oBACF,wEAAwE;oBACxE,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC;oBACjB,MAAM,GAAG,CAAC;iBACX;YACH,CAAC,CAAC,CAAC;YAEH,MAAM,OAAM,QAAQ,YAAC,MAAM,CAAC,CAAC;QAC/B,CAAC;KAAA;IAEK,cAAc,CAAC,MAAc;;;;;YACjC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,CAAC;YAEzB,wBAAwB;YACxB,IAAI,CAAC,KAAK;gBAAE,OAAO;YAEnB,gBAAG,CAAC,IAAI,CACN,mKAAmK,CACpK,CAAC;YAEF,IAAI;gBACF,iDAAiD;gBACjD,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC/C,MAAM,OAAM,cAAc,YAAC,MAAM,EAAE;oBACjC,GAAG,EAAE,OAAO,CAAC,GAAG;oBAChB,MAAM,EAAE,OAAO,CAAC,MAAM;oBACtB,MAAM,EAAE,OAAO,CAAC,MAAM;oBACtB,SAAS,EAAE,OAAO,CAAC,SAAS;iBAC7B,CAAC,CAAC;gBAEH,MAAM,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;aAClC;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,IAAA,yBAAiB,EAAC,GAAG,CAAC,EAAE;oBAC1B,gBAAG,CAAC,IAAI,CACN,iMAAiM,CAClM,CAAC;oBACF,OAAO;iBACR;gBACD,MAAM,GAAG,CAAC;aACX;QACH,CAAC;KAAA;CACF;AA1LD,+BA0LC","sourcesContent":["import DefaultHandler from './default';\nimport constants from '../../constants';\nimport { Asset, Assets, CalculatedChanges } from '../../../types';\nimport log from '../../../logger';\nimport { isDeprecatedError } from '../../utils';\n\nconst ALLOWED_TRIGGER_IDS = [\n  'credentials-exchange',\n  'pre-user-registration',\n  'post-user-registration',\n  'post-change-password',\n  'send-phone-message',\n];\n\nexport const excludeSchema = {\n  type: 'array',\n  items: { type: 'string' },\n};\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    default: [],\n    properties: {\n      script: {\n        type: 'string',\n        description: \"A script that contains the hook's code\",\n        default: '',\n      },\n      name: {\n        type: 'string',\n        description:\n          \"The name of the hook. Can only contain alphanumeric characters, spaces and '-'. Can neither start nor end with '-' or spaces\",\n        pattern: '^[^-\\\\s][a-zA-Z0-9-\\\\s]+[^-\\\\s]$',\n      },\n      enabled: {\n        type: 'boolean',\n        description: 'true if the hook is active, false otherwise',\n        default: false,\n      },\n      triggerId: {\n        type: 'string',\n        description: \"The hooks's trigger ID\",\n        enum: ALLOWED_TRIGGER_IDS,\n      },\n      secrets: {\n        type: 'object',\n        description: 'List of key-value pairs containing secrets available to the hook.',\n        default: {},\n      },\n      dependencies: {\n        type: 'object',\n        default: {},\n        description: 'List of key-value pairs of NPM dependencies available to the hook.',\n      },\n    },\n    required: ['script', 'name', 'triggerId'],\n  },\n};\n\nconst getCertainHook = (hooks: Asset[], name: string, triggerId: string): Asset | null => {\n  let result: Asset | null = null;\n\n  hooks.forEach((hook) => {\n    if (hook.name === name && hook.triggerId === triggerId) {\n      result = hook;\n    }\n  });\n\n  return result;\n};\n\nconst getActive = (hooks) => {\n  const result = {};\n\n  ALLOWED_TRIGGER_IDS.forEach((type) => {\n    result[type] = hooks.filter((h) => h.active && h.triggerId === type);\n  });\n\n  return result;\n};\n\nexport default class HooksHandler extends DefaultHandler {\n  existing: Asset[];\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'hooks',\n      stripUpdateFields: ['id', 'triggerId'],\n    });\n  }\n\n  objString(hook): string {\n    return super.objString({ name: hook.name, triggerId: hook.triggerId });\n  }\n\n  async processSecrets(hooks): Promise<void> {\n    const allHooks = await this.getType(true);\n\n    if (allHooks === null) return;\n\n    const changes: CalculatedChanges = {\n      create: [],\n      update: [],\n      del: [],\n      conflicts: [],\n    };\n\n    hooks.forEach((hook) => {\n      const current = getCertainHook(allHooks, hook.name, hook.triggerId);\n      if (current) {\n        // if the hook was deleted we don't care about its secrets\n        const oldSecrets = current.secrets || {};\n        const newSecrets = hook.secrets || {};\n        const create = {};\n        const update = {};\n        const del: string[] = [];\n\n        Object.keys(newSecrets).forEach((key) => {\n          if (!oldSecrets[key]) {\n            create[key] = newSecrets[key];\n          } else if (newSecrets[key] !== constants.HOOKS_HIDDEN_SECRET_VALUE) {\n            update[key] = newSecrets[key];\n          }\n        });\n\n        Object.keys(oldSecrets).forEach((key) => {\n          if (!newSecrets[key]) {\n            del.push(key);\n          }\n        });\n\n        if (Object.keys(create).length)\n          changes.create.push({ hookId: current.id, secrets: create });\n        if (Object.keys(update).length)\n          changes.update.push({ hookId: current.id, secrets: update });\n        if (del.length) changes.del.push({ hookId: current.id, secrets: del });\n      }\n    });\n\n    await Promise.all(\n      changes.del.map(async (data) => {\n        await this.client.hooks.removeSecrets({ id: data.hookId }, data.secrets);\n      })\n    );\n\n    await Promise.all(\n      changes.update.map(async (data) => {\n        await this.client.hooks.updateSecrets({ id: data.hookId }, data.secrets);\n      })\n    );\n\n    await Promise.all(\n      changes.create.map(async (data) => {\n        await this.client.hooks.addSecrets({ id: data.hookId }, data.secrets);\n      })\n    );\n  }\n\n  //@ts-ignore because hooks use a special reload argument\n  async getType(reload: boolean): Promise<Asset[] | null> {\n    if (this.existing && !reload) {\n      return this.existing;\n    }\n\n    // in case client version does not support hooks\n    if (!this.client.hooks || typeof this.client.hooks.getAll !== 'function') {\n      return [];\n    }\n\n    try {\n      const hooks = await this.client.hooks.getAll({ paginate: true, include_totals: true });\n\n      // hooks.getAll does not return code and secrets, we have to fetch hooks one-by-one\n      this.existing = await Promise.all(\n        hooks.map((hook: { id: string }) =>\n          this.client.hooks\n            .get({ id: hook.id })\n            .then((hookWithCode) =>\n              this.client.hooks\n                .getSecrets({ id: hook.id })\n                .then((secrets) => ({ ...hookWithCode, secrets }))\n            )\n        )\n      );\n\n      return this.existing;\n    } catch (err) {\n      if (err.statusCode === 404 || err.statusCode === 501) {\n        return [];\n      }\n      if (isDeprecatedError(err)) {\n        return null;\n      }\n      throw err;\n    }\n  }\n\n  async calcChanges(assets: Assets): Promise<CalculatedChanges> {\n    const { del, update, create, conflicts } = await super.calcChanges(assets);\n\n    // strip secrets before hooks creating/updating, secrets have to be handled separately\n    const stripSecrets = (list) => list.map((item) => ({ ...item, secrets: undefined }));\n\n    return {\n      del,\n      update: stripSecrets(update),\n      create: stripSecrets(create),\n      conflicts: stripSecrets(conflicts),\n    };\n  }\n\n  async validate(assets): Promise<void> {\n    const { hooks } = assets;\n\n    // Do nothing if not set\n    if (!hooks) return;\n\n    const activeHooks = getActive(hooks);\n\n    ALLOWED_TRIGGER_IDS.forEach((type) => {\n      if (activeHooks[type].length > 1) {\n        // There can be only one!\n        const conflict = activeHooks[type].map((h) => h.name).join(', ');\n        const err = new Error(\n          `Only one active hook allowed for \"${type}\" extensibility point. Conflicting hooks: ${conflict}`\n        );\n        //@ts-ignore need to investigate if appending status actually works here\n        err.status = 409;\n        throw err;\n      }\n    });\n\n    await super.validate(assets);\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    const { hooks } = assets;\n\n    // Do nothing if not set\n    if (!hooks) return;\n\n    log.warn(\n      'Hooks are deprecated, migrate to using actions instead. See: https://auth0.com/docs/customize/actions/migrate/migrate-from-hooks-to-actions for more information.'\n    );\n\n    try {\n      // Figure out what needs to be updated vs created\n      const changes = await this.calcChanges(assets);\n      await super.processChanges(assets, {\n        del: changes.del,\n        create: changes.create,\n        update: changes.update,\n        conflicts: changes.conflicts,\n      });\n\n      await this.processSecrets(hooks);\n    } catch (err) {\n      if (isDeprecatedError(err)) {\n        log.warn(\n          'Failed to update hooks because functionality has been deprecated in favor of actions. See: https://auth0.com/docs/customize/actions/migrate/migrate-from-hooks-to-actions for more information.'\n        );\n        return;\n      }\n      throw err;\n    }\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5326dc598de12aa870f2b87d7d5f431c7eb3a80d","contentHash":"a8ba014211e45d15b8c549bdf72c9938d906e6f1aa1ec6704d80dede41c5108a"},"/home/circleci/repo/src/tools/auth0/handlers/pages.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/pages.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":71}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":20},"end":{"line":17,"column":63}},"18":{"start":{"line":18,"column":0},"end":{"line":18,"column":126}},"19":{"start":{"line":18,"column":70},"end":{"line":18,"column":89}},"20":{"start":{"line":18,"column":102},"end":{"line":18,"column":124}},"21":{"start":{"line":19,"column":0},"end":{"line":23,"column":2}},"22":{"start":{"line":25,"column":0},"end":{"line":38,"column":2}},"23":{"start":{"line":41,"column":8},"end":{"line":41,"column":99}},"24":{"start":{"line":44,"column":8},"end":{"line":44,"column":75}},"25":{"start":{"line":47,"column":8},"end":{"line":62,"column":11}},"26":{"start":{"line":48,"column":33},"end":{"line":52,"column":14}},"27":{"start":{"line":53,"column":12},"end":{"line":55,"column":13}},"28":{"start":{"line":54,"column":16},"end":{"line":54,"column":104}},"29":{"start":{"line":56,"column":12},"end":{"line":59,"column":15}},"30":{"start":{"line":60,"column":12},"end":{"line":60,"column":30}},"31":{"start":{"line":61,"column":12},"end":{"line":61,"column":33}},"32":{"start":{"line":65,"column":8},"end":{"line":85,"column":11}},"33":{"start":{"line":66,"column":29},"end":{"line":66,"column":89}},"34":{"start":{"line":66,"column":49},"end":{"line":66,"column":88}},"35":{"start":{"line":67,"column":27},"end":{"line":77,"column":18}},"36":{"start":{"line":68,"column":16},"end":{"line":75,"column":17}},"37":{"start":{"line":69,"column":37},"end":{"line":69,"column":67}},"38":{"start":{"line":70,"column":20},"end":{"line":72,"column":21}},"39":{"start":{"line":71,"column":24},"end":{"line":71,"column":106}},"40":{"start":{"line":73,"column":20},"end":{"line":73,"column":62}},"41":{"start":{"line":74,"column":20},"end":{"line":74,"column":48}},"42":{"start":{"line":76,"column":16},"end":{"line":76,"column":29}},"43":{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},"44":{"start":{"line":79,"column":16},"end":{"line":79,"column":64}},"45":{"start":{"line":81,"column":12},"end":{"line":84,"column":15}},"46":{"start":{"line":82,"column":16},"end":{"line":82,"column":34}},"47":{"start":{"line":83,"column":16},"end":{"line":83,"column":37}},"48":{"start":{"line":88,"column":8},"end":{"line":114,"column":11}},"49":{"start":{"line":89,"column":26},"end":{"line":89,"column":28}},"50":{"start":{"line":91,"column":33},"end":{"line":95,"column":14}},"51":{"start":{"line":96,"column":12},"end":{"line":98,"column":13}},"52":{"start":{"line":97,"column":16},"end":{"line":97,"column":102}},"53":{"start":{"line":99,"column":12},"end":{"line":105,"column":13}},"54":{"start":{"line":100,"column":16},"end":{"line":104,"column":19}},"55":{"start":{"line":106,"column":35},"end":{"line":106,"column":73}},"56":{"start":{"line":107,"column":12},"end":{"line":112,"column":15}},"57":{"start":{"line":108,"column":29},"end":{"line":108,"column":49}},"58":{"start":{"line":109,"column":16},"end":{"line":111,"column":17}},"59":{"start":{"line":110,"column":20},"end":{"line":110,"column":86}},"60":{"start":{"line":113,"column":12},"end":{"line":113,"column":25}},"61":{"start":{"line":117,"column":8},"end":{"line":129,"column":11}},"62":{"start":{"line":118,"column":30},"end":{"line":118,"column":36}},"63":{"start":{"line":120,"column":12},"end":{"line":121,"column":23}},"64":{"start":{"line":121,"column":16},"end":{"line":121,"column":23}},"65":{"start":{"line":123,"column":30},"end":{"line":123,"column":67}},"66":{"start":{"line":123,"column":48},"end":{"line":123,"column":66}},"67":{"start":{"line":124,"column":12},"end":{"line":126,"column":13}},"68":{"start":{"line":125,"column":16},"end":{"line":125,"column":54}},"69":{"start":{"line":128,"column":12},"end":{"line":128,"column":76}},"70":{"start":{"line":128,"column":55},"end":{"line":128,"column":73}},"71":{"start":{"line":132,"column":0},"end":{"line":132,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":18,"column":63},"end":{"line":18,"column":64}},"loc":{"start":{"line":18,"column":70},"end":{"line":18,"column":89}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":18,"column":95},"end":{"line":18,"column":96}},"loc":{"start":{"line":18,"column":102},"end":{"line":18,"column":124}},"line":18},"10":{"name":"(anonymous_10)","decl":{"start":{"line":40,"column":4},"end":{"line":40,"column":5}},"loc":{"start":{"line":40,"column":25},"end":{"line":42,"column":5}},"line":40},"11":{"name":"(anonymous_11)","decl":{"start":{"line":43,"column":4},"end":{"line":43,"column":5}},"loc":{"start":{"line":43,"column":20},"end":{"line":45,"column":5}},"line":43},"12":{"name":"(anonymous_12)","decl":{"start":{"line":46,"column":4},"end":{"line":46,"column":5}},"loc":{"start":{"line":46,"column":26},"end":{"line":63,"column":5}},"line":46},"13":{"name":"(anonymous_13)","decl":{"start":{"line":47,"column":47},"end":{"line":47,"column":48}},"loc":{"start":{"line":47,"column":60},"end":{"line":62,"column":9}},"line":47},"14":{"name":"(anonymous_14)","decl":{"start":{"line":64,"column":4},"end":{"line":64,"column":5}},"loc":{"start":{"line":64,"column":23},"end":{"line":86,"column":5}},"line":64},"15":{"name":"(anonymous_15)","decl":{"start":{"line":65,"column":47},"end":{"line":65,"column":48}},"loc":{"start":{"line":65,"column":60},"end":{"line":85,"column":9}},"line":65},"16":{"name":"(anonymous_16)","decl":{"start":{"line":66,"column":42},"end":{"line":66,"column":43}},"loc":{"start":{"line":66,"column":49},"end":{"line":66,"column":88}},"line":66},"17":{"name":"(anonymous_17)","decl":{"start":{"line":67,"column":43},"end":{"line":67,"column":44}},"loc":{"start":{"line":67,"column":60},"end":{"line":77,"column":13}},"line":67},"18":{"name":"(anonymous_18)","decl":{"start":{"line":81,"column":29},"end":{"line":81,"column":30}},"loc":{"start":{"line":81,"column":39},"end":{"line":84,"column":13}},"line":81},"19":{"name":"(anonymous_19)","decl":{"start":{"line":87,"column":4},"end":{"line":87,"column":5}},"loc":{"start":{"line":87,"column":14},"end":{"line":115,"column":5}},"line":87},"20":{"name":"(anonymous_20)","decl":{"start":{"line":88,"column":47},"end":{"line":88,"column":48}},"loc":{"start":{"line":88,"column":60},"end":{"line":114,"column":9}},"line":88},"21":{"name":"(anonymous_21)","decl":{"start":{"line":107,"column":56},"end":{"line":107,"column":57}},"loc":{"start":{"line":107,"column":73},"end":{"line":112,"column":13}},"line":107},"22":{"name":"(anonymous_22)","decl":{"start":{"line":116,"column":4},"end":{"line":116,"column":5}},"loc":{"start":{"line":116,"column":27},"end":{"line":130,"column":5}},"line":116},"23":{"name":"(anonymous_23)","decl":{"start":{"line":117,"column":47},"end":{"line":117,"column":48}},"loc":{"start":{"line":117,"column":60},"end":{"line":129,"column":9}},"line":117},"24":{"name":"(anonymous_24)","decl":{"start":{"line":123,"column":41},"end":{"line":123,"column":42}},"loc":{"start":{"line":123,"column":48},"end":{"line":123,"column":66}},"line":123},"25":{"name":"(anonymous_25)","decl":{"start":{"line":128,"column":48},"end":{"line":128,"column":49}},"loc":{"start":{"line":128,"column":55},"end":{"line":128,"column":73}},"line":128}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":53,"column":12},"end":{"line":55,"column":13}},"type":"if","locations":[{"start":{"line":53,"column":12},"end":{"line":55,"column":13}},{"start":{"line":53,"column":12},"end":{"line":55,"column":13}}],"line":53},"9":{"loc":{"start":{"line":68,"column":16},"end":{"line":75,"column":17}},"type":"if","locations":[{"start":{"line":68,"column":16},"end":{"line":75,"column":17}},{"start":{"line":68,"column":16},"end":{"line":75,"column":17}}],"line":68},"10":{"loc":{"start":{"line":70,"column":20},"end":{"line":72,"column":21}},"type":"if","locations":[{"start":{"line":70,"column":20},"end":{"line":72,"column":21}},{"start":{"line":70,"column":20},"end":{"line":72,"column":21}}],"line":70},"11":{"loc":{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},"type":"if","locations":[{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},{"start":{"line":78,"column":12},"end":{"line":80,"column":13}}],"line":78},"12":{"loc":{"start":{"line":96,"column":12},"end":{"line":98,"column":13}},"type":"if","locations":[{"start":{"line":96,"column":12},"end":{"line":98,"column":13}},{"start":{"line":96,"column":12},"end":{"line":98,"column":13}}],"line":96},"13":{"loc":{"start":{"line":99,"column":12},"end":{"line":105,"column":13}},"type":"if","locations":[{"start":{"line":99,"column":12},"end":{"line":105,"column":13}},{"start":{"line":99,"column":12},"end":{"line":105,"column":13}}],"line":99},"14":{"loc":{"start":{"line":109,"column":16},"end":{"line":111,"column":17}},"type":"if","locations":[{"start":{"line":109,"column":16},"end":{"line":111,"column":17}},{"start":{"line":109,"column":16},"end":{"line":111,"column":17}}],"line":109},"15":{"loc":{"start":{"line":120,"column":12},"end":{"line":121,"column":23}},"type":"if","locations":[{"start":{"line":120,"column":12},"end":{"line":121,"column":23}},{"start":{"line":120,"column":12},"end":{"line":121,"column":23}}],"line":120},"16":{"loc":{"start":{"line":124,"column":12},"end":{"line":126,"column":13}},"type":"if","locations":[{"start":{"line":124,"column":12},"end":{"line":126,"column":13}},{"start":{"line":124,"column":12},"end":{"line":126,"column":13}}],"line":124}},"s":{"0":1,"1":18,"2":3,"3":12,"4":18,"5":18,"6":0,"7":0,"8":0,"9":0,"10":30,"11":12,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":8,"20":4,"21":1,"22":1,"23":134,"24":3,"25":1,"26":1,"27":1,"28":0,"29":1,"30":1,"31":1,"32":3,"33":3,"34":2,"35":3,"36":2,"37":2,"38":2,"39":0,"40":2,"41":2,"42":2,"43":3,"44":2,"45":3,"46":2,"47":2,"48":5,"49":5,"50":5,"51":5,"52":0,"53":5,"54":5,"55":5,"56":5,"57":15,"58":15,"59":3,"60":5,"61":3,"62":3,"63":3,"64":0,"65":3,"66":3,"67":3,"68":1,"69":3,"70":3,"71":1},"f":{"0":12,"1":18,"2":3,"3":12,"4":18,"5":0,"6":30,"7":2,"8":8,"9":4,"10":134,"11":3,"12":1,"13":1,"14":3,"15":3,"16":2,"17":2,"18":2,"19":5,"20":5,"21":15,"22":3,"23":3,"24":3,"25":3},"b":{"0":[1,1,1],"1":[15,3],"2":[12,12],"3":[12,18],"4":[12,12],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[0,1],"9":[2,0],"10":[0,2],"11":[2,1],"12":[0,5],"13":[5,0],"14":[3,12],"15":[0,3],"16":[1,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/pages.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/pages.ts"],"names":[],"mappings":"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","sourcesContent":["import DefaultHandler from './default';\nimport constants from '../../constants';\nimport { Asset, Assets } from '../../../types';\n\nexport const supportedPages = constants.PAGE_NAMES.filter((p) => p.includes('.json')).map((p) =>\n  p.replace('.json', '')\n);\n\nexport const pageNameMap = {\n  guardian_multifactor: 'guardian_mfa_page',\n  password_reset: 'change_password',\n  error_page: 'error_page',\n};\n\nexport type Page = {\n  show_log_link?: boolean;\n  name: string;\n  enabled?: boolean;\n  html?: string;\n  url?: string;\n};\n\n// With this schema, we can only validate property types but not valid properties on per type basis\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      name: { type: 'string', enum: supportedPages },\n      html: { type: 'string', default: '' },\n      url: { type: 'string' },\n      show_log_link: { type: 'boolean' },\n      enabled: { type: 'boolean' },\n    },\n    required: ['name'],\n  },\n};\n\nexport default class PagesHandler extends DefaultHandler {\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'pages',\n      identifiers: ['name'],\n    });\n  }\n\n  objString(page): string {\n    return super.objString({ name: page.name, enabled: page.enabled });\n  }\n\n  async updateLoginPage(page): Promise<void> {\n    const globalClient = await this.client.clients.getAll({\n      is_global: true,\n      paginate: true,\n      include_totals: true,\n    });\n\n    if (!globalClient[0]) {\n      throw new Error('Unable to find global client id when trying to update the login page');\n    }\n\n    await this.client.clients.update(\n      { client_id: globalClient[0].client_id },\n      {\n        custom_login_page: page.html,\n        custom_login_page_on: page.enabled,\n      }\n    );\n    this.updated += 1;\n    this.didUpdate(page);\n  }\n\n  async updatePages(pages: Asset[]): Promise<void> {\n    const toUpdate = pages.filter((p) => supportedPages.includes(p.name));\n    const update = toUpdate.reduce((accum, page) => {\n      if (supportedPages.includes(page.name)) {\n        const pageName = pageNameMap[page.name];\n        if (!pageName) {\n          throw new Error(`Unable to map page ${page.name} into tenant level page setting`);\n        }\n        accum[pageName] = { ...page };\n        delete accum[pageName].name;\n      }\n      return accum;\n    }, {});\n\n    if (Object.keys(update).length) {\n      await this.client.tenant.updateSettings(update);\n    }\n\n    toUpdate.forEach((page) => {\n      this.updated += 1;\n      this.didUpdate(page);\n    });\n  }\n\n  async getType(): Promise<Asset[]> {\n    const pages: {\n      name: string;\n      enabled: boolean;\n      html: string;\n    }[] = [];\n\n    // Login page is handled via the global client\n    const globalClient = await this.client.clients.getAll({\n      is_global: true,\n      paginate: true,\n      include_totals: true,\n    });\n    if (!globalClient[0]) {\n      throw new Error('Unable to find global client id when trying to dump the login page');\n    }\n\n    if (globalClient[0].custom_login_page) {\n      pages.push({\n        name: 'login',\n        enabled: !!globalClient[0].custom_login_page_on,\n        html: globalClient[0].custom_login_page,\n      });\n    }\n\n    const tenantSettings = await this.client.tenant.getSettings();\n\n    Object.entries(pageNameMap).forEach(([key, name]) => {\n      const page = tenantSettings[name];\n      if (tenantSettings[name]) {\n        pages.push({\n          ...page,\n          name: key,\n        });\n      }\n    });\n\n    return pages;\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    const { pages } = assets;\n\n    // Do nothing if not set\n    if (!pages) return;\n\n    // Login page is handled via the global client\n    const loginPage = pages.find((p) => p.name === 'login');\n    if (loginPage !== undefined) {\n      await this.updateLoginPage(loginPage);\n    }\n\n    // Rest of pages are on tenant level settings\n    await this.updatePages(pages.filter((p) => p.name !== 'login'));\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2b801ca1dddd8a27412fb3bd01056745f261ff82","contentHash":"f5eca32c88b3aaa78cd45f6ea0cd639ba0cda65cffef07146f1519fb2354bc77"},"/home/circleci/repo/src/tools/auth0/handlers/resourceServers.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/resourceServers.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":48}},"16":{"start":{"line":16,"column":26},"end":{"line":16,"column":75}},"17":{"start":{"line":17,"column":20},"end":{"line":17,"column":63}},"18":{"start":{"line":18,"column":18},"end":{"line":18,"column":55}},"19":{"start":{"line":19,"column":27},"end":{"line":19,"column":60}},"20":{"start":{"line":20,"column":0},"end":{"line":23,"column":2}},"21":{"start":{"line":24,"column":0},"end":{"line":46,"column":2}},"22":{"start":{"line":49,"column":8},"end":{"line":49,"column":156}},"23":{"start":{"line":52,"column":8},"end":{"line":52,"column":101}},"24":{"start":{"line":55,"column":8},"end":{"line":63,"column":11}},"25":{"start":{"line":56,"column":12},"end":{"line":57,"column":37}},"26":{"start":{"line":57,"column":16},"end":{"line":57,"column":37}},"27":{"start":{"line":58,"column":36},"end":{"line":61,"column":14}},"28":{"start":{"line":62,"column":12},"end":{"line":62,"column":120}},"29":{"start":{"line":62,"column":50},"end":{"line":62,"column":118}},"30":{"start":{"line":66,"column":8},"end":{"line":88,"column":11}},"31":{"start":{"line":67,"column":38},"end":{"line":67,"column":44}},"32":{"start":{"line":69,"column":12},"end":{"line":75,"column":18}},"33":{"start":{"line":70,"column":16},"end":{"line":75,"column":18}},"34":{"start":{"line":76,"column":29},"end":{"line":76,"column":85}},"35":{"start":{"line":77,"column":27},"end":{"line":77,"column":47}},"36":{"start":{"line":79,"column":12},"end":{"line":79,"column":88}},"37":{"start":{"line":79,"column":60},"end":{"line":79,"column":86}},"38":{"start":{"line":80,"column":12},"end":{"line":80,"column":74}},"39":{"start":{"line":80,"column":46},"end":{"line":80,"column":72}},"40":{"start":{"line":81,"column":12},"end":{"line":87,"column":15}},"41":{"start":{"line":91,"column":23},"end":{"line":93,"column":10}},"42":{"start":{"line":92,"column":35},"end":{"line":92,"column":49}},"43":{"start":{"line":94,"column":8},"end":{"line":104,"column":11}},"44":{"start":{"line":95,"column":40},"end":{"line":95,"column":46}},"45":{"start":{"line":97,"column":12},"end":{"line":98,"column":23}},"46":{"start":{"line":98,"column":16},"end":{"line":98,"column":23}},"47":{"start":{"line":99,"column":36},"end":{"line":99,"column":132}},"48":{"start":{"line":99,"column":64},"end":{"line":99,"column":131}},"49":{"start":{"line":100,"column":12},"end":{"line":102,"column":13}},"50":{"start":{"line":101,"column":16},"end":{"line":101,"column":144}},"51":{"start":{"line":103,"column":12},"end":{"line":103,"column":53}},"52":{"start":{"line":107,"column":0},"end":{"line":107,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":48,"column":4},"end":{"line":48,"column":5}},"loc":{"start":{"line":48,"column":25},"end":{"line":50,"column":5}},"line":48},"9":{"name":"(anonymous_9)","decl":{"start":{"line":51,"column":4},"end":{"line":51,"column":5}},"loc":{"start":{"line":51,"column":30},"end":{"line":53,"column":5}},"line":51},"10":{"name":"(anonymous_10)","decl":{"start":{"line":54,"column":4},"end":{"line":54,"column":5}},"loc":{"start":{"line":54,"column":14},"end":{"line":64,"column":5}},"line":54},"11":{"name":"(anonymous_11)","decl":{"start":{"line":55,"column":47},"end":{"line":55,"column":48}},"loc":{"start":{"line":55,"column":60},"end":{"line":63,"column":9}},"line":55},"12":{"name":"(anonymous_12)","decl":{"start":{"line":62,"column":42},"end":{"line":62,"column":43}},"loc":{"start":{"line":62,"column":50},"end":{"line":62,"column":118}},"line":62},"13":{"name":"(anonymous_13)","decl":{"start":{"line":65,"column":4},"end":{"line":65,"column":5}},"loc":{"start":{"line":65,"column":24},"end":{"line":89,"column":5}},"line":65},"14":{"name":"(anonymous_14)","decl":{"start":{"line":66,"column":47},"end":{"line":66,"column":48}},"loc":{"start":{"line":66,"column":60},"end":{"line":88,"column":9}},"line":66},"15":{"name":"(anonymous_15)","decl":{"start":{"line":79,"column":53},"end":{"line":79,"column":54}},"loc":{"start":{"line":79,"column":60},"end":{"line":79,"column":86}},"line":79},"16":{"name":"(anonymous_16)","decl":{"start":{"line":80,"column":39},"end":{"line":80,"column":40}},"loc":{"start":{"line":80,"column":46},"end":{"line":80,"column":72}},"line":80},"17":{"name":"(anonymous_17)","decl":{"start":{"line":90,"column":4},"end":{"line":90,"column":5}},"loc":{"start":{"line":90,"column":21},"end":{"line":105,"column":5}},"line":90},"18":{"name":"(anonymous_18)","decl":{"start":{"line":92,"column":29},"end":{"line":92,"column":30}},"loc":{"start":{"line":92,"column":35},"end":{"line":92,"column":49}},"line":92},"19":{"name":"(anonymous_19)","decl":{"start":{"line":94,"column":47},"end":{"line":94,"column":48}},"loc":{"start":{"line":94,"column":60},"end":{"line":104,"column":9}},"line":94},"20":{"name":"(anonymous_20)","decl":{"start":{"line":99,"column":57},"end":{"line":99,"column":58}},"loc":{"start":{"line":99,"column":64},"end":{"line":99,"column":131}},"line":99}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":56,"column":12},"end":{"line":57,"column":37}},"type":"if","locations":[{"start":{"line":56,"column":12},"end":{"line":57,"column":37}},{"start":{"line":56,"column":12},"end":{"line":57,"column":37}}],"line":56},"9":{"loc":{"start":{"line":69,"column":12},"end":{"line":75,"column":18}},"type":"if","locations":[{"start":{"line":69,"column":12},"end":{"line":75,"column":18}},{"start":{"line":69,"column":12},"end":{"line":75,"column":18}}],"line":69},"10":{"loc":{"start":{"line":76,"column":29},"end":{"line":76,"column":85}},"type":"binary-expr","locations":[{"start":{"line":76,"column":30},"end":{"line":76,"column":44}},{"start":{"line":76,"column":48},"end":{"line":76,"column":78}},{"start":{"line":76,"column":83},"end":{"line":76,"column":85}}],"line":76},"11":{"loc":{"start":{"line":97,"column":12},"end":{"line":98,"column":23}},"type":"if","locations":[{"start":{"line":97,"column":12},"end":{"line":98,"column":23}},{"start":{"line":97,"column":12},"end":{"line":98,"column":23}}],"line":97},"12":{"loc":{"start":{"line":100,"column":12},"end":{"line":102,"column":13}},"type":"if","locations":[{"start":{"line":100,"column":12},"end":{"line":102,"column":13}},{"start":{"line":100,"column":12},"end":{"line":102,"column":13}}],"line":100}},"s":{"0":1,"1":23,"2":8,"3":93,"4":22,"5":22,"6":0,"7":1,"8":1,"9":1,"10":114,"11":93,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":141,"23":8,"24":12,"25":12,"26":0,"27":12,"28":12,"29":9,"30":7,"31":7,"32":7,"33":0,"34":7,"35":7,"36":7,"37":5,"38":7,"39":7,"40":7,"41":74,"42":4,"43":74,"44":74,"45":74,"46":69,"47":5,"48":6,"49":5,"50":1,"51":4,"52":1},"f":{"0":93,"1":23,"2":8,"3":93,"4":22,"5":1,"6":114,"7":3,"8":141,"9":8,"10":12,"11":12,"12":9,"13":7,"14":7,"15":5,"16":7,"17":74,"18":4,"19":74,"20":6},"b":{"0":[1,1,1],"1":[15,8],"2":[93,93],"3":[91,23],"4":[93,93],"5":[1,1,1],"6":[3,0],"7":[3,3],"8":[0,12],"9":[0,7],"10":[7,1,6],"11":[69,5],"12":[1,4]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/resourceServers.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/resourceServers.ts"],"names":[],"mappings":"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","sourcesContent":["import ValidationError from '../../validationError';\n\nimport constants from '../../constants';\nimport DefaultHandler from './default';\nimport { calculateChanges } from '../../calculateChanges';\nimport { Assets, CalculatedChanges } from '../../../types';\n\nexport const excludeSchema = {\n  type: 'array',\n  items: { type: 'string' },\n};\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      name: { type: 'string' },\n      identifier: { type: 'string' },\n      scopes: {\n        type: 'array',\n        items: {\n          type: 'object',\n          properties: {\n            name: { type: 'string' },\n            description: { type: 'string' },\n          },\n        },\n      },\n      enforce_policies: { type: 'boolean' },\n      token_dialect: { type: 'string' },\n    },\n    required: ['name', 'identifier'],\n  },\n};\n\nexport type ResourceServer = {\n  id: string;\n  name: string;\n  identifier: string;\n  scopes?: { description: string; value: string }[];\n};\nexport default class ResourceServersHandler extends DefaultHandler {\n  existing: ResourceServer[];\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'resourceServers',\n      identifiers: ['id', 'identifier'],\n      stripUpdateFields: ['identifier'], // Fields not allowed in updates\n    });\n  }\n\n  objString(resourceServer): string {\n    return super.objString({ name: resourceServer.name, identifier: resourceServer.identifier });\n  }\n\n  async getType(): Promise<ResourceServer[]> {\n    if (this.existing) return this.existing;\n    const resourceServers = await this.client.resourceServers.getAll({\n      paginate: true,\n      include_totals: true,\n    });\n    return resourceServers.filter(\n      (rs) => rs.name !== constants.RESOURCE_SERVERS_MANAGEMENT_API_NAME\n    );\n  }\n\n  async calcChanges(assets: Assets): Promise<CalculatedChanges> {\n    let { resourceServers } = assets;\n\n    // Do nothing if not set\n    if (!resourceServers)\n      return {\n        del: [],\n        create: [],\n        conflicts: [],\n        update: [],\n      };\n\n    const excluded = (assets.exclude && assets.exclude.resourceServers) || [];\n\n    let existing = await this.getType();\n\n    // Filter excluded\n    resourceServers = resourceServers.filter((r) => !excluded.includes(r.name));\n    existing = existing.filter((r) => !excluded.includes(r.name));\n\n    return calculateChanges({\n      handler: this,\n      assets: resourceServers,\n      existing,\n      identifiers: this.identifiers,\n      allowDelete: !!this.config('AUTH0_ALLOW_DELETE'),\n    });\n  }\n\n  async validate(assets: Assets): Promise<void> {\n    const { resourceServers } = assets;\n\n    // Do nothing if not set\n    if (!resourceServers) return;\n\n    const mgmtAPIResource = resourceServers.find(\n      (r) => r.name === constants.RESOURCE_SERVERS_MANAGEMENT_API_NAME\n    );\n    if (mgmtAPIResource) {\n      throw new ValidationError(\n        `You can not configure the '${constants.RESOURCE_SERVERS_MANAGEMENT_API_NAME}'.`\n      );\n    }\n\n    await super.validate(assets);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fb86b85b885bd5f5d48c03042df69600f14bf860","contentHash":"0a477e8cf74d08b291d97695ea0522086ccb269eee0f4d6033325d9d7efbf3d3"},"/home/circleci/repo/src/tools/auth0/handlers/databases.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/databases.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":24}},"50":{"start":{"line":45,"column":18},"end":{"line":45,"column":52}},"51":{"start":{"line":46,"column":20},"end":{"line":46,"column":63}},"52":{"start":{"line":47,"column":16},"end":{"line":47,"column":38}},"53":{"start":{"line":48,"column":0},"end":{"line":67,"column":2}},"54":{"start":{"line":60,"column":114},"end":{"line":60,"column":183}},"55":{"start":{"line":70,"column":8},"end":{"line":70,"column":120}},"56":{"start":{"line":73,"column":8},"end":{"line":73,"column":61}},"57":{"start":{"line":78,"column":8},"end":{"line":83,"column":9}},"58":{"start":{"line":79,"column":12},"end":{"line":82,"column":15}},"59":{"start":{"line":79,"column":40},"end":{"line":82,"column":14}},"60":{"start":{"line":80,"column":16},"end":{"line":80,"column":104}},"61":{"start":{"line":81,"column":16},"end":{"line":81,"column":71}},"62":{"start":{"line":84,"column":8},"end":{"line":84,"column":73}},"63":{"start":{"line":87,"column":8},"end":{"line":96,"column":11}},"64":{"start":{"line":88,"column":12},"end":{"line":89,"column":37}},"65":{"start":{"line":89,"column":16},"end":{"line":89,"column":37}},"66":{"start":{"line":90,"column":12},"end":{"line":94,"column":15}},"67":{"start":{"line":95,"column":12},"end":{"line":95,"column":33}},"68":{"start":{"line":99,"column":23},"end":{"line":101,"column":10}},"69":{"start":{"line":100,"column":38},"end":{"line":100,"column":55}},"70":{"start":{"line":102,"column":8},"end":{"line":126,"column":11}},"71":{"start":{"line":103,"column":34},"end":{"line":103,"column":40}},"72":{"start":{"line":105,"column":12},"end":{"line":111,"column":18}},"73":{"start":{"line":106,"column":16},"end":{"line":111,"column":18}},"74":{"start":{"line":113,"column":28},"end":{"line":113,"column":102}},"75":{"start":{"line":114,"column":49},"end":{"line":118,"column":14}},"76":{"start":{"line":119,"column":30},"end":{"line":124,"column":14}},"77":{"start":{"line":120,"column":16},"end":{"line":122,"column":17}},"78":{"start":{"line":121,"column":20},"end":{"line":121,"column":168}},"79":{"start":{"line":123,"column":16},"end":{"line":123,"column":26}},"80":{"start":{"line":125,"column":12},"end":{"line":125,"column":117}},"81":{"start":{"line":130,"column":23},"end":{"line":132,"column":10}},"82":{"start":{"line":131,"column":41},"end":{"line":131,"column":61}},"83":{"start":{"line":133,"column":8},"end":{"line":141,"column":11}},"84":{"start":{"line":134,"column":34},"end":{"line":134,"column":40}},"85":{"start":{"line":136,"column":12},"end":{"line":137,"column":23}},"86":{"start":{"line":137,"column":16},"end":{"line":137,"column":23}},"87":{"start":{"line":138,"column":40},"end":{"line":138,"column":90}},"88":{"start":{"line":139,"column":28},"end":{"line":139,"column":58}},"89":{"start":{"line":140,"column":12},"end":{"line":140,"column":118}},"90":{"start":{"line":144,"column":0},"end":{"line":146,"column":54}},"91":{"start":{"line":147,"column":0},"end":{"line":147,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"(anonymous_15)","decl":{"start":{"line":60,"column":98},"end":{"line":60,"column":99}},"loc":{"start":{"line":60,"column":114},"end":{"line":60,"column":183}},"line":60},"16":{"name":"(anonymous_16)","decl":{"start":{"line":69,"column":4},"end":{"line":69,"column":5}},"loc":{"start":{"line":69,"column":24},"end":{"line":71,"column":5}},"line":69},"17":{"name":"(anonymous_17)","decl":{"start":{"line":72,"column":4},"end":{"line":72,"column":5}},"loc":{"start":{"line":72,"column":18},"end":{"line":74,"column":5}},"line":72},"18":{"name":"(anonymous_18)","decl":{"start":{"line":75,"column":4},"end":{"line":75,"column":5}},"loc":{"start":{"line":75,"column":20},"end":{"line":85,"column":5}},"line":75},"19":{"name":"(anonymous_19)","decl":{"start":{"line":79,"column":19},"end":{"line":79,"column":20}},"loc":{"start":{"line":79,"column":40},"end":{"line":82,"column":14}},"line":79},"20":{"name":"(anonymous_20)","decl":{"start":{"line":79,"column":81},"end":{"line":79,"column":82}},"loc":{"start":{"line":79,"column":97},"end":{"line":82,"column":13}},"line":79},"21":{"name":"(anonymous_21)","decl":{"start":{"line":86,"column":4},"end":{"line":86,"column":5}},"loc":{"start":{"line":86,"column":14},"end":{"line":97,"column":5}},"line":86},"22":{"name":"(anonymous_22)","decl":{"start":{"line":87,"column":47},"end":{"line":87,"column":48}},"loc":{"start":{"line":87,"column":60},"end":{"line":96,"column":9}},"line":87},"23":{"name":"(anonymous_23)","decl":{"start":{"line":98,"column":4},"end":{"line":98,"column":5}},"loc":{"start":{"line":98,"column":24},"end":{"line":127,"column":5}},"line":98},"24":{"name":"(anonymous_24)","decl":{"start":{"line":100,"column":32},"end":{"line":100,"column":33}},"loc":{"start":{"line":100,"column":38},"end":{"line":100,"column":55}},"line":100},"25":{"name":"(anonymous_25)","decl":{"start":{"line":102,"column":47},"end":{"line":102,"column":48}},"loc":{"start":{"line":102,"column":60},"end":{"line":126,"column":9}},"line":102},"26":{"name":"(anonymous_26)","decl":{"start":{"line":119,"column":44},"end":{"line":119,"column":45}},"loc":{"start":{"line":119,"column":52},"end":{"line":124,"column":13}},"line":119},"27":{"name":"(anonymous_27)","decl":{"start":{"line":129,"column":4},"end":{"line":129,"column":5}},"loc":{"start":{"line":129,"column":27},"end":{"line":142,"column":5}},"line":129},"28":{"name":"(anonymous_28)","decl":{"start":{"line":131,"column":35},"end":{"line":131,"column":36}},"loc":{"start":{"line":131,"column":41},"end":{"line":131,"column":61}},"line":131},"29":{"name":"(anonymous_29)","decl":{"start":{"line":133,"column":47},"end":{"line":133,"column":48}},"loc":{"start":{"line":133,"column":60},"end":{"line":141,"column":9}},"line":133}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":78,"column":8},"end":{"line":83,"column":9}},"type":"if","locations":[{"start":{"line":78,"column":8},"end":{"line":83,"column":9}},{"start":{"line":78,"column":8},"end":{"line":83,"column":9}}],"line":78},"35":{"loc":{"start":{"line":88,"column":12},"end":{"line":89,"column":37}},"type":"if","locations":[{"start":{"line":88,"column":12},"end":{"line":89,"column":37}},{"start":{"line":88,"column":12},"end":{"line":89,"column":37}}],"line":88},"36":{"loc":{"start":{"line":105,"column":12},"end":{"line":111,"column":18}},"type":"if","locations":[{"start":{"line":105,"column":12},"end":{"line":111,"column":18}},{"start":{"line":105,"column":12},"end":{"line":111,"column":18}}],"line":105},"37":{"loc":{"start":{"line":120,"column":16},"end":{"line":122,"column":17}},"type":"if","locations":[{"start":{"line":120,"column":16},"end":{"line":122,"column":17}},{"start":{"line":120,"column":16},"end":{"line":122,"column":17}}],"line":120},"38":{"loc":{"start":{"line":136,"column":12},"end":{"line":137,"column":23}},"type":"if","locations":[{"start":{"line":136,"column":12},"end":{"line":137,"column":23}},{"start":{"line":136,"column":12},"end":{"line":137,"column":23}}],"line":136},"39":{"loc":{"start":{"line":138,"column":40},"end":{"line":138,"column":90}},"type":"binary-expr","locations":[{"start":{"line":138,"column":41},"end":{"line":138,"column":55}},{"start":{"line":138,"column":59},"end":{"line":138,"column":83}},{"start":{"line":138,"column":88},"end":{"line":138,"column":90}}],"line":138}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":36,"36":18,"37":32,"38":36,"39":36,"40":0,"41":0,"42":0,"43":0,"44":68,"45":32,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":7,"55":142,"56":10,"57":8,"58":3,"59":3,"60":3,"61":3,"62":5,"63":14,"64":14,"65":0,"66":14,"67":14,"68":9,"69":9,"70":9,"71":9,"72":9,"73":0,"74":9,"75":9,"76":9,"77":7,"78":2,"79":5,"80":9,"81":9,"82":9,"83":9,"84":9,"85":9,"86":0,"87":9,"88":9,"89":9,"90":1,"91":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":32,"8":36,"9":18,"10":32,"11":36,"12":0,"13":68,"14":1,"15":7,"16":142,"17":10,"18":8,"19":3,"20":3,"21":14,"22":14,"23":9,"24":9,"25":9,"26":7,"27":9,"28":9,"29":9},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[18,18],"28":[32,32],"29":[32,36],"30":[32,32],"31":[1,1,1],"32":[1,0],"33":[1,1],"34":[3,5],"35":[0,14],"36":[0,9],"37":[2,5],"38":[0,9],"39":[9,2,8]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/databases.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/databases.ts"],"names":[],"mappings":"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","sourcesContent":["import DefaultAPIHandler, { order } from './default';\nimport constants from '../../constants';\nimport { filterExcluded, getEnabledClients } from '../../utils';\nimport { CalculatedChanges, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      strategy: { type: 'string', enum: ['auth0'], default: 'auth0' },\n      name: { type: 'string' },\n      options: {\n        type: 'object',\n        properties: {\n          customScripts: {\n            type: 'object',\n            properties: {\n              ...constants.DATABASE_SCRIPTS.reduce(\n                (o, script) => ({ ...o, [script]: { type: 'string' } }),\n                {}\n              ),\n            },\n          },\n        },\n      },\n    },\n    required: ['name'],\n  },\n};\n\nexport default class DatabaseHandler extends DefaultAPIHandler {\n  constructor(config: DefaultAPIHandler) {\n    super({\n      ...config,\n      type: 'databases',\n      stripUpdateFields: ['strategy', 'name'],\n    });\n  }\n\n  objString(db) {\n    return super.objString({ name: db.name, id: db.id });\n  }\n\n  getClientFN(fn: 'create' | 'delete' | 'getAll' | 'update'): Function {\n    // Override this as a database is actually a connection but we are treating them as a different object\n    // If we going to update database, we need to get current options first\n    if (fn === 'update') {\n      return (params, payload) =>\n        this.client.connections.get(params).then((connection) => {\n          payload.options = { ...connection.options, ...payload.options };\n          return this.client.connections.update(params, payload);\n        });\n    }\n\n    return this.client.connections[fn].bind(this.client.connections);\n  }\n\n  async getType() {\n    if (this.existing) return this.existing;\n    this.existing = this.client.connections.getAll({\n      strategy: 'auth0',\n      paginate: true,\n      include_totals: true,\n    });\n\n    return this.existing;\n  }\n\n  async calcChanges(assets: Assets): Promise<CalculatedChanges> {\n    const { databases } = assets;\n\n    // Do nothing if not set\n    if (!databases)\n      return {\n        del: [],\n        create: [],\n        update: [],\n        conflicts: [],\n      };\n\n    // Convert enabled_clients by name to the id\n    const clients = await this.client.clients.getAll({ paginate: true, include_totals: true });\n    const existingDatabasesConnections = await this.client.connections.getAll({\n      strategy: 'auth0',\n      paginate: true,\n      include_totals: true,\n    });\n    const formatted = databases.map((db) => {\n      if (db.enabled_clients) {\n        return {\n          ...db,\n          enabled_clients: getEnabledClients(assets, db, existingDatabasesConnections, clients),\n        };\n      }\n\n      return db;\n    });\n\n    return super.calcChanges({ ...assets, databases: formatted });\n  }\n\n  // Run after clients are updated so we can convert all the enabled_clients names to id's\n  @order('60')\n  async processChanges(assets: Assets) {\n    const { databases } = assets;\n\n    // Do nothing if not set\n    if (!databases) return;\n\n    const excludedConnections: string[] = (assets.exclude && assets.exclude.databases) || [];\n\n    const changes = await this.calcChanges(assets);\n\n    await super.processChanges(assets, filterExcluded(changes, excludedConnections));\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"861038f6932580b02e3ab918b2ac45ad214d1deb","contentHash":"70c56cf58d56584601f041629ee3557795ff45f48af7ec2990b6ef4c7d46aed5"},"/home/circleci/repo/src/tools/auth0/handlers/connections.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/connections.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":75}},"50":{"start":{"line":45,"column":19},"end":{"line":45,"column":55}},"51":{"start":{"line":46,"column":17},"end":{"line":46,"column":51}},"52":{"start":{"line":47,"column":18},"end":{"line":47,"column":52}},"53":{"start":{"line":48,"column":16},"end":{"line":48,"column":38}},"54":{"start":{"line":49,"column":0},"end":{"line":63,"column":2}},"55":{"start":{"line":68,"column":49},"end":{"line":94,"column":1}},"56":{"start":{"line":70,"column":4},"end":{"line":71,"column":31}},"57":{"start":{"line":71,"column":8},"end":{"line":71,"column":31}},"58":{"start":{"line":73,"column":27},"end":{"line":73,"column":164}},"59":{"start":{"line":74,"column":4},"end":{"line":75,"column":31}},"60":{"start":{"line":75,"column":8},"end":{"line":75,"column":31}},"61":{"start":{"line":76,"column":35},"end":{"line":76,"column":84}},"62":{"start":{"line":77,"column":28},"end":{"line":79,"column":59}},"63":{"start":{"line":79,"column":23},"end":{"line":79,"column":58}},"64":{"start":{"line":80,"column":31},"end":{"line":92,"column":6}},"65":{"start":{"line":81,"column":31},"end":{"line":81,"column":76}},"66":{"start":{"line":82,"column":46},"end":{"line":90,"column":10}},"67":{"start":{"line":83,"column":12},"end":{"line":84,"column":27}},"68":{"start":{"line":84,"column":16},"end":{"line":84,"column":27}},"69":{"start":{"line":85,"column":46},"end":{"line":85,"column":99}},"70":{"start":{"line":86,"column":12},"end":{"line":86,"column":82}},"71":{"start":{"line":87,"column":12},"end":{"line":87,"column":23}},"72":{"start":{"line":91,"column":8},"end":{"line":91,"column":182}},"73":{"start":{"line":93,"column":4},"end":{"line":93,"column":93}},"74":{"start":{"line":95,"column":0},"end":{"line":95,"column":92}},"75":{"start":{"line":98,"column":8},"end":{"line":98,"column":122}},"76":{"start":{"line":101,"column":8},"end":{"line":101,"column":77}},"77":{"start":{"line":104,"column":8},"end":{"line":111,"column":9}},"78":{"start":{"line":105,"column":12},"end":{"line":107,"column":14}},"79":{"start":{"line":110,"column":12},"end":{"line":110,"column":22}},"80":{"start":{"line":114,"column":8},"end":{"line":126,"column":11}},"81":{"start":{"line":115,"column":12},"end":{"line":116,"column":37}},"82":{"start":{"line":116,"column":16},"end":{"line":116,"column":37}},"83":{"start":{"line":117,"column":32},"end":{"line":120,"column":14}},"84":{"start":{"line":122,"column":12},"end":{"line":122,"column":78}},"85":{"start":{"line":122,"column":54},"end":{"line":122,"column":76}},"86":{"start":{"line":123,"column":12},"end":{"line":124,"column":26}},"87":{"start":{"line":124,"column":16},"end":{"line":124,"column":26}},"88":{"start":{"line":125,"column":12},"end":{"line":125,"column":33}},"89":{"start":{"line":129,"column":23},"end":{"line":131,"column":10}},"90":{"start":{"line":130,"column":38},"end":{"line":130,"column":55}},"91":{"start":{"line":132,"column":8},"end":{"line":156,"column":11}},"92":{"start":{"line":133,"column":36},"end":{"line":133,"column":42}},"93":{"start":{"line":135,"column":12},"end":{"line":141,"column":18}},"94":{"start":{"line":136,"column":16},"end":{"line":141,"column":18}},"95":{"start":{"line":143,"column":28},"end":{"line":143,"column":102}},"96":{"start":{"line":144,"column":40},"end":{"line":147,"column":14}},"97":{"start":{"line":148,"column":30},"end":{"line":148,"column":274}},"98":{"start":{"line":148,"column":63},"end":{"line":148,"column":272}},"99":{"start":{"line":149,"column":36},"end":{"line":149,"column":141}},"100":{"start":{"line":150,"column":58},"end":{"line":154,"column":14}},"101":{"start":{"line":155,"column":12},"end":{"line":155,"column":57}},"102":{"start":{"line":160,"column":23},"end":{"line":162,"column":10}},"103":{"start":{"line":161,"column":41},"end":{"line":161,"column":61}},"104":{"start":{"line":163,"column":8},"end":{"line":171,"column":11}},"105":{"start":{"line":164,"column":36},"end":{"line":164,"column":42}},"106":{"start":{"line":166,"column":12},"end":{"line":167,"column":23}},"107":{"start":{"line":167,"column":16},"end":{"line":167,"column":23}},"108":{"start":{"line":168,"column":40},"end":{"line":168,"column":92}},"109":{"start":{"line":169,"column":28},"end":{"line":169,"column":58}},"110":{"start":{"line":170,"column":12},"end":{"line":170,"column":118}},"111":{"start":{"line":174,"column":0},"end":{"line":176,"column":57}},"112":{"start":{"line":177,"column":0},"end":{"line":177,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"(anonymous_15)","decl":{"start":{"line":68,"column":49},"end":{"line":68,"column":50}},"loc":{"start":{"line":68,"column":104},"end":{"line":94,"column":1}},"line":68},"16":{"name":"(anonymous_16)","decl":{"start":{"line":79,"column":4},"end":{"line":79,"column":5}},"loc":{"start":{"line":79,"column":23},"end":{"line":79,"column":58}},"line":79},"17":{"name":"(anonymous_17)","decl":{"start":{"line":80,"column":58},"end":{"line":80,"column":59}},"loc":{"start":{"line":80,"column":82},"end":{"line":92,"column":5}},"line":80},"18":{"name":"(anonymous_18)","decl":{"start":{"line":82,"column":69},"end":{"line":82,"column":70}},"loc":{"start":{"line":82,"column":93},"end":{"line":88,"column":9}},"line":82},"19":{"name":"(anonymous_19)","decl":{"start":{"line":97,"column":4},"end":{"line":97,"column":5}},"loc":{"start":{"line":97,"column":24},"end":{"line":99,"column":5}},"line":97},"20":{"name":"(anonymous_20)","decl":{"start":{"line":100,"column":4},"end":{"line":100,"column":5}},"loc":{"start":{"line":100,"column":26},"end":{"line":102,"column":5}},"line":100},"21":{"name":"(anonymous_21)","decl":{"start":{"line":103,"column":4},"end":{"line":103,"column":5}},"loc":{"start":{"line":103,"column":45},"end":{"line":112,"column":5}},"line":103},"22":{"name":"(anonymous_22)","decl":{"start":{"line":113,"column":4},"end":{"line":113,"column":5}},"loc":{"start":{"line":113,"column":14},"end":{"line":127,"column":5}},"line":113},"23":{"name":"(anonymous_23)","decl":{"start":{"line":114,"column":47},"end":{"line":114,"column":48}},"loc":{"start":{"line":114,"column":60},"end":{"line":126,"column":9}},"line":114},"24":{"name":"(anonymous_24)","decl":{"start":{"line":122,"column":47},"end":{"line":122,"column":48}},"loc":{"start":{"line":122,"column":54},"end":{"line":122,"column":76}},"line":122},"25":{"name":"(anonymous_25)","decl":{"start":{"line":128,"column":4},"end":{"line":128,"column":5}},"loc":{"start":{"line":128,"column":24},"end":{"line":157,"column":5}},"line":128},"26":{"name":"(anonymous_26)","decl":{"start":{"line":130,"column":32},"end":{"line":130,"column":33}},"loc":{"start":{"line":130,"column":38},"end":{"line":130,"column":55}},"line":130},"27":{"name":"(anonymous_27)","decl":{"start":{"line":132,"column":47},"end":{"line":132,"column":48}},"loc":{"start":{"line":132,"column":60},"end":{"line":156,"column":9}},"line":132},"28":{"name":"(anonymous_28)","decl":{"start":{"line":148,"column":46},"end":{"line":148,"column":47}},"loc":{"start":{"line":148,"column":63},"end":{"line":148,"column":272}},"line":148},"29":{"name":"(anonymous_29)","decl":{"start":{"line":159,"column":4},"end":{"line":159,"column":5}},"loc":{"start":{"line":159,"column":27},"end":{"line":172,"column":5}},"line":159},"30":{"name":"(anonymous_30)","decl":{"start":{"line":161,"column":35},"end":{"line":161,"column":36}},"loc":{"start":{"line":161,"column":41},"end":{"line":161,"column":61}},"line":161},"31":{"name":"(anonymous_31)","decl":{"start":{"line":163,"column":47},"end":{"line":163,"column":48}},"loc":{"start":{"line":163,"column":60},"end":{"line":171,"column":9}},"line":163}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":70,"column":4},"end":{"line":71,"column":31}},"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":71,"column":31}},{"start":{"line":70,"column":4},"end":{"line":71,"column":31}}],"line":70},"35":{"loc":{"start":{"line":73,"column":27},"end":{"line":73,"column":164}},"type":"binary-expr","locations":[{"start":{"line":73,"column":28},"end":{"line":73,"column":157}},{"start":{"line":73,"column":162},"end":{"line":73,"column":164}}],"line":73},"36":{"loc":{"start":{"line":73,"column":28},"end":{"line":73,"column":157}},"type":"cond-expr","locations":[{"start":{"line":73,"column":134},"end":{"line":73,"column":140}},{"start":{"line":73,"column":143},"end":{"line":73,"column":157}}],"line":73},"37":{"loc":{"start":{"line":73,"column":28},"end":{"line":73,"column":131}},"type":"binary-expr","locations":[{"start":{"line":73,"column":28},"end":{"line":73,"column":114}},{"start":{"line":73,"column":118},"end":{"line":73,"column":131}}],"line":73},"38":{"loc":{"start":{"line":73,"column":34},"end":{"line":73,"column":104}},"type":"cond-expr","locations":[{"start":{"line":73,"column":78},"end":{"line":73,"column":84}},{"start":{"line":73,"column":87},"end":{"line":73,"column":104}}],"line":73},"39":{"loc":{"start":{"line":73,"column":34},"end":{"line":73,"column":75}},"type":"binary-expr","locations":[{"start":{"line":73,"column":34},"end":{"line":73,"column":58}},{"start":{"line":73,"column":62},"end":{"line":73,"column":75}}],"line":73},"40":{"loc":{"start":{"line":74,"column":4},"end":{"line":75,"column":31}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":75,"column":31}},{"start":{"line":74,"column":4},"end":{"line":75,"column":31}}],"line":74},"41":{"loc":{"start":{"line":83,"column":12},"end":{"line":84,"column":27}},"type":"if","locations":[{"start":{"line":83,"column":12},"end":{"line":84,"column":27}},{"start":{"line":83,"column":12},"end":{"line":84,"column":27}}],"line":83},"42":{"loc":{"start":{"line":115,"column":12},"end":{"line":116,"column":37}},"type":"if","locations":[{"start":{"line":115,"column":12},"end":{"line":116,"column":37}},{"start":{"line":115,"column":12},"end":{"line":116,"column":37}}],"line":115},"43":{"loc":{"start":{"line":123,"column":12},"end":{"line":124,"column":26}},"type":"if","locations":[{"start":{"line":123,"column":12},"end":{"line":124,"column":26}},{"start":{"line":123,"column":12},"end":{"line":124,"column":26}}],"line":123},"44":{"loc":{"start":{"line":135,"column":12},"end":{"line":141,"column":18}},"type":"if","locations":[{"start":{"line":135,"column":12},"end":{"line":141,"column":18}},{"start":{"line":135,"column":12},"end":{"line":141,"column":18}}],"line":135},"45":{"loc":{"start":{"line":166,"column":12},"end":{"line":167,"column":23}},"type":"if","locations":[{"start":{"line":166,"column":12},"end":{"line":167,"column":23}},{"start":{"line":166,"column":12},"end":{"line":167,"column":23}}],"line":166},"46":{"loc":{"start":{"line":168,"column":40},"end":{"line":168,"column":92}},"type":"binary-expr","locations":[{"start":{"line":168,"column":41},"end":{"line":168,"column":55}},{"start":{"line":168,"column":59},"end":{"line":168,"column":85}},{"start":{"line":168,"column":90},"end":{"line":168,"column":92}}],"line":168}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":66,"36":31,"37":36,"38":66,"39":66,"40":0,"41":0,"42":0,"43":0,"44":102,"45":36,"46":1,"47":2,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":15,"57":7,"58":8,"59":8,"60":5,"61":3,"62":3,"63":5,"64":3,"65":9,"66":9,"67":12,"68":5,"69":7,"70":7,"71":7,"72":9,"73":3,"74":1,"75":143,"76":13,"77":10,"78":10,"79":6,"80":16,"81":16,"82":0,"83":16,"84":16,"85":13,"86":16,"87":0,"88":16,"89":10,"90":10,"91":10,"92":10,"93":10,"94":0,"95":10,"96":10,"97":10,"98":10,"99":10,"100":10,"101":10,"102":10,"103":10,"104":10,"105":10,"106":10,"107":0,"108":10,"109":10,"110":10,"111":1,"112":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":36,"8":66,"9":31,"10":36,"11":66,"12":0,"13":102,"14":2,"15":15,"16":5,"17":9,"18":12,"19":143,"20":13,"21":10,"22":16,"23":16,"24":13,"25":10,"26":10,"27":10,"28":10,"29":10,"30":10,"31":10},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[35,31],"28":[36,36],"29":[36,66],"30":[36,36],"31":[1,1,1],"32":[0,2],"33":[2,2],"34":[7,8],"35":[8,5],"36":[5,3],"37":[8,8],"38":[4,4],"39":[8,8],"40":[5,3],"41":[5,7],"42":[0,16],"43":[0,16],"44":[0,10],"45":[0,10],"46":[10,2,9]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/connections.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/connections.ts"],"names":[],"mappings":"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","sourcesContent":["import dotProp from 'dot-prop';\nimport _ from 'lodash';\nimport DefaultAPIHandler, { order } from './default';\nimport { filterExcluded, convertClientNameToId, getEnabledClients } from '../../utils';\nimport { CalculatedChanges, Asset, Assets } from '../../../types';\nimport { ConfigFunction } from '../../../configFactory';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      name: { type: 'string' },\n      strategy: { type: 'string' },\n      options: { type: 'object' },\n      enabled_clients: { type: 'array', items: { type: 'string' } },\n      realms: { type: 'array', items: { type: 'string' } },\n      metadata: { type: 'object' },\n    },\n    required: ['name', 'strategy'],\n  },\n};\n\n// addExcludedConnectionPropertiesToChanges superimposes excluded properties on the `options` object. The Auth0 API\n// will overwrite the options property when updating connections, so it is necessary to add excluded properties back in to prevent those excluded properties from being deleted.\n// This use case is common because organizations may not want to expose sensitive connection details, but want to preserve them in the tenant.\n// exported only for unit testing purposes\nexport const addExcludedConnectionPropertiesToChanges = ({\n  proposedChanges,\n  existingConnections,\n  config,\n}: {\n  proposedChanges: CalculatedChanges;\n  existingConnections: Asset[];\n  config: ConfigFunction;\n}) => {\n  if (proposedChanges.update.length === 0) return proposedChanges;\n\n  //@ts-ignore because this expects a parameter to be passed\n  const excludedFields = config()?.EXCLUDED_PROPS?.connections || [];\n  if (excludedFields.length === 0) return proposedChanges;\n\n  const existingConnectionsMap = _.keyBy(existingConnections, 'id');\n  const excludedOptions = excludedFields.filter(\n    // Only include fields that pertain to options\n    (excludedField) => excludedField.startsWith('options')\n  );\n\n  const newProposedUpdates = proposedChanges.update.map((proposedConnection) => {\n    const currConnection = existingConnectionsMap[proposedConnection.id];\n    const currentExcludedPropertyValues = excludedOptions.reduce(\n      (agg, excludedField) => {\n        if (!dotProp.has(currConnection, excludedField)) return agg;\n\n        const currentExcludedFieldValue = dotProp.get(currConnection, excludedField);\n\n        dotProp.set(agg, excludedField, currentExcludedFieldValue);\n        return agg;\n      },\n      {\n        options: {},\n      }\n    );\n\n    return {\n      ...proposedConnection,\n      options: {\n        ...proposedConnection.options,\n        ...currentExcludedPropertyValues.options,\n      },\n    };\n  });\n\n  return {\n    ...proposedChanges,\n    update: newProposedUpdates,\n  };\n};\n\nexport default class ConnectionsHandler extends DefaultAPIHandler {\n  existing: Asset[] | null;\n\n  constructor(config: DefaultAPIHandler) {\n    super({\n      ...config,\n      type: 'connections',\n      stripUpdateFields: ['strategy', 'name'],\n    });\n  }\n\n  objString(connection): string {\n    return super.objString({ name: connection.name, id: connection.id });\n  }\n\n  getFormattedOptions(connection, clients) {\n    try {\n      return {\n        options: {\n          ...connection.options,\n          idpinitiated: {\n            ...connection.options.idpinitiated,\n            client_id: convertClientNameToId(connection.options.idpinitiated.client_id, clients),\n          },\n        },\n      };\n    } catch (e) {\n      return {};\n    }\n  }\n\n  async getType(): Promise<Asset[] | null> {\n    if (this.existing) return this.existing;\n    const connections: Asset[] = await this.client.connections.getAll({\n      paginate: true,\n      include_totals: true,\n    });\n    // Filter out database connections\n    this.existing = connections.filter((c) => c.strategy !== 'auth0');\n    if (this.existing === null) return [];\n    return this.existing;\n  }\n\n  async calcChanges(assets: Assets): Promise<CalculatedChanges> {\n    const { connections } = assets;\n\n    // Do nothing if not set\n    if (!connections)\n      return {\n        del: [],\n        create: [],\n        update: [],\n        conflicts: [],\n      };\n\n    // Convert enabled_clients by name to the id\n    const clients = await this.client.clients.getAll({ paginate: true, include_totals: true });\n    const existingConnections = await this.client.connections.getAll({\n      paginate: true,\n      include_totals: true,\n    });\n    const formatted = connections.map((connection) => ({\n      ...connection,\n      ...this.getFormattedOptions(connection, clients),\n      enabled_clients: getEnabledClients(assets, connection, existingConnections, clients),\n    }));\n    const proposedChanges = await super.calcChanges({ ...assets, connections: formatted });\n\n    const proposedChangesWithExcludedProperties = addExcludedConnectionPropertiesToChanges({\n      proposedChanges,\n      existingConnections,\n      config: this.config,\n    });\n\n    return proposedChangesWithExcludedProperties;\n  }\n\n  // Run after clients are updated so we can convert all the enabled_clients names to id's\n  @order('60')\n  async processChanges(assets: Assets): Promise<void> {\n    const { connections } = assets;\n\n    // Do nothing if not set\n    if (!connections) return;\n\n    const excludedConnections = (assets.exclude && assets.exclude.connections) || [];\n\n    const changes = await this.calcChanges(assets);\n\n    await super.processChanges(assets, filterExcluded(changes, excludedConnections));\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"aabb9d96d3b65e78b9fad1f8344520b2521587be","contentHash":"d6aaead1678e90b912b69317ec36951859dad524f504509eb62d82e54505be33"},"/home/circleci/repo/src/tools/auth0/handlers/clients.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/clients.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":0},"end":{"line":26,"column":2}},"18":{"start":{"line":29,"column":8},"end":{"line":36,"column":18}},"19":{"start":{"line":39,"column":8},"end":{"line":39,"column":79}},"20":{"start":{"line":42,"column":23},"end":{"line":44,"column":10}},"21":{"start":{"line":43,"column":41},"end":{"line":43,"column":61}},"22":{"start":{"line":45,"column":8},"end":{"line":68,"column":11}},"23":{"start":{"line":46,"column":32},"end":{"line":46,"column":38}},"24":{"start":{"line":48,"column":12},"end":{"line":49,"column":23}},"25":{"start":{"line":49,"column":16},"end":{"line":49,"column":23}},"26":{"start":{"line":50,"column":36},"end":{"line":50,"column":84}},"27":{"start":{"line":51,"column":55},"end":{"line":51,"column":85}},"28":{"start":{"line":54,"column":34},"end":{"line":54,"column":70}},"29":{"start":{"line":55,"column":34},"end":{"line":60,"column":13}},"30":{"start":{"line":56,"column":16},"end":{"line":58,"column":17}},"31":{"start":{"line":57,"column":20},"end":{"line":57,"column":123}},"32":{"start":{"line":57,"column":49},"end":{"line":57,"column":121}},"33":{"start":{"line":59,"column":16},"end":{"line":59,"column":79}},"34":{"start":{"line":59,"column":45},"end":{"line":59,"column":77}},"35":{"start":{"line":61,"column":28},"end":{"line":66,"column":13}},"36":{"start":{"line":67,"column":12},"end":{"line":67,"column":87}},"37":{"start":{"line":71,"column":8},"end":{"line":80,"column":11}},"38":{"start":{"line":72,"column":12},"end":{"line":73,"column":37}},"39":{"start":{"line":73,"column":16},"end":{"line":73,"column":37}},"40":{"start":{"line":74,"column":12},"end":{"line":78,"column":15}},"41":{"start":{"line":79,"column":12},"end":{"line":79,"column":33}},"42":{"start":{"line":83,"column":0},"end":{"line":83,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":28,"column":4},"end":{"line":28,"column":5}},"loc":{"start":{"line":28,"column":24},"end":{"line":37,"column":5}},"line":28},"9":{"name":"(anonymous_9)","decl":{"start":{"line":38,"column":4},"end":{"line":38,"column":5}},"loc":{"start":{"line":38,"column":20},"end":{"line":40,"column":5}},"line":38},"10":{"name":"(anonymous_10)","decl":{"start":{"line":41,"column":4},"end":{"line":41,"column":5}},"loc":{"start":{"line":41,"column":27},"end":{"line":69,"column":5}},"line":41},"11":{"name":"(anonymous_11)","decl":{"start":{"line":43,"column":35},"end":{"line":43,"column":36}},"loc":{"start":{"line":43,"column":41},"end":{"line":43,"column":61}},"line":43},"12":{"name":"(anonymous_12)","decl":{"start":{"line":45,"column":47},"end":{"line":45,"column":48}},"loc":{"start":{"line":45,"column":60},"end":{"line":68,"column":9}},"line":45},"13":{"name":"(anonymous_13)","decl":{"start":{"line":55,"column":34},"end":{"line":55,"column":35}},"loc":{"start":{"line":55,"column":44},"end":{"line":60,"column":13}},"line":55},"14":{"name":"(anonymous_14)","decl":{"start":{"line":57,"column":39},"end":{"line":57,"column":40}},"loc":{"start":{"line":57,"column":49},"end":{"line":57,"column":121}},"line":57},"15":{"name":"(anonymous_15)","decl":{"start":{"line":59,"column":35},"end":{"line":59,"column":36}},"loc":{"start":{"line":59,"column":45},"end":{"line":59,"column":77}},"line":59},"16":{"name":"(anonymous_16)","decl":{"start":{"line":70,"column":4},"end":{"line":70,"column":5}},"loc":{"start":{"line":70,"column":14},"end":{"line":81,"column":5}},"line":70},"17":{"name":"(anonymous_17)","decl":{"start":{"line":71,"column":47},"end":{"line":71,"column":48}},"loc":{"start":{"line":71,"column":60},"end":{"line":80,"column":9}},"line":71}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":48,"column":12},"end":{"line":49,"column":23}},"type":"if","locations":[{"start":{"line":48,"column":12},"end":{"line":49,"column":23}},{"start":{"line":48,"column":12},"end":{"line":49,"column":23}}],"line":48},"9":{"loc":{"start":{"line":50,"column":36},"end":{"line":50,"column":84}},"type":"binary-expr","locations":[{"start":{"line":50,"column":37},"end":{"line":50,"column":51}},{"start":{"line":50,"column":55},"end":{"line":50,"column":77}},{"start":{"line":50,"column":82},"end":{"line":50,"column":84}}],"line":50},"10":{"loc":{"start":{"line":54,"column":34},"end":{"line":54,"column":70}},"type":"binary-expr","locations":[{"start":{"line":54,"column":34},"end":{"line":54,"column":64}},{"start":{"line":54,"column":68},"end":{"line":54,"column":70}}],"line":54},"11":{"loc":{"start":{"line":56,"column":16},"end":{"line":58,"column":17}},"type":"if","locations":[{"start":{"line":56,"column":16},"end":{"line":58,"column":17}},{"start":{"line":56,"column":16},"end":{"line":58,"column":17}}],"line":56},"12":{"loc":{"start":{"line":57,"column":49},"end":{"line":57,"column":121}},"type":"binary-expr","locations":[{"start":{"line":57,"column":49},"end":{"line":57,"column":81}},{"start":{"line":57,"column":85},"end":{"line":57,"column":121}}],"line":57},"13":{"loc":{"start":{"line":72,"column":12},"end":{"line":73,"column":37}},"type":"if","locations":[{"start":{"line":72,"column":12},"end":{"line":73,"column":37}},{"start":{"line":72,"column":12},"end":{"line":73,"column":37}}],"line":72}},"s":{"0":1,"1":29,"2":8,"3":21,"4":29,"5":29,"6":0,"7":0,"8":0,"9":0,"10":50,"11":21,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":141,"19":12,"20":8,"21":8,"22":8,"23":8,"24":8,"25":0,"26":8,"27":8,"28":8,"29":8,"30":32,"31":4,"32":2,"33":28,"34":14,"35":8,"36":8,"37":13,"38":13,"39":0,"40":13,"41":13,"42":1},"f":{"0":21,"1":29,"2":8,"3":21,"4":29,"5":0,"6":50,"7":1,"8":141,"9":12,"10":8,"11":8,"12":8,"13":32,"14":2,"15":14,"16":13,"17":13},"b":{"0":[1,1,1],"1":[21,8],"2":[21,21],"3":[21,29],"4":[21,21],"5":[1,1,1],"6":[1,0],"7":[1,1],"8":[0,8],"9":[8,1,7],"10":[8,2],"11":[4,28],"12":[2,2],"13":[0,13]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/clients.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/clients.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AACA,wDAA0C;AAE7B,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,OAAO;IACb,KAAK,EAAE;QACL,IAAI,EAAE,QAAQ;QACd,UAAU,EAAE;YACV,IAAI,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAE,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE;SAC1D;QACD,QAAQ,EAAE,CAAC,MAAM,CAAC;KACnB;CACF,CAAC;AASF,MAAqB,aAAc,SAAQ,iBAAiB;IAG1D,YAAY,MAAyB;QACnC,KAAK,iCACA,MAAM,KACT,IAAI,EAAE,SAAS,EACf,EAAE,EAAE,WAAW,EACf,WAAW,EAAE,CAAC,WAAW,EAAE,MAAM,CAAC,EAClC,YAAY,EAAE,CAAC,iBAAiB,CAAC,EACjC,iBAAiB,EAAE;gBACjB,oCAAoC;gBACpC,uBAAuB;gBACvB,cAAc;gBACd,QAAQ;gBACR,QAAQ;gBACR,kCAAkC;aACnC,IACD,CAAC;IACL,CAAC;IAED,SAAS,CAAC,IAAI;QACZ,OAAO,KAAK,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC;IACzE,CAAC;IAEK,cAAc,CAAC,MAAc;;;;;YACjC,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAC;YAE3B,wBAAwB;YACxB,IAAI,CAAC,OAAO;gBAAE,OAAO;YAErB,MAAM,eAAe,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;YAEzE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;YAE1E,2EAA2E;YAC3E,+DAA+D;YAC/D,MAAM,aAAa,GAAG,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC;YAE3D,MAAM,aAAa,GAAG,CAAC,IAAI,EAAE,EAAE;gBAC7B,IAAI,eAAe,CAAC,MAAM,EAAE;oBAC1B,OAAO,IAAI,CAAC,MAAM,CAChB,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,SAAS,KAAK,aAAa,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CACnF,CAAC;iBACH;gBAED,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,SAAS,KAAK,aAAa,CAAC,CAAC;YACjE,CAAC,CAAC;YAEF,MAAM,OAAO,GAAG;gBACd,GAAG,EAAE,aAAa,CAAC,GAAG,CAAC;gBACvB,MAAM,EAAE,aAAa,CAAC,MAAM,CAAC;gBAC7B,MAAM,EAAE,aAAa,CAAC,MAAM,CAAC;gBAC7B,SAAS,EAAE,aAAa,CAAC,SAAS,CAAC;aACpC,CAAC;YAEF,MAAM,OAAM,cAAc,YAAC,MAAM,oBAC5B,OAAO,EACV,CAAC;QACL,CAAC;KAAA;IAEK,OAAO;;YACX,IAAI,IAAI,CAAC,QAAQ;gBAAE,OAAO,IAAI,CAAC,QAAQ,CAAC;YACxC,IAAI,CAAC,QAAQ,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC;gBAC/C,QAAQ,EAAE,IAAI;gBACd,cAAc,EAAE,IAAI;gBACpB,SAAS,EAAE,KAAK;aACjB,CAAC,CAAC;YACH,OAAO,IAAI,CAAC,QAAQ,CAAC;QACvB,CAAC;KAAA;CACF;AAtED,gCAsEC","sourcesContent":["import { Asset, Assets } from '../../../types';\nimport DefaultAPIHandler from './default';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      name: { type: 'string', minLength: 1, pattern: '[^<>]+' },\n    },\n    required: ['name'],\n  },\n};\n\nexport type Client = {\n  client_id: string;\n  name: string;\n  custom_login_page?: string;\n  custom_login_page_on?: boolean;\n};\n\nexport default class ClientHandler extends DefaultAPIHandler {\n  existing: Asset[] | null;\n\n  constructor(config: DefaultAPIHandler) {\n    super({\n      ...config,\n      type: 'clients',\n      id: 'client_id',\n      identifiers: ['client_id', 'name'],\n      objectFields: ['client_metadata'],\n      stripUpdateFields: [\n        // Fields not allowed during updates\n        'callback_url_template',\n        'signing_keys',\n        'global',\n        'tenant',\n        'jwt_configuration.secret_encoded',\n      ],\n    });\n  }\n\n  objString(item): string {\n    return super.objString({ name: item.name, client_id: item.client_id });\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    const { clients } = assets;\n\n    // Do nothing if not set\n    if (!clients) return;\n\n    const excludedClients = (assets.exclude && assets.exclude.clients) || [];\n\n    const { del, update, create, conflicts } = await this.calcChanges(assets);\n\n    // Always filter out the client we are using to access Auth0 Management API\n    // As it could cause problems if it gets deleted or updated etc\n    const currentClient = this.config('AUTH0_CLIENT_ID') || '';\n\n    const filterClients = (list) => {\n      if (excludedClients.length) {\n        return list.filter(\n          (item) => item.client_id !== currentClient && !excludedClients.includes(item.name)\n        );\n      }\n\n      return list.filter((item) => item.client_id !== currentClient);\n    };\n\n    const changes = {\n      del: filterClients(del),\n      update: filterClients(update),\n      create: filterClients(create),\n      conflicts: filterClients(conflicts),\n    };\n\n    await super.processChanges(assets, {\n      ...changes,\n    });\n  }\n\n  async getType() {\n    if (this.existing) return this.existing;\n    this.existing = await this.client.clients.getAll({\n      paginate: true,\n      include_totals: true,\n      is_global: false,\n    });\n    return this.existing;\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"316473578cc2b7482b22da500cca3f2383fa5036","contentHash":"3de27c5435d59ea8d701d2f83371092af8629b18435f12e39eae307005848ba4"},"/home/circleci/repo/src/tools/auth0/handlers/tenant.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/tenant.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":90}},"50":{"start":{"line":45,"column":26},"end":{"line":45,"column":75}},"51":{"start":{"line":46,"column":18},"end":{"line":46,"column":52}},"52":{"start":{"line":47,"column":16},"end":{"line":47,"column":34}},"53":{"start":{"line":48,"column":16},"end":{"line":48,"column":38}},"54":{"start":{"line":49,"column":17},"end":{"line":49,"column":60}},"55":{"start":{"line":50,"column":0},"end":{"line":52,"column":2}},"56":{"start":{"line":53,"column":22},"end":{"line":57,"column":1}},"57":{"start":{"line":60,"column":8},"end":{"line":60,"column":77}},"58":{"start":{"line":63,"column":8},"end":{"line":72,"column":11}},"59":{"start":{"line":64,"column":27},"end":{"line":64,"column":65}},"60":{"start":{"line":65,"column":12},"end":{"line":65,"column":81}},"61":{"start":{"line":66,"column":12},"end":{"line":66,"column":35}},"62":{"start":{"line":67,"column":12},"end":{"line":70,"column":15}},"63":{"start":{"line":68,"column":16},"end":{"line":69,"column":39}},"64":{"start":{"line":69,"column":20},"end":{"line":69,"column":39}},"65":{"start":{"line":71,"column":12},"end":{"line":71,"column":26}},"66":{"start":{"line":75,"column":8},"end":{"line":84,"column":11}},"67":{"start":{"line":76,"column":31},"end":{"line":76,"column":37}},"68":{"start":{"line":78,"column":12},"end":{"line":79,"column":23}},"69":{"start":{"line":79,"column":16},"end":{"line":79,"column":23}},"70":{"start":{"line":80,"column":29},"end":{"line":80,"column":89}},"71":{"start":{"line":80,"column":63},"end":{"line":80,"column":88}},"72":{"start":{"line":81,"column":12},"end":{"line":83,"column":13}},"73":{"start":{"line":82,"column":16},"end":{"line":82,"column":219}},"74":{"start":{"line":88,"column":8},"end":{"line":105,"column":11}},"75":{"start":{"line":89,"column":31},"end":{"line":89,"column":37}},"76":{"start":{"line":91,"column":12},"end":{"line":92,"column":23}},"77":{"start":{"line":92,"column":16},"end":{"line":92,"column":23}},"78":{"start":{"line":93,"column":34},"end":{"line":93,"column":59}},"79":{"start":{"line":94,"column":12},"end":{"line":99,"column":13}},"80":{"start":{"line":95,"column":16},"end":{"line":95,"column":92}},"81":{"start":{"line":96,"column":16},"end":{"line":98,"column":17}},"82":{"start":{"line":97,"column":20},"end":{"line":97,"column":47}},"83":{"start":{"line":100,"column":12},"end":{"line":104,"column":13}},"84":{"start":{"line":101,"column":16},"end":{"line":101,"column":71}},"85":{"start":{"line":102,"column":16},"end":{"line":102,"column":34}},"86":{"start":{"line":103,"column":16},"end":{"line":103,"column":46}},"87":{"start":{"line":108,"column":0},"end":{"line":110,"column":52}},"88":{"start":{"line":111,"column":0},"end":{"line":111,"column":32}},"89":{"start":{"line":120,"column":0},"end":{"line":146,"column":2}},"90":{"start":{"line":147,"column":35},"end":{"line":164,"column":1}},"91":{"start":{"line":148,"column":4},"end":{"line":149,"column":18}},"92":{"start":{"line":149,"column":8},"end":{"line":149,"column":18}},"93":{"start":{"line":150,"column":25},"end":{"line":150,"column":27}},"94":{"start":{"line":151,"column":26},"end":{"line":158,"column":10}},"95":{"start":{"line":152,"column":30},"end":{"line":152,"column":78}},"96":{"start":{"line":153,"column":8},"end":{"line":156,"column":9}},"97":{"start":{"line":154,"column":12},"end":{"line":154,"column":43}},"98":{"start":{"line":155,"column":12},"end":{"line":155,"column":23}},"99":{"start":{"line":157,"column":8},"end":{"line":157,"column":100}},"100":{"start":{"line":159,"column":4},"end":{"line":162,"column":5}},"101":{"start":{"line":160,"column":8},"end":{"line":161,"column":195}},"102":{"start":{"line":163,"column":4},"end":{"line":163,"column":25}},"103":{"start":{"line":165,"column":0},"end":{"line":165,"column":64}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"(anonymous_15)","decl":{"start":{"line":59,"column":4},"end":{"line":59,"column":5}},"loc":{"start":{"line":59,"column":25},"end":{"line":61,"column":5}},"line":59},"16":{"name":"(anonymous_16)","decl":{"start":{"line":62,"column":4},"end":{"line":62,"column":5}},"loc":{"start":{"line":62,"column":14},"end":{"line":73,"column":5}},"line":62},"17":{"name":"(anonymous_17)","decl":{"start":{"line":63,"column":47},"end":{"line":63,"column":48}},"loc":{"start":{"line":63,"column":60},"end":{"line":72,"column":9}},"line":63},"18":{"name":"(anonymous_18)","decl":{"start":{"line":67,"column":34},"end":{"line":67,"column":35}},"loc":{"start":{"line":67,"column":43},"end":{"line":70,"column":13}},"line":67},"19":{"name":"(anonymous_19)","decl":{"start":{"line":74,"column":4},"end":{"line":74,"column":5}},"loc":{"start":{"line":74,"column":21},"end":{"line":85,"column":5}},"line":74},"20":{"name":"(anonymous_20)","decl":{"start":{"line":75,"column":47},"end":{"line":75,"column":48}},"loc":{"start":{"line":75,"column":60},"end":{"line":84,"column":9}},"line":75},"21":{"name":"(anonymous_21)","decl":{"start":{"line":80,"column":56},"end":{"line":80,"column":57}},"loc":{"start":{"line":80,"column":63},"end":{"line":80,"column":88}},"line":80},"22":{"name":"(anonymous_22)","decl":{"start":{"line":87,"column":4},"end":{"line":87,"column":5}},"loc":{"start":{"line":87,"column":27},"end":{"line":106,"column":5}},"line":87},"23":{"name":"(anonymous_23)","decl":{"start":{"line":88,"column":47},"end":{"line":88,"column":48}},"loc":{"start":{"line":88,"column":60},"end":{"line":105,"column":9}},"line":88},"24":{"name":"(anonymous_24)","decl":{"start":{"line":147,"column":35},"end":{"line":147,"column":36}},"loc":{"start":{"line":147,"column":54},"end":{"line":164,"column":1}},"line":147},"25":{"name":"(anonymous_25)","decl":{"start":{"line":151,"column":60},"end":{"line":151,"column":61}},"loc":{"start":{"line":151,"column":82},"end":{"line":158,"column":5}},"line":151}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":68,"column":16},"end":{"line":69,"column":39}},"type":"if","locations":[{"start":{"line":68,"column":16},"end":{"line":69,"column":39}},{"start":{"line":68,"column":16},"end":{"line":69,"column":39}}],"line":68},"35":{"loc":{"start":{"line":78,"column":12},"end":{"line":79,"column":23}},"type":"if","locations":[{"start":{"line":78,"column":12},"end":{"line":79,"column":23}},{"start":{"line":78,"column":12},"end":{"line":79,"column":23}}],"line":78},"36":{"loc":{"start":{"line":81,"column":12},"end":{"line":83,"column":13}},"type":"if","locations":[{"start":{"line":81,"column":12},"end":{"line":83,"column":13}},{"start":{"line":81,"column":12},"end":{"line":83,"column":13}}],"line":81},"37":{"loc":{"start":{"line":91,"column":12},"end":{"line":92,"column":23}},"type":"if","locations":[{"start":{"line":91,"column":12},"end":{"line":92,"column":23}},{"start":{"line":91,"column":12},"end":{"line":92,"column":23}}],"line":91},"38":{"loc":{"start":{"line":94,"column":12},"end":{"line":99,"column":13}},"type":"if","locations":[{"start":{"line":94,"column":12},"end":{"line":99,"column":13}},{"start":{"line":94,"column":12},"end":{"line":99,"column":13}}],"line":94},"39":{"loc":{"start":{"line":96,"column":16},"end":{"line":98,"column":17}},"type":"if","locations":[{"start":{"line":96,"column":16},"end":{"line":98,"column":17}},{"start":{"line":96,"column":16},"end":{"line":98,"column":17}}],"line":96},"40":{"loc":{"start":{"line":100,"column":12},"end":{"line":104,"column":13}},"type":"if","locations":[{"start":{"line":100,"column":12},"end":{"line":104,"column":13}},{"start":{"line":100,"column":12},"end":{"line":104,"column":13}}],"line":100},"41":{"loc":{"start":{"line":100,"column":16},"end":{"line":100,"column":70}},"type":"binary-expr","locations":[{"start":{"line":100,"column":16},"end":{"line":100,"column":29}},{"start":{"line":100,"column":33},"end":{"line":100,"column":70}}],"line":100},"42":{"loc":{"start":{"line":148,"column":4},"end":{"line":149,"column":18}},"type":"if","locations":[{"start":{"line":148,"column":4},"end":{"line":149,"column":18}},{"start":{"line":148,"column":4},"end":{"line":149,"column":18}}],"line":148},"43":{"loc":{"start":{"line":153,"column":8},"end":{"line":156,"column":9}},"type":"if","locations":[{"start":{"line":153,"column":8},"end":{"line":156,"column":9}},{"start":{"line":153,"column":8},"end":{"line":156,"column":9}}],"line":153},"44":{"loc":{"start":{"line":159,"column":4},"end":{"line":162,"column":5}},"type":"if","locations":[{"start":{"line":159,"column":4},"end":{"line":162,"column":5}},{"start":{"line":159,"column":4},"end":{"line":162,"column":5}}],"line":159},"45":{"loc":{"start":{"line":160,"column":58},"end":{"line":160,"column":119}},"type":"cond-expr","locations":[{"start":{"line":160,"column":84},"end":{"line":160,"column":101}},{"start":{"line":160,"column":104},"end":{"line":160,"column":119}}],"line":160},"46":{"loc":{"start":{"line":161,"column":8},"end":{"line":161,"column":61}},"type":"cond-expr","locations":[{"start":{"line":161,"column":34},"end":{"line":161,"column":47}},{"start":{"line":161,"column":50},"end":{"line":161,"column":61}}],"line":161}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":9,"36":1,"37":83,"38":9,"39":9,"40":0,"41":0,"42":0,"43":0,"44":91,"45":83,"46":1,"47":2,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":135,"58":7,"59":7,"60":7,"61":7,"62":7,"63":70,"64":0,"65":7,"66":73,"67":73,"68":73,"69":68,"70":5,"71":11,"72":5,"73":1,"74":3,"75":3,"76":3,"77":0,"78":3,"79":3,"80":2,"81":2,"82":1,"83":3,"84":2,"85":2,"86":2,"87":1,"88":1,"89":1,"90":1,"91":12,"92":6,"93":6,"94":6,"95":84,"96":84,"97":7,"98":7,"99":77,"100":6,"101":4,"102":6,"103":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":83,"8":9,"9":1,"10":83,"11":9,"12":0,"13":91,"14":2,"15":135,"16":7,"17":7,"18":70,"19":73,"20":73,"21":11,"22":3,"23":3,"24":12,"25":84},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[8,1],"28":[83,83],"29":[82,9],"30":[83,83],"31":[1,1,1],"32":[2,0],"33":[2,2],"34":[0,70],"35":[68,5],"36":[1,4],"37":[0,3],"38":[2,1],"39":[1,1],"40":[2,1],"41":[3,3],"42":[6,6],"43":[7,77],"44":[4,2],"45":[3,1],"46":[3,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/tenant.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/tenant.ts"],"names":[],"mappings":"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","sourcesContent":["import ValidationError from '../../validationError';\n\nimport DefaultHandler, { order } from './default';\nimport { supportedPages, pageNameMap } from './pages';\nimport { convertJsonToString } from '../../utils';\nimport { Asset, Assets, Language } from '../../../types';\nimport log from '../../../logger';\n\nexport const schema = {\n  type: 'object',\n};\n\nexport type Tenant = Asset & { enabled_locales?: Language[]; flags: { [key: string]: boolean } };\n\nconst blockPageKeys = [\n  ...Object.keys(pageNameMap),\n  ...Object.values(pageNameMap),\n  ...supportedPages,\n];\n\nexport default class TenantHandler extends DefaultHandler {\n  existing: Tenant;\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'tenant',\n    });\n  }\n\n  async getType(): Promise<Asset> {\n    const tenant = await this.client.tenant.getSettings();\n\n    tenant.flags = removeUnallowedTenantFlags(tenant.flags);\n\n    this.existing = tenant;\n\n    blockPageKeys.forEach((key) => {\n      if (tenant[key]) delete tenant[key];\n    });\n\n    return tenant;\n  }\n\n  async validate(assets: Assets): Promise<void> {\n    const { tenant } = assets;\n\n    // Nothing to validate?\n    if (!tenant) return;\n\n    const pageKeys = Object.keys(tenant).filter((k) => blockPageKeys.includes(k));\n    if (pageKeys.length > 0) {\n      throw new ValidationError(\n        `The following pages ${convertJsonToString(\n          pageKeys\n        )} were found in tenant settings. Pages should be set separately. Please refer to the documentation.`\n      );\n    }\n  }\n\n  // Run after other updates so objected can be referenced such as default directory\n  @order('100')\n  async processChanges(assets: Assets): Promise<void> {\n    const { tenant } = assets;\n\n    // Do nothing if not set\n    if (!tenant) return;\n\n    const updatedTenant: Partial<Tenant> = {\n      ...tenant,\n    };\n\n    if ('flags' in updatedTenant) {\n      updatedTenant.flags = removeUnallowedTenantFlags(tenant.flags);\n      if (Object.keys(updatedTenant.flags).length === 0) {\n        delete updatedTenant.flags;\n      }\n    }\n\n    if (updatedTenant && Object.keys(updatedTenant).length > 0) {\n      await this.client.tenant.updateSettings(updatedTenant);\n      this.updated += 1;\n      this.didUpdate(updatedTenant);\n    }\n  }\n}\n\n/*\n Tenant flags are used to facilitate a number of functionalities, some\n public, some internal. The subset of flags that are allowed to be updated \n in the context of the Deploy CLI is based on wether they're publicly exposed\n in the Auth0 API docs:\n\n https://auth0.com/docs/api/management/v2#!/Tenants/patch_settings\n*/\nexport const allowedTenantFlags = [\n  'change_pwd_flow_v1',\n  'enable_client_connections',\n  'enable_apis_section',\n  'enable_pipeline2',\n  'enable_dynamic_client_registration',\n  'enable_custom_domain_in_emails',\n  'allow_legacy_tokeninfo_endpoint',\n  'enable_legacy_profile',\n  'enable_idtoken_api2',\n  'enable_public_signup_user_exists_error',\n  'allow_legacy_delegation_grant_types',\n  'allow_legacy_ro_grant_types',\n  'enable_sso',\n  'disable_clickjack_protection_headers',\n  'no_disclose_enterprise_connections',\n  'disable_management_api_sms_obfuscation',\n  'enforce_client_authentication_on_passwordless_start',\n  'trust_azure_adfs_email_verified_connection_property',\n  'enable_adfs_waad_email_verification',\n  'revoke_refresh_token_grant',\n  'dashboard_log_streams_next',\n  'dashboard_insights_view',\n  'disable_fields_map_fix',\n  'require_pushed_authorization_requests',\n  'mfa_show_factor_list_on_enrollment',\n];\n\nexport const removeUnallowedTenantFlags = (\n  proposedFlags: Tenant['flags'] | undefined\n): Tenant['flags'] => {\n  if (proposedFlags === undefined) return {};\n\n  const removedFlags: string[] = [];\n  const filteredFlags = Object.keys(proposedFlags).reduce(\n    (acc: Tenant['flags'], proposedKey: string): Tenant['flags'] => {\n      const isAllowedFlag = allowedTenantFlags.includes(proposedKey);\n      if (!isAllowedFlag) {\n        removedFlags.push(proposedKey);\n        return acc;\n      }\n      return {\n        ...acc,\n        [proposedKey]: proposedFlags[proposedKey],\n      };\n    },\n    {}\n  );\n\n  if (removedFlags.length > 0) {\n    log.warn(\n      `The following tenant flag${\n        removedFlags.length > 1 ? 's have not been' : ' has not been'\n      } updated because deemed incompatible with the target tenant: ${removedFlags.join(', ')}\n      ${\n        removedFlags.length > 1 ? 'These flags' : 'This flag'\n      } can likely be removed from the tenant definition file. If you believe this removal is an error, please report via a Github issue.`\n    );\n  }\n\n  return filteredFlags;\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ea42e54ad9401e0b4abe9289b69db2a513cf8592","contentHash":"9c54fd948dfb4de5ea1f78bde9583fdf4a1c7a9b8974c16035ca4987d8b37ea1"},"/home/circleci/repo/src/tools/auth0/handlers/emailProvider.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/emailProvider.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":0},"end":{"line":17,"column":36}},"18":{"start":{"line":19,"column":22},"end":{"line":19,"column":92}},"19":{"start":{"line":22,"column":8},"end":{"line":22,"column":84}},"20":{"start":{"line":25,"column":8},"end":{"line":34,"column":11}},"21":{"start":{"line":26,"column":12},"end":{"line":33,"column":13}},"22":{"start":{"line":27,"column":16},"end":{"line":27,"column":108}},"23":{"start":{"line":30,"column":16},"end":{"line":31,"column":30}},"24":{"start":{"line":31,"column":20},"end":{"line":31,"column":30}},"25":{"start":{"line":32,"column":16},"end":{"line":32,"column":26}},"26":{"start":{"line":37,"column":8},"end":{"line":37,"column":83}},"27":{"start":{"line":40,"column":8},"end":{"line":72,"column":11}},"28":{"start":{"line":41,"column":38},"end":{"line":41,"column":44}},"29":{"start":{"line":42,"column":12},"end":{"line":43,"column":23}},"30":{"start":{"line":43,"column":16},"end":{"line":43,"column":23}},"31":{"start":{"line":44,"column":27},"end":{"line":44,"column":47}},"32":{"start":{"line":45,"column":12},"end":{"line":51,"column":13}},"33":{"start":{"line":46,"column":16},"end":{"line":49,"column":17}},"34":{"start":{"line":47,"column":20},"end":{"line":47,"column":61}},"35":{"start":{"line":48,"column":20},"end":{"line":48,"column":45}},"36":{"start":{"line":50,"column":16},"end":{"line":50,"column":23}},"37":{"start":{"line":52,"column":12},"end":{"line":59,"column":13}},"38":{"start":{"line":53,"column":16},"end":{"line":58,"column":17}},"39":{"start":{"line":55,"column":20},"end":{"line":55,"column":61}},"40":{"start":{"line":56,"column":20},"end":{"line":56,"column":45}},"41":{"start":{"line":57,"column":20},"end":{"line":57,"column":34}},"42":{"start":{"line":60,"column":12},"end":{"line":71,"column":13}},"43":{"start":{"line":61,"column":33},"end":{"line":61,"column":93}},"44":{"start":{"line":62,"column":32},"end":{"line":62,"column":95}},"45":{"start":{"line":63,"column":16},"end":{"line":63,"column":34}},"46":{"start":{"line":64,"column":16},"end":{"line":64,"column":40}},"47":{"start":{"line":67,"column":33},"end":{"line":67,"column":93}},"48":{"start":{"line":68,"column":32},"end":{"line":68,"column":98}},"49":{"start":{"line":69,"column":16},"end":{"line":69,"column":34}},"50":{"start":{"line":70,"column":16},"end":{"line":70,"column":40}},"51":{"start":{"line":75,"column":0},"end":{"line":75,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":21,"column":4},"end":{"line":21,"column":5}},"loc":{"start":{"line":21,"column":25},"end":{"line":23,"column":5}},"line":21},"9":{"name":"(anonymous_9)","decl":{"start":{"line":24,"column":4},"end":{"line":24,"column":5}},"loc":{"start":{"line":24,"column":14},"end":{"line":35,"column":5}},"line":24},"10":{"name":"(anonymous_10)","decl":{"start":{"line":25,"column":47},"end":{"line":25,"column":48}},"loc":{"start":{"line":25,"column":60},"end":{"line":34,"column":9}},"line":25},"11":{"name":"(anonymous_11)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":24},"end":{"line":38,"column":5}},"line":36},"12":{"name":"(anonymous_12)","decl":{"start":{"line":39,"column":4},"end":{"line":39,"column":5}},"loc":{"start":{"line":39,"column":27},"end":{"line":73,"column":5}},"line":39},"13":{"name":"(anonymous_13)","decl":{"start":{"line":40,"column":47},"end":{"line":40,"column":48}},"loc":{"start":{"line":40,"column":60},"end":{"line":72,"column":9}},"line":40}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":30,"column":16},"end":{"line":31,"column":30}},"type":"if","locations":[{"start":{"line":30,"column":16},"end":{"line":31,"column":30}},{"start":{"line":30,"column":16},"end":{"line":31,"column":30}}],"line":30},"9":{"loc":{"start":{"line":42,"column":12},"end":{"line":43,"column":23}},"type":"if","locations":[{"start":{"line":42,"column":12},"end":{"line":43,"column":23}},{"start":{"line":42,"column":12},"end":{"line":43,"column":23}}],"line":42},"10":{"loc":{"start":{"line":45,"column":12},"end":{"line":51,"column":13}},"type":"if","locations":[{"start":{"line":45,"column":12},"end":{"line":51,"column":13}},{"start":{"line":45,"column":12},"end":{"line":51,"column":13}}],"line":45},"11":{"loc":{"start":{"line":46,"column":16},"end":{"line":49,"column":17}},"type":"if","locations":[{"start":{"line":46,"column":16},"end":{"line":49,"column":17}},{"start":{"line":46,"column":16},"end":{"line":49,"column":17}}],"line":46},"12":{"loc":{"start":{"line":52,"column":12},"end":{"line":59,"column":13}},"type":"if","locations":[{"start":{"line":52,"column":12},"end":{"line":59,"column":13}},{"start":{"line":52,"column":12},"end":{"line":59,"column":13}}],"line":52},"13":{"loc":{"start":{"line":53,"column":16},"end":{"line":58,"column":17}},"type":"if","locations":[{"start":{"line":53,"column":16},"end":{"line":58,"column":17}},{"start":{"line":53,"column":16},"end":{"line":58,"column":17}}],"line":53},"14":{"loc":{"start":{"line":60,"column":12},"end":{"line":71,"column":13}},"type":"if","locations":[{"start":{"line":60,"column":12},"end":{"line":71,"column":13}},{"start":{"line":60,"column":12},"end":{"line":71,"column":13}}],"line":60}},"s":{"0":1,"1":20,"2":10,"3":15,"4":20,"5":20,"6":0,"7":0,"8":0,"9":0,"10":35,"11":15,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":136,"20":10,"21":10,"22":10,"23":0,"24":0,"25":0,"26":5,"27":5,"28":5,"29":5,"30":0,"31":5,"32":5,"33":2,"34":1,"35":1,"36":2,"37":3,"38":2,"39":1,"40":1,"41":1,"42":3,"43":1,"44":1,"45":1,"46":1,"47":2,"48":2,"49":2,"50":2,"51":1},"f":{"0":15,"1":20,"2":10,"3":15,"4":20,"5":0,"6":35,"7":1,"8":136,"9":10,"10":10,"11":5,"12":5,"13":5},"b":{"0":[1,1,1],"1":[10,10],"2":[15,15],"3":[15,20],"4":[15,15],"5":[1,1,1],"6":[1,0],"7":[1,1],"8":[0,0],"9":[0,5],"10":[2,3],"11":[1,1],"12":[2,1],"13":[1,1],"14":[1,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/emailProvider.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/emailProvider.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,wDAAuC;AAG1B,QAAA,MAAM,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC;AAEzC,yDAAyD;AACzD,MAAM,aAAa,GAAG,CAAC,MAAM,EAAE,SAAS,EAAE,aAAa,EAAE,UAAU,EAAE,sBAAsB,CAAC,CAAC;AAE7F,MAAqB,oBAAqB,SAAQ,iBAAc;IAC9D,YAAY,OAAuB;QACjC,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,eAAe,IACrB,CAAC;IACL,CAAC;IAEK,OAAO;;YACX,IAAI;gBACF,OAAO,MAAM,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,cAAc,EAAE,IAAI,EAAE,MAAM,EAAE,aAAa,EAAE,CAAC,CAAC;aAC7F;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,GAAG,CAAC,UAAU,KAAK,GAAG;oBAAE,OAAO,EAAE,CAAC;gBACtC,MAAM,GAAG,CAAC;aACX;QACH,CAAC;KAAA;IAED,SAAS,CAAC,QAAQ;QAChB,OAAO,KAAK,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,QAAQ,CAAC,IAAI,EAAE,OAAO,EAAE,QAAQ,CAAC,OAAO,EAAE,CAAC,CAAC;IAC7E,CAAC;IAEK,cAAc,CAAC,MAAc;;YACjC,MAAM,EAAE,aAAa,EAAE,GAAG,MAAM,CAAC;YAEjC,IAAI,CAAC,aAAa;gBAAE,OAAO;YAE3B,IAAI,QAAQ,GAAG,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC;YAEpC,IAAI,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC3C,IAAI,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC,KAAK,IAAI,EAAE;oBAC9C,MAAM,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC;oBACzC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;iBAC1B;gBACD,OAAO;aACR;YAED,IAAI,QAAQ,CAAC,IAAI,EAAE;gBACjB,IAAI,QAAQ,CAAC,IAAI,KAAK,aAAa,CAAC,IAAI,EAAE;oBACxC,gDAAgD;oBAChD,MAAM,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC;oBACzC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;oBACzB,QAAQ,GAAG,EAAE,CAAC;iBACf;aACF;YAED,IAAI,QAAQ,CAAC,IAAI,EAAE;gBACjB,MAAM,QAAQ,GAAG,EAAE,IAAI,EAAE,aAAa,CAAC,IAAI,EAAE,OAAO,EAAE,aAAa,CAAC,OAAO,EAAE,CAAC;gBAC9E,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;gBAChF,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;gBAClB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;aACzB;iBAAM;gBACL,MAAM,QAAQ,GAAG,EAAE,IAAI,EAAE,aAAa,CAAC,IAAI,EAAE,OAAO,EAAE,aAAa,CAAC,OAAO,EAAE,CAAC;gBAC9E,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;gBACnF,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;gBAClB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;aACzB;QACH,CAAC;KAAA;CACF;AAzDD,uCAyDC","sourcesContent":["import DefaultHandler from './default';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = { type: 'object' };\n\n// The Management API requires the fields to be specified\nconst defaultFields = ['name', 'enabled', 'credentials', 'settings', 'default_from_address'];\n\nexport default class EmailProviderHandler extends DefaultHandler {\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'emailProvider',\n    });\n  }\n\n  async getType(): Promise<Asset> {\n    try {\n      return await this.client.emailProvider.get({ include_fields: true, fields: defaultFields });\n    } catch (err) {\n      if (err.statusCode === 404) return {};\n      throw err;\n    }\n  }\n\n  objString(provider) {\n    return super.objString({ name: provider.name, enabled: provider.enabled });\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    const { emailProvider } = assets;\n\n    if (!emailProvider) return;\n\n    let existing = await this.getType();\n\n    if (Object.keys(emailProvider).length === 0) {\n      if (this.config('AUTH0_ALLOW_DELETE') === true) {\n        await this.client.emailProvider.delete();\n        this.didDelete(existing);\n      }\n      return;\n    }\n\n    if (existing.name) {\n      if (existing.name !== emailProvider.name) {\n        // Delete the current provider as it's different\n        await this.client.emailProvider.delete();\n        this.didDelete(existing);\n        existing = {};\n      }\n    }\n\n    if (existing.name) {\n      const provider = { name: emailProvider.name, enabled: emailProvider.enabled };\n      const updated = await this.client.emailProvider.update(provider, emailProvider);\n      this.updated += 1;\n      this.didUpdate(updated);\n    } else {\n      const provider = { name: emailProvider.name, enabled: emailProvider.enabled };\n      const created = await this.client.emailProvider.configure(provider, emailProvider);\n      this.created += 1;\n      this.didCreate(created);\n    }\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"16c05addbebd282fca12fdf62d4963e4ed849d6d","contentHash":"6f0977caf5418260d9ef87cd5eb5772f4e8ff4a329aa1d9afb857f53d8b6c0b8"},"/home/circleci/repo/src/tools/auth0/handlers/emailTemplates.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/emailTemplates.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":53}},"50":{"start":{"line":45,"column":18},"end":{"line":45,"column":52}},"51":{"start":{"line":46,"column":20},"end":{"line":46,"column":63}},"52":{"start":{"line":47,"column":0},"end":{"line":47,"column":141}},"53":{"start":{"line":47,"column":85},"end":{"line":47,"column":104}},"54":{"start":{"line":47,"column":117},"end":{"line":47,"column":139}},"55":{"start":{"line":48,"column":0},"end":{"line":58,"column":2}},"56":{"start":{"line":61,"column":8},"end":{"line":61,"column":112}},"57":{"start":{"line":64,"column":8},"end":{"line":79,"column":11}},"58":{"start":{"line":65,"column":35},"end":{"line":76,"column":16}},"59":{"start":{"line":65,"column":109},"end":{"line":76,"column":14}},"60":{"start":{"line":66,"column":16},"end":{"line":75,"column":17}},"61":{"start":{"line":67,"column":37},"end":{"line":67,"column":83}},"62":{"start":{"line":68,"column":20},"end":{"line":68,"column":36}},"63":{"start":{"line":72,"column":20},"end":{"line":74,"column":21}},"64":{"start":{"line":73,"column":24},"end":{"line":73,"column":34}},"65":{"start":{"line":77,"column":38},"end":{"line":77,"column":85}},"66":{"start":{"line":77,"column":74},"end":{"line":77,"column":84}},"67":{"start":{"line":78,"column":12},"end":{"line":78,"column":37}},"68":{"start":{"line":82,"column":8},"end":{"line":103,"column":11}},"69":{"start":{"line":83,"column":12},"end":{"line":102,"column":13}},"70":{"start":{"line":84,"column":40},"end":{"line":84,"column":59}},"71":{"start":{"line":85,"column":31},"end":{"line":85,"column":71}},"72":{"start":{"line":86,"column":32},"end":{"line":86,"column":94}},"73":{"start":{"line":87,"column":16},"end":{"line":87,"column":36}},"74":{"start":{"line":88,"column":16},"end":{"line":88,"column":40}},"75":{"start":{"line":89,"column":16},"end":{"line":89,"column":34}},"76":{"start":{"line":92,"column":16},"end":{"line":101,"column":17}},"77":{"start":{"line":94,"column":36},"end":{"line":94,"column":90}},"78":{"start":{"line":95,"column":20},"end":{"line":95,"column":40}},"79":{"start":{"line":96,"column":20},"end":{"line":96,"column":44}},"80":{"start":{"line":97,"column":20},"end":{"line":97,"column":38}},"81":{"start":{"line":100,"column":20},"end":{"line":100,"column":30}},"82":{"start":{"line":107,"column":8},"end":{"line":115,"column":11}},"83":{"start":{"line":108,"column":39},"end":{"line":108,"column":45}},"84":{"start":{"line":110,"column":12},"end":{"line":111,"column":23}},"85":{"start":{"line":111,"column":16},"end":{"line":111,"column":23}},"86":{"start":{"line":112,"column":12},"end":{"line":114,"column":17}},"87":{"start":{"line":112,"column":68},"end":{"line":114,"column":14}},"88":{"start":{"line":113,"column":16},"end":{"line":113,"column":57}},"89":{"start":{"line":118,"column":0},"end":{"line":120,"column":59}},"90":{"start":{"line":121,"column":0},"end":{"line":121,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"(anonymous_15)","decl":{"start":{"line":47,"column":78},"end":{"line":47,"column":79}},"loc":{"start":{"line":47,"column":85},"end":{"line":47,"column":104}},"line":47},"16":{"name":"(anonymous_16)","decl":{"start":{"line":47,"column":110},"end":{"line":47,"column":111}},"loc":{"start":{"line":47,"column":117},"end":{"line":47,"column":139}},"line":47},"17":{"name":"(anonymous_17)","decl":{"start":{"line":60,"column":4},"end":{"line":60,"column":5}},"loc":{"start":{"line":60,"column":25},"end":{"line":62,"column":5}},"line":60},"18":{"name":"(anonymous_18)","decl":{"start":{"line":63,"column":4},"end":{"line":63,"column":5}},"loc":{"start":{"line":63,"column":14},"end":{"line":80,"column":5}},"line":63},"19":{"name":"(anonymous_19)","decl":{"start":{"line":64,"column":47},"end":{"line":64,"column":48}},"loc":{"start":{"line":64,"column":60},"end":{"line":79,"column":9}},"line":64},"20":{"name":"(anonymous_20)","decl":{"start":{"line":65,"column":99},"end":{"line":65,"column":100}},"loc":{"start":{"line":65,"column":109},"end":{"line":76,"column":14}},"line":65},"21":{"name":"(anonymous_21)","decl":{"start":{"line":65,"column":141},"end":{"line":65,"column":142}},"loc":{"start":{"line":65,"column":154},"end":{"line":76,"column":13}},"line":65},"22":{"name":"(anonymous_22)","decl":{"start":{"line":77,"column":60},"end":{"line":77,"column":61}},"loc":{"start":{"line":77,"column":74},"end":{"line":77,"column":84}},"line":77},"23":{"name":"(anonymous_23)","decl":{"start":{"line":81,"column":4},"end":{"line":81,"column":5}},"loc":{"start":{"line":81,"column":34},"end":{"line":104,"column":5}},"line":81},"24":{"name":"(anonymous_24)","decl":{"start":{"line":82,"column":47},"end":{"line":82,"column":48}},"loc":{"start":{"line":82,"column":60},"end":{"line":103,"column":9}},"line":82},"25":{"name":"(anonymous_25)","decl":{"start":{"line":106,"column":4},"end":{"line":106,"column":5}},"loc":{"start":{"line":106,"column":27},"end":{"line":116,"column":5}},"line":106},"26":{"name":"(anonymous_26)","decl":{"start":{"line":107,"column":47},"end":{"line":107,"column":48}},"loc":{"start":{"line":107,"column":60},"end":{"line":115,"column":9}},"line":107},"27":{"name":"(anonymous_27)","decl":{"start":{"line":112,"column":49},"end":{"line":112,"column":50}},"loc":{"start":{"line":112,"column":68},"end":{"line":114,"column":14}},"line":112},"28":{"name":"(anonymous_28)","decl":{"start":{"line":112,"column":100},"end":{"line":112,"column":101}},"loc":{"start":{"line":112,"column":113},"end":{"line":114,"column":13}},"line":112}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":72,"column":20},"end":{"line":74,"column":21}},"type":"if","locations":[{"start":{"line":72,"column":20},"end":{"line":74,"column":21}},{"start":{"line":72,"column":20},"end":{"line":74,"column":21}}],"line":72},"35":{"loc":{"start":{"line":92,"column":16},"end":{"line":101,"column":17}},"type":"if","locations":[{"start":{"line":92,"column":16},"end":{"line":101,"column":17}},{"start":{"line":92,"column":16},"end":{"line":101,"column":17}}],"line":92},"36":{"loc":{"start":{"line":110,"column":12},"end":{"line":111,"column":23}},"type":"if","locations":[{"start":{"line":110,"column":12},"end":{"line":111,"column":23}},{"start":{"line":110,"column":12},"end":{"line":111,"column":23}}],"line":110},"37":{"loc":{"start":{"line":110,"column":16},"end":{"line":110,"column":57}},"type":"binary-expr","locations":[{"start":{"line":110,"column":16},"end":{"line":110,"column":31}},{"start":{"line":110,"column":35},"end":{"line":110,"column":57}}],"line":110}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":66,"36":55,"37":66,"38":66,"39":66,"40":0,"41":0,"42":0,"43":0,"44":132,"45":66,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":22,"54":11,"55":1,"56":133,"57":5,"58":5,"59":55,"60":55,"61":55,"62":55,"63":0,"64":0,"65":5,"66":55,"67":5,"68":2,"69":2,"70":2,"71":2,"72":2,"73":1,"74":1,"75":1,"76":1,"77":1,"78":1,"79":1,"80":1,"81":0,"82":2,"83":2,"84":2,"85":0,"86":2,"87":2,"88":2,"89":1,"90":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":66,"8":66,"9":55,"10":66,"11":66,"12":0,"13":132,"14":1,"15":22,"16":11,"17":133,"18":5,"19":5,"20":55,"21":55,"22":55,"23":2,"24":2,"25":2,"26":2,"27":2,"28":2},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[11,55],"28":[66,66],"29":[66,66],"30":[66,66],"31":[1,1,1],"32":[1,0],"33":[1,1],"34":[0,0],"35":[1,0],"36":[0,2],"37":[2,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/emailTemplates.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/emailTemplates.ts"],"names":[],"mappings":"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","sourcesContent":["import DefaultHandler, { order } from './default';\nimport constants from '../../constants';\nimport { Assets, Asset } from '../../../types';\n\nexport const supportedTemplates = constants.EMAIL_TEMPLATES_NAMES.filter((p) =>\n  p.includes('.json')\n).map((p) => p.replace('.json', ''));\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      template: { type: 'string', enum: supportedTemplates },\n      body: { type: 'string', default: '' },\n    },\n    required: ['template'],\n  },\n};\n\nexport default class EmailTemplateHandler extends DefaultHandler {\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'emailTemplates',\n      identifiers: ['template'],\n    });\n  }\n\n  async getType(): Promise<Asset> {\n    const emailTemplates = await Promise.all(\n      constants.EMAIL_TEMPLATES_TYPES.map(async (name) => {\n        try {\n          const template = await this.client.emailTemplates.get({ name });\n          return template;\n        } catch (err) {\n          // Ignore if not found, else throw error\n          if (err.statusCode !== 404) {\n            throw err;\n          }\n        }\n      })\n    );\n\n    const nonEmptyTemplates = emailTemplates.filter((template) => !!template);\n\n    return nonEmptyTemplates;\n  }\n\n  async updateOrCreate(emailTemplate): Promise<void> {\n    try {\n      const identifierField = this.identifiers[0];\n\n      const params = { name: emailTemplate[identifierField] };\n      const updated = await this.client.emailTemplates.update(params, emailTemplate);\n      delete updated.body;\n      this.didUpdate(updated);\n      this.updated += 1;\n    } catch (err) {\n      if (err.statusCode === 404) {\n        // Create if it does not exist\n        const created = await this.client.emailTemplates.create(emailTemplate);\n        delete created.body;\n        this.didCreate(created);\n        this.created += 1;\n      } else {\n        throw err;\n      }\n    }\n  }\n\n  // Run after email provider changes\n  @order('60')\n  async processChanges(assets: Assets): Promise<void> {\n    const { emailTemplates } = assets;\n\n    // Do nothing if not set\n    if (!emailTemplates || !emailTemplates.length) return;\n\n    await Promise.all(\n      emailTemplates.map(async (emailTemplate) => {\n        await this.updateOrCreate(emailTemplate);\n      })\n    );\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7716be8452198a5fe31ff080066bf77e0883fe8d","contentHash":"b69618a80d4784e1da86660996afbc61dc64109cd3895232931c2da55ab064e8"},"/home/circleci/repo/src/tools/auth0/handlers/clientGrants.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/clientGrants.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":0},"end":{"line":40,"column":62}},"47":{"start":{"line":41,"column":0},"end":{"line":41,"column":24}},"48":{"start":{"line":42,"column":18},"end":{"line":42,"column":52}},"49":{"start":{"line":43,"column":16},"end":{"line":43,"column":38}},"50":{"start":{"line":44,"column":0},"end":{"line":59,"column":2}},"51":{"start":{"line":62,"column":8},"end":{"line":64,"column":109}},"52":{"start":{"line":67,"column":8},"end":{"line":67,"column":100}},"53":{"start":{"line":70,"column":8},"end":{"line":80,"column":11}},"54":{"start":{"line":71,"column":12},"end":{"line":73,"column":13}},"55":{"start":{"line":72,"column":16},"end":{"line":72,"column":37}},"56":{"start":{"line":74,"column":12},"end":{"line":74,"column":108}},"57":{"start":{"line":77,"column":34},"end":{"line":77,"column":64}},"58":{"start":{"line":78,"column":12},"end":{"line":78,"column":95}},"59":{"start":{"line":78,"column":60},"end":{"line":78,"column":93}},"60":{"start":{"line":79,"column":12},"end":{"line":79,"column":33}},"61":{"start":{"line":84,"column":23},"end":{"line":86,"column":10}},"62":{"start":{"line":85,"column":41},"end":{"line":85,"column":61}},"63":{"start":{"line":87,"column":8},"end":{"line":124,"column":11}},"64":{"start":{"line":88,"column":37},"end":{"line":88,"column":43}},"65":{"start":{"line":90,"column":12},"end":{"line":91,"column":23}},"66":{"start":{"line":91,"column":16},"end":{"line":91,"column":23}},"67":{"start":{"line":92,"column":28},"end":{"line":92,"column":102}},"68":{"start":{"line":93,"column":43},"end":{"line":93,"column":91}},"69":{"start":{"line":94,"column":36},"end":{"line":94,"column":105}},"70":{"start":{"line":96,"column":30},"end":{"line":102,"column":14}},"71":{"start":{"line":97,"column":30},"end":{"line":97,"column":60}},"72":{"start":{"line":98,"column":30},"end":{"line":98,"column":77}},"73":{"start":{"line":98,"column":50},"end":{"line":98,"column":76}},"74":{"start":{"line":99,"column":16},"end":{"line":100,"column":54}},"75":{"start":{"line":100,"column":20},"end":{"line":100,"column":54}},"76":{"start":{"line":101,"column":16},"end":{"line":101,"column":29}},"77":{"start":{"line":104,"column":34},"end":{"line":104,"column":64}},"78":{"start":{"line":105,"column":55},"end":{"line":105,"column":148}},"79":{"start":{"line":106,"column":33},"end":{"line":112,"column":13}},"80":{"start":{"line":107,"column":16},"end":{"line":110,"column":17}},"81":{"start":{"line":108,"column":20},"end":{"line":109,"column":99}},"82":{"start":{"line":108,"column":49},"end":{"line":109,"column":97}},"83":{"start":{"line":111,"column":16},"end":{"line":111,"column":79}},"84":{"start":{"line":111,"column":45},"end":{"line":111,"column":77}},"85":{"start":{"line":113,"column":28},"end":{"line":122,"column":13}},"86":{"start":{"line":123,"column":12},"end":{"line":123,"column":87}},"87":{"start":{"line":127,"column":0},"end":{"line":129,"column":58}},"88":{"start":{"line":130,"column":0},"end":{"line":130,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":61,"column":4},"end":{"line":61,"column":5}},"loc":{"start":{"line":61,"column":24},"end":{"line":65,"column":5}},"line":61},"15":{"name":"(anonymous_15)","decl":{"start":{"line":66,"column":4},"end":{"line":66,"column":5}},"loc":{"start":{"line":66,"column":20},"end":{"line":68,"column":5}},"line":66},"16":{"name":"(anonymous_16)","decl":{"start":{"line":69,"column":4},"end":{"line":69,"column":5}},"loc":{"start":{"line":69,"column":14},"end":{"line":81,"column":5}},"line":69},"17":{"name":"(anonymous_17)","decl":{"start":{"line":70,"column":47},"end":{"line":70,"column":48}},"loc":{"start":{"line":70,"column":60},"end":{"line":80,"column":9}},"line":70},"18":{"name":"(anonymous_18)","decl":{"start":{"line":78,"column":49},"end":{"line":78,"column":50}},"loc":{"start":{"line":78,"column":60},"end":{"line":78,"column":93}},"line":78},"19":{"name":"(anonymous_19)","decl":{"start":{"line":83,"column":4},"end":{"line":83,"column":5}},"loc":{"start":{"line":83,"column":27},"end":{"line":125,"column":5}},"line":83},"20":{"name":"(anonymous_20)","decl":{"start":{"line":85,"column":35},"end":{"line":85,"column":36}},"loc":{"start":{"line":85,"column":41},"end":{"line":85,"column":61}},"line":85},"21":{"name":"(anonymous_21)","decl":{"start":{"line":87,"column":47},"end":{"line":87,"column":48}},"loc":{"start":{"line":87,"column":60},"end":{"line":124,"column":9}},"line":87},"22":{"name":"(anonymous_22)","decl":{"start":{"line":96,"column":47},"end":{"line":96,"column":48}},"loc":{"start":{"line":96,"column":64},"end":{"line":102,"column":13}},"line":96},"23":{"name":"(anonymous_23)","decl":{"start":{"line":98,"column":43},"end":{"line":98,"column":44}},"loc":{"start":{"line":98,"column":50},"end":{"line":98,"column":76}},"line":98},"24":{"name":"(anonymous_24)","decl":{"start":{"line":106,"column":33},"end":{"line":106,"column":34}},"loc":{"start":{"line":106,"column":43},"end":{"line":112,"column":13}},"line":106},"25":{"name":"(anonymous_25)","decl":{"start":{"line":108,"column":39},"end":{"line":108,"column":40}},"loc":{"start":{"line":108,"column":49},"end":{"line":109,"column":97}},"line":108},"26":{"name":"(anonymous_26)","decl":{"start":{"line":111,"column":35},"end":{"line":111,"column":36}},"loc":{"start":{"line":111,"column":45},"end":{"line":111,"column":77}},"line":111}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":71,"column":12},"end":{"line":73,"column":13}},"type":"if","locations":[{"start":{"line":71,"column":12},"end":{"line":73,"column":13}},{"start":{"line":71,"column":12},"end":{"line":73,"column":13}}],"line":71},"32":{"loc":{"start":{"line":90,"column":12},"end":{"line":91,"column":23}},"type":"if","locations":[{"start":{"line":90,"column":12},"end":{"line":91,"column":23}},{"start":{"line":90,"column":12},"end":{"line":91,"column":23}}],"line":90},"33":{"loc":{"start":{"line":93,"column":43},"end":{"line":93,"column":91}},"type":"binary-expr","locations":[{"start":{"line":93,"column":44},"end":{"line":93,"column":58}},{"start":{"line":93,"column":62},"end":{"line":93,"column":84}},{"start":{"line":93,"column":89},"end":{"line":93,"column":91}}],"line":93},"34":{"loc":{"start":{"line":99,"column":16},"end":{"line":100,"column":54}},"type":"if","locations":[{"start":{"line":99,"column":16},"end":{"line":100,"column":54}},{"start":{"line":99,"column":16},"end":{"line":100,"column":54}}],"line":99},"35":{"loc":{"start":{"line":107,"column":16},"end":{"line":110,"column":17}},"type":"if","locations":[{"start":{"line":107,"column":16},"end":{"line":110,"column":17}},{"start":{"line":107,"column":16},"end":{"line":110,"column":17}}],"line":107},"36":{"loc":{"start":{"line":108,"column":49},"end":{"line":109,"column":97}},"type":"binary-expr","locations":[{"start":{"line":108,"column":49},"end":{"line":108,"column":81}},{"start":{"line":109,"column":24},"end":{"line":109,"column":97}}],"line":108}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":41,"36":19,"37":23,"38":41,"39":41,"40":0,"41":0,"42":0,"43":0,"44":64,"45":23,"46":1,"47":1,"48":1,"49":1,"50":1,"51":142,"52":6,"53":14,"54":14,"55":0,"56":14,"57":14,"58":14,"59":13,"60":14,"61":9,"62":9,"63":9,"64":9,"65":9,"66":0,"67":9,"68":9,"69":9,"70":9,"71":11,"72":11,"73":14,"74":11,"75":7,"76":11,"77":9,"78":9,"79":9,"80":36,"81":8,"82":13,"83":28,"84":8,"85":9,"86":9,"87":1,"88":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":23,"8":41,"9":19,"10":23,"11":41,"12":0,"13":64,"14":142,"15":6,"16":14,"17":14,"18":13,"19":9,"20":9,"21":9,"22":11,"23":14,"24":36,"25":13,"26":8},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[22,19],"28":[23,23],"29":[23,41],"30":[23,23],"31":[0,14],"32":[0,9],"33":[9,2,7],"34":[7,4],"35":[8,28],"36":[13,13]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/clientGrants.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/clientGrants.ts"],"names":[],"mappings":"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","sourcesContent":["import DefaultHandler, { order } from './default';\nimport { convertClientNamesToIds } from '../../utils';\nimport { Asset, Assets, CalculatedChanges } from '../../../types';\nimport DefaultAPIHandler from './default';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      client_id: { type: 'string' },\n      audience: { type: 'string' },\n      scope: {\n        type: 'array',\n        items: { type: 'string' },\n        uniqueItems: true,\n      },\n    },\n    required: ['client_id', 'scope', 'audience'],\n  },\n};\n\nexport type ClientGrant = {\n  client_id: string;\n  audience: string;\n  scope: string[];\n};\n\nexport default class ClientGrantsHandler extends DefaultHandler {\n  existing: ClientGrant[] | null;\n\n  constructor(config: DefaultAPIHandler) {\n    super({\n      ...config,\n      type: 'clientGrants',\n      id: 'id',\n      //@ts-ignore because not sure why two-dimensional array passed in\n      identifiers: ['id', ['client_id', 'audience']],\n      stripUpdateFields: ['audience', 'client_id'],\n    });\n  }\n\n  objString(item): string {\n    return super.objString({ id: item.id, client_id: item.client_id, audience: item.audience });\n  }\n\n  async getType(): Promise<ClientGrant[]> {\n    if (this.existing) {\n      return this.existing;\n    }\n    this.existing = await this.client.clientGrants.getAll({ paginate: true, include_totals: true });\n\n    // Always filter out the client we are using to access Auth0 Management API\n    // As it could cause problems if the grants are deleted or updated etc\n    const currentClient = this.config('AUTH0_CLIENT_ID');\n\n    this.existing = this.existing.filter((grant) => grant.client_id !== currentClient);\n\n    return this.existing;\n  }\n\n  // Run after clients are updated so we can convert client_id names to id's\n  @order('60')\n  async processChanges(assets: Assets): Promise<void> {\n    const { clientGrants } = assets;\n\n    // Do nothing if not set\n    if (!clientGrants) return;\n\n    const clients = await this.client.clients.getAll({ paginate: true, include_totals: true });\n    const excludedClientsByNames = (assets.exclude && assets.exclude.clients) || [];\n    const excludedClients = convertClientNamesToIds(excludedClientsByNames, clients);\n\n    // Convert clients by name to the id\n    const formatted = clientGrants.map((clientGrant) => {\n      const grant = { ...clientGrant };\n      const found = clients.find((c) => c.name === grant.client_id);\n      if (found) grant.client_id = found.client_id;\n      return grant;\n    });\n\n    // Always filter out the client we are using to access Auth0 Management API\n    const currentClient = this.config('AUTH0_CLIENT_ID');\n\n    const { del, update, create, conflicts } = await this.calcChanges({\n      ...assets,\n      clientGrants: formatted,\n    });\n\n    const filterGrants = (list: { client_id: string }[]) => {\n      if (excludedClients.length) {\n        return list.filter(\n          (item) =>\n            item.client_id !== currentClient &&\n            ![...excludedClientsByNames, ...excludedClients].includes(item.client_id)\n        );\n      }\n\n      return list.filter((item) => item.client_id !== currentClient);\n    };\n\n    const changes: CalculatedChanges = {\n      //@ts-ignore because this expects `client_id` and that's not yet typed on Asset\n      del: filterGrants(del),\n      //@ts-ignore because this expects `client_id` and that's not yet typed on Asset\n      update: filterGrants(update),\n      //@ts-ignore because this expects `client_id` and that's not yet typed on Asset\n      create: filterGrants(create),\n      //@ts-ignore because this expects `client_id` and that's not yet typed on Asset\n      conflicts: filterGrants(conflicts),\n    };\n\n    await super.processChanges(assets, {\n      ...changes,\n    });\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a4f637917fb2ad6554aa49df5bf8210e66e003df","contentHash":"2ed089cac14b6431c5cdbf016a9473674bd6f207e5e5e1506501243153869b0b"},"/home/circleci/repo/src/tools/auth0/handlers/guardianFactors.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/guardianFactors.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":20},"end":{"line":17,"column":63}},"18":{"start":{"line":18,"column":0},"end":{"line":27,"column":2}},"19":{"start":{"line":30,"column":8},"end":{"line":30,"column":98}},"20":{"start":{"line":33,"column":8},"end":{"line":38,"column":11}},"21":{"start":{"line":34,"column":12},"end":{"line":35,"column":37}},"22":{"start":{"line":35,"column":16},"end":{"line":35,"column":37}},"23":{"start":{"line":36,"column":12},"end":{"line":36,"column":68}},"24":{"start":{"line":37,"column":12},"end":{"line":37,"column":33}},"25":{"start":{"line":41,"column":8},"end":{"line":56,"column":11}},"26":{"start":{"line":43,"column":40},"end":{"line":43,"column":46}},"27":{"start":{"line":45,"column":12},"end":{"line":46,"column":23}},"28":{"start":{"line":46,"column":16},"end":{"line":46,"column":23}},"29":{"start":{"line":48,"column":12},"end":{"line":55,"column":17}},"30":{"start":{"line":48,"column":62},"end":{"line":55,"column":14}},"31":{"start":{"line":49,"column":29},"end":{"line":49,"column":54}},"32":{"start":{"line":50,"column":31},"end":{"line":50,"column":52}},"33":{"start":{"line":51,"column":16},"end":{"line":51,"column":33}},"34":{"start":{"line":52,"column":16},"end":{"line":52,"column":70}},"35":{"start":{"line":53,"column":16},"end":{"line":53,"column":39}},"36":{"start":{"line":54,"column":16},"end":{"line":54,"column":34}},"37":{"start":{"line":59,"column":0},"end":{"line":59,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":29,"column":4},"end":{"line":29,"column":5}},"loc":{"start":{"line":29,"column":25},"end":{"line":31,"column":5}},"line":29},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":4},"end":{"line":32,"column":5}},"loc":{"start":{"line":32,"column":14},"end":{"line":39,"column":5}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":47},"end":{"line":33,"column":48}},"loc":{"start":{"line":33,"column":60},"end":{"line":38,"column":9}},"line":33},"11":{"name":"(anonymous_11)","decl":{"start":{"line":40,"column":4},"end":{"line":40,"column":5}},"loc":{"start":{"line":40,"column":27},"end":{"line":57,"column":5}},"line":40},"12":{"name":"(anonymous_12)","decl":{"start":{"line":41,"column":47},"end":{"line":41,"column":48}},"loc":{"start":{"line":41,"column":60},"end":{"line":56,"column":9}},"line":41},"13":{"name":"(anonymous_13)","decl":{"start":{"line":48,"column":50},"end":{"line":48,"column":51}},"loc":{"start":{"line":48,"column":62},"end":{"line":55,"column":14}},"line":48},"14":{"name":"(anonymous_14)","decl":{"start":{"line":48,"column":94},"end":{"line":48,"column":95}},"loc":{"start":{"line":48,"column":107},"end":{"line":55,"column":13}},"line":48}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":34,"column":12},"end":{"line":35,"column":37}},"type":"if","locations":[{"start":{"line":34,"column":12},"end":{"line":35,"column":37}},{"start":{"line":34,"column":12},"end":{"line":35,"column":37}}],"line":34},"9":{"loc":{"start":{"line":45,"column":12},"end":{"line":46,"column":23}},"type":"if","locations":[{"start":{"line":45,"column":12},"end":{"line":46,"column":23}},{"start":{"line":45,"column":12},"end":{"line":46,"column":23}}],"line":45},"10":{"loc":{"start":{"line":45,"column":16},"end":{"line":45,"column":59}},"type":"binary-expr","locations":[{"start":{"line":45,"column":16},"end":{"line":45,"column":32}},{"start":{"line":45,"column":36},"end":{"line":45,"column":59}}],"line":45}},"s":{"0":1,"1":7,"2":6,"3":7,"4":7,"5":7,"6":0,"7":0,"8":0,"9":0,"10":14,"11":7,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":134,"20":5,"21":5,"22":0,"23":5,"24":5,"25":1,"26":1,"27":1,"28":0,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1},"f":{"0":7,"1":7,"2":6,"3":7,"4":7,"5":0,"6":14,"7":2,"8":134,"9":5,"10":5,"11":1,"12":1,"13":1,"14":1},"b":{"0":[1,1,1],"1":[1,6],"2":[7,7],"3":[7,7],"4":[7,7],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[0,5],"9":[0,1],"10":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/guardianFactors.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/guardianFactors.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,wDAAuC;AACvC,gEAAwC;AAG3B,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,OAAO;IACb,KAAK,EAAE;QACL,IAAI,EAAE,QAAQ;QACd,UAAU,EAAE;YACV,IAAI,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,mBAAS,CAAC,gBAAgB,EAAE;SAC3D;QACD,QAAQ,EAAE,CAAC,MAAM,CAAC;KACnB;CACF,CAAC;AAEF,MAAqB,sBAAuB,SAAQ,iBAAc;IAGhE,YAAY,OAAuB;QACjC,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,iBAAiB,EACvB,EAAE,EAAE,MAAM,IACV,CAAC;IACL,CAAC;IAEK,OAAO;;YACX,IAAI,IAAI,CAAC,QAAQ;gBAAE,OAAO,IAAI,CAAC,QAAQ,CAAC;YACxC,IAAI,CAAC,QAAQ,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;YACxD,OAAO,IAAI,CAAC,QAAQ,CAAC;QACvB,CAAC;KAAA;IAEK,cAAc,CAAC,MAAc;;YACjC,kEAAkE;YAClE,MAAM,EAAE,eAAe,EAAE,GAAG,MAAM,CAAC;YAEnC,wBAAwB;YACxB,IAAI,CAAC,eAAe,IAAI,CAAC,eAAe,CAAC,MAAM;gBAAE,OAAO;YAExD,sBAAsB;YACtB,MAAM,OAAO,CAAC,GAAG,CACf,eAAe,CAAC,GAAG,CAAC,CAAO,MAAM,EAAE,EAAE;gBACnC,MAAM,IAAI,qBAAQ,MAAM,CAAE,CAAC;gBAC3B,MAAM,MAAM,GAAG,EAAE,IAAI,EAAE,MAAM,CAAC,IAAI,EAAE,CAAC;gBACrC,OAAO,IAAI,CAAC,IAAI,CAAC;gBACjB,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;gBACtD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;gBACvB,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;YACpB,CAAC,CAAA,CAAC,CACH,CAAC;QACJ,CAAC;KAAA;CACF;AApCD,yCAoCC","sourcesContent":["import DefaultHandler from './default';\nimport constants from '../../constants';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      name: { type: 'string', enum: constants.GUARDIAN_FACTORS },\n    },\n    required: ['name'],\n  },\n};\n\nexport default class GuardianFactorsHandler extends DefaultHandler {\n  existing: Asset[];\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'guardianFactors',\n      id: 'name',\n    });\n  }\n\n  async getType(): Promise<Asset[]> {\n    if (this.existing) return this.existing;\n    this.existing = await this.client.guardian.getFactors();\n    return this.existing;\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    // No API to delete or create guardianFactors, we can only update.\n    const { guardianFactors } = assets;\n\n    // Do nothing if not set\n    if (!guardianFactors || !guardianFactors.length) return;\n\n    // Process each factor\n    await Promise.all(\n      guardianFactors.map(async (factor) => {\n        const data = { ...factor };\n        const params = { name: factor.name };\n        delete data.name;\n        await this.client.guardian.updateFactor(params, data);\n        this.didUpdate(params);\n        this.updated += 1;\n      })\n    );\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c00c0e861ac34a342724338e3102def723cec4cb","contentHash":"fa4c2a6e0125ff426eb93a8b4c4279647343706029227c93deb1ac0c86e597dc"},"/home/circleci/repo/src/tools/auth0/handlers/guardianFactorProviders.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/guardianFactorProviders.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":20},"end":{"line":17,"column":63}},"18":{"start":{"line":18,"column":17},"end":{"line":23,"column":6}},"19":{"start":{"line":19,"column":4},"end":{"line":21,"column":7}},"20":{"start":{"line":20,"column":8},"end":{"line":20,"column":42}},"21":{"start":{"line":22,"column":4},"end":{"line":22,"column":17}},"22":{"start":{"line":24,"column":0},"end":{"line":34,"column":2}},"23":{"start":{"line":30,"column":66},"end":{"line":30,"column":76}},"24":{"start":{"line":37,"column":8},"end":{"line":37,"column":106}},"25":{"start":{"line":40,"column":8},"end":{"line":49,"column":11}},"26":{"start":{"line":41,"column":12},"end":{"line":42,"column":37}},"27":{"start":{"line":42,"column":16},"end":{"line":42,"column":37}},"28":{"start":{"line":43,"column":25},"end":{"line":46,"column":16}},"29":{"start":{"line":43,"column":63},"end":{"line":46,"column":14}},"30":{"start":{"line":44,"column":33},"end":{"line":44,"column":80}},"31":{"start":{"line":45,"column":16},"end":{"line":45,"column":69}},"32":{"start":{"line":48,"column":12},"end":{"line":48,"column":65}},"33":{"start":{"line":48,"column":38},"end":{"line":48,"column":63}},"34":{"start":{"line":52,"column":8},"end":{"line":68,"column":11}},"35":{"start":{"line":54,"column":48},"end":{"line":54,"column":54}},"36":{"start":{"line":56,"column":12},"end":{"line":57,"column":23}},"37":{"start":{"line":57,"column":16},"end":{"line":57,"column":23}},"38":{"start":{"line":59,"column":12},"end":{"line":67,"column":17}},"39":{"start":{"line":59,"column":78},"end":{"line":67,"column":14}},"40":{"start":{"line":60,"column":29},"end":{"line":60,"column":62}},"41":{"start":{"line":61,"column":31},"end":{"line":61,"column":95}},"42":{"start":{"line":62,"column":16},"end":{"line":62,"column":33}},"43":{"start":{"line":63,"column":16},"end":{"line":63,"column":37}},"44":{"start":{"line":64,"column":16},"end":{"line":64,"column":78}},"45":{"start":{"line":65,"column":16},"end":{"line":65,"column":39}},"46":{"start":{"line":66,"column":16},"end":{"line":66,"column":34}},"47":{"start":{"line":71,"column":0},"end":{"line":71,"column":49}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":18,"column":86},"end":{"line":18,"column":87}},"loc":{"start":{"line":18,"column":116},"end":{"line":23,"column":1}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":19,"column":22},"end":{"line":19,"column":23}},"loc":{"start":{"line":19,"column":29},"end":{"line":21,"column":5}},"line":19},"10":{"name":"(anonymous_10)","decl":{"start":{"line":30,"column":59},"end":{"line":30,"column":60}},"loc":{"start":{"line":30,"column":66},"end":{"line":30,"column":76}},"line":30},"11":{"name":"(anonymous_11)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":25},"end":{"line":38,"column":5}},"line":36},"12":{"name":"(anonymous_12)","decl":{"start":{"line":39,"column":4},"end":{"line":39,"column":5}},"loc":{"start":{"line":39,"column":14},"end":{"line":50,"column":5}},"line":39},"13":{"name":"(anonymous_13)","decl":{"start":{"line":40,"column":47},"end":{"line":40,"column":48}},"loc":{"start":{"line":40,"column":60},"end":{"line":49,"column":9}},"line":40},"14":{"name":"(anonymous_14)","decl":{"start":{"line":43,"column":56},"end":{"line":43,"column":57}},"loc":{"start":{"line":43,"column":63},"end":{"line":46,"column":14}},"line":43},"15":{"name":"(anonymous_15)","decl":{"start":{"line":43,"column":95},"end":{"line":43,"column":96}},"loc":{"start":{"line":43,"column":108},"end":{"line":46,"column":13}},"line":43},"16":{"name":"(anonymous_16)","decl":{"start":{"line":48,"column":31},"end":{"line":48,"column":32}},"loc":{"start":{"line":48,"column":38},"end":{"line":48,"column":63}},"line":48},"17":{"name":"(anonymous_17)","decl":{"start":{"line":51,"column":4},"end":{"line":51,"column":5}},"loc":{"start":{"line":51,"column":27},"end":{"line":69,"column":5}},"line":51},"18":{"name":"(anonymous_18)","decl":{"start":{"line":52,"column":47},"end":{"line":52,"column":48}},"loc":{"start":{"line":52,"column":60},"end":{"line":68,"column":9}},"line":52},"19":{"name":"(anonymous_19)","decl":{"start":{"line":59,"column":58},"end":{"line":59,"column":59}},"loc":{"start":{"line":59,"column":78},"end":{"line":67,"column":14}},"line":59},"20":{"name":"(anonymous_20)","decl":{"start":{"line":59,"column":110},"end":{"line":59,"column":111}},"loc":{"start":{"line":59,"column":123},"end":{"line":67,"column":13}},"line":59}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":41,"column":12},"end":{"line":42,"column":37}},"type":"if","locations":[{"start":{"line":41,"column":12},"end":{"line":42,"column":37}},{"start":{"line":41,"column":12},"end":{"line":42,"column":37}}],"line":41},"9":{"loc":{"start":{"line":56,"column":12},"end":{"line":57,"column":23}},"type":"if","locations":[{"start":{"line":56,"column":12},"end":{"line":57,"column":23}},{"start":{"line":56,"column":12},"end":{"line":57,"column":23}}],"line":56},"10":{"loc":{"start":{"line":56,"column":16},"end":{"line":56,"column":75}},"type":"binary-expr","locations":[{"start":{"line":56,"column":16},"end":{"line":56,"column":40}},{"start":{"line":56,"column":44},"end":{"line":56,"column":75}}],"line":56}},"s":{"0":1,"1":17,"2":11,"3":17,"4":17,"5":17,"6":0,"7":0,"8":0,"9":0,"10":34,"11":17,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":2,"20":2,"21":2,"22":1,"23":2,"24":134,"25":5,"26":5,"27":0,"28":5,"29":10,"30":10,"31":10,"32":5,"33":10,"34":1,"35":1,"36":1,"37":0,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1},"f":{"0":17,"1":17,"2":11,"3":17,"4":17,"5":0,"6":34,"7":2,"8":2,"9":2,"10":2,"11":134,"12":5,"13":5,"14":10,"15":10,"16":10,"17":1,"18":1,"19":1,"20":1},"b":{"0":[1,1,1],"1":[6,11],"2":[17,17],"3":[17,17],"4":[17,17],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[0,5],"9":[0,1],"10":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/guardianFactorProviders.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/guardianFactorProviders.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,wDAAuC;AACvC,gEAAwC;AAGxC,MAAM,QAAQ,GAAG,MAAM,CAAC,OAAO,CAAC,mBAAS,CAAC,yBAAyB,CAAC,CAAC,MAAM,CACzE,CAAC,KAA2C,EAAE,CAAC,IAAI,EAAE,SAAS,CAAC,EAAE,EAAE;IACjE,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE;QACtB,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC;IACpC,CAAC,CAAC,CAAC;IACH,OAAO,KAAK,CAAC;AACf,CAAC,EACD,EAAE,CACH,CAAC;AAEW,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,OAAO;IACb,KAAK,EAAE;QACL,IAAI,EAAE,QAAQ;QACd,UAAU,EAAE;YACV,IAAI,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,mBAAS,CAAC,gBAAgB,EAAE;YAC1D,QAAQ,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE;SACpE;QACD,QAAQ,EAAE,CAAC,MAAM,EAAE,UAAU,CAAC;KAC/B;CACF,CAAC;AAEF,MAAqB,8BAA+B,SAAQ,iBAAc;IAGxE,YAAY,OAAuB;QACjC,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,yBAAyB,EAC/B,EAAE,EAAE,MAAM,IACV,CAAC;IACL,CAAC;IAEK,OAAO;;YACX,IAAI,IAAI,CAAC,QAAQ;gBAAE,OAAO,IAAI,CAAC,QAAQ,CAAC;YAExC,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,GAAG,CAC5B,QAAQ,CAAC,GAAG,CAAC,CAAO,CAAC,EAAE,EAAE;gBACvB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;gBACjE,uCAAY,CAAC,GAAK,QAAQ,EAAG;YAC/B,CAAC,CAAA,CAAC,CACH,CAAC;YAEF,kEAAkE;YAClE,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QACvD,CAAC;KAAA;IAEK,cAAc,CAAC,MAAc;;YACjC,0EAA0E;YAC1E,MAAM,EAAE,uBAAuB,EAAE,GAAG,MAAM,CAAC;YAE3C,wBAAwB;YACxB,IAAI,CAAC,uBAAuB,IAAI,CAAC,uBAAuB,CAAC,MAAM;gBAAE,OAAO;YAExE,sBAAsB;YACtB,MAAM,OAAO,CAAC,GAAG,CACf,uBAAuB,CAAC,GAAG,CAAC,CAAO,cAAc,EAAE,EAAE;gBACnD,MAAM,IAAI,qBAAQ,cAAc,CAAE,CAAC;gBACnC,MAAM,MAAM,GAAG,EAAE,IAAI,EAAE,cAAc,CAAC,IAAI,EAAE,QAAQ,EAAE,cAAc,CAAC,QAAQ,EAAE,CAAC;gBAChF,OAAO,IAAI,CAAC,IAAI,CAAC;gBACjB,OAAO,IAAI,CAAC,QAAQ,CAAC;gBACrB,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,oBAAoB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;gBAC9D,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;gBACvB,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;YACpB,CAAC,CAAA,CAAC,CACH,CAAC;QACJ,CAAC;KAAA;CACF;AA7CD,iDA6CC","sourcesContent":["import DefaultHandler from './default';\nimport constants from '../../constants';\nimport { Asset, Assets } from '../../../types';\n\nconst mappings = Object.entries(constants.GUARDIAN_FACTOR_PROVIDERS).reduce(\n  (accum: { name: string; provider: string }[], [name, providers]) => {\n    providers.forEach((p) => {\n      accum.push({ name, provider: p });\n    });\n    return accum;\n  },\n  []\n);\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      name: { type: 'string', enum: constants.GUARDIAN_FACTORS },\n      provider: { type: 'string', enum: mappings.map((p) => p.provider) },\n    },\n    required: ['name', 'provider'],\n  },\n};\n\nexport default class GuardianFactorProvidersHandler extends DefaultHandler {\n  existing: Asset[];\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'guardianFactorProviders',\n      id: 'name',\n    });\n  }\n\n  async getType(): Promise<Asset[]> {\n    if (this.existing) return this.existing;\n\n    const data = await Promise.all(\n      mappings.map(async (m) => {\n        const provider = await this.client.guardian.getFactorProvider(m);\n        return { ...m, ...provider };\n      })\n    );\n\n    // Filter out empty, should have more then 2 keys (name, provider)\n    return data.filter((d) => Object.keys(d).length > 2);\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    // No API to delete or create guardianFactorProviders, we can only update.\n    const { guardianFactorProviders } = assets;\n\n    // Do nothing if not set\n    if (!guardianFactorProviders || !guardianFactorProviders.length) return;\n\n    // Process each factor\n    await Promise.all(\n      guardianFactorProviders.map(async (factorProvider) => {\n        const data = { ...factorProvider };\n        const params = { name: factorProvider.name, provider: factorProvider.provider };\n        delete data.name;\n        delete data.provider;\n        await this.client.guardian.updateFactorProvider(params, data);\n        this.didUpdate(params);\n        this.updated += 1;\n      })\n    );\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fb039d0827b79be162b0abe25b7a3f7a2958a03e","contentHash":"26b8c239fd58d5cabb54ceda57500ddcc306f03ce7d2bfc25b1d229125e35334"},"/home/circleci/repo/src/tools/auth0/handlers/guardianFactorTemplates.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/guardianFactorTemplates.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":20},"end":{"line":17,"column":63}},"18":{"start":{"line":18,"column":0},"end":{"line":27,"column":2}},"19":{"start":{"line":30,"column":8},"end":{"line":30,"column":106}},"20":{"start":{"line":33,"column":8},"end":{"line":42,"column":11}},"21":{"start":{"line":34,"column":12},"end":{"line":35,"column":37}},"22":{"start":{"line":35,"column":16},"end":{"line":35,"column":37}},"23":{"start":{"line":36,"column":25},"end":{"line":39,"column":16}},"24":{"start":{"line":36,"column":103},"end":{"line":39,"column":14}},"25":{"start":{"line":37,"column":34},"end":{"line":37,"column":89}},"26":{"start":{"line":38,"column":16},"end":{"line":38,"column":58}},"27":{"start":{"line":41,"column":12},"end":{"line":41,"column":65}},"28":{"start":{"line":41,"column":38},"end":{"line":41,"column":63}},"29":{"start":{"line":45,"column":8},"end":{"line":60,"column":11}},"30":{"start":{"line":47,"column":48},"end":{"line":47,"column":54}},"31":{"start":{"line":49,"column":12},"end":{"line":50,"column":23}},"32":{"start":{"line":50,"column":16},"end":{"line":50,"column":23}},"33":{"start":{"line":52,"column":12},"end":{"line":59,"column":17}},"34":{"start":{"line":52,"column":78},"end":{"line":59,"column":14}},"35":{"start":{"line":53,"column":29},"end":{"line":53,"column":62}},"36":{"start":{"line":54,"column":31},"end":{"line":54,"column":60}},"37":{"start":{"line":55,"column":16},"end":{"line":55,"column":33}},"38":{"start":{"line":56,"column":16},"end":{"line":56,"column":79}},"39":{"start":{"line":57,"column":16},"end":{"line":57,"column":39}},"40":{"start":{"line":58,"column":16},"end":{"line":58,"column":34}},"41":{"start":{"line":63,"column":0},"end":{"line":63,"column":49}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":29,"column":4},"end":{"line":29,"column":5}},"loc":{"start":{"line":29,"column":25},"end":{"line":31,"column":5}},"line":29},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":4},"end":{"line":32,"column":5}},"loc":{"start":{"line":32,"column":14},"end":{"line":43,"column":5}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":47},"end":{"line":33,"column":48}},"loc":{"start":{"line":33,"column":60},"end":{"line":42,"column":9}},"line":33},"11":{"name":"(anonymous_11)","decl":{"start":{"line":36,"column":93},"end":{"line":36,"column":94}},"loc":{"start":{"line":36,"column":103},"end":{"line":39,"column":14}},"line":36},"12":{"name":"(anonymous_12)","decl":{"start":{"line":36,"column":135},"end":{"line":36,"column":136}},"loc":{"start":{"line":36,"column":148},"end":{"line":39,"column":13}},"line":36},"13":{"name":"(anonymous_13)","decl":{"start":{"line":41,"column":31},"end":{"line":41,"column":32}},"loc":{"start":{"line":41,"column":38},"end":{"line":41,"column":63}},"line":41},"14":{"name":"(anonymous_14)","decl":{"start":{"line":44,"column":4},"end":{"line":44,"column":5}},"loc":{"start":{"line":44,"column":27},"end":{"line":61,"column":5}},"line":44},"15":{"name":"(anonymous_15)","decl":{"start":{"line":45,"column":47},"end":{"line":45,"column":48}},"loc":{"start":{"line":45,"column":60},"end":{"line":60,"column":9}},"line":45},"16":{"name":"(anonymous_16)","decl":{"start":{"line":52,"column":58},"end":{"line":52,"column":59}},"loc":{"start":{"line":52,"column":78},"end":{"line":59,"column":14}},"line":52},"17":{"name":"(anonymous_17)","decl":{"start":{"line":52,"column":110},"end":{"line":52,"column":111}},"loc":{"start":{"line":52,"column":123},"end":{"line":59,"column":13}},"line":52}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":34,"column":12},"end":{"line":35,"column":37}},"type":"if","locations":[{"start":{"line":34,"column":12},"end":{"line":35,"column":37}},{"start":{"line":34,"column":12},"end":{"line":35,"column":37}}],"line":34},"9":{"loc":{"start":{"line":49,"column":12},"end":{"line":50,"column":23}},"type":"if","locations":[{"start":{"line":49,"column":12},"end":{"line":50,"column":23}},{"start":{"line":49,"column":12},"end":{"line":50,"column":23}}],"line":49},"10":{"loc":{"start":{"line":49,"column":16},"end":{"line":49,"column":75}},"type":"binary-expr","locations":[{"start":{"line":49,"column":16},"end":{"line":49,"column":40}},{"start":{"line":49,"column":44},"end":{"line":49,"column":75}}],"line":49}},"s":{"0":1,"1":12,"2":6,"3":12,"4":12,"5":12,"6":0,"7":0,"8":0,"9":0,"10":24,"11":12,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":134,"20":5,"21":5,"22":0,"23":5,"24":5,"25":5,"26":5,"27":5,"28":5,"29":1,"30":1,"31":1,"32":0,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1},"f":{"0":12,"1":12,"2":6,"3":12,"4":12,"5":0,"6":24,"7":2,"8":134,"9":5,"10":5,"11":5,"12":5,"13":5,"14":1,"15":1,"16":1,"17":1},"b":{"0":[1,1,1],"1":[6,6],"2":[12,12],"3":[12,12],"4":[12,12],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[0,5],"9":[0,1],"10":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/guardianFactorTemplates.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/guardianFactorTemplates.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,wDAAuC;AACvC,gEAAwC;AAG3B,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,OAAO;IACb,KAAK,EAAE;QACL,IAAI,EAAE,QAAQ;QACd,UAAU,EAAE;YACV,IAAI,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,mBAAS,CAAC,yBAAyB,EAAE;SACpE;QACD,QAAQ,EAAE,CAAC,MAAM,CAAC;KACnB;CACF,CAAC;AAEF,MAAqB,8BAA+B,SAAQ,iBAAc;IAGxE,YAAY,OAAO;QACjB,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,yBAAyB,EAC/B,EAAE,EAAE,MAAM,IACV,CAAC;IACL,CAAC;IAEK,OAAO;;YACX,IAAI,IAAI,CAAC,QAAQ;gBAAE,OAAO,IAAI,CAAC,QAAQ,CAAC;YAExC,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,GAAG,CAC5B,mBAAS,CAAC,yBAAyB,CAAC,GAAG,CAAC,CAAO,IAAI,EAAE,EAAE;gBACrD,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,kBAAkB,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;gBAC1E,uBAAS,IAAI,IAAK,SAAS,EAAG;YAChC,CAAC,CAAA,CAAC,CACH,CAAC;YAEF,wDAAwD;YACxD,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QACvD,CAAC;KAAA;IAEK,cAAc,CAAC,MAAc;;YACjC,0EAA0E;YAC1E,MAAM,EAAE,uBAAuB,EAAE,GAAG,MAAM,CAAC;YAE3C,wBAAwB;YACxB,IAAI,CAAC,uBAAuB,IAAI,CAAC,uBAAuB,CAAC,MAAM;gBAAE,OAAO;YAExE,gCAAgC;YAChC,MAAM,OAAO,CAAC,GAAG,CACf,uBAAuB,CAAC,GAAG,CAAC,CAAO,cAAc,EAAE,EAAE;gBACnD,MAAM,IAAI,qBAAQ,cAAc,CAAE,CAAC;gBACnC,MAAM,MAAM,GAAG,EAAE,IAAI,EAAE,cAAc,CAAC,IAAI,EAAE,CAAC;gBAC7C,OAAO,IAAI,CAAC,IAAI,CAAC;gBACjB,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,qBAAqB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;gBAC/D,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;gBACvB,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;YACpB,CAAC,CAAA,CAAC,CACH,CAAC;QACJ,CAAC;KAAA;CACF;AA5CD,iDA4CC","sourcesContent":["import DefaultHandler from './default';\nimport constants from '../../constants';\nimport { Assets, Asset, CalculatedChanges } from '../../../types';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      name: { type: 'string', enum: constants.GUARDIAN_FACTOR_TEMPLATES },\n    },\n    required: ['name'],\n  },\n};\n\nexport default class GuardianFactorTemplatesHandler extends DefaultHandler {\n  existing: Asset[];\n\n  constructor(options) {\n    super({\n      ...options,\n      type: 'guardianFactorTemplates',\n      id: 'name',\n    });\n  }\n\n  async getType(): Promise<Asset[]> {\n    if (this.existing) return this.existing;\n\n    const data = await Promise.all(\n      constants.GUARDIAN_FACTOR_TEMPLATES.map(async (name) => {\n        const templates = await this.client.guardian.getFactorTemplates({ name });\n        return { name, ...templates };\n      })\n    );\n\n    // Filter out empty, should have more then 1 keys (name)\n    return data.filter((d) => Object.keys(d).length > 1);\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    // No API to delete or create guardianFactorTemplates, we can only update.\n    const { guardianFactorTemplates } = assets;\n\n    // Do nothing if not set\n    if (!guardianFactorTemplates || !guardianFactorTemplates.length) return;\n\n    // Process each factor templates\n    await Promise.all(\n      guardianFactorTemplates.map(async (fatorTemplates) => {\n        const data = { ...fatorTemplates };\n        const params = { name: fatorTemplates.name };\n        delete data.name;\n        await this.client.guardian.updateFactorTemplates(params, data);\n        this.didUpdate(params);\n        this.updated += 1;\n      })\n    );\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3bd5a305770c3fb921f5359a49a68f3568bd6663","contentHash":"4b749ef9920eaeab05b88921965e62409793b1e412a6b90b289a6a95e64a0c90"},"/home/circleci/repo/src/tools/auth0/handlers/guardianPolicies.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/guardianPolicies.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":20},"end":{"line":17,"column":63}},"18":{"start":{"line":18,"column":0},"end":{"line":30,"column":2}},"19":{"start":{"line":33,"column":8},"end":{"line":33,"column":87}},"20":{"start":{"line":37,"column":8},"end":{"line":47,"column":11}},"21":{"start":{"line":39,"column":12},"end":{"line":41,"column":13}},"22":{"start":{"line":40,"column":16},"end":{"line":40,"column":26}},"23":{"start":{"line":42,"column":12},"end":{"line":43,"column":37}},"24":{"start":{"line":43,"column":16},"end":{"line":43,"column":37}},"25":{"start":{"line":44,"column":29},"end":{"line":44,"column":69}},"26":{"start":{"line":45,"column":12},"end":{"line":45,"column":41}},"27":{"start":{"line":46,"column":12},"end":{"line":46,"column":33}},"28":{"start":{"line":50,"column":8},"end":{"line":61,"column":11}},"29":{"start":{"line":52,"column":41},"end":{"line":52,"column":47}},"30":{"start":{"line":54,"column":12},"end":{"line":55,"column":23}},"31":{"start":{"line":55,"column":16},"end":{"line":55,"column":23}},"32":{"start":{"line":56,"column":27},"end":{"line":56,"column":29}},"33":{"start":{"line":57,"column":25},"end":{"line":57,"column":50}},"34":{"start":{"line":58,"column":12},"end":{"line":58,"column":68}},"35":{"start":{"line":59,"column":12},"end":{"line":59,"column":30}},"36":{"start":{"line":60,"column":12},"end":{"line":60,"column":45}},"37":{"start":{"line":64,"column":0},"end":{"line":64,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":32,"column":4},"end":{"line":32,"column":5}},"loc":{"start":{"line":32,"column":25},"end":{"line":34,"column":5}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":14},"end":{"line":48,"column":5}},"line":36},"10":{"name":"(anonymous_10)","decl":{"start":{"line":37,"column":47},"end":{"line":37,"column":48}},"loc":{"start":{"line":37,"column":60},"end":{"line":47,"column":9}},"line":37},"11":{"name":"(anonymous_11)","decl":{"start":{"line":49,"column":4},"end":{"line":49,"column":5}},"loc":{"start":{"line":49,"column":27},"end":{"line":62,"column":5}},"line":49},"12":{"name":"(anonymous_12)","decl":{"start":{"line":50,"column":47},"end":{"line":50,"column":48}},"loc":{"start":{"line":50,"column":60},"end":{"line":61,"column":9}},"line":50}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":39,"column":12},"end":{"line":41,"column":13}},"type":"if","locations":[{"start":{"line":39,"column":12},"end":{"line":41,"column":13}},{"start":{"line":39,"column":12},"end":{"line":41,"column":13}}],"line":39},"9":{"loc":{"start":{"line":39,"column":16},"end":{"line":39,"column":95}},"type":"binary-expr","locations":[{"start":{"line":39,"column":16},"end":{"line":39,"column":37}},{"start":{"line":39,"column":41},"end":{"line":39,"column":95}}],"line":39},"10":{"loc":{"start":{"line":42,"column":12},"end":{"line":43,"column":37}},"type":"if","locations":[{"start":{"line":42,"column":12},"end":{"line":43,"column":37}},{"start":{"line":42,"column":12},"end":{"line":43,"column":37}}],"line":42},"11":{"loc":{"start":{"line":54,"column":12},"end":{"line":55,"column":23}},"type":"if","locations":[{"start":{"line":54,"column":12},"end":{"line":55,"column":23}},{"start":{"line":54,"column":12},"end":{"line":55,"column":23}}],"line":54},"12":{"loc":{"start":{"line":54,"column":16},"end":{"line":54,"column":63}},"type":"binary-expr","locations":[{"start":{"line":54,"column":16},"end":{"line":54,"column":33}},{"start":{"line":54,"column":37},"end":{"line":54,"column":63}}],"line":54}},"s":{"0":1,"1":6,"2":5,"3":8,"4":6,"5":6,"6":0,"7":0,"8":0,"9":0,"10":14,"11":8,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":134,"20":6,"21":6,"22":1,"23":5,"24":0,"25":5,"26":5,"27":5,"28":2,"29":2,"30":2,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1},"f":{"0":8,"1":6,"2":5,"3":8,"4":6,"5":0,"6":14,"7":2,"8":134,"9":6,"10":6,"11":2,"12":2},"b":{"0":[1,1,1],"1":[1,5],"2":[8,8],"3":[8,6],"4":[8,8],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[1,5],"9":[6,6],"10":[0,5],"11":[1,1],"12":[2,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/guardianPolicies.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/guardianPolicies.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,wDAAuC;AACvC,gEAAwC;AAG3B,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,QAAQ;IACd,UAAU,EAAE;QACV,QAAQ,EAAE;YACR,IAAI,EAAE,OAAO;YACb,KAAK,EAAE;gBACL,IAAI,EAAE,QAAQ;gBACd,IAAI,EAAE,mBAAS,CAAC,iBAAiB;aAClC;SACF;KACF;IACD,oBAAoB,EAAE,KAAK;CAC5B,CAAC;AAEF,MAAqB,uBAAwB,SAAQ,iBAAc;IAKjE,YAAY,OAAO;QACjB,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,kBAAkB,IACxB,CAAC;IACL,CAAC;IAED,8EAA8E;IACxE,OAAO;;YACX,wDAAwD;YACxD,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,KAAK,UAAU,EAAE;gBACnF,OAAO,EAAE,CAAC;aACX;YAED,IAAI,IAAI,CAAC,QAAQ;gBAAE,OAAO,IAAI,CAAC,QAAQ,CAAC;YACxC,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;YAC1D,IAAI,CAAC,QAAQ,GAAG,EAAE,QAAQ,EAAE,CAAC;YAC7B,OAAO,IAAI,CAAC,QAAQ,CAAC;QACvB,CAAC;KAAA;IAEK,cAAc,CAAC,MAAc;;YACjC,mEAAmE;YACnE,MAAM,EAAE,gBAAgB,EAAE,GAAG,MAAM,CAAC;YAEpC,wBAAwB;YACxB,IAAI,CAAC,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,QAAQ;gBAAE,OAAO;YAE5D,MAAM,MAAM,GAAG,EAAE,CAAC;YAClB,MAAM,IAAI,GAAG,gBAAgB,CAAC,QAAQ,CAAC;YACvC,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YACxD,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;YAClB,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;QACnC,CAAC;KAAA;CACF;AAtCD,0CAsCC","sourcesContent":["import DefaultHandler from './default';\nimport constants from '../../constants';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'object',\n  properties: {\n    policies: {\n      type: 'array',\n      items: {\n        type: 'string',\n        enum: constants.GUARDIAN_POLICIES,\n      },\n    },\n  },\n  additionalProperties: false,\n};\n\nexport default class GuardianPoliciesHandler extends DefaultHandler {\n  existing: {\n    policies: Asset[];\n  };\n\n  constructor(options) {\n    super({\n      ...options,\n      type: 'guardianPolicies',\n    });\n  }\n\n  //TODO: standardize empty object literal with more intentional empty indicator\n  async getType(): Promise<GuardianPoliciesHandler['existing'] | {}> {\n    // in case client version does not support the operation\n    if (!this.client.guardian || typeof this.client.guardian.getPolicies !== 'function') {\n      return {};\n    }\n\n    if (this.existing) return this.existing;\n    const policies = await this.client.guardian.getPolicies();\n    this.existing = { policies };\n    return this.existing;\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    // No API to delete or create guardianPolicies, we can only update.\n    const { guardianPolicies } = assets;\n\n    // Do nothing if not set\n    if (!guardianPolicies || !guardianPolicies.policies) return;\n\n    const params = {};\n    const data = guardianPolicies.policies;\n    await this.client.guardian.updatePolicies(params, data);\n    this.updated += 1;\n    this.didUpdate(guardianPolicies);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"858a7407d7f582dd62fde3da717f73c74b4904b9","contentHash":"1339a85a03339ca30f52c709f4e2067216f7a5c90bed119dc96cffe0828374cc"},"/home/circleci/repo/src/tools/auth0/handlers/guardianPhoneFactorSelectedProvider.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/guardianPhoneFactorSelectedProvider.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":20},"end":{"line":17,"column":63}},"18":{"start":{"line":18,"column":0},"end":{"line":27,"column":2}},"19":{"start":{"line":28,"column":34},"end":{"line":42,"column":1}},"20":{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},"21":{"start":{"line":31,"column":8},"end":{"line":31,"column":20}},"22":{"start":{"line":33,"column":4},"end":{"line":40,"column":5}},"23":{"start":{"line":39,"column":8},"end":{"line":39,"column":20}},"24":{"start":{"line":41,"column":4},"end":{"line":41,"column":17}},"25":{"start":{"line":45,"column":8},"end":{"line":45,"column":106}},"26":{"start":{"line":48,"column":8},"end":{"line":67,"column":11}},"27":{"start":{"line":50,"column":12},"end":{"line":53,"column":13}},"28":{"start":{"line":52,"column":16},"end":{"line":52,"column":26}},"29":{"start":{"line":54,"column":12},"end":{"line":55,"column":37}},"30":{"start":{"line":55,"column":16},"end":{"line":55,"column":37}},"31":{"start":{"line":56,"column":12},"end":{"line":65,"column":13}},"32":{"start":{"line":57,"column":16},"end":{"line":57,"column":92}},"33":{"start":{"line":60,"column":16},"end":{"line":63,"column":17}},"34":{"start":{"line":62,"column":20},"end":{"line":62,"column":30}},"35":{"start":{"line":64,"column":16},"end":{"line":64,"column":24}},"36":{"start":{"line":66,"column":12},"end":{"line":66,"column":33}},"37":{"start":{"line":70,"column":8},"end":{"line":81,"column":11}},"38":{"start":{"line":72,"column":60},"end":{"line":72,"column":66}},"39":{"start":{"line":74,"column":12},"end":{"line":75,"column":23}},"40":{"start":{"line":75,"column":16},"end":{"line":75,"column":23}},"41":{"start":{"line":76,"column":27},"end":{"line":76,"column":29}},"42":{"start":{"line":77,"column":25},"end":{"line":77,"column":60}},"43":{"start":{"line":78,"column":12},"end":{"line":78,"column":87}},"44":{"start":{"line":79,"column":12},"end":{"line":79,"column":30}},"45":{"start":{"line":80,"column":12},"end":{"line":80,"column":64}},"46":{"start":{"line":84,"column":0},"end":{"line":84,"column":55}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":28,"column":34},"end":{"line":28,"column":35}},"loc":{"start":{"line":28,"column":43},"end":{"line":42,"column":1}},"line":28},"9":{"name":"(anonymous_9)","decl":{"start":{"line":44,"column":4},"end":{"line":44,"column":5}},"loc":{"start":{"line":44,"column":25},"end":{"line":46,"column":5}},"line":44},"10":{"name":"(anonymous_10)","decl":{"start":{"line":47,"column":4},"end":{"line":47,"column":5}},"loc":{"start":{"line":47,"column":14},"end":{"line":68,"column":5}},"line":47},"11":{"name":"(anonymous_11)","decl":{"start":{"line":48,"column":47},"end":{"line":48,"column":48}},"loc":{"start":{"line":48,"column":60},"end":{"line":67,"column":9}},"line":48},"12":{"name":"(anonymous_12)","decl":{"start":{"line":69,"column":4},"end":{"line":69,"column":5}},"loc":{"start":{"line":69,"column":27},"end":{"line":82,"column":5}},"line":69},"13":{"name":"(anonymous_13)","decl":{"start":{"line":70,"column":47},"end":{"line":70,"column":48}},"loc":{"start":{"line":70,"column":60},"end":{"line":81,"column":9}},"line":70}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":32,"column":5}},{"start":{"line":29,"column":4},"end":{"line":32,"column":5}}],"line":29},"9":{"loc":{"start":{"line":33,"column":4},"end":{"line":40,"column":5}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":40,"column":5}},{"start":{"line":33,"column":4},"end":{"line":40,"column":5}}],"line":33},"10":{"loc":{"start":{"line":33,"column":8},"end":{"line":37,"column":73}},"type":"binary-expr","locations":[{"start":{"line":33,"column":8},"end":{"line":33,"column":30}},{"start":{"line":34,"column":8},"end":{"line":34,"column":25}},{"start":{"line":35,"column":8},"end":{"line":35,"column":34}},{"start":{"line":36,"column":8},"end":{"line":36,"column":39}},{"start":{"line":37,"column":8},"end":{"line":37,"column":73}}],"line":33},"11":{"loc":{"start":{"line":50,"column":12},"end":{"line":53,"column":13}},"type":"if","locations":[{"start":{"line":50,"column":12},"end":{"line":53,"column":13}},{"start":{"line":50,"column":12},"end":{"line":53,"column":13}}],"line":50},"12":{"loc":{"start":{"line":50,"column":16},"end":{"line":51,"column":89}},"type":"binary-expr","locations":[{"start":{"line":50,"column":16},"end":{"line":50,"column":37}},{"start":{"line":51,"column":16},"end":{"line":51,"column":89}}],"line":50},"13":{"loc":{"start":{"line":54,"column":12},"end":{"line":55,"column":37}},"type":"if","locations":[{"start":{"line":54,"column":12},"end":{"line":55,"column":37}},{"start":{"line":54,"column":12},"end":{"line":55,"column":37}}],"line":54},"14":{"loc":{"start":{"line":60,"column":16},"end":{"line":63,"column":17}},"type":"if","locations":[{"start":{"line":60,"column":16},"end":{"line":63,"column":17}},{"start":{"line":60,"column":16},"end":{"line":63,"column":17}}],"line":60},"15":{"loc":{"start":{"line":74,"column":12},"end":{"line":75,"column":23}},"type":"if","locations":[{"start":{"line":74,"column":12},"end":{"line":75,"column":23}},{"start":{"line":74,"column":12},"end":{"line":75,"column":23}}],"line":74},"16":{"loc":{"start":{"line":74,"column":16},"end":{"line":74,"column":101}},"type":"binary-expr","locations":[{"start":{"line":74,"column":16},"end":{"line":74,"column":52}},{"start":{"line":74,"column":56},"end":{"line":74,"column":101}}],"line":74}},"s":{"0":1,"1":8,"2":5,"3":11,"4":6,"5":6,"6":0,"7":2,"8":2,"9":0,"10":18,"11":11,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":3,"21":1,"22":2,"23":1,"24":1,"25":137,"26":9,"27":9,"28":1,"29":8,"30":0,"31":8,"32":8,"33":3,"34":2,"35":1,"36":5,"37":2,"38":2,"39":2,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1},"f":{"0":11,"1":8,"2":5,"3":11,"4":6,"5":2,"6":18,"7":2,"8":3,"9":137,"10":9,"11":9,"12":2,"13":2},"b":{"0":[1,1,1],"1":[3,5],"2":[11,11],"3":[10,8],"4":[11,11],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[1,2],"9":[1,1],"10":[2,1,1,1,1],"11":[1,8],"12":[9,9],"13":[0,8],"14":[2,1],"15":[1,1],"16":[2,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/guardianPhoneFactorSelectedProvider.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/guardianPhoneFactorSelectedProvider.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,wDAAuC;AACvC,gEAAwC;AAG3B,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,QAAQ;IACd,UAAU,EAAE;QACV,QAAQ,EAAE;YACR,IAAI,EAAE,QAAQ;YACd,IAAI,EAAE,mBAAS,CAAC,wBAAwB;SACzC;KACF;IACD,oBAAoB,EAAE,KAAK;CAC5B,CAAC;AAEF,MAAM,yBAAyB,GAAG,CAAC,GAAG,EAAE,EAAE;IACxC,IAAI,GAAG,CAAC,UAAU,KAAK,GAAG,EAAE;QAC1B,oEAAoE;QACpE,OAAO,IAAI,CAAC;KACb;IACD,IACE,GAAG,CAAC,UAAU,KAAK,GAAG;QACtB,GAAG,CAAC,aAAa;QACjB,GAAG,CAAC,aAAa,CAAC,QAAQ;QAC1B,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI;QAC/B,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,KAAK,mBAAmB,EACjE;QACA,uEAAuE;QACvE,OAAO,IAAI,CAAC;KACb;IACD,OAAO,KAAK,CAAC;AACf,CAAC,CAAC;AAEF,MAAqB,oCAAqC,SAAQ,iBAAc;IAG9E,YAAY,OAAO;QACjB,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,qCAAqC,IAC3C,CAAC;IACL,CAAC;IAEK,OAAO;;YACX,wDAAwD;YACxD,IACE,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ;gBACrB,OAAO,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,8BAA8B,KAAK,UAAU,EACzE;gBACA,OAAO,EAAE,CAAC;aACX;YAED,IAAI,IAAI,CAAC,QAAQ;gBAAE,OAAO,IAAI,CAAC,QAAQ,CAAC;YAExC,IAAI;gBACF,IAAI,CAAC,QAAQ,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,8BAA8B,EAAE,CAAC;aAC7E;YAAC,OAAO,CAAC,EAAE;gBACV,IAAI,yBAAyB,CAAC,CAAC,CAAC,EAAE;oBAChC,uDAAuD;oBACvD,OAAO,EAAE,CAAC;iBACX;gBACD,MAAM,CAAC,CAAC;aACT;YAED,OAAO,IAAI,CAAC,QAAQ,CAAC;QACvB,CAAC;KAAA;IAEK,cAAc,CAAC,MAAc;;YACjC,sFAAsF;YACtF,MAAM,EAAE,mCAAmC,EAAE,GAAG,MAAM,CAAC;YAEvD,wBAAwB;YACxB,IAAI,CAAC,mCAAmC,IAAI,CAAC,mCAAmC,CAAC,QAAQ;gBACvF,OAAO;YAET,MAAM,MAAM,GAAG,EAAE,CAAC;YAClB,MAAM,IAAI,GAAG,mCAAmC,CAAC;YACjD,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,iCAAiC,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YAC3E,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;YAClB,IAAI,CAAC,SAAS,CAAC,mCAAmC,CAAC,CAAC;QACtD,CAAC;KAAA;CACF;AAhDD,uDAgDC","sourcesContent":["import DefaultHandler from './default';\nimport constants from '../../constants';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'object',\n  properties: {\n    provider: {\n      type: 'string',\n      enum: constants.GUARDIAN_PHONE_PROVIDERS,\n    },\n  },\n  additionalProperties: false,\n};\n\nconst isFeatureUnavailableError = (err) => {\n  if (err.statusCode === 404) {\n    // Older Management API version where the endpoint is not available.\n    return true;\n  }\n  if (\n    err.statusCode === 403 &&\n    err.originalError &&\n    err.originalError.response &&\n    err.originalError.response.body &&\n    err.originalError.response.body.errorCode === 'hooks_not_allowed'\n  ) {\n    // Recent Management API version, but with feature explicitly disabled.\n    return true;\n  }\n  return false;\n};\n\nexport default class GuardianPhoneSelectedProviderHandler extends DefaultHandler {\n  existing: Asset[];\n\n  constructor(options) {\n    super({\n      ...options,\n      type: 'guardianPhoneFactorSelectedProvider',\n    });\n  }\n\n  async getType() {\n    // in case client version does not support the operation\n    if (\n      !this.client.guardian ||\n      typeof this.client.guardian.getPhoneFactorSelectedProvider !== 'function'\n    ) {\n      return {};\n    }\n\n    if (this.existing) return this.existing;\n\n    try {\n      this.existing = await this.client.guardian.getPhoneFactorSelectedProvider();\n    } catch (e) {\n      if (isFeatureUnavailableError(e)) {\n        // Gracefully skip processing this configuration value.\n        return {};\n      }\n      throw e;\n    }\n\n    return this.existing;\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    // No API to delete or create guardianPhoneFactorSelectedProvider, we can only update.\n    const { guardianPhoneFactorSelectedProvider } = assets;\n\n    // Do nothing if not set\n    if (!guardianPhoneFactorSelectedProvider || !guardianPhoneFactorSelectedProvider.provider)\n      return;\n\n    const params = {};\n    const data = guardianPhoneFactorSelectedProvider;\n    await this.client.guardian.updatePhoneFactorSelectedProvider(params, data);\n    this.updated += 1;\n    this.didUpdate(guardianPhoneFactorSelectedProvider);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b6bcd6407adfb6c211c4fcd2d9ef9050986dbe44","contentHash":"11b2aa4d04eabfc8bc8ba842e8e6fb8fc631751d024995cd4e0e5a18a69fc74e"},"/home/circleci/repo/src/tools/auth0/handlers/guardianPhoneFactorMessageTypes.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/guardianPhoneFactorMessageTypes.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":20},"end":{"line":17,"column":63}},"18":{"start":{"line":18,"column":0},"end":{"line":30,"column":2}},"19":{"start":{"line":31,"column":34},"end":{"line":45,"column":1}},"20":{"start":{"line":32,"column":4},"end":{"line":35,"column":5}},"21":{"start":{"line":34,"column":8},"end":{"line":34,"column":20}},"22":{"start":{"line":36,"column":4},"end":{"line":43,"column":5}},"23":{"start":{"line":42,"column":8},"end":{"line":42,"column":20}},"24":{"start":{"line":44,"column":4},"end":{"line":44,"column":17}},"25":{"start":{"line":48,"column":8},"end":{"line":48,"column":102}},"26":{"start":{"line":51,"column":8},"end":{"line":70,"column":11}},"27":{"start":{"line":53,"column":12},"end":{"line":56,"column":13}},"28":{"start":{"line":55,"column":16},"end":{"line":55,"column":26}},"29":{"start":{"line":57,"column":12},"end":{"line":58,"column":37}},"30":{"start":{"line":58,"column":16},"end":{"line":58,"column":37}},"31":{"start":{"line":59,"column":12},"end":{"line":68,"column":13}},"32":{"start":{"line":60,"column":16},"end":{"line":60,"column":88}},"33":{"start":{"line":63,"column":16},"end":{"line":66,"column":17}},"34":{"start":{"line":65,"column":20},"end":{"line":65,"column":30}},"35":{"start":{"line":67,"column":16},"end":{"line":67,"column":24}},"36":{"start":{"line":69,"column":12},"end":{"line":69,"column":33}},"37":{"start":{"line":73,"column":8},"end":{"line":84,"column":11}},"38":{"start":{"line":75,"column":56},"end":{"line":75,"column":62}},"39":{"start":{"line":77,"column":12},"end":{"line":78,"column":23}},"40":{"start":{"line":78,"column":16},"end":{"line":78,"column":23}},"41":{"start":{"line":79,"column":27},"end":{"line":79,"column":29}},"42":{"start":{"line":80,"column":25},"end":{"line":80,"column":56}},"43":{"start":{"line":81,"column":12},"end":{"line":81,"column":83}},"44":{"start":{"line":82,"column":12},"end":{"line":82,"column":30}},"45":{"start":{"line":83,"column":12},"end":{"line":83,"column":60}},"46":{"start":{"line":87,"column":0},"end":{"line":87,"column":51}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":31,"column":34},"end":{"line":31,"column":35}},"loc":{"start":{"line":31,"column":43},"end":{"line":45,"column":1}},"line":31},"9":{"name":"(anonymous_9)","decl":{"start":{"line":47,"column":4},"end":{"line":47,"column":5}},"loc":{"start":{"line":47,"column":25},"end":{"line":49,"column":5}},"line":47},"10":{"name":"(anonymous_10)","decl":{"start":{"line":50,"column":4},"end":{"line":50,"column":5}},"loc":{"start":{"line":50,"column":14},"end":{"line":71,"column":5}},"line":50},"11":{"name":"(anonymous_11)","decl":{"start":{"line":51,"column":47},"end":{"line":51,"column":48}},"loc":{"start":{"line":51,"column":60},"end":{"line":70,"column":9}},"line":51},"12":{"name":"(anonymous_12)","decl":{"start":{"line":72,"column":4},"end":{"line":72,"column":5}},"loc":{"start":{"line":72,"column":27},"end":{"line":85,"column":5}},"line":72},"13":{"name":"(anonymous_13)","decl":{"start":{"line":73,"column":47},"end":{"line":73,"column":48}},"loc":{"start":{"line":73,"column":60},"end":{"line":84,"column":9}},"line":73}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":32,"column":4},"end":{"line":35,"column":5}},"type":"if","locations":[{"start":{"line":32,"column":4},"end":{"line":35,"column":5}},{"start":{"line":32,"column":4},"end":{"line":35,"column":5}}],"line":32},"9":{"loc":{"start":{"line":36,"column":4},"end":{"line":43,"column":5}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":43,"column":5}},{"start":{"line":36,"column":4},"end":{"line":43,"column":5}}],"line":36},"10":{"loc":{"start":{"line":36,"column":8},"end":{"line":40,"column":77}},"type":"binary-expr","locations":[{"start":{"line":36,"column":8},"end":{"line":36,"column":30}},{"start":{"line":37,"column":8},"end":{"line":37,"column":25}},{"start":{"line":38,"column":8},"end":{"line":38,"column":34}},{"start":{"line":39,"column":8},"end":{"line":39,"column":39}},{"start":{"line":40,"column":8},"end":{"line":40,"column":77}}],"line":36},"11":{"loc":{"start":{"line":53,"column":12},"end":{"line":56,"column":13}},"type":"if","locations":[{"start":{"line":53,"column":12},"end":{"line":56,"column":13}},{"start":{"line":53,"column":12},"end":{"line":56,"column":13}}],"line":53},"12":{"loc":{"start":{"line":53,"column":16},"end":{"line":54,"column":85}},"type":"binary-expr","locations":[{"start":{"line":53,"column":16},"end":{"line":53,"column":37}},{"start":{"line":54,"column":16},"end":{"line":54,"column":85}}],"line":53},"13":{"loc":{"start":{"line":57,"column":12},"end":{"line":58,"column":37}},"type":"if","locations":[{"start":{"line":57,"column":12},"end":{"line":58,"column":37}},{"start":{"line":57,"column":12},"end":{"line":58,"column":37}}],"line":57},"14":{"loc":{"start":{"line":63,"column":16},"end":{"line":66,"column":17}},"type":"if","locations":[{"start":{"line":63,"column":16},"end":{"line":66,"column":17}},{"start":{"line":63,"column":16},"end":{"line":66,"column":17}}],"line":63},"15":{"loc":{"start":{"line":77,"column":12},"end":{"line":78,"column":23}},"type":"if","locations":[{"start":{"line":77,"column":12},"end":{"line":78,"column":23}},{"start":{"line":77,"column":12},"end":{"line":78,"column":23}}],"line":77},"16":{"loc":{"start":{"line":77,"column":16},"end":{"line":77,"column":98}},"type":"binary-expr","locations":[{"start":{"line":77,"column":16},"end":{"line":77,"column":48}},{"start":{"line":77,"column":52},"end":{"line":77,"column":98}}],"line":77}},"s":{"0":1,"1":8,"2":5,"3":11,"4":6,"5":6,"6":0,"7":2,"8":2,"9":0,"10":18,"11":11,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":3,"21":1,"22":2,"23":1,"24":1,"25":137,"26":9,"27":9,"28":1,"29":8,"30":0,"31":8,"32":8,"33":3,"34":2,"35":1,"36":5,"37":2,"38":2,"39":2,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1},"f":{"0":11,"1":8,"2":5,"3":11,"4":6,"5":2,"6":18,"7":2,"8":3,"9":137,"10":9,"11":9,"12":2,"13":2},"b":{"0":[1,1,1],"1":[3,5],"2":[11,11],"3":[10,8],"4":[11,11],"5":[1,1,1],"6":[2,0],"7":[2,2],"8":[1,2],"9":[1,1],"10":[2,1,1,1,1],"11":[1,8],"12":[9,9],"13":[0,8],"14":[2,1],"15":[1,1],"16":[2,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/guardianPhoneFactorMessageTypes.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/guardianPhoneFactorMessageTypes.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,wDAAuC;AACvC,gEAAwC;AAG3B,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,QAAQ;IACd,UAAU,EAAE;QACV,aAAa,EAAE;YACb,IAAI,EAAE,OAAO;YACb,KAAK,EAAE;gBACL,IAAI,EAAE,QAAQ;gBACd,IAAI,EAAE,mBAAS,CAAC,4BAA4B;aAC7C;SACF;KACF;IACD,oBAAoB,EAAE,KAAK;CAC5B,CAAC;AAEF,MAAM,yBAAyB,GAAG,CAAC,GAAG,EAAW,EAAE;IACjD,IAAI,GAAG,CAAC,UAAU,KAAK,GAAG,EAAE;QAC1B,oEAAoE;QACpE,OAAO,IAAI,CAAC;KACb;IACD,IACE,GAAG,CAAC,UAAU,KAAK,GAAG;QACtB,GAAG,CAAC,aAAa;QACjB,GAAG,CAAC,aAAa,CAAC,QAAQ;QAC1B,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI;QAC/B,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,KAAK,uBAAuB,EACrE;QACA,uEAAuE;QACvE,OAAO,IAAI,CAAC;KACb;IACD,OAAO,KAAK,CAAC;AACf,CAAC,CAAC;AAEF,MAAqB,gCAAiC,SAAQ,iBAAc;IAG1E,YAAY,OAAuB;QACjC,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,iCAAiC,IACvC,CAAC;IACL,CAAC;IAEK,OAAO;;YACX,wDAAwD;YACxD,IACE,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ;gBACrB,OAAO,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,0BAA0B,KAAK,UAAU,EACrE;gBACA,OAAO,EAAE,CAAC;aACX;YAED,IAAI,IAAI,CAAC,QAAQ;gBAAE,OAAO,IAAI,CAAC,QAAQ,CAAC;YAExC,IAAI;gBACF,IAAI,CAAC,QAAQ,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,0BAA0B,EAAE,CAAC;aACzE;YAAC,OAAO,CAAC,EAAE;gBACV,IAAI,yBAAyB,CAAC,CAAC,CAAC,EAAE;oBAChC,uDAAuD;oBACvD,OAAO,EAAE,CAAC;iBACX;gBACD,MAAM,CAAC,CAAC;aACT;YAED,OAAO,IAAI,CAAC,QAAQ,CAAC;QACvB,CAAC;KAAA;IAEK,cAAc,CAAC,MAAc;;YACjC,kFAAkF;YAClF,MAAM,EAAE,+BAA+B,EAAE,GAAG,MAAM,CAAC;YAEnD,wBAAwB;YACxB,IAAI,CAAC,+BAA+B,IAAI,CAAC,+BAA+B,CAAC,aAAa;gBAAE,OAAO;YAE/F,MAAM,MAAM,GAAG,EAAE,CAAC;YAClB,MAAM,IAAI,GAAG,+BAA+B,CAAC;YAC7C,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,6BAA6B,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YACvE,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;YAClB,IAAI,CAAC,SAAS,CAAC,+BAA+B,CAAC,CAAC;QAClD,CAAC;KAAA;CACF;AA/CD,mDA+CC","sourcesContent":["import DefaultHandler from './default';\nimport constants from '../../constants';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'object',\n  properties: {\n    message_types: {\n      type: 'array',\n      items: {\n        type: 'string',\n        enum: constants.GUARDIAN_PHONE_MESSAGE_TYPES,\n      },\n    },\n  },\n  additionalProperties: false,\n};\n\nconst isFeatureUnavailableError = (err): boolean => {\n  if (err.statusCode === 404) {\n    // Older Management API version where the endpoint is not available.\n    return true;\n  }\n  if (\n    err.statusCode === 403 &&\n    err.originalError &&\n    err.originalError.response &&\n    err.originalError.response.body &&\n    err.originalError.response.body.errorCode === 'voice_mfa_not_allowed'\n  ) {\n    // Recent Management API version, but with feature explicitly disabled.\n    return true;\n  }\n  return false;\n};\n\nexport default class GuardianPhoneMessageTypesHandler extends DefaultHandler {\n  existing: Asset[];\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'guardianPhoneFactorMessageTypes',\n    });\n  }\n\n  async getType(): Promise<Asset[] | {}> {\n    // in case client version does not support the operation\n    if (\n      !this.client.guardian ||\n      typeof this.client.guardian.getPhoneFactorMessageTypes !== 'function'\n    ) {\n      return {};\n    }\n\n    if (this.existing) return this.existing;\n\n    try {\n      this.existing = await this.client.guardian.getPhoneFactorMessageTypes();\n    } catch (e) {\n      if (isFeatureUnavailableError(e)) {\n        // Gracefully skip processing this configuration value.\n        return {};\n      }\n      throw e;\n    }\n\n    return this.existing;\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    // No API to delete or create guardianPhoneFactorMessageTypes, we can only update.\n    const { guardianPhoneFactorMessageTypes } = assets;\n\n    // Do nothing if not set\n    if (!guardianPhoneFactorMessageTypes || !guardianPhoneFactorMessageTypes.message_types) return;\n\n    const params = {};\n    const data = guardianPhoneFactorMessageTypes;\n    await this.client.guardian.updatePhoneFactorMessageTypes(params, data);\n    this.updated += 1;\n    this.didUpdate(guardianPhoneFactorMessageTypes);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e6c5494df33b042f33e52156ddc3804a978fe94e","contentHash":"da78332f54e64aacd65ab05ee4501b77f9258e3c2a448a9a48be3207517f8282"},"/home/circleci/repo/src/tools/auth0/handlers/roles.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/roles.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":24}},"50":{"start":{"line":45,"column":18},"end":{"line":45,"column":52}},"51":{"start":{"line":46,"column":27},"end":{"line":46,"column":60}},"52":{"start":{"line":47,"column":17},"end":{"line":47,"column":60}},"53":{"start":{"line":48,"column":0},"end":{"line":69,"column":2}},"54":{"start":{"line":72,"column":8},"end":{"line":72,"column":85}},"55":{"start":{"line":75,"column":8},"end":{"line":83,"column":11}},"56":{"start":{"line":76,"column":25},"end":{"line":76,"column":48}},"57":{"start":{"line":77,"column":12},"end":{"line":77,"column":36}},"58":{"start":{"line":78,"column":28},"end":{"line":78,"column":64}},"59":{"start":{"line":79,"column":12},"end":{"line":81,"column":13}},"60":{"start":{"line":80,"column":16},"end":{"line":80,"column":114}},"61":{"start":{"line":82,"column":12},"end":{"line":82,"column":27}},"62":{"start":{"line":86,"column":8},"end":{"line":100,"column":11}},"63":{"start":{"line":87,"column":12},"end":{"line":99,"column":27}},"64":{"start":{"line":90,"column":37},"end":{"line":97,"column":18}},"65":{"start":{"line":92,"column":20},"end":{"line":92,"column":41}},"66":{"start":{"line":93,"column":20},"end":{"line":93,"column":38}},"67":{"start":{"line":96,"column":20},"end":{"line":96,"column":101}},"68":{"start":{"line":103,"column":8},"end":{"line":105,"column":11}},"69":{"start":{"line":104,"column":12},"end":{"line":104,"column":60}},"70":{"start":{"line":108,"column":8},"end":{"line":129,"column":11}},"71":{"start":{"line":109,"column":12},"end":{"line":128,"column":13}},"72":{"start":{"line":111,"column":16},"end":{"line":123,"column":31}},"73":{"start":{"line":114,"column":41},"end":{"line":121,"column":22}},"74":{"start":{"line":116,"column":24},"end":{"line":116,"column":45}},"75":{"start":{"line":117,"column":24},"end":{"line":117,"column":42}},"76":{"start":{"line":120,"column":24},"end":{"line":120,"column":105}},"77":{"start":{"line":126,"column":16},"end":{"line":127,"column":59}},"78":{"start":{"line":127,"column":26},"end":{"line":127,"column":43}},"79":{"start":{"line":132,"column":8},"end":{"line":146,"column":11}},"80":{"start":{"line":133,"column":33},"end":{"line":133,"column":110}},"81":{"start":{"line":133,"column":73},"end":{"line":133,"column":109}},"82":{"start":{"line":134,"column":27},"end":{"line":134,"column":42}},"83":{"start":{"line":135,"column":35},"end":{"line":135,"column":51}},"84":{"start":{"line":136,"column":12},"end":{"line":136,"column":36}},"85":{"start":{"line":137,"column":12},"end":{"line":137,"column":27}},"86":{"start":{"line":138,"column":12},"end":{"line":138,"column":57}},"87":{"start":{"line":139,"column":12},"end":{"line":141,"column":13}},"88":{"start":{"line":140,"column":16},"end":{"line":140,"column":110}},"89":{"start":{"line":142,"column":12},"end":{"line":144,"column":13}},"90":{"start":{"line":143,"column":16},"end":{"line":143,"column":100}},"91":{"start":{"line":145,"column":12},"end":{"line":145,"column":26}},"92":{"start":{"line":149,"column":8},"end":{"line":163,"column":11}},"93":{"start":{"line":150,"column":12},"end":{"line":162,"column":27}},"94":{"start":{"line":153,"column":37},"end":{"line":160,"column":18}},"95":{"start":{"line":155,"column":20},"end":{"line":155,"column":41}},"96":{"start":{"line":156,"column":20},"end":{"line":156,"column":38}},"97":{"start":{"line":159,"column":20},"end":{"line":159,"column":101}},"98":{"start":{"line":166,"column":8},"end":{"line":198,"column":11}},"99":{"start":{"line":167,"column":12},"end":{"line":169,"column":13}},"100":{"start":{"line":168,"column":16},"end":{"line":168,"column":37}},"101":{"start":{"line":171,"column":12},"end":{"line":173,"column":13}},"102":{"start":{"line":172,"column":16},"end":{"line":172,"column":26}},"103":{"start":{"line":174,"column":12},"end":{"line":197,"column":13}},"104":{"start":{"line":175,"column":30},"end":{"line":175,"column":102}},"105":{"start":{"line":176,"column":16},"end":{"line":188,"column":17}},"106":{"start":{"line":176,"column":33},"end":{"line":176,"column":34}},"107":{"start":{"line":177,"column":40},"end":{"line":181,"column":22}},"108":{"start":{"line":182,"column":42},"end":{"line":186,"column":24}},"109":{"start":{"line":182,"column":92},"end":{"line":186,"column":22}},"110":{"start":{"line":183,"column":24},"end":{"line":183,"column":63}},"111":{"start":{"line":184,"column":24},"end":{"line":184,"column":54}},"112":{"start":{"line":185,"column":24},"end":{"line":185,"column":42}},"113":{"start":{"line":187,"column":20},"end":{"line":187,"column":61}},"114":{"start":{"line":189,"column":16},"end":{"line":189,"column":38}},"115":{"start":{"line":190,"column":16},"end":{"line":190,"column":37}},"116":{"start":{"line":193,"column":16},"end":{"line":195,"column":17}},"117":{"start":{"line":194,"column":20},"end":{"line":194,"column":30}},"118":{"start":{"line":196,"column":16},"end":{"line":196,"column":26}},"119":{"start":{"line":201,"column":8},"end":{"line":238,"column":11}},"120":{"start":{"line":202,"column":30},"end":{"line":202,"column":36}},"121":{"start":{"line":204,"column":12},"end":{"line":205,"column":23}},"122":{"start":{"line":205,"column":16},"end":{"line":205,"column":23}},"123":{"start":{"line":207,"column":29},"end":{"line":207,"column":49}},"124":{"start":{"line":208,"column":28},"end":{"line":214,"column":14}},"125":{"start":{"line":215,"column":12},"end":{"line":215,"column":169}},"126":{"start":{"line":216,"column":30},"end":{"line":220,"column":13}},"127":{"start":{"line":221,"column":12},"end":{"line":237,"column":17}},"128":{"start":{"line":221,"column":56},"end":{"line":237,"column":14}},"129":{"start":{"line":222,"column":16},"end":{"line":236,"column":17}},"130":{"start":{"line":224,"column":24},"end":{"line":225,"column":63}},"131":{"start":{"line":225,"column":28},"end":{"line":225,"column":63}},"132":{"start":{"line":226,"column":24},"end":{"line":226,"column":30}},"133":{"start":{"line":228,"column":24},"end":{"line":228,"column":63}},"134":{"start":{"line":229,"column":24},"end":{"line":229,"column":30}},"135":{"start":{"line":231,"column":24},"end":{"line":232,"column":76}},"136":{"start":{"line":232,"column":28},"end":{"line":232,"column":76}},"137":{"start":{"line":233,"column":24},"end":{"line":233,"column":30}},"138":{"start":{"line":235,"column":24},"end":{"line":235,"column":30}},"139":{"start":{"line":241,"column":0},"end":{"line":243,"column":51}},"140":{"start":{"line":244,"column":0},"end":{"line":244,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"(anonymous_15)","decl":{"start":{"line":71,"column":4},"end":{"line":71,"column":5}},"loc":{"start":{"line":71,"column":24},"end":{"line":73,"column":5}},"line":71},"16":{"name":"(anonymous_16)","decl":{"start":{"line":74,"column":4},"end":{"line":74,"column":5}},"loc":{"start":{"line":74,"column":21},"end":{"line":84,"column":5}},"line":74},"17":{"name":"(anonymous_17)","decl":{"start":{"line":75,"column":47},"end":{"line":75,"column":48}},"loc":{"start":{"line":75,"column":60},"end":{"line":83,"column":9}},"line":75},"18":{"name":"(anonymous_18)","decl":{"start":{"line":85,"column":4},"end":{"line":85,"column":5}},"loc":{"start":{"line":85,"column":25},"end":{"line":101,"column":5}},"line":85},"19":{"name":"(anonymous_19)","decl":{"start":{"line":86,"column":47},"end":{"line":86,"column":48}},"loc":{"start":{"line":86,"column":60},"end":{"line":100,"column":9}},"line":86},"20":{"name":"(anonymous_20)","decl":{"start":{"line":90,"column":27},"end":{"line":90,"column":28}},"loc":{"start":{"line":90,"column":37},"end":{"line":97,"column":18}},"line":90},"21":{"name":"(anonymous_21)","decl":{"start":{"line":91,"column":26},"end":{"line":91,"column":27}},"loc":{"start":{"line":91,"column":36},"end":{"line":94,"column":17}},"line":91},"22":{"name":"(anonymous_22)","decl":{"start":{"line":95,"column":27},"end":{"line":95,"column":28}},"loc":{"start":{"line":95,"column":36},"end":{"line":97,"column":17}},"line":95},"23":{"name":"(anonymous_23)","decl":{"start":{"line":102,"column":4},"end":{"line":102,"column":5}},"loc":{"start":{"line":102,"column":21},"end":{"line":106,"column":5}},"line":102},"24":{"name":"(anonymous_24)","decl":{"start":{"line":103,"column":47},"end":{"line":103,"column":48}},"loc":{"start":{"line":103,"column":60},"end":{"line":105,"column":9}},"line":103},"25":{"name":"(anonymous_25)","decl":{"start":{"line":107,"column":4},"end":{"line":107,"column":5}},"loc":{"start":{"line":107,"column":22},"end":{"line":130,"column":5}},"line":107},"26":{"name":"(anonymous_26)","decl":{"start":{"line":108,"column":47},"end":{"line":108,"column":48}},"loc":{"start":{"line":108,"column":60},"end":{"line":129,"column":9}},"line":108},"27":{"name":"(anonymous_27)","decl":{"start":{"line":114,"column":31},"end":{"line":114,"column":32}},"loc":{"start":{"line":114,"column":41},"end":{"line":121,"column":22}},"line":114},"28":{"name":"(anonymous_28)","decl":{"start":{"line":115,"column":30},"end":{"line":115,"column":31}},"loc":{"start":{"line":115,"column":36},"end":{"line":118,"column":21}},"line":115},"29":{"name":"(anonymous_29)","decl":{"start":{"line":119,"column":31},"end":{"line":119,"column":32}},"loc":{"start":{"line":119,"column":40},"end":{"line":121,"column":21}},"line":119},"30":{"name":"(anonymous_30)","decl":{"start":{"line":127,"column":19},"end":{"line":127,"column":20}},"loc":{"start":{"line":127,"column":26},"end":{"line":127,"column":43}},"line":127},"31":{"name":"(anonymous_31)","decl":{"start":{"line":131,"column":4},"end":{"line":131,"column":5}},"loc":{"start":{"line":131,"column":28},"end":{"line":147,"column":5}},"line":131},"32":{"name":"(anonymous_32)","decl":{"start":{"line":132,"column":47},"end":{"line":132,"column":48}},"loc":{"start":{"line":132,"column":60},"end":{"line":146,"column":9}},"line":132},"33":{"name":"(anonymous_33)","decl":{"start":{"line":133,"column":50},"end":{"line":133,"column":51}},"loc":{"start":{"line":133,"column":73},"end":{"line":133,"column":109}},"line":133},"34":{"name":"(anonymous_34)","decl":{"start":{"line":148,"column":4},"end":{"line":148,"column":5}},"loc":{"start":{"line":148,"column":32},"end":{"line":164,"column":5}},"line":148},"35":{"name":"(anonymous_35)","decl":{"start":{"line":149,"column":47},"end":{"line":149,"column":48}},"loc":{"start":{"line":149,"column":60},"end":{"line":163,"column":9}},"line":149},"36":{"name":"(anonymous_36)","decl":{"start":{"line":153,"column":27},"end":{"line":153,"column":28}},"loc":{"start":{"line":153,"column":37},"end":{"line":160,"column":18}},"line":153},"37":{"name":"(anonymous_37)","decl":{"start":{"line":154,"column":26},"end":{"line":154,"column":27}},"loc":{"start":{"line":154,"column":36},"end":{"line":157,"column":17}},"line":154},"38":{"name":"(anonymous_38)","decl":{"start":{"line":158,"column":27},"end":{"line":158,"column":28}},"loc":{"start":{"line":158,"column":36},"end":{"line":160,"column":17}},"line":158},"39":{"name":"(anonymous_39)","decl":{"start":{"line":165,"column":4},"end":{"line":165,"column":5}},"loc":{"start":{"line":165,"column":14},"end":{"line":199,"column":5}},"line":165},"40":{"name":"(anonymous_40)","decl":{"start":{"line":166,"column":47},"end":{"line":166,"column":48}},"loc":{"start":{"line":166,"column":60},"end":{"line":198,"column":9}},"line":166},"41":{"name":"(anonymous_41)","decl":{"start":{"line":182,"column":76},"end":{"line":182,"column":77}},"loc":{"start":{"line":182,"column":92},"end":{"line":186,"column":22}},"line":182},"42":{"name":"(anonymous_42)","decl":{"start":{"line":182,"column":124},"end":{"line":182,"column":125}},"loc":{"start":{"line":182,"column":137},"end":{"line":186,"column":21}},"line":182},"43":{"name":"(anonymous_43)","decl":{"start":{"line":200,"column":4},"end":{"line":200,"column":5}},"loc":{"start":{"line":200,"column":27},"end":{"line":239,"column":5}},"line":200},"44":{"name":"(anonymous_44)","decl":{"start":{"line":201,"column":47},"end":{"line":201,"column":48}},"loc":{"start":{"line":201,"column":60},"end":{"line":238,"column":9}},"line":201},"45":{"name":"(anonymous_45)","decl":{"start":{"line":221,"column":44},"end":{"line":221,"column":45}},"loc":{"start":{"line":221,"column":56},"end":{"line":237,"column":14}},"line":221},"46":{"name":"(anonymous_46)","decl":{"start":{"line":221,"column":88},"end":{"line":221,"column":89}},"loc":{"start":{"line":221,"column":101},"end":{"line":237,"column":13}},"line":221}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":79,"column":12},"end":{"line":81,"column":13}},"type":"if","locations":[{"start":{"line":79,"column":12},"end":{"line":81,"column":13}},{"start":{"line":79,"column":12},"end":{"line":81,"column":13}}],"line":79},"35":{"loc":{"start":{"line":79,"column":16},"end":{"line":79,"column":86}},"type":"binary-expr","locations":[{"start":{"line":79,"column":16},"end":{"line":79,"column":55}},{"start":{"line":79,"column":59},"end":{"line":79,"column":86}}],"line":79},"36":{"loc":{"start":{"line":89,"column":22},"end":{"line":89,"column":35}},"type":"binary-expr","locations":[{"start":{"line":89,"column":22},"end":{"line":89,"column":29}},{"start":{"line":89,"column":33},"end":{"line":89,"column":35}}],"line":89},"37":{"loc":{"start":{"line":109,"column":12},"end":{"line":128,"column":13}},"type":"if","locations":[{"start":{"line":109,"column":12},"end":{"line":128,"column":13}},{"start":{"line":109,"column":12},"end":{"line":128,"column":13}}],"line":109},"38":{"loc":{"start":{"line":109,"column":16},"end":{"line":110,"column":58}},"type":"binary-expr","locations":[{"start":{"line":109,"column":16},"end":{"line":109,"column":60}},{"start":{"line":110,"column":16},"end":{"line":110,"column":58}}],"line":109},"39":{"loc":{"start":{"line":113,"column":26},"end":{"line":113,"column":36}},"type":"binary-expr","locations":[{"start":{"line":113,"column":26},"end":{"line":113,"column":30}},{"start":{"line":113,"column":34},"end":{"line":113,"column":36}}],"line":113},"40":{"loc":{"start":{"line":139,"column":12},"end":{"line":141,"column":13}},"type":"if","locations":[{"start":{"line":139,"column":12},"end":{"line":141,"column":13}},{"start":{"line":139,"column":12},"end":{"line":141,"column":13}}],"line":139},"41":{"loc":{"start":{"line":139,"column":16},"end":{"line":139,"column":102}},"type":"binary-expr","locations":[{"start":{"line":139,"column":16},"end":{"line":139,"column":63}},{"start":{"line":139,"column":67},"end":{"line":139,"column":102}}],"line":139},"42":{"loc":{"start":{"line":142,"column":12},"end":{"line":144,"column":13}},"type":"if","locations":[{"start":{"line":142,"column":12},"end":{"line":144,"column":13}},{"start":{"line":142,"column":12},"end":{"line":144,"column":13}}],"line":142},"43":{"loc":{"start":{"line":142,"column":16},"end":{"line":142,"column":82}},"type":"binary-expr","locations":[{"start":{"line":142,"column":16},"end":{"line":142,"column":53}},{"start":{"line":142,"column":57},"end":{"line":142,"column":82}}],"line":142},"44":{"loc":{"start":{"line":152,"column":22},"end":{"line":152,"column":35}},"type":"binary-expr","locations":[{"start":{"line":152,"column":22},"end":{"line":152,"column":29}},{"start":{"line":152,"column":33},"end":{"line":152,"column":35}}],"line":152},"45":{"loc":{"start":{"line":167,"column":12},"end":{"line":169,"column":13}},"type":"if","locations":[{"start":{"line":167,"column":12},"end":{"line":169,"column":13}},{"start":{"line":167,"column":12},"end":{"line":169,"column":13}}],"line":167},"46":{"loc":{"start":{"line":171,"column":12},"end":{"line":173,"column":13}},"type":"if","locations":[{"start":{"line":171,"column":12},"end":{"line":173,"column":13}},{"start":{"line":171,"column":12},"end":{"line":173,"column":13}}],"line":171},"47":{"loc":{"start":{"line":171,"column":16},"end":{"line":171,"column":84}},"type":"binary-expr","locations":[{"start":{"line":171,"column":16},"end":{"line":171,"column":34}},{"start":{"line":171,"column":38},"end":{"line":171,"column":84}}],"line":171},"48":{"loc":{"start":{"line":193,"column":16},"end":{"line":195,"column":17}},"type":"if","locations":[{"start":{"line":193,"column":16},"end":{"line":195,"column":17}},{"start":{"line":193,"column":16},"end":{"line":195,"column":17}}],"line":193},"49":{"loc":{"start":{"line":193,"column":20},"end":{"line":193,"column":68}},"type":"binary-expr","locations":[{"start":{"line":193,"column":20},"end":{"line":193,"column":42}},{"start":{"line":193,"column":46},"end":{"line":193,"column":68}}],"line":193},"50":{"loc":{"start":{"line":204,"column":12},"end":{"line":205,"column":23}},"type":"if","locations":[{"start":{"line":204,"column":12},"end":{"line":205,"column":23}},{"start":{"line":204,"column":12},"end":{"line":205,"column":23}}],"line":204},"51":{"loc":{"start":{"line":222,"column":16},"end":{"line":236,"column":17}},"type":"switch","locations":[{"start":{"line":223,"column":20},"end":{"line":226,"column":30}},{"start":{"line":227,"column":20},"end":{"line":229,"column":30}},{"start":{"line":230,"column":20},"end":{"line":233,"column":30}},{"start":{"line":234,"column":20},"end":{"line":235,"column":30}}],"line":222},"52":{"loc":{"start":{"line":223,"column":25},"end":{"line":223,"column":60}},"type":"binary-expr","locations":[{"start":{"line":223,"column":25},"end":{"line":223,"column":35}},{"start":{"line":223,"column":39},"end":{"line":223,"column":60}}],"line":223},"53":{"loc":{"start":{"line":224,"column":24},"end":{"line":225,"column":63}},"type":"if","locations":[{"start":{"line":224,"column":24},"end":{"line":225,"column":63}},{"start":{"line":224,"column":24},"end":{"line":225,"column":63}}],"line":224},"54":{"loc":{"start":{"line":227,"column":25},"end":{"line":227,"column":66}},"type":"binary-expr","locations":[{"start":{"line":227,"column":25},"end":{"line":227,"column":38}},{"start":{"line":227,"column":42},"end":{"line":227,"column":66}}],"line":227},"55":{"loc":{"start":{"line":230,"column":25},"end":{"line":230,"column":66}},"type":"binary-expr","locations":[{"start":{"line":230,"column":25},"end":{"line":230,"column":38}},{"start":{"line":230,"column":42},"end":{"line":230,"column":66}}],"line":230},"56":{"loc":{"start":{"line":231,"column":24},"end":{"line":232,"column":76}},"type":"if","locations":[{"start":{"line":231,"column":24},"end":{"line":232,"column":76}},{"start":{"line":231,"column":24},"end":{"line":232,"column":76}}],"line":231}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":43,"36":5,"37":186,"38":43,"39":43,"40":0,"41":0,"42":0,"43":0,"44":228,"45":186,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":139,"55":2,"56":2,"57":2,"58":2,"59":2,"60":0,"61":2,"62":2,"63":2,"64":2,"65":2,"66":2,"67":0,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":1,"75":1,"76":0,"77":0,"78":0,"79":1,"80":1,"81":1,"82":1,"83":1,"84":1,"85":1,"86":1,"87":1,"88":1,"89":1,"90":1,"91":1,"92":1,"93":1,"94":1,"95":1,"96":1,"97":0,"98":11,"99":11,"100":0,"101":11,"102":0,"103":11,"104":11,"105":8,"106":8,"107":7,"108":7,"109":155,"110":155,"111":155,"112":155,"113":7,"114":8,"115":8,"116":3,"117":2,"118":1,"119":3,"120":3,"121":3,"122":0,"123":3,"124":3,"125":3,"126":3,"127":3,"128":9,"129":9,"130":1,"131":1,"132":1,"133":2,"134":2,"135":1,"136":1,"137":1,"138":5,"139":1,"140":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":186,"8":43,"9":5,"10":186,"11":43,"12":0,"13":228,"14":1,"15":139,"16":2,"17":2,"18":2,"19":2,"20":2,"21":2,"22":0,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":0,"30":0,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":0,"39":11,"40":11,"41":155,"42":155,"43":3,"44":3,"45":9,"46":9},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[38,5],"28":[186,186],"29":[185,43],"30":[186,186],"31":[1,1,1],"32":[1,0],"33":[1,1],"34":[0,2],"35":[2,1],"36":[2,0],"37":[1,0],"38":[1,1],"39":[1,0],"40":[1,0],"41":[1,1],"42":[1,0],"43":[1,1],"44":[1,0],"45":[0,11],"46":[0,11],"47":[11,11],"48":[2,1],"49":[3,2],"50":[0,3],"51":[1,2,1,5],"52":[9,3],"53":[1,0],"54":[8,3],"55":[6,3],"56":[1,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/roles.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/roles.ts"],"names":[],"mappings":"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","sourcesContent":["import DefaultHandler, { order } from './default';\nimport { calculateChanges } from '../../calculateChanges';\nimport log from '../../../logger';\nimport { Asset, Assets, CalculatedChanges } from '../../../types';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      name: { type: 'string' },\n      id: { type: 'string' },\n      description: { type: 'string' },\n      permissions: {\n        type: 'array',\n        items: {\n          type: 'object',\n          properties: {\n            permission_name: { type: 'string' },\n            resource_server_identifier: { type: 'string' },\n          },\n        },\n      },\n    },\n    required: ['name'],\n  },\n};\n\nexport default class RolesHandler extends DefaultHandler {\n  existing: Asset[];\n\n  constructor(config: DefaultHandler) {\n    super({\n      ...config,\n      type: 'roles',\n      id: 'id',\n    });\n  }\n\n  async createRole(data): Promise<Asset> {\n    const role = { ...data };\n    delete role.permissions;\n\n    const created = await this.client.roles.create(role);\n\n    if (typeof data.permissions !== 'undefined' && data.permissions.length > 0) {\n      await this.client.roles.permissions.create(\n        { id: created.id },\n        { permissions: data.permissions }\n      );\n    }\n\n    return created;\n  }\n\n  async createRoles(creates: CalculatedChanges['create']): Promise<void> {\n    await this.client.pool\n      .addEachTask({\n        data: creates || [],\n        generator: (item) =>\n          this.createRole(item)\n            .then((data) => {\n              this.didCreate(data);\n              this.created += 1;\n            })\n            .catch((err) => {\n              throw new Error(`Problem creating ${this.type} ${this.objString(item)}\\n${err}`);\n            }),\n      })\n      .promise();\n  }\n\n  async deleteRole(data) {\n    await this.client.roles.delete({ id: data.id });\n  }\n\n  async deleteRoles(dels: CalculatedChanges['del']): Promise<void> {\n    if (\n      this.config('AUTH0_ALLOW_DELETE') === 'true' ||\n      this.config('AUTH0_ALLOW_DELETE') === true\n    ) {\n      await this.client.pool\n        .addEachTask({\n          data: dels || [],\n          generator: (item) =>\n            this.deleteRole(item)\n              .then(() => {\n                this.didDelete(item);\n                this.deleted += 1;\n              })\n              .catch((err) => {\n                throw new Error(`Problem deleting ${this.type} ${this.objString(item)}\\n${err}`);\n              }),\n        })\n        .promise();\n    } else {\n      log.warn(`Detected the following roles should be deleted. Doing so may be destructive.\\nYou can enable deletes by setting 'AUTH0_ALLOW_DELETE' to true in the config\n      \\n${dels.map((i) => this.objString(i)).join('\\n')}`);\n    }\n  }\n\n  async updateRole(data, roles) {\n    const existingRole = await roles.find(\n      (roleDataForUpdate) => roleDataForUpdate.name === data.name\n    );\n\n    const params = { id: data.id };\n    const newPermissions = data.permissions;\n\n    delete data.permissions;\n    delete data.id;\n\n    await this.client.roles.update(params, data);\n\n    if (typeof existingRole.permissions !== 'undefined' && existingRole.permissions.length > 0) {\n      await this.client.roles.permissions.delete(params, { permissions: existingRole.permissions });\n    }\n\n    if (typeof newPermissions !== 'undefined' && newPermissions.length > 0) {\n      await this.client.roles.permissions.create(params, { permissions: newPermissions });\n    }\n\n    return params;\n  }\n\n  async updateRoles(updates: CalculatedChanges['update'], roles) {\n    await this.client.pool\n      .addEachTask({\n        data: updates || [],\n        generator: (item) =>\n          this.updateRole(item, roles)\n            .then((data) => {\n              this.didUpdate(data);\n              this.updated += 1;\n            })\n            .catch((err) => {\n              throw new Error(`Problem updating ${this.type} ${this.objString(item)}\\n${err}`);\n            }),\n      })\n      .promise();\n  }\n\n  async getType() {\n    if (this.existing) {\n      return this.existing;\n    }\n\n    // in case client version does not support roles\n    if (!this.client.roles || typeof this.client.roles.getAll !== 'function') {\n      return [];\n    }\n\n    try {\n      const roles = await this.client.roles.getAll({ paginate: true, include_totals: true });\n      for (let index = 0; index < roles.length; index++) {\n        const permissions = await this.client.roles.permissions.getAll({\n          paginate: true,\n          include_totals: true,\n          id: roles[index].id,\n        });\n        const strippedPerms = await Promise.all(\n          permissions.map(async (permission) => {\n            delete permission.resource_server_name;\n            delete permission.description;\n            return permission;\n          })\n        );\n        roles[index].permissions = strippedPerms;\n      }\n      this.existing = roles;\n      return this.existing;\n    } catch (err) {\n      if (err.statusCode === 404 || err.statusCode === 501) {\n        return [];\n      }\n      throw err;\n    }\n  }\n\n  @order('60')\n  async processChanges(assets: Assets): Promise<void> {\n    const { roles } = assets;\n    // Do nothing if not set\n    if (!roles) return;\n    // Gets roles from destination tenant\n    const existing = await this.getType();\n\n    const changes = calculateChanges({\n      handler: this,\n      assets: roles,\n      existing,\n      identifiers: this.identifiers,\n      allowDelete: !!this.config('AUTH0_ALLOW_DELETE'),\n    });\n    log.debug(\n      `Start processChanges for roles [delete:${changes.del.length}] [update:${changes.update.length}], [create:${changes.create.length}]`\n    );\n    const myChanges = [\n      { del: changes.del },\n      { create: changes.create },\n      { update: changes.update },\n    ];\n    await Promise.all(\n      myChanges.map(async (change) => {\n        switch (true) {\n          case change.del && change.del.length > 0:\n            if (change.del) await this.deleteRoles(change.del);\n            break;\n          case change.create && change.create.length > 0:\n            await this.createRoles(changes.create); //TODO: fix this tho change.create\n            break;\n          case change.update && change.update.length > 0:\n            if (change.update) await this.updateRoles(change.update, existing);\n            break;\n          default:\n            break;\n        }\n      })\n    );\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8e530e1031635b5806015bdc79f1360108534205","contentHash":"ccaba537930e737c1430779087dcca4425578fa1d94e828145cd1742491599ef"},"/home/circleci/repo/src/tools/auth0/handlers/branding.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/branding.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":13},"end":{"line":50,"column":1}},"47":{"start":{"line":41,"column":12},"end":{"line":41,"column":14}},"48":{"start":{"line":42,"column":4},"end":{"line":43,"column":20}},"49":{"start":{"line":42,"column":21},"end":{"line":43,"column":20}},"50":{"start":{"line":43,"column":8},"end":{"line":43,"column":20}},"51":{"start":{"line":44,"column":4},"end":{"line":48,"column":9}},"52":{"start":{"line":45,"column":8},"end":{"line":48,"column":9}},"53":{"start":{"line":45,"column":21},"end":{"line":45,"column":22}},"54":{"start":{"line":45,"column":28},"end":{"line":45,"column":59}},"55":{"start":{"line":46,"column":12},"end":{"line":47,"column":34}},"56":{"start":{"line":47,"column":16},"end":{"line":47,"column":34}},"57":{"start":{"line":49,"column":4},"end":{"line":49,"column":13}},"58":{"start":{"line":51,"column":22},"end":{"line":53,"column":1}},"59":{"start":{"line":52,"column":4},"end":{"line":52,"column":62}},"60":{"start":{"line":54,"column":0},"end":{"line":54,"column":62}},"61":{"start":{"line":55,"column":0},"end":{"line":55,"column":24}},"62":{"start":{"line":56,"column":18},"end":{"line":56,"column":52}},"63":{"start":{"line":57,"column":20},"end":{"line":57,"column":63}},"64":{"start":{"line":58,"column":17},"end":{"line":58,"column":60}},"65":{"start":{"line":59,"column":0},"end":{"line":73,"column":2}},"66":{"start":{"line":76,"column":8},"end":{"line":76,"column":79}},"67":{"start":{"line":79,"column":8},"end":{"line":112,"column":11}},"68":{"start":{"line":80,"column":27},"end":{"line":80,"column":29}},"69":{"start":{"line":81,"column":12},"end":{"line":111,"column":13}},"70":{"start":{"line":83,"column":16},"end":{"line":85,"column":17}},"71":{"start":{"line":84,"column":20},"end":{"line":84,"column":72}},"72":{"start":{"line":87,"column":16},"end":{"line":99,"column":17}},"73":{"start":{"line":88,"column":42},"end":{"line":88,"column":82}},"74":{"start":{"line":90,"column":20},"end":{"line":98,"column":21}},"75":{"start":{"line":91,"column":40},"end":{"line":91,"column":94}},"76":{"start":{"line":92,"column":24},"end":{"line":97,"column":26}},"77":{"start":{"line":100,"column":16},"end":{"line":100,"column":32}},"78":{"start":{"line":103,"column":16},"end":{"line":103,"column":117}},"79":{"start":{"line":104,"column":16},"end":{"line":105,"column":36}},"80":{"start":{"line":105,"column":20},"end":{"line":105,"column":36}},"81":{"start":{"line":106,"column":16},"end":{"line":107,"column":36}},"82":{"start":{"line":107,"column":20},"end":{"line":107,"column":36}},"83":{"start":{"line":108,"column":16},"end":{"line":109,"column":36}},"84":{"start":{"line":109,"column":20},"end":{"line":109,"column":36}},"85":{"start":{"line":110,"column":16},"end":{"line":110,"column":26}},"86":{"start":{"line":115,"column":8},"end":{"line":146,"column":11}},"87":{"start":{"line":116,"column":12},"end":{"line":117,"column":23}},"88":{"start":{"line":117,"column":16},"end":{"line":117,"column":23}},"89":{"start":{"line":118,"column":23},"end":{"line":118,"column":38}},"90":{"start":{"line":118,"column":56},"end":{"line":118,"column":58}},"91":{"start":{"line":118,"column":79},"end":{"line":118,"column":104}},"92":{"start":{"line":119,"column":12},"end":{"line":122,"column":13}},"93":{"start":{"line":121,"column":16},"end":{"line":121,"column":49}},"94":{"start":{"line":123,"column":12},"end":{"line":127,"column":13}},"95":{"start":{"line":124,"column":16},"end":{"line":124,"column":80}},"96":{"start":{"line":125,"column":16},"end":{"line":125,"column":34}},"97":{"start":{"line":126,"column":16},"end":{"line":126,"column":49}},"98":{"start":{"line":129,"column":12},"end":{"line":145,"column":13}},"99":{"start":{"line":130,"column":41},"end":{"line":132,"column":43}},"100":{"start":{"line":131,"column":35},"end":{"line":131,"column":105}},"101":{"start":{"line":132,"column":32},"end":{"line":132,"column":42}},"102":{"start":{"line":133,"column":16},"end":{"line":138,"column":17}},"103":{"start":{"line":135,"column":20},"end":{"line":137,"column":134}},"104":{"start":{"line":139,"column":43},"end":{"line":139,"column":125}},"105":{"start":{"line":139,"column":65},"end":{"line":139,"column":124}},"106":{"start":{"line":140,"column":16},"end":{"line":144,"column":17}},"107":{"start":{"line":141,"column":20},"end":{"line":141,"column":116}},"108":{"start":{"line":142,"column":20},"end":{"line":142,"column":38}},"109":{"start":{"line":143,"column":20},"end":{"line":143,"column":46}},"110":{"start":{"line":149,"column":0},"end":{"line":151,"column":54}},"111":{"start":{"line":152,"column":0},"end":{"line":152,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":38},"end":{"line":40,"column":39}},"loc":{"start":{"line":40,"column":54},"end":{"line":50,"column":1}},"line":40},"15":{"name":"(anonymous_15)","decl":{"start":{"line":51,"column":56},"end":{"line":51,"column":57}},"loc":{"start":{"line":51,"column":71},"end":{"line":53,"column":1}},"line":51},"16":{"name":"(anonymous_16)","decl":{"start":{"line":75,"column":4},"end":{"line":75,"column":5}},"loc":{"start":{"line":75,"column":25},"end":{"line":77,"column":5}},"line":75},"17":{"name":"(anonymous_17)","decl":{"start":{"line":78,"column":4},"end":{"line":78,"column":5}},"loc":{"start":{"line":78,"column":14},"end":{"line":113,"column":5}},"line":78},"18":{"name":"(anonymous_18)","decl":{"start":{"line":79,"column":47},"end":{"line":79,"column":48}},"loc":{"start":{"line":79,"column":60},"end":{"line":112,"column":9}},"line":79},"19":{"name":"(anonymous_19)","decl":{"start":{"line":114,"column":4},"end":{"line":114,"column":5}},"loc":{"start":{"line":114,"column":27},"end":{"line":147,"column":5}},"line":114},"20":{"name":"(anonymous_20)","decl":{"start":{"line":115,"column":47},"end":{"line":115,"column":48}},"loc":{"start":{"line":115,"column":60},"end":{"line":146,"column":9}},"line":115},"21":{"name":"(anonymous_21)","decl":{"start":{"line":131,"column":28},"end":{"line":131,"column":29}},"loc":{"start":{"line":131,"column":35},"end":{"line":131,"column":105}},"line":131},"22":{"name":"(anonymous_22)","decl":{"start":{"line":132,"column":25},"end":{"line":132,"column":26}},"loc":{"start":{"line":132,"column":32},"end":{"line":132,"column":42}},"line":132},"23":{"name":"(anonymous_23)","decl":{"start":{"line":139,"column":58},"end":{"line":139,"column":59}},"loc":{"start":{"line":139,"column":65},"end":{"line":139,"column":124}},"line":139}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":13},"end":{"line":50,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":14},"end":{"line":40,"column":18}},{"start":{"line":40,"column":22},"end":{"line":40,"column":33}},{"start":{"line":40,"column":38},"end":{"line":50,"column":1}}],"line":40},"32":{"loc":{"start":{"line":42,"column":21},"end":{"line":43,"column":20}},"type":"if","locations":[{"start":{"line":42,"column":21},"end":{"line":43,"column":20}},{"start":{"line":42,"column":21},"end":{"line":43,"column":20}}],"line":42},"33":{"loc":{"start":{"line":42,"column":25},"end":{"line":42,"column":87}},"type":"binary-expr","locations":[{"start":{"line":42,"column":25},"end":{"line":42,"column":67}},{"start":{"line":42,"column":71},"end":{"line":42,"column":87}}],"line":42},"34":{"loc":{"start":{"line":44,"column":4},"end":{"line":48,"column":9}},"type":"if","locations":[{"start":{"line":44,"column":4},"end":{"line":48,"column":9}},{"start":{"line":44,"column":4},"end":{"line":48,"column":9}}],"line":44},"35":{"loc":{"start":{"line":44,"column":8},"end":{"line":44,"column":71}},"type":"binary-expr","locations":[{"start":{"line":44,"column":8},"end":{"line":44,"column":17}},{"start":{"line":44,"column":21},"end":{"line":44,"column":71}}],"line":44},"36":{"loc":{"start":{"line":46,"column":12},"end":{"line":47,"column":34}},"type":"if","locations":[{"start":{"line":46,"column":12},"end":{"line":47,"column":34}},{"start":{"line":46,"column":12},"end":{"line":47,"column":34}}],"line":46},"37":{"loc":{"start":{"line":46,"column":16},"end":{"line":46,"column":90}},"type":"binary-expr","locations":[{"start":{"line":46,"column":16},"end":{"line":46,"column":35}},{"start":{"line":46,"column":39},"end":{"line":46,"column":90}}],"line":46},"38":{"loc":{"start":{"line":51,"column":22},"end":{"line":53,"column":1}},"type":"binary-expr","locations":[{"start":{"line":51,"column":23},"end":{"line":51,"column":27}},{"start":{"line":51,"column":31},"end":{"line":51,"column":51}},{"start":{"line":51,"column":56},"end":{"line":53,"column":1}}],"line":51},"39":{"loc":{"start":{"line":52,"column":11},"end":{"line":52,"column":61}},"type":"cond-expr","locations":[{"start":{"line":52,"column":37},"end":{"line":52,"column":40}},{"start":{"line":52,"column":43},"end":{"line":52,"column":61}}],"line":52},"40":{"loc":{"start":{"line":52,"column":12},"end":{"line":52,"column":33}},"type":"binary-expr","locations":[{"start":{"line":52,"column":12},"end":{"line":52,"column":15}},{"start":{"line":52,"column":19},"end":{"line":52,"column":33}}],"line":52},"41":{"loc":{"start":{"line":83,"column":16},"end":{"line":85,"column":17}},"type":"if","locations":[{"start":{"line":83,"column":16},"end":{"line":85,"column":17}},{"start":{"line":83,"column":16},"end":{"line":85,"column":17}}],"line":83},"42":{"loc":{"start":{"line":83,"column":20},"end":{"line":83,"column":98}},"type":"binary-expr","locations":[{"start":{"line":83,"column":20},"end":{"line":83,"column":40}},{"start":{"line":83,"column":44},"end":{"line":83,"column":98}}],"line":83},"43":{"loc":{"start":{"line":87,"column":16},"end":{"line":99,"column":17}},"type":"if","locations":[{"start":{"line":87,"column":16},"end":{"line":99,"column":17}},{"start":{"line":87,"column":16},"end":{"line":99,"column":17}}],"line":87},"44":{"loc":{"start":{"line":87,"column":20},"end":{"line":87,"column":103}},"type":"binary-expr","locations":[{"start":{"line":87,"column":20},"end":{"line":87,"column":45}},{"start":{"line":87,"column":49},"end":{"line":87,"column":103}}],"line":87},"45":{"loc":{"start":{"line":90,"column":20},"end":{"line":98,"column":21}},"type":"if","locations":[{"start":{"line":90,"column":20},"end":{"line":98,"column":21}},{"start":{"line":90,"column":20},"end":{"line":98,"column":21}}],"line":90},"46":{"loc":{"start":{"line":90,"column":24},"end":{"line":90,"column":61}},"type":"binary-expr","locations":[{"start":{"line":90,"column":24},"end":{"line":90,"column":37}},{"start":{"line":90,"column":41},"end":{"line":90,"column":61}}],"line":90},"47":{"loc":{"start":{"line":104,"column":16},"end":{"line":105,"column":36}},"type":"if","locations":[{"start":{"line":104,"column":16},"end":{"line":105,"column":36}},{"start":{"line":104,"column":16},"end":{"line":105,"column":36}}],"line":104},"48":{"loc":{"start":{"line":106,"column":16},"end":{"line":107,"column":36}},"type":"if","locations":[{"start":{"line":106,"column":16},"end":{"line":107,"column":36}},{"start":{"line":106,"column":16},"end":{"line":107,"column":36}}],"line":106},"49":{"loc":{"start":{"line":108,"column":16},"end":{"line":109,"column":36}},"type":"if","locations":[{"start":{"line":108,"column":16},"end":{"line":109,"column":36}},{"start":{"line":108,"column":16},"end":{"line":109,"column":36}}],"line":108},"50":{"loc":{"start":{"line":116,"column":12},"end":{"line":117,"column":23}},"type":"if","locations":[{"start":{"line":116,"column":12},"end":{"line":117,"column":23}},{"start":{"line":116,"column":12},"end":{"line":117,"column":23}}],"line":116},"51":{"loc":{"start":{"line":119,"column":12},"end":{"line":122,"column":13}},"type":"if","locations":[{"start":{"line":119,"column":12},"end":{"line":122,"column":13}},{"start":{"line":119,"column":12},"end":{"line":122,"column":13}}],"line":119},"52":{"loc":{"start":{"line":123,"column":12},"end":{"line":127,"column":13}},"type":"if","locations":[{"start":{"line":123,"column":12},"end":{"line":127,"column":13}},{"start":{"line":123,"column":12},"end":{"line":127,"column":13}}],"line":123},"53":{"loc":{"start":{"line":123,"column":16},"end":{"line":123,"column":72}},"type":"binary-expr","locations":[{"start":{"line":123,"column":16},"end":{"line":123,"column":32}},{"start":{"line":123,"column":36},"end":{"line":123,"column":72}}],"line":123},"54":{"loc":{"start":{"line":129,"column":12},"end":{"line":145,"column":13}},"type":"if","locations":[{"start":{"line":129,"column":12},"end":{"line":145,"column":13}},{"start":{"line":129,"column":12},"end":{"line":145,"column":13}}],"line":129},"55":{"loc":{"start":{"line":129,"column":16},"end":{"line":129,"column":45}},"type":"binary-expr","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":25}},{"start":{"line":129,"column":29},"end":{"line":129,"column":45}}],"line":129},"56":{"loc":{"start":{"line":133,"column":16},"end":{"line":138,"column":17}},"type":"if","locations":[{"start":{"line":133,"column":16},"end":{"line":138,"column":17}},{"start":{"line":133,"column":16},"end":{"line":138,"column":17}}],"line":133},"57":{"loc":{"start":{"line":140,"column":16},"end":{"line":144,"column":17}},"type":"if","locations":[{"start":{"line":140,"column":16},"end":{"line":144,"column":17}},{"start":{"line":140,"column":16},"end":{"line":144,"column":17}}],"line":140},"58":{"loc":{"start":{"line":140,"column":20},"end":{"line":140,"column":65}},"type":"binary-expr","locations":[{"start":{"line":140,"column":20},"end":{"line":140,"column":38}},{"start":{"line":140,"column":42},"end":{"line":140,"column":65}}],"line":140}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":19,"36":14,"37":12,"38":18,"39":18,"40":0,"41":1,"42":1,"43":0,"44":31,"45":12,"46":1,"47":4,"48":4,"49":6,"50":5,"51":4,"52":4,"53":4,"54":4,"55":0,"56":0,"57":4,"58":1,"59":2,"60":1,"61":1,"62":1,"63":1,"64":1,"65":1,"66":138,"67":7,"68":7,"69":7,"70":7,"71":7,"72":7,"73":7,"74":6,"75":1,"76":1,"77":6,"78":1,"79":1,"80":1,"81":0,"82":0,"83":0,"84":0,"85":0,"86":5,"87":5,"88":1,"89":4,"90":4,"91":4,"92":4,"93":1,"94":4,"95":3,"96":3,"97":3,"98":4,"99":1,"100":1,"101":0,"102":1,"103":0,"104":1,"105":1,"106":1,"107":1,"108":1,"109":1,"110":1,"111":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":12,"8":19,"9":14,"10":12,"11":18,"12":1,"13":31,"14":4,"15":2,"16":138,"17":7,"18":7,"19":5,"20":5,"21":1,"22":0,"23":1},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[5,14],"28":[12,12],"29":[12,19],"30":[12,12],"31":[1,1,1],"32":[5,1],"33":[6,6],"34":[4,0],"35":[4,4],"36":[0,0],"37":[0,0],"38":[1,1,1],"39":[2,0],"40":[2,2],"41":[7,0],"42":[7,7],"43":[7,0],"44":[7,7],"45":[1,5],"46":[6,6],"47":[1,0],"48":[0,0],"49":[0,0],"50":[1,4],"51":[1,3],"52":[3,1],"53":[4,4],"54":[1,3],"55":[4,1],"56":[0,1],"57":[1,0],"58":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/branding.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/branding.ts"],"names":[],"mappings":"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","sourcesContent":["import DefaultHandler, { order } from './default';\nimport constants from '../../constants';\nimport log from '../../../logger';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'object',\n  properties: {\n    templates: {\n      type: 'array',\n      items: {\n        type: 'object',\n        properties: {\n          template: { type: 'string' },\n          body: { type: 'string' },\n        },\n      },\n    },\n  },\n};\n\nexport default class BrandingHandler extends DefaultHandler {\n  existing: Asset;\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'branding',\n    });\n  }\n\n  async getType(): Promise<Asset> {\n    let branding: {\n      templates?: {\n        template: string;\n        body: string;\n      }[];\n    } = {};\n\n    try {\n      // in case client version does not support branding\n      if (this.client.branding && typeof this.client.branding.getSettings === 'function') {\n        branding = await this.client.branding.getSettings();\n      }\n\n      // in case client version does not custom domains\n      if (this.client.customDomains && typeof this.client.customDomains.getAll === 'function') {\n        const customDomains = await this.client.customDomains.getAll();\n        // templates are only supported if there's custom domains.\n        if (customDomains && customDomains.length) {\n          const payload = await this.client.branding.getUniversalLoginTemplate();\n          branding.templates = [\n            {\n              template: constants.UNIVERSAL_LOGIN_TEMPLATE,\n              body: payload.body,\n            },\n          ];\n        }\n      }\n\n      return branding;\n    } catch (err) {\n      log.debug(`Error calling branding API, ${err.message}, status code: ${err.statusCode}`);\n      if (err.statusCode === 403) return branding;\n      if (err.statusCode === 404) return branding;\n      if (err.statusCode === 501) return branding;\n      throw err;\n    }\n  }\n\n  @order('70') // Run after custom domains and themes.\n  async processChanges(assets: Assets) {\n    if (!assets.branding) return;\n\n    const { templates, ...brandingSettings } = assets.branding;\n\n    if (brandingSettings.logo_url === '') {\n      //Sometimes blank logo_url returned by API but is invalid on import. See: DXCDT-240\n      delete brandingSettings.logo_url;\n    }\n\n    if (brandingSettings && Object.keys(brandingSettings).length) {\n      await this.client.branding.updateSettings({}, brandingSettings);\n      this.updated += 1;\n      this.didUpdate(brandingSettings);\n    }\n\n    // handle templates\n    if (templates && templates.length) {\n      const unknownTemplates = templates\n        .filter((t) => !constants.SUPPORTED_BRANDING_TEMPLATES.includes(t.template))\n        .map((t) => t.template);\n      if (unknownTemplates.length) {\n        // throw a helpful warning for unknown templates, the context handlers are unaware of which are supported, that's all handled here.\n        log.warn(\n          `Found unknown branding template(s): ${unknownTemplates\n            .join()\n            .toString()}. Supported branding templates are: ${constants.SUPPORTED_BRANDING_TEMPLATES.join()}.`\n        );\n      }\n\n      const templateDefinition = templates.find(\n        (t) => t.template === constants.UNIVERSAL_LOGIN_TEMPLATE\n      );\n      if (templateDefinition && templateDefinition.body) {\n        await this.client.branding.setUniversalLoginTemplate(\n          {},\n          { template: templateDefinition.body }\n        );\n        this.updated += 1;\n        this.didUpdate(templates);\n      }\n    }\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"91458ec59f4be73084a3062456263fce4b63b112","contentHash":"10cc0a59b479d38b290c87a04353e59e23aa579b967e513a4a86aeefd028d8a5"},"/home/circleci/repo/src/tools/auth0/handlers/prompts.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/prompts.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":14}},"14":{"start":{"line":13,"column":4},"end":{"line":14,"column":20}},"15":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"16":{"start":{"line":14,"column":8},"end":{"line":14,"column":20}},"17":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"18":{"start":{"line":16,"column":8},"end":{"line":19,"column":9}},"19":{"start":{"line":16,"column":21},"end":{"line":16,"column":22}},"20":{"start":{"line":16,"column":28},"end":{"line":16,"column":59}},"21":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"22":{"start":{"line":18,"column":16},"end":{"line":18,"column":34}},"23":{"start":{"line":20,"column":4},"end":{"line":20,"column":13}},"24":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"25":{"start":{"line":23,"column":4},"end":{"line":23,"column":62}},"26":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"27":{"start":{"line":26,"column":0},"end":{"line":26,"column":24}},"28":{"start":{"line":27,"column":18},"end":{"line":27,"column":55}},"29":{"start":{"line":28,"column":16},"end":{"line":28,"column":41}},"30":{"start":{"line":29,"column":17},"end":{"line":29,"column":34}},"31":{"start":{"line":30,"column":20},"end":{"line":56,"column":1}},"32":{"start":{"line":57,"column":20},"end":{"line":114,"column":1}},"33":{"start":{"line":115,"column":0},"end":{"line":147,"column":2}},"34":{"start":{"line":131,"column":16},"end":{"line":143,"column":25}},"35":{"start":{"line":134,"column":28},"end":{"line":141,"column":37}},"36":{"start":{"line":137,"column":40},"end":{"line":139,"column":49}},"37":{"start":{"line":150,"column":8},"end":{"line":150,"column":78}},"38":{"start":{"line":153,"column":8},"end":{"line":153,"column":83}},"39":{"start":{"line":156,"column":8},"end":{"line":160,"column":11}},"40":{"start":{"line":157,"column":36},"end":{"line":157,"column":75}},"41":{"start":{"line":158,"column":31},"end":{"line":158,"column":65}},"42":{"start":{"line":159,"column":12},"end":{"line":159,"column":85}},"43":{"start":{"line":163,"column":8},"end":{"line":204,"column":11}},"44":{"start":{"line":164,"column":39},"end":{"line":170,"column":14}},"45":{"start":{"line":167,"column":16},"end":{"line":168,"column":30}},"46":{"start":{"line":168,"column":20},"end":{"line":168,"column":30}},"47":{"start":{"line":169,"column":16},"end":{"line":169,"column":39}},"48":{"start":{"line":171,"column":12},"end":{"line":203,"column":15}},"49":{"start":{"line":174,"column":39},"end":{"line":174,"column":98}},"50":{"start":{"line":174,"column":72},"end":{"line":174,"column":96}},"51":{"start":{"line":175,"column":42},"end":{"line":175,"column":57}},"52":{"start":{"line":176,"column":57},"end":{"line":188,"column":18}},"53":{"start":{"line":182,"column":20},"end":{"line":183,"column":36}},"54":{"start":{"line":183,"column":24},"end":{"line":183,"column":36}},"55":{"start":{"line":184,"column":20},"end":{"line":187,"column":22}},"56":{"start":{"line":192,"column":16},"end":{"line":202,"column":23}},"57":{"start":{"line":194,"column":20},"end":{"line":194,"column":51}},"58":{"start":{"line":197,"column":20},"end":{"line":198,"column":35}},"59":{"start":{"line":198,"column":24},"end":{"line":198,"column":35}},"60":{"start":{"line":199,"column":41},"end":{"line":199,"column":55}},"61":{"start":{"line":199,"column":78},"end":{"line":199,"column":114}},"62":{"start":{"line":200,"column":20},"end":{"line":201,"column":141}},"63":{"start":{"line":207,"column":8},"end":{"line":218,"column":11}},"64":{"start":{"line":208,"column":32},"end":{"line":208,"column":38}},"65":{"start":{"line":209,"column":12},"end":{"line":210,"column":23}},"66":{"start":{"line":210,"column":16},"end":{"line":210,"column":23}},"67":{"start":{"line":211,"column":35},"end":{"line":211,"column":42}},"68":{"start":{"line":211,"column":61},"end":{"line":211,"column":92}},"69":{"start":{"line":212,"column":12},"end":{"line":214,"column":13}},"70":{"start":{"line":213,"column":16},"end":{"line":213,"column":77}},"71":{"start":{"line":215,"column":12},"end":{"line":215,"column":60}},"72":{"start":{"line":216,"column":12},"end":{"line":216,"column":30}},"73":{"start":{"line":217,"column":12},"end":{"line":217,"column":36}},"74":{"start":{"line":221,"column":8},"end":{"line":249,"column":11}},"75":{"start":{"line":225,"column":12},"end":{"line":226,"column":23}},"76":{"start":{"line":226,"column":16},"end":{"line":226,"column":23}},"77":{"start":{"line":227,"column":12},"end":{"line":248,"column":27}},"78":{"start":{"line":230,"column":48},"end":{"line":230,"column":68}},"79":{"start":{"line":231,"column":20},"end":{"line":232,"column":34}},"80":{"start":{"line":232,"column":24},"end":{"line":232,"column":34}},"81":{"start":{"line":233,"column":20},"end":{"line":240,"column":23}},"82":{"start":{"line":234,"column":37},"end":{"line":234,"column":70}},"83":{"start":{"line":235,"column":24},"end":{"line":239,"column":26}},"84":{"start":{"line":242,"column":59},"end":{"line":246,"column":18}},"85":{"start":{"line":252,"column":0},"end":{"line":252,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":38},"end":{"line":11,"column":39}},"loc":{"start":{"line":11,"column":54},"end":{"line":21,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":22,"column":56},"end":{"line":22,"column":57}},"loc":{"start":{"line":22,"column":71},"end":{"line":24,"column":1}},"line":22},"9":{"name":"(anonymous_9)","decl":{"start":{"line":130,"column":49},"end":{"line":130,"column":50}},"loc":{"start":{"line":130,"column":68},"end":{"line":144,"column":13}},"line":130},"10":{"name":"(anonymous_10)","decl":{"start":{"line":133,"column":55},"end":{"line":133,"column":56}},"loc":{"start":{"line":133,"column":77},"end":{"line":142,"column":25}},"line":133},"11":{"name":"(anonymous_11)","decl":{"start":{"line":136,"column":67},"end":{"line":136,"column":68}},"loc":{"start":{"line":136,"column":89},"end":{"line":140,"column":37}},"line":136},"12":{"name":"(anonymous_12)","decl":{"start":{"line":149,"column":4},"end":{"line":149,"column":5}},"loc":{"start":{"line":149,"column":25},"end":{"line":151,"column":5}},"line":149},"13":{"name":"(anonymous_13)","decl":{"start":{"line":152,"column":4},"end":{"line":152,"column":5}},"loc":{"start":{"line":152,"column":30},"end":{"line":154,"column":5}},"line":152},"14":{"name":"(anonymous_14)","decl":{"start":{"line":155,"column":4},"end":{"line":155,"column":5}},"loc":{"start":{"line":155,"column":14},"end":{"line":161,"column":5}},"line":155},"15":{"name":"(anonymous_15)","decl":{"start":{"line":156,"column":47},"end":{"line":156,"column":48}},"loc":{"start":{"line":156,"column":60},"end":{"line":160,"column":9}},"line":156},"16":{"name":"(anonymous_16)","decl":{"start":{"line":162,"column":4},"end":{"line":162,"column":5}},"loc":{"start":{"line":162,"column":28},"end":{"line":205,"column":5}},"line":162},"17":{"name":"(anonymous_17)","decl":{"start":{"line":163,"column":47},"end":{"line":163,"column":48}},"loc":{"start":{"line":163,"column":60},"end":{"line":204,"column":9}},"line":163},"18":{"name":"(anonymous_18)","decl":{"start":{"line":166,"column":22},"end":{"line":166,"column":23}},"loc":{"start":{"line":166,"column":47},"end":{"line":170,"column":13}},"line":166},"19":{"name":"(anonymous_19)","decl":{"start":{"line":174,"column":25},"end":{"line":174,"column":26}},"loc":{"start":{"line":174,"column":39},"end":{"line":174,"column":98}},"line":174},"20":{"name":"(anonymous_20)","decl":{"start":{"line":174,"column":55},"end":{"line":174,"column":56}},"loc":{"start":{"line":174,"column":72},"end":{"line":174,"column":96}},"line":174},"21":{"name":"(anonymous_21)","decl":{"start":{"line":175,"column":28},"end":{"line":175,"column":29}},"loc":{"start":{"line":175,"column":42},"end":{"line":175,"column":57}},"line":175},"22":{"name":"(anonymous_22)","decl":{"start":{"line":176,"column":27},"end":{"line":176,"column":28}},"loc":{"start":{"line":176,"column":57},"end":{"line":188,"column":18}},"line":176},"23":{"name":"(anonymous_23)","decl":{"start":{"line":181,"column":26},"end":{"line":181,"column":27}},"loc":{"start":{"line":181,"column":46},"end":{"line":188,"column":17}},"line":181},"24":{"name":"(anonymous_24)","decl":{"start":{"line":191,"column":22},"end":{"line":191,"column":23}},"loc":{"start":{"line":191,"column":42},"end":{"line":203,"column":13}},"line":191},"25":{"name":"(anonymous_25)","decl":{"start":{"line":193,"column":28},"end":{"line":193,"column":29}},"loc":{"start":{"line":193,"column":48},"end":{"line":195,"column":17}},"line":193},"26":{"name":"(anonymous_26)","decl":{"start":{"line":196,"column":28},"end":{"line":196,"column":29}},"loc":{"start":{"line":196,"column":53},"end":{"line":202,"column":17}},"line":196},"27":{"name":"(anonymous_27)","decl":{"start":{"line":206,"column":4},"end":{"line":206,"column":5}},"loc":{"start":{"line":206,"column":27},"end":{"line":219,"column":5}},"line":206},"28":{"name":"(anonymous_28)","decl":{"start":{"line":207,"column":47},"end":{"line":207,"column":48}},"loc":{"start":{"line":207,"column":60},"end":{"line":218,"column":9}},"line":207},"29":{"name":"(anonymous_29)","decl":{"start":{"line":220,"column":4},"end":{"line":220,"column":5}},"loc":{"start":{"line":220,"column":41},"end":{"line":250,"column":5}},"line":220},"30":{"name":"(anonymous_30)","decl":{"start":{"line":221,"column":47},"end":{"line":221,"column":48}},"loc":{"start":{"line":221,"column":60},"end":{"line":249,"column":9}},"line":221},"31":{"name":"(anonymous_31)","decl":{"start":{"line":229,"column":54},"end":{"line":229,"column":55}},"loc":{"start":{"line":229,"column":68},"end":{"line":241,"column":17}},"line":229},"32":{"name":"(anonymous_32)","decl":{"start":{"line":233,"column":64},"end":{"line":233,"column":65}},"loc":{"start":{"line":233,"column":76},"end":{"line":240,"column":21}},"line":233},"33":{"name":"(anonymous_33)","decl":{"start":{"line":242,"column":27},"end":{"line":242,"column":28}},"loc":{"start":{"line":242,"column":59},"end":{"line":246,"column":18}},"line":242}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":14},"end":{"line":11,"column":18}},{"start":{"line":11,"column":22},"end":{"line":11,"column":33}},{"start":{"line":11,"column":38},"end":{"line":21,"column":1}}],"line":11},"6":{"loc":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"type":"if","locations":[{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},{"start":{"line":13,"column":21},"end":{"line":14,"column":20}}],"line":13},"7":{"loc":{"start":{"line":13,"column":25},"end":{"line":13,"column":87}},"type":"binary-expr","locations":[{"start":{"line":13,"column":25},"end":{"line":13,"column":67}},{"start":{"line":13,"column":71},"end":{"line":13,"column":87}}],"line":13},"8":{"loc":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"type":"if","locations":[{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},{"start":{"line":15,"column":4},"end":{"line":19,"column":9}}],"line":15},"9":{"loc":{"start":{"line":15,"column":8},"end":{"line":15,"column":71}},"type":"binary-expr","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":17}},{"start":{"line":15,"column":21},"end":{"line":15,"column":71}}],"line":15},"10":{"loc":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},{"start":{"line":17,"column":12},"end":{"line":18,"column":34}}],"line":17},"11":{"loc":{"start":{"line":17,"column":16},"end":{"line":17,"column":90}},"type":"binary-expr","locations":[{"start":{"line":17,"column":16},"end":{"line":17,"column":35}},{"start":{"line":17,"column":39},"end":{"line":17,"column":90}}],"line":17},"12":{"loc":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":22,"column":23},"end":{"line":22,"column":27}},{"start":{"line":22,"column":31},"end":{"line":22,"column":51}},{"start":{"line":22,"column":56},"end":{"line":24,"column":1}}],"line":22},"13":{"loc":{"start":{"line":23,"column":11},"end":{"line":23,"column":61}},"type":"cond-expr","locations":[{"start":{"line":23,"column":37},"end":{"line":23,"column":40}},{"start":{"line":23,"column":43},"end":{"line":23,"column":61}}],"line":23},"14":{"loc":{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},"type":"binary-expr","locations":[{"start":{"line":23,"column":12},"end":{"line":23,"column":15}},{"start":{"line":23,"column":19},"end":{"line":23,"column":33}}],"line":23},"15":{"loc":{"start":{"line":153,"column":34},"end":{"line":153,"column":80}},"type":"cond-expr","locations":[{"start":{"line":153,"column":49},"end":{"line":153,"column":75}},{"start":{"line":153,"column":78},"end":{"line":153,"column":80}}],"line":153},"16":{"loc":{"start":{"line":167,"column":16},"end":{"line":168,"column":30}},"type":"if","locations":[{"start":{"line":167,"column":16},"end":{"line":168,"column":30}},{"start":{"line":167,"column":16},"end":{"line":168,"column":30}}],"line":167},"17":{"loc":{"start":{"line":173,"column":22},"end":{"line":175,"column":68}},"type":"binary-expr","locations":[{"start":{"line":173,"column":22},"end":{"line":175,"column":62}},{"start":{"line":175,"column":66},"end":{"line":175,"column":68}}],"line":173},"18":{"loc":{"start":{"line":182,"column":20},"end":{"line":183,"column":36}},"type":"if","locations":[{"start":{"line":182,"column":20},"end":{"line":183,"column":36}},{"start":{"line":182,"column":20},"end":{"line":183,"column":36}}],"line":182},"19":{"loc":{"start":{"line":197,"column":20},"end":{"line":198,"column":35}},"type":"if","locations":[{"start":{"line":197,"column":20},"end":{"line":198,"column":35}},{"start":{"line":197,"column":20},"end":{"line":198,"column":35}}],"line":197},"20":{"loc":{"start":{"line":197,"column":25},"end":{"line":197,"column":112}},"type":"cond-expr","locations":[{"start":{"line":197,"column":80},"end":{"line":197,"column":86}},{"start":{"line":197,"column":89},"end":{"line":197,"column":112}}],"line":197},"21":{"loc":{"start":{"line":197,"column":25},"end":{"line":197,"column":77}},"type":"binary-expr","locations":[{"start":{"line":197,"column":25},"end":{"line":197,"column":48}},{"start":{"line":197,"column":52},"end":{"line":197,"column":77}}],"line":197},"22":{"loc":{"start":{"line":200,"column":79},"end":{"line":201,"column":137}},"type":"cond-expr","locations":[{"start":{"line":201,"column":30},"end":{"line":201,"column":97}},{"start":{"line":201,"column":100},"end":{"line":201,"column":137}}],"line":200},"23":{"loc":{"start":{"line":209,"column":12},"end":{"line":210,"column":23}},"type":"if","locations":[{"start":{"line":209,"column":12},"end":{"line":210,"column":23}},{"start":{"line":209,"column":12},"end":{"line":210,"column":23}}],"line":209},"24":{"loc":{"start":{"line":212,"column":12},"end":{"line":214,"column":13}},"type":"if","locations":[{"start":{"line":212,"column":12},"end":{"line":214,"column":13}},{"start":{"line":212,"column":12},"end":{"line":214,"column":13}}],"line":212},"25":{"loc":{"start":{"line":225,"column":12},"end":{"line":226,"column":23}},"type":"if","locations":[{"start":{"line":225,"column":12},"end":{"line":226,"column":23}},{"start":{"line":225,"column":12},"end":{"line":226,"column":23}}],"line":225},"26":{"loc":{"start":{"line":231,"column":20},"end":{"line":232,"column":34}},"type":"if","locations":[{"start":{"line":231,"column":20},"end":{"line":232,"column":34}},{"start":{"line":231,"column":20},"end":{"line":232,"column":34}}],"line":231},"27":{"loc":{"start":{"line":234,"column":37},"end":{"line":234,"column":70}},"type":"binary-expr","locations":[{"start":{"line":234,"column":37},"end":{"line":234,"column":64}},{"start":{"line":234,"column":68},"end":{"line":234,"column":70}}],"line":234}},"s":{"0":1,"1":23,"2":6,"3":16,"4":23,"5":23,"6":0,"7":0,"8":0,"9":0,"10":39,"11":16,"12":1,"13":5,"14":5,"15":12,"16":7,"17":5,"18":5,"19":5,"20":5,"21":0,"22":0,"23":5,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":49,"35":1225,"36":68600,"37":134,"38":2,"39":6,"40":6,"41":6,"42":6,"43":6,"44":6,"45":6,"46":1,"47":5,"48":6,"49":7,"50":175,"51":7,"52":175,"53":175,"54":172,"55":3,"56":6,"57":175,"58":3,"59":0,"60":3,"61":3,"62":3,"63":2,"64":2,"65":2,"66":0,"67":2,"68":2,"69":2,"70":2,"71":2,"72":2,"73":2,"74":2,"75":2,"76":1,"77":1,"78":2,"79":2,"80":0,"81":2,"82":3,"83":3,"84":3,"85":1},"f":{"0":16,"1":23,"2":6,"3":16,"4":23,"5":0,"6":39,"7":5,"8":1,"9":49,"10":1225,"11":68600,"12":134,"13":2,"14":6,"15":6,"16":6,"17":6,"18":6,"19":7,"20":175,"21":7,"22":175,"23":175,"24":6,"25":175,"26":3,"27":2,"28":2,"29":2,"30":2,"31":2,"32":3,"33":3},"b":{"0":[1,1,1],"1":[17,6],"2":[16,16],"3":[16,23],"4":[16,16],"5":[1,1,1],"6":[7,5],"7":[12,12],"8":[5,0],"9":[5,5],"10":[0,0],"11":[0,0],"12":[1,1,1],"13":[1,0],"14":[1,1],"15":[1,1],"16":[1,5],"17":[6,0],"18":[172,3],"19":[0,3],"20":[0,3],"21":[3,3],"22":[1,2],"23":[0,2],"24":[2,0],"25":[1,1],"26":[0,2],"27":[3,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/prompts.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/prompts.ts"],"names":[],"mappings":"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","sourcesContent":["import DefaultHandler from './default';\nimport { Assets, Language, languages } from '../../../types';\nimport { isEmpty } from 'lodash';\n\nconst promptTypes = [\n  'login',\n  'login-id',\n  'login-password',\n  'login-email-verification',\n  'signup',\n  'signup-id',\n  'signup-password',\n  'reset-password',\n  'consent',\n  'mfa-push',\n  'mfa-otp',\n  'mfa-voice',\n  'mfa-phone',\n  'mfa-webauthn',\n  'mfa-sms',\n  'mfa-email',\n  'mfa-recovery-code',\n  'mfa',\n  'status',\n  'device-flow',\n  'email-verification',\n  'email-otp-challenge',\n  'organizations',\n  'invitation',\n  'common',\n] as const;\n\nexport type PromptTypes = typeof promptTypes[number];\n\nconst screenTypes = [\n  'login',\n  'login-id',\n  'login-password',\n  'login-email-verification',\n  'signup',\n  'signup-id',\n  'signup-password',\n  'reset-password-request',\n  'reset-password-email',\n  'reset-password',\n  'reset-password-success',\n  'reset-password-error',\n  'consent',\n  'status',\n  'mfa-detect-browser-capabilities',\n  'mfa-enroll-result',\n  'mfa-login-options',\n  'mfa-begin-enroll-options',\n  'mfa-otp-enrollment-qr',\n  'mfa-otp-enrollment-code',\n  'mfa-otp-challenge',\n  'mfa-voice-challenge',\n  'mfa-sms-challenge',\n  'mfa-recovery-code-enrollment',\n  'mfa-recovery-code-challenge',\n  'mfa-country-codes',\n  'mfa-sms-enrollment',\n  'mfa-voice-enrollment',\n  'mfa-phone-challenge',\n  'mfa-phone-enrollment',\n  'mfa-webauthn-roaming-enrollment',\n  'mfa-webauthn-platform-enrollment',\n  'mfa-webauthn-platform-challenge',\n  'mfa-webauthn-roaming-challenge',\n  'mfa-webauthn-change-key-nickname',\n  'mfa-webauthn-enrollment-success',\n  'mfa-webauthn-error',\n  'mfa-webauthn-not-available-error',\n  'mfa-sms-list',\n  'mfa-email-challenge',\n  'mfa-email-list',\n  'mfa-push-welcome',\n  'mfa-push-list',\n  'mfa-push-enrollment-qr',\n  'mfa-push-enrollment-code',\n  'mfa-push-success',\n  'mfa-push-challenge-push',\n  'device-code-activation',\n  'device-code-activation-allowed',\n  'device-code-activation-denied',\n  'device-code-confirmation',\n  'email-verification-result',\n  'email-otp-challenge',\n  'redeem-ticket',\n  'organization-selection',\n  'accept-invitation',\n] as const;\n\nexport type ScreenTypes = typeof screenTypes[number];\n\nexport const schema = {\n  type: 'object',\n  properties: {\n    universal_login_experience: {\n      type: 'string',\n      enum: ['new', 'classic'],\n    },\n    webauthn_platform_first_factor: {\n      type: 'boolean',\n    },\n    identifier_first: {\n      type: 'boolean',\n    },\n    customText: {\n      type: 'object',\n      properties: languages.reduce((acc, language) => {\n        return {\n          ...acc,\n          [language]: {\n            type: 'object',\n            properties: promptTypes.reduce((acc, promptTypes) => {\n              return {\n                ...acc,\n                [promptTypes]: {\n                  type: 'object',\n                  properties: screenTypes.reduce((acc, screenTypes) => {\n                    return {\n                      ...acc,\n                      [screenTypes]: {\n                        type: 'object',\n                      },\n                    };\n                  }, {}),\n                },\n              };\n            }, {}),\n          },\n        };\n      }, {}),\n    },\n  },\n};\n\nexport type PromptSettings = {\n  universal_login_experience?: 'new' | 'classic';\n  webauthn_platform_first_factor?: boolean;\n  identifier_first?: boolean;\n};\n\nexport type PromptsCustomText = {\n  [key in PromptTypes]: Partial<{\n    [key in ScreenTypes]: {\n      [key: string]: string;\n    };\n  }>;\n};\n\nexport type Prompts = Partial<\n  PromptSettings & {\n    customText: AllPromptsByLanguage;\n  }\n>;\n\nexport type AllPromptsByLanguage = Partial<{\n  [key in Language]: Partial<PromptsCustomText>;\n}>;\n\nexport default class PromptsHandler extends DefaultHandler {\n  existing: Prompts;\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'prompts',\n    });\n  }\n\n  objString({ customText }: Prompts): string {\n    return `Prompts settings${!!customText ? ' and prompts custom text' : ''}`;\n  }\n\n  async getType(): Promise<Prompts | null> {\n    const promptsSettings = await this.client.prompts.getSettings();\n\n    const customText = await this.getCustomTextSettings();\n\n    return {\n      ...promptsSettings,\n      customText,\n    };\n  }\n\n  async getCustomTextSettings(): Promise<AllPromptsByLanguage> {\n    const supportedLanguages = await this.client.tenant\n      .getSettings()\n      .then(({ enabled_locales }) => {\n        if (enabled_locales === undefined) return []; // In rare cases, private cloud tenants may not have `enabled_locales` defined\n        return enabled_locales;\n      });\n\n    return this.client.pool\n      .addEachTask({\n        data:\n          supportedLanguages\n            .map((language) => promptTypes.map((promptType) => ({ promptType, language })))\n            .reduce((acc, val) => acc.concat(val), []) || [],\n        generator: ({ promptType, language }) =>\n          this.client.prompts\n            .getCustomTextByLanguage({\n              prompt: promptType,\n              language,\n            })\n            .then((customTextData) => {\n              if (isEmpty(customTextData)) return null;\n              return {\n                language,\n                [promptType]: {\n                  ...customTextData,\n                },\n              };\n            }),\n      })\n      .promise()\n      .then((customTextData) => {\n        return customTextData\n          .filter((customTextData) => {\n            return customTextData !== null;\n          })\n          .reduce((acc: AllPromptsByLanguage, customTextItem) => {\n            if (customTextItem?.language === undefined) return acc;\n\n            const { language, ...customTextSettings } = customTextItem;\n\n            return {\n              ...acc,\n              [language]: !!acc[language]\n                ? { ...acc[language], ...customTextSettings }\n                : { ...customTextSettings },\n            };\n          }, {});\n      });\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    const { prompts } = assets;\n\n    if (!prompts) return;\n\n    const { customText, ...promptSettings } = prompts;\n\n    if (!isEmpty(promptSettings)) {\n      await this.client.prompts.updateSettings({}, promptSettings);\n    }\n\n    await this.updateCustomTextSettings(customText);\n\n    this.updated += 1;\n    this.didUpdate(prompts);\n  }\n\n  async updateCustomTextSettings(customText: Prompts['customText']): Promise<void> {\n    /*\n      Note: deletes are not currently supported\n    */\n    if (!customText) return;\n\n    await this.client.pool\n      .addEachTask({\n        data: Object.keys(customText).flatMap((language: Language) => {\n          const languageScreenTypes = customText[language];\n\n          if (!languageScreenTypes) return [];\n\n          return Object.keys(languageScreenTypes).map((prompt: PromptTypes) => {\n            const body = languageScreenTypes[prompt] || {};\n            return {\n              body,\n              language,\n              prompt,\n            };\n          });\n        }),\n        generator: ({ prompt, language, body }) =>\n          this.client.prompts.updateCustomTextByLanguage({\n            prompt,\n            language,\n            body,\n          }),\n      })\n      .promise();\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b280d0643a372a6c5a498470a44d55fdb449e37d","contentHash":"1741484ea5a9c83ead5832ec812dd221bd0fa17a7d8405bc3ff744fe91f188e9"},"/home/circleci/repo/src/types.ts":{"path":"/home/circleci/repo/src/types.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"2":{"start":{"line":4,"column":0},"end":{"line":54,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/types.ts","sources":["/home/circleci/repo/src/types.ts"],"names":[],"mappings":";;;AA+Ta,QAAA,SAAS,GAAG;IACvB,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,OAAO;IACP,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,OAAO;IACP,IAAI;IACJ,IAAI;IACJ,OAAO;IACP,OAAO;IACP,OAAO;IACP,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,OAAO;IACP,OAAO;IACP,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,OAAO;IACP,OAAO;CACC,CAAC","sourcesContent":["import { Action } from './tools/auth0/handlers/actions';\nimport {\n  PromptTypes,\n  ScreenTypes,\n  Prompts,\n  PromptsCustomText,\n  PromptSettings,\n} from './tools/auth0/handlers/prompts';\nimport { Tenant } from './tools/auth0/handlers/tenant';\nimport { Theme } from './tools/auth0/handlers/themes';\nimport { Page } from './tools/auth0/handlers/pages';\nimport { LogStream } from './tools/auth0/handlers/logStreams';\nimport { Client } from './tools/auth0/handlers/clients';\nimport { ClientGrant } from './tools/auth0/handlers/clientGrants';\nimport { ResourceServer } from './tools/auth0/handlers/resourceServers';\nimport { PromisePoolExecutor } from 'promise-pool-executor';\n\ntype SharedPaginationParams = {\n  checkpoint?: boolean;\n  paginate?: boolean;\n  is_global?: boolean;\n  include_totals?: boolean;\n  id?: string;\n  strategy?: 'auth0';\n};\n\nexport type CheckpointPaginationParams = SharedPaginationParams & {\n  from: string;\n  take: number;\n};\n\nexport type PagePaginationParams = SharedPaginationParams & {\n  page: number;\n  per_page: number;\n};\n\ntype APIClientBaseFunctions = {\n  getAll: (arg0: SharedPaginationParams) => Promise<Asset[]>;\n  create: (arg0: { id: string }) => Promise<Asset>;\n  update: (arg0: {}, arg1: Asset) => Promise<Asset>;\n  delete: (arg0: Asset) => Promise<void>;\n};\n\nexport type ApiResponse = {\n  start: number;\n  limit: number;\n  total: number;\n  next?: string;\n} & { [key in AssetTypes]: Asset[] };\n\nexport type BaseAuth0APIClient = {\n  actions: {\n    getAll: (arg0: SharedPaginationParams) => Promise<Action[]>;\n    create: (arg0: { id: string }) => Promise<Action>;\n    update: (arg0: {}, arg1: Action) => Promise<Action>;\n    delete: (arg0: Asset) => Promise<void>;\n    deploy: (arg0: { id: string }) => Promise<void>;\n    getAllTriggers: () => Promise<{ triggers: Asset[] }>;\n    getTriggerBindings: (arg0: { trigger_id: string }) => Promise<{ bindings: Asset[] }>;\n    updateTriggerBindings: (\n      arg0: { trigger_id: string },\n      arg1: { bindings: Object }\n    ) => Promise<{ bindings: Asset[] }>;\n  };\n  attackProtection: APIClientBaseFunctions & {\n    getBreachedPasswordDetectionConfig: () => Promise<Asset>;\n    getBruteForceConfig: () => Promise<Asset>;\n    getSuspiciousIpThrottlingConfig: () => Promise<Asset>;\n    updateBreachedPasswordDetectionConfig: ({}, arg1: Asset) => Promise<void>;\n    updateSuspiciousIpThrottlingConfig: ({}, arg1: Asset) => Promise<void>;\n    updateBruteForceConfig: ({}, arg1: Asset) => Promise<void>;\n  };\n  branding: APIClientBaseFunctions & {\n    getSettings: () => Promise<Asset>;\n    getUniversalLoginTemplate: () => Promise<Asset>;\n    updateSettings: ({}, Asset) => Promise<void>;\n    setUniversalLoginTemplate: ({}, Asset) => Promise<void>;\n    getDefaultTheme: () => Promise<Theme>;\n    updateTheme: (\n      arg0: { id: string },\n      arg1: Omit<Theme, 'themeId'>\n    ) => Promise<Omit<Theme, 'themeId'>>;\n    createTheme: (arg0: Omit<Theme, 'themeId'>) => Promise<Omit<Theme, 'themeId'>>;\n    deleteTheme: (arg0: { id: string }) => Promise<void>;\n  };\n  clients: {\n    getAll: (arg0: SharedPaginationParams) => Promise<Client[]>;\n    create: (arg0: { id: string }) => Promise<Client>;\n    update: (arg0: {}, arg1: Partial<Client>) => Promise<Client>;\n    delete: (arg0: Asset) => Promise<void>;\n  };\n  clientGrants: {\n    getAll: (arg0: SharedPaginationParams) => Promise<ClientGrant[]>;\n    create: (arg0: { id: string }) => Promise<ClientGrant>;\n    update: (arg0: {}, arg1: Partial<ClientGrant>) => Promise<ClientGrant>;\n    delete: (arg0: Asset) => Promise<void>;\n  };\n  connections: APIClientBaseFunctions & {\n    get: (arg0: Asset) => Promise<Asset>;\n    getAll: (arg0: PagePaginationParams | CheckpointPaginationParams) => Promise<Asset[]>;\n  };\n  customDomains: APIClientBaseFunctions & {\n    getAll: () => Promise<Asset[]>;\n  };\n  emailProvider: APIClientBaseFunctions & {\n    delete: () => Promise<void>;\n    get: (arg0: Asset) => Promise<Asset>;\n    configure: (arg0: Object, arg1: Object) => Promise<Asset>;\n  };\n  emailTemplates: APIClientBaseFunctions & {\n    get: (arg0: Asset) => Promise<Asset>;\n  };\n  guardian: APIClientBaseFunctions & {\n    getFactorProvider: (arg0: Asset) => Promise<Asset>;\n    updateFactorProvider: (arg0: {}, arg1: Asset) => Promise<void>;\n    getFactors: () => Promise<Asset[]>;\n    updateFactor: (arg0: {}, arg1: Asset) => Promise<void>;\n    getPolicies: () => Promise<Asset[]>;\n    updatePolicies: (arg0: {}, arg1: Asset) => Promise<void>;\n    getFactorTemplates: (arg0: { name: string }) => Promise<Asset[]>;\n    updateFactorTemplates: (arg0: {}, arg1: Asset) => Promise<void>;\n    updatePhoneFactorMessageTypes: (arg0: {}, arg1: Asset) => Promise<void>;\n    getPhoneFactorSelectedProvider: () => Promise<Asset[]>;\n    getPhoneFactorMessageTypes: () => Promise<Asset[]>;\n    updatePhoneFactorSelectedProvider: (arg0: {}, arg1: Asset) => Promise<void>;\n  };\n  hooks: APIClientBaseFunctions & {\n    get: (arg0: { id: string }) => Promise<Asset>;\n    removeSecrets: (arg0: {}, arg1: Asset) => Promise<void>;\n    updateSecrets: (arg0: {}, arg1: Asset) => Promise<void>;\n    getSecrets: (arg0: { id: string }) => Promise<Promise<Asset[]>>;\n    addSecrets: (arg0: {}, arg1: Asset) => Promise<void>;\n  };\n  logStreams: {\n    getAll: (arg0: SharedPaginationParams) => Promise<LogStream[]>;\n    create: (arg0: { id: string }) => Promise<LogStream>;\n    update: (arg0: {}, arg1: Partial<LogStream>) => Promise<LogStream>;\n    delete: (arg0: Asset) => Promise<void>;\n  };\n  migrations: APIClientBaseFunctions & {\n    getMigrations: () => Promise<{ flags: Asset[] }>;\n    updateMigrations: (arg0: { flags: Asset[] }) => Promise<void>;\n  };\n  organizations: APIClientBaseFunctions & {\n    updateEnabledConnection: (arg0: {}, arg1: Asset) => Promise<void>;\n    addEnabledConnection: (arg0: {}, arg1: Asset) => Promise<void>;\n    removeEnabledConnection: (arg0: Asset) => Promise<void>;\n    connections: {\n      get: (arg0: Asset) => Promise<Asset>;\n    };\n  };\n  prompts: {\n    updateCustomTextByLanguage: (arg0: {\n      prompt: PromptTypes;\n      language: Language;\n      body: Partial<{ [key in ScreenTypes]: { [key: string]: string } }>;\n    }) => Promise<void>;\n    getCustomTextByLanguage: (arg0: {\n      prompt: PromptTypes;\n      language: Language;\n    }) => Promise<Partial<PromptsCustomText>>;\n    getSettings: () => Promise<PromptSettings>;\n    updateSettings: (arg0: {}, arg1: Partial<PromptSettings>) => Promise<void>;\n  };\n  resourceServers: {\n    getAll: (arg0: SharedPaginationParams) => Promise<ResourceServer[]>;\n    create: (arg0: { id: string }) => Promise<ResourceServer>;\n    update: (arg0: {}, arg1: Partial<ResourceServer>) => Promise<ResourceServer>;\n    delete: (arg0: Asset) => Promise<void>;\n  };\n  roles: APIClientBaseFunctions & {\n    permissions: APIClientBaseFunctions & {\n      delete: (arg0: { id: string }, arg1: { permissions: Asset[] }) => Promise<void>;\n      create: (arg0: { id: string }, arg1: { permissions: Asset[] }) => Promise<Asset>;\n    };\n  };\n  rules: APIClientBaseFunctions;\n  rulesConfigs: APIClientBaseFunctions & {\n    getAll: () => Promise<Asset[]>;\n  };\n  tenant: APIClientBaseFunctions & {\n    getSettings: () => Promise<Tenant>;\n    updateSettings: (arg0: Partial<Tenant>) => Promise<Tenant>;\n  };\n  triggers: APIClientBaseFunctions & {\n    getTriggerBindings: () => Promise<Asset>;\n  };\n}; // TODO: replace with a more accurate representation of the Auth0APIClient type\n\nexport type Auth0APIClient = BaseAuth0APIClient & {\n  pool: PromisePoolExecutor;\n};\n\nexport type Config = {\n  AUTH0_DOMAIN: string;\n  AUTH0_CLIENT_ID: string;\n  AUTH0_CLIENT_SECRET: string;\n  AUTH0_CLIENT_SIGNING_KEY_PATH: string;\n  AUTH0_CLIENT_SIGNING_ALGORITHM: string;\n  AUTH0_INPUT_FILE: string;\n  AUTH0_ALLOW_DELETE: boolean;\n  AUTH0_EXCLUDED?: AssetTypes[];\n  AUTH0_INCLUDED_ONLY?: AssetTypes[];\n  AUTH0_PRESERVE_KEYWORDS: boolean;\n  EXTENSION_SECRET: string;\n  AUTH0_ACCESS_TOKEN?: string;\n  AUTH0_BASE_PATH?: string;\n  AUTH0_AUDIENCE?: string;\n  AUTH0_API_MAX_RETRIES?: number;\n  AUTH0_KEYWORD_REPLACE_MAPPINGS?: KeywordMappings;\n  AUTH0_EXPORT_IDENTIFIERS?: boolean;\n  AUTH0_CONNECTIONS_DIRECTORY?: string;\n  EXCLUDED_PROPS?: {\n    [key: string]: string[];\n  };\n  INCLUDED_PROPS?: {\n    [key: string]: string[];\n  };\n  AUTH0_IGNORE_UNAVAILABLE_MIGRATIONS?: boolean;\n  // Eventually deprecate. See: https://github.com/auth0/auth0-deploy-cli/issues/451#user-content-deprecated-exclusion-props\n  AUTH0_EXCLUDED_RULES?: string[];\n  AUTH0_EXCLUDED_CLIENTS?: string[];\n  AUTH0_EXCLUDED_DATABASES?: string[];\n  AUTH0_EXCLUDED_CONNECTIONS?: string[];\n  AUTH0_EXCLUDED_RESOURCE_SERVERS?: string[];\n  AUTH0_EXCLUDED_DEFAULTS?: string[];\n}; // TODO: replace with a more accurate representation of the Config type\n\nexport type Asset = { [key: string]: any };\n\nexport type Assets = Partial<{\n  actions: Action[] | null;\n  attackProtection: Asset | null;\n  branding:\n    | (Asset & {\n        templates?: { template: string; body: string }[] | null;\n      })\n    | null;\n  clients: Client[] | null;\n  clientGrants: ClientGrant[] | null;\n  connections: Asset[] | null;\n  customDomains: Asset[] | null;\n  databases: Asset[] | null;\n  emailProvider: Asset | null;\n  emailTemplates: Asset[] | null;\n  guardianFactorProviders: Asset[] | null;\n  guardianFactors: Asset[] | null;\n  guardianFactorTemplates: Asset[] | null;\n  guardianPhoneFactorMessageTypes: {\n    message_types: Asset[]; //TODO: eliminate this intermediate level for consistency\n  } | null;\n  guardianPhoneFactorSelectedProvider: Asset | null;\n  guardianPolicies: {\n    policies: Asset[]; //TODO: eliminate this intermediate level for consistency\n  } | null;\n  hooks: Asset[] | null;\n  logStreams: LogStream[] | null;\n  migrations: Asset[] | null;\n  organizations: Asset[] | null;\n  pages: Page[] | null;\n  prompts: Prompts | null;\n  resourceServers: ResourceServer[] | null;\n  roles: Asset[] | null;\n  rules: Asset[] | null;\n  rulesConfigs: Asset[] | null;\n  tenant: Tenant | null;\n  triggers: Asset[] | null;\n  //non-resource types\n  exclude?: {\n    [key: string]: string[];\n  };\n  clientsOrig: Asset[] | null;\n  themes: Theme[] | null;\n}>;\n\nexport type CalculatedChanges = {\n  del: Asset[];\n  update: Asset[];\n  conflicts: Asset[];\n  create: Asset[];\n};\n\nexport type AssetTypes =\n  | 'rules'\n  | 'rulesConfigs'\n  | 'hooks'\n  | 'pages'\n  | 'databases'\n  | 'clientGrants'\n  | 'resourceServers'\n  | 'clients'\n  | 'connections'\n  | 'tenant'\n  | 'emailProvider'\n  | 'emailTemplates'\n  | 'guardianFactors'\n  | 'guardianFactorProviders'\n  | 'guardianFactorTemplates'\n  | 'migrations'\n  | 'guardianPhoneFactorMessageTypes'\n  | 'guardianPhoneFactorSelectedProvider'\n  | 'guardianPolicies'\n  | 'roles'\n  | 'actions'\n  | 'organizations'\n  | 'triggers'\n  | 'attackProtection'\n  | 'branding'\n  | 'logStreams'\n  | 'prompts'\n  | 'customDomains'\n  | 'themes';\n\nexport type KeywordMappings = { [key: string]: (string | number)[] | string | number };\n\nexport type ParsedAsset<Key extends AssetTypes, T> = {\n  [key in Key]: T | null;\n};\n\nexport const languages = [\n  'ar',\n  'bg',\n  'bs',\n  'ca-ES',\n  'cs',\n  'cy',\n  'da',\n  'de',\n  'el',\n  'en',\n  'es',\n  'et',\n  'eu-ES',\n  'fi',\n  'fr',\n  'fr-CA',\n  'fr-FR',\n  'gl-ES',\n  'he',\n  'hi',\n  'hr',\n  'hu',\n  'id',\n  'is',\n  'it',\n  'ja',\n  'ko',\n  'lt',\n  'lv',\n  'nb',\n  'nl',\n  'nn',\n  'no',\n  'pl',\n  'pt',\n  'pt-BR',\n  'pt-PT',\n  'ro',\n  'ru',\n  'sk',\n  'sl',\n  'sr',\n  'sv',\n  'th',\n  'tr',\n  'uk',\n  'vi',\n  'zh-CN',\n  'zh-TW',\n] as const;\n\nexport type Language = typeof languages[number];\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7df7ce763d8a0722a112b4bca2043a13b9b79515","contentHash":"05718e8a5e05d844bdb318bbd8fda8e0984f21618b9548d3001b8a2c774a0cda"},"/home/circleci/repo/src/tools/auth0/handlers/migrations.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/migrations.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":24}},"50":{"start":{"line":45,"column":18},"end":{"line":45,"column":52}},"51":{"start":{"line":46,"column":17},"end":{"line":46,"column":60}},"52":{"start":{"line":47,"column":0},"end":{"line":50,"column":2}},"53":{"start":{"line":53,"column":8},"end":{"line":53,"column":81}},"54":{"start":{"line":57,"column":8},"end":{"line":67,"column":11}},"55":{"start":{"line":58,"column":12},"end":{"line":66,"column":13}},"56":{"start":{"line":59,"column":35},"end":{"line":59,"column":79}},"57":{"start":{"line":60,"column":16},"end":{"line":60,"column":40}},"58":{"start":{"line":63,"column":16},"end":{"line":64,"column":30}},"59":{"start":{"line":64,"column":20},"end":{"line":64,"column":30}},"60":{"start":{"line":65,"column":16},"end":{"line":65,"column":26}},"61":{"start":{"line":71,"column":8},"end":{"line":81,"column":11}},"62":{"start":{"line":72,"column":35},"end":{"line":72,"column":41}},"63":{"start":{"line":73,"column":12},"end":{"line":80,"column":13}},"64":{"start":{"line":74,"column":30},"end":{"line":74,"column":80}},"65":{"start":{"line":75,"column":16},"end":{"line":79,"column":17}},"66":{"start":{"line":76,"column":20},"end":{"line":76,"column":77}},"67":{"start":{"line":77,"column":20},"end":{"line":77,"column":38}},"68":{"start":{"line":78,"column":20},"end":{"line":78,"column":42}},"69":{"start":{"line":84,"column":8},"end":{"line":89,"column":9}},"70":{"start":{"line":85,"column":12},"end":{"line":85,"column":226}},"71":{"start":{"line":88,"column":12},"end":{"line":88,"column":203}},"72":{"start":{"line":92,"column":8},"end":{"line":103,"column":11}},"73":{"start":{"line":93,"column":26},"end":{"line":93,"column":55}},"74":{"start":{"line":94,"column":48},"end":{"line":94,"column":100}},"75":{"start":{"line":95,"column":39},"end":{"line":95,"column":59}},"76":{"start":{"line":96,"column":42},"end":{"line":96,"column":108}},"77":{"start":{"line":96,"column":78},"end":{"line":96,"column":107}},"78":{"start":{"line":97,"column":38},"end":{"line":97,"column":130}},"79":{"start":{"line":97,"column":77},"end":{"line":97,"column":129}},"80":{"start":{"line":98,"column":12},"end":{"line":101,"column":13}},"81":{"start":{"line":99,"column":16},"end":{"line":99,"column":94}},"82":{"start":{"line":100,"column":16},"end":{"line":100,"column":72}},"83":{"start":{"line":100,"column":52},"end":{"line":100,"column":70}},"84":{"start":{"line":102,"column":12},"end":{"line":102,"column":25}},"85":{"start":{"line":106,"column":0},"end":{"line":108,"column":56}},"86":{"start":{"line":109,"column":0},"end":{"line":109,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"(anonymous_15)","decl":{"start":{"line":52,"column":4},"end":{"line":52,"column":5}},"loc":{"start":{"line":52,"column":25},"end":{"line":54,"column":5}},"line":52},"16":{"name":"(anonymous_16)","decl":{"start":{"line":56,"column":4},"end":{"line":56,"column":5}},"loc":{"start":{"line":56,"column":14},"end":{"line":68,"column":5}},"line":56},"17":{"name":"(anonymous_17)","decl":{"start":{"line":57,"column":47},"end":{"line":57,"column":48}},"loc":{"start":{"line":57,"column":60},"end":{"line":67,"column":9}},"line":57},"18":{"name":"(anonymous_18)","decl":{"start":{"line":70,"column":4},"end":{"line":70,"column":5}},"loc":{"start":{"line":70,"column":27},"end":{"line":82,"column":5}},"line":70},"19":{"name":"(anonymous_19)","decl":{"start":{"line":71,"column":47},"end":{"line":71,"column":48}},"loc":{"start":{"line":71,"column":60},"end":{"line":81,"column":9}},"line":71},"20":{"name":"(anonymous_20)","decl":{"start":{"line":83,"column":4},"end":{"line":83,"column":5}},"loc":{"start":{"line":83,"column":77},"end":{"line":90,"column":5}},"line":83},"21":{"name":"(anonymous_21)","decl":{"start":{"line":91,"column":4},"end":{"line":91,"column":5}},"loc":{"start":{"line":91,"column":44},"end":{"line":104,"column":5}},"line":91},"22":{"name":"(anonymous_22)","decl":{"start":{"line":92,"column":47},"end":{"line":92,"column":48}},"loc":{"start":{"line":92,"column":60},"end":{"line":103,"column":9}},"line":92},"23":{"name":"(anonymous_23)","decl":{"start":{"line":96,"column":68},"end":{"line":96,"column":69}},"loc":{"start":{"line":96,"column":78},"end":{"line":96,"column":107}},"line":96},"24":{"name":"(anonymous_24)","decl":{"start":{"line":97,"column":67},"end":{"line":97,"column":68}},"loc":{"start":{"line":97,"column":77},"end":{"line":97,"column":129}},"line":97},"25":{"name":"(anonymous_25)","decl":{"start":{"line":100,"column":42},"end":{"line":100,"column":43}},"loc":{"start":{"line":100,"column":52},"end":{"line":100,"column":70}},"line":100}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":63,"column":16},"end":{"line":64,"column":30}},"type":"if","locations":[{"start":{"line":63,"column":16},"end":{"line":64,"column":30}},{"start":{"line":63,"column":16},"end":{"line":64,"column":30}}],"line":63},"35":{"loc":{"start":{"line":73,"column":12},"end":{"line":80,"column":13}},"type":"if","locations":[{"start":{"line":73,"column":12},"end":{"line":80,"column":13}},{"start":{"line":73,"column":12},"end":{"line":80,"column":13}}],"line":73},"36":{"loc":{"start":{"line":73,"column":16},"end":{"line":73,"column":64}},"type":"binary-expr","locations":[{"start":{"line":73,"column":16},"end":{"line":73,"column":26}},{"start":{"line":73,"column":30},"end":{"line":73,"column":64}}],"line":73},"37":{"loc":{"start":{"line":75,"column":16},"end":{"line":79,"column":17}},"type":"if","locations":[{"start":{"line":75,"column":16},"end":{"line":79,"column":17}},{"start":{"line":75,"column":16},"end":{"line":79,"column":17}}],"line":75},"38":{"loc":{"start":{"line":84,"column":8},"end":{"line":89,"column":9}},"type":"if","locations":[{"start":{"line":84,"column":8},"end":{"line":89,"column":9}},{"start":{"line":84,"column":8},"end":{"line":89,"column":9}}],"line":84},"39":{"loc":{"start":{"line":97,"column":77},"end":{"line":97,"column":129}},"type":"binary-expr","locations":[{"start":{"line":97,"column":77},"end":{"line":97,"column":104}},{"start":{"line":97,"column":108},"end":{"line":97,"column":129}}],"line":97},"40":{"loc":{"start":{"line":98,"column":12},"end":{"line":101,"column":13}},"type":"if","locations":[{"start":{"line":98,"column":12},"end":{"line":101,"column":13}},{"start":{"line":98,"column":12},"end":{"line":101,"column":13}}],"line":98}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":25,"36":10,"37":21,"38":24,"39":24,"40":0,"41":1,"42":1,"43":0,"44":46,"45":21,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":137,"54":11,"55":11,"56":11,"57":10,"58":1,"59":1,"60":0,"61":5,"62":5,"63":5,"64":5,"65":5,"66":4,"67":4,"68":4,"69":3,"70":1,"71":2,"72":5,"73":5,"74":5,"75":5,"76":5,"77":9,"78":5,"79":5,"80":5,"81":3,"82":3,"83":4,"84":5,"85":1,"86":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":21,"8":25,"9":10,"10":21,"11":24,"12":1,"13":46,"14":1,"15":137,"16":11,"17":11,"18":5,"19":5,"20":3,"21":5,"22":5,"23":9,"24":5,"25":4},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[15,10],"28":[21,21],"29":[21,25],"30":[21,21],"31":[1,1,1],"32":[1,0],"33":[1,1],"34":[1,0],"35":[5,0],"36":[5,5],"37":[4,1],"38":[1,2],"39":[5,3],"40":[3,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/migrations.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/migrations.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,qDAAkD;AAClD,6DAAkC;AAGrB,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,QAAQ;IACd,oBAAoB,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE;CAC1C,CAAC;AAEF,MAAqB,iBAAkB,SAAQ,iBAAc;IAC3D,YAAY,OAAuB;QACjC,KAAK,iCACA,OAAO,KACV,IAAI,EAAE,YAAY,IAClB,CAAC;IACL,CAAC;IAED,8EAA8E;IACxE,OAAO;;YACX,IAAI;gBACF,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,aAAa,EAAE,CAAC;gBAChE,OAAO,UAAU,CAAC,KAAK,CAAC;aACzB;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,GAAG,CAAC,UAAU,KAAK,GAAG;oBAAE,OAAO,EAAE,CAAC;gBACtC,MAAM,GAAG,CAAC;aACX;QACH,CAAC;KAAA;IAED,oFAAoF;IAE9E,cAAc,CAAC,MAAc;;YACjC,MAAM,EAAE,UAAU,EAAE,GAAG,MAAM,CAAC;YAE9B,IAAI,UAAU,IAAI,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBACpD,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,2BAA2B,CAAC,UAAU,CAAC,CAAC;gBAEjE,IAAI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;oBACjC,MAAM,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,gBAAgB,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;oBACzD,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;oBAClB,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;iBACvB;aACF;QACH,CAAC;KAAA;IAED,wBAAwB,CAAC,2BAAoC,EAAE,iBAA2B;QACxF,IAAI,2BAA2B,EAAE;YAC/B,gBAAG,CAAC,IAAI,CACN,+CAA+C,iBAAiB,CAAC,IAAI,CACnE,GAAG,CACJ,oHAAoH,CACtH,CAAC;SACH;aAAM;YACL,gBAAG,CAAC,IAAI,CACN,wDAAwD,iBAAiB,CAAC,IAAI,CAC5E,GAAG,CACJ,oFAAoF,CACtF,CAAC;SACH;IACH,CAAC;IAEK,2BAA2B,CAAC,UAAmB;;YACnD,MAAM,KAAK,qBAAQ,UAAU,CAAE,CAAC;YAChC,MAAM,2BAA2B,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,qCAAqC,CAAC,CAAC;YACzF,MAAM,kBAAkB,GAAG,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC;YAChD,MAAM,qBAAqB,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CACrD,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,kBAAkB,CAAC,CACxC,CAAC;YACF,MAAM,iBAAiB,GAAG,qBAAqB,CAAC,MAAM,CACpD,CAAC,IAAI,EAAE,EAAE,CAAC,2BAA2B,IAAI,KAAK,CAAC,IAAI,CAAC,KAAK,KAAK,CAC/D,CAAC;YAEF,IAAI,iBAAiB,CAAC,MAAM,GAAG,CAAC,EAAE;gBAChC,IAAI,CAAC,wBAAwB,CAAC,2BAA2B,EAAE,iBAAiB,CAAC,CAAC;gBAC9E,iBAAiB,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,OAAO,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;aACzD;YACD,OAAO,KAAK,CAAC;QACf,CAAC;KAAA;CACF;AA/CO;IADL,IAAA,eAAK,EAAC,KAAK,CAAC;uDAaZ;AAjCH,oCAoEC","sourcesContent":["import DefaultHandler, { order } from './default';\nimport log from '../../../logger';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'object',\n  additionalProperties: { type: 'boolean' },\n};\n\nexport default class MigrationsHandler extends DefaultHandler {\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'migrations',\n    });\n  }\n\n  //TODO: standardize empty object literal with more intentional empty indicator\n  async getType(): Promise<Asset[] | {}> {\n    try {\n      const migrations = await this.client.migrations.getMigrations();\n      return migrations.flags;\n    } catch (err) {\n      if (err.statusCode === 404) return {};\n      throw err;\n    }\n  }\n\n  // Run at the end since switching a flag will depend on other applying other changes\n  @order('150')\n  async processChanges(assets: Assets): Promise<void> {\n    const { migrations } = assets;\n\n    if (migrations && Object.keys(migrations).length > 0) {\n      const flags = await this.removeUnavailableMigrations(migrations);\n\n      if (Object.keys(flags).length > 0) {\n        await this.client.migrations.updateMigrations({ flags });\n        this.updated += 1;\n        this.didUpdate(flags);\n      }\n    }\n  }\n\n  logUnavailableMigrations(ignoreUnavailableMigrations: boolean, ignoredMigrations: string[]) {\n    if (ignoreUnavailableMigrations) {\n      log.info(\n        `The following migrations are not available '${ignoredMigrations.join(\n          ','\n        )}'. The migrations will be ignored because you have AUTH0_IGNORE_UNAVAILABLE_MIGRATIONS=true in your configuration.`\n      );\n    } else {\n      log.warn(\n        `The following disabled migrations are not available '${ignoredMigrations.join(\n          ','\n        )}'. The migrations will be ignored, remove the migrations to avoid future warnings.`\n      );\n    }\n  }\n\n  async removeUnavailableMigrations(migrations: Asset[]): Promise<Asset[]> {\n    const flags = { ...migrations };\n    const ignoreUnavailableMigrations = !!this.config('AUTH0_IGNORE_UNAVAILABLE_MIGRATIONS');\n    const existingMigrations = await this.getType();\n    const unavailableMigrations = Object.keys(flags).filter(\n      (flag) => !(flag in existingMigrations)\n    );\n    const ignoredMigrations = unavailableMigrations.filter(\n      (flag) => ignoreUnavailableMigrations || flags[flag] === false\n    );\n\n    if (ignoredMigrations.length > 0) {\n      this.logUnavailableMigrations(ignoreUnavailableMigrations, ignoredMigrations);\n      ignoredMigrations.forEach((flag) => delete flags[flag]);\n    }\n    return flags;\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9fae873c786a25dd909a135a1a1647ebde9a12b6","contentHash":"27f4ba770af46a0f55c55cdbf8294d7e433819d3b91349936a92a237ef24785b"},"/home/circleci/repo/src/tools/auth0/handlers/actions.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/actions.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":54}},"50":{"start":{"line":45,"column":17},"end":{"line":45,"column":51}},"51":{"start":{"line":46,"column":18},"end":{"line":46,"column":52}},"52":{"start":{"line":47,"column":17},"end":{"line":47,"column":60}},"53":{"start":{"line":48,"column":16},"end":{"line":48,"column":38}},"54":{"start":{"line":49,"column":41},"end":{"line":49,"column":43}},"55":{"start":{"line":51,"column":0},"end":{"line":99,"column":2}},"56":{"start":{"line":101,"column":22},"end":{"line":101,"column":84}},"57":{"start":{"line":102,"column":4},"end":{"line":102,"column":83}},"58":{"start":{"line":105,"column":4},"end":{"line":105,"column":32}},"59":{"start":{"line":107,"column":0},"end":{"line":107,"column":50}},"60":{"start":{"line":110,"column":8},"end":{"line":113,"column":61}},"61":{"start":{"line":111,"column":36},"end":{"line":111,"column":61}},"62":{"start":{"line":112,"column":36},"end":{"line":112,"column":61}},"63":{"start":{"line":116,"column":8},"end":{"line":125,"column":11}},"64":{"start":{"line":118,"column":30},"end":{"line":118,"column":55}},"65":{"start":{"line":119,"column":12},"end":{"line":119,"column":38}},"66":{"start":{"line":120,"column":12},"end":{"line":120,"column":36}},"67":{"start":{"line":121,"column":34},"end":{"line":121,"column":77}},"68":{"start":{"line":123,"column":12},"end":{"line":123,"column":41}},"69":{"start":{"line":124,"column":12},"end":{"line":124,"column":33}},"70":{"start":{"line":128,"column":8},"end":{"line":133,"column":11}},"71":{"start":{"line":129,"column":12},"end":{"line":131,"column":13}},"72":{"start":{"line":130,"column":16},"end":{"line":130,"column":26}},"73":{"start":{"line":132,"column":12},"end":{"line":132,"column":78}},"74":{"start":{"line":136,"column":8},"end":{"line":136,"column":69}},"75":{"start":{"line":139,"column":8},"end":{"line":152,"column":11}},"76":{"start":{"line":140,"column":12},"end":{"line":151,"column":27}},"77":{"start":{"line":143,"column":39},"end":{"line":149,"column":18}},"78":{"start":{"line":145,"column":20},"end":{"line":145,"column":96}},"79":{"start":{"line":148,"column":20},"end":{"line":148,"column":104}},"80":{"start":{"line":155,"column":8},"end":{"line":177,"column":11}},"81":{"start":{"line":156,"column":12},"end":{"line":176,"column":13}},"82":{"start":{"line":157,"column":16},"end":{"line":157,"column":68}},"83":{"start":{"line":161,"column":16},"end":{"line":175,"column":17}},"84":{"start":{"line":162,"column":20},"end":{"line":165,"column":21}},"85":{"start":{"line":163,"column":24},"end":{"line":163,"column":121}},"86":{"start":{"line":164,"column":24},"end":{"line":164,"column":47}},"87":{"start":{"line":166,"column":20},"end":{"line":168,"column":21}},"88":{"start":{"line":167,"column":24},"end":{"line":167,"column":34}},"89":{"start":{"line":169,"column":20},"end":{"line":169,"column":51}},"90":{"start":{"line":170,"column":20},"end":{"line":170,"column":44}},"91":{"start":{"line":171,"column":20},"end":{"line":171,"column":52}},"92":{"start":{"line":174,"column":20},"end":{"line":174,"column":30}},"93":{"start":{"line":180,"column":8},"end":{"line":199,"column":11}},"94":{"start":{"line":181,"column":34},"end":{"line":181,"column":36}},"95":{"start":{"line":183,"column":12},"end":{"line":194,"column":13}},"96":{"start":{"line":185,"column":16},"end":{"line":187,"column":17}},"97":{"start":{"line":186,"column":20},"end":{"line":186,"column":53}},"98":{"start":{"line":188,"column":16},"end":{"line":190,"column":17}},"99":{"start":{"line":189,"column":20},"end":{"line":189,"column":59}},"100":{"start":{"line":191,"column":16},"end":{"line":193,"column":17}},"101":{"start":{"line":192,"column":20},"end":{"line":192,"column":69}},"102":{"start":{"line":195,"column":12},"end":{"line":197,"column":13}},"103":{"start":{"line":196,"column":16},"end":{"line":196,"column":77}},"104":{"start":{"line":198,"column":12},"end":{"line":198,"column":33}},"105":{"start":{"line":202,"column":8},"end":{"line":228,"column":11}},"106":{"start":{"line":203,"column":12},"end":{"line":204,"column":37}},"107":{"start":{"line":204,"column":16},"end":{"line":204,"column":37}},"108":{"start":{"line":205,"column":12},"end":{"line":207,"column":13}},"109":{"start":{"line":206,"column":16},"end":{"line":206,"column":26}},"110":{"start":{"line":210,"column":12},"end":{"line":227,"column":13}},"111":{"start":{"line":211,"column":32},"end":{"line":211,"column":84}},"112":{"start":{"line":212,"column":16},"end":{"line":212,"column":40}},"113":{"start":{"line":213,"column":16},"end":{"line":213,"column":31}},"114":{"start":{"line":216,"column":16},"end":{"line":218,"column":17}},"115":{"start":{"line":217,"column":20},"end":{"line":217,"column":32}},"116":{"start":{"line":219,"column":16},"end":{"line":221,"column":17}},"117":{"start":{"line":220,"column":20},"end":{"line":220,"column":355}},"118":{"start":{"line":222,"column":16},"end":{"line":225,"column":17}},"119":{"start":{"line":223,"column":20},"end":{"line":223,"column":89}},"120":{"start":{"line":224,"column":20},"end":{"line":224,"column":32}},"121":{"start":{"line":226,"column":16},"end":{"line":226,"column":26}},"122":{"start":{"line":231,"column":23},"end":{"line":233,"column":10}},"123":{"start":{"line":232,"column":41},"end":{"line":232,"column":61}},"124":{"start":{"line":234,"column":8},"end":{"line":267,"column":11}},"125":{"start":{"line":235,"column":32},"end":{"line":235,"column":38}},"126":{"start":{"line":237,"column":12},"end":{"line":238,"column":23}},"127":{"start":{"line":238,"column":16},"end":{"line":238,"column":23}},"128":{"start":{"line":239,"column":28},"end":{"line":239,"column":58}},"129":{"start":{"line":241,"column":58},"end":{"line":243,"column":16}},"130":{"start":{"line":242,"column":16},"end":{"line":242,"column":136}},"131":{"start":{"line":242,"column":103},"end":{"line":242,"column":131}},"132":{"start":{"line":244,"column":12},"end":{"line":244,"column":98}},"133":{"start":{"line":245,"column":41},"end":{"line":249,"column":17}},"134":{"start":{"line":245,"column":54},"end":{"line":249,"column":14}},"135":{"start":{"line":246,"column":16},"end":{"line":246,"column":37}},"136":{"start":{"line":247,"column":32},"end":{"line":247,"column":52}},"137":{"start":{"line":248,"column":16},"end":{"line":248,"column":31}},"138":{"start":{"line":251,"column":34},"end":{"line":265,"column":13}},"139":{"start":{"line":253,"column":40},"end":{"line":253,"column":55}},"140":{"start":{"line":257,"column":37},"end":{"line":259,"column":66}},"141":{"start":{"line":258,"column":24},"end":{"line":258,"column":81}},"142":{"start":{"line":260,"column":41},"end":{"line":260,"column":108}},"143":{"start":{"line":261,"column":20},"end":{"line":261,"column":40}},"144":{"start":{"line":263,"column":40},"end":{"line":263,"column":51}},"145":{"start":{"line":264,"column":53},"end":{"line":264,"column":68}},"146":{"start":{"line":266,"column":12},"end":{"line":266,"column":52}},"147":{"start":{"line":270,"column":0},"end":{"line":272,"column":52}},"148":{"start":{"line":273,"column":0},"end":{"line":273,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"isActionsDisabled","decl":{"start":{"line":100,"column":9},"end":{"line":100,"column":26}},"loc":{"start":{"line":100,"column":32},"end":{"line":103,"column":1}},"line":100},"16":{"name":"isMarketplaceAction","decl":{"start":{"line":104,"column":9},"end":{"line":104,"column":28}},"loc":{"start":{"line":104,"column":37},"end":{"line":106,"column":1}},"line":104},"17":{"name":"(anonymous_17)","decl":{"start":{"line":109,"column":4},"end":{"line":109,"column":5}},"loc":{"start":{"line":109,"column":25},"end":{"line":114,"column":5}},"line":109},"18":{"name":"(anonymous_18)","decl":{"start":{"line":111,"column":24},"end":{"line":111,"column":25}},"loc":{"start":{"line":111,"column":36},"end":{"line":111,"column":61}},"line":111},"19":{"name":"(anonymous_19)","decl":{"start":{"line":112,"column":24},"end":{"line":112,"column":25}},"loc":{"start":{"line":112,"column":36},"end":{"line":112,"column":61}},"line":112},"20":{"name":"(anonymous_20)","decl":{"start":{"line":115,"column":4},"end":{"line":115,"column":5}},"loc":{"start":{"line":115,"column":25},"end":{"line":126,"column":5}},"line":115},"21":{"name":"(anonymous_21)","decl":{"start":{"line":116,"column":47},"end":{"line":116,"column":48}},"loc":{"start":{"line":116,"column":60},"end":{"line":125,"column":9}},"line":116},"22":{"name":"(anonymous_22)","decl":{"start":{"line":127,"column":4},"end":{"line":127,"column":5}},"loc":{"start":{"line":127,"column":25},"end":{"line":134,"column":5}},"line":127},"23":{"name":"(anonymous_23)","decl":{"start":{"line":128,"column":47},"end":{"line":128,"column":48}},"loc":{"start":{"line":128,"column":60},"end":{"line":133,"column":9}},"line":128},"24":{"name":"(anonymous_24)","decl":{"start":{"line":135,"column":4},"end":{"line":135,"column":5}},"loc":{"start":{"line":135,"column":22},"end":{"line":137,"column":5}},"line":135},"25":{"name":"(anonymous_25)","decl":{"start":{"line":138,"column":4},"end":{"line":138,"column":5}},"loc":{"start":{"line":138,"column":27},"end":{"line":153,"column":5}},"line":138},"26":{"name":"(anonymous_26)","decl":{"start":{"line":139,"column":47},"end":{"line":139,"column":48}},"loc":{"start":{"line":139,"column":60},"end":{"line":152,"column":9}},"line":139},"27":{"name":"(anonymous_27)","decl":{"start":{"line":143,"column":27},"end":{"line":143,"column":28}},"loc":{"start":{"line":143,"column":39},"end":{"line":149,"column":18}},"line":143},"28":{"name":"(anonymous_28)","decl":{"start":{"line":144,"column":26},"end":{"line":144,"column":27}},"loc":{"start":{"line":144,"column":32},"end":{"line":146,"column":17}},"line":144},"29":{"name":"(anonymous_29)","decl":{"start":{"line":147,"column":27},"end":{"line":147,"column":28}},"loc":{"start":{"line":147,"column":36},"end":{"line":149,"column":17}},"line":147},"30":{"name":"(anonymous_30)","decl":{"start":{"line":154,"column":4},"end":{"line":154,"column":5}},"loc":{"start":{"line":154,"column":25},"end":{"line":178,"column":5}},"line":154},"31":{"name":"(anonymous_31)","decl":{"start":{"line":155,"column":47},"end":{"line":155,"column":48}},"loc":{"start":{"line":155,"column":60},"end":{"line":177,"column":9}},"line":155},"32":{"name":"(anonymous_32)","decl":{"start":{"line":179,"column":4},"end":{"line":179,"column":5}},"loc":{"start":{"line":179,"column":33},"end":{"line":200,"column":5}},"line":179},"33":{"name":"(anonymous_33)","decl":{"start":{"line":180,"column":47},"end":{"line":180,"column":48}},"loc":{"start":{"line":180,"column":60},"end":{"line":199,"column":9}},"line":180},"34":{"name":"(anonymous_34)","decl":{"start":{"line":201,"column":4},"end":{"line":201,"column":5}},"loc":{"start":{"line":201,"column":14},"end":{"line":229,"column":5}},"line":201},"35":{"name":"(anonymous_35)","decl":{"start":{"line":202,"column":47},"end":{"line":202,"column":48}},"loc":{"start":{"line":202,"column":60},"end":{"line":228,"column":9}},"line":202},"36":{"name":"(anonymous_36)","decl":{"start":{"line":230,"column":4},"end":{"line":230,"column":5}},"loc":{"start":{"line":230,"column":27},"end":{"line":268,"column":5}},"line":230},"37":{"name":"(anonymous_37)","decl":{"start":{"line":232,"column":35},"end":{"line":232,"column":36}},"loc":{"start":{"line":232,"column":41},"end":{"line":232,"column":61}},"line":232},"38":{"name":"(anonymous_38)","decl":{"start":{"line":234,"column":47},"end":{"line":234,"column":48}},"loc":{"start":{"line":234,"column":60},"end":{"line":267,"column":9}},"line":234},"39":{"name":"(anonymous_39)","decl":{"start":{"line":241,"column":59},"end":{"line":241,"column":60}},"loc":{"start":{"line":241,"column":65},"end":{"line":243,"column":13}},"line":241},"40":{"name":"(anonymous_40)","decl":{"start":{"line":242,"column":91},"end":{"line":242,"column":92}},"loc":{"start":{"line":242,"column":103},"end":{"line":242,"column":131}},"line":242},"41":{"name":"(anonymous_41)","decl":{"start":{"line":245,"column":48},"end":{"line":245,"column":49}},"loc":{"start":{"line":245,"column":54},"end":{"line":249,"column":14}},"line":245},"42":{"name":"(anonymous_42)","decl":{"start":{"line":245,"column":86},"end":{"line":245,"column":87}},"loc":{"start":{"line":245,"column":99},"end":{"line":249,"column":13}},"line":245},"43":{"name":"(anonymous_43)","decl":{"start":{"line":253,"column":28},"end":{"line":253,"column":29}},"loc":{"start":{"line":253,"column":40},"end":{"line":253,"column":55}},"line":253},"44":{"name":"(anonymous_44)","decl":{"start":{"line":254,"column":25},"end":{"line":254,"column":26}},"loc":{"start":{"line":254,"column":46},"end":{"line":262,"column":17}},"line":254},"45":{"name":"(anonymous_45)","decl":{"start":{"line":257,"column":145},"end":{"line":257,"column":146}},"loc":{"start":{"line":257,"column":170},"end":{"line":259,"column":21}},"line":257},"46":{"name":"(anonymous_46)","decl":{"start":{"line":263,"column":28},"end":{"line":263,"column":29}},"loc":{"start":{"line":263,"column":40},"end":{"line":263,"column":51}},"line":263},"47":{"name":"(anonymous_47)","decl":{"start":{"line":264,"column":41},"end":{"line":264,"column":42}},"loc":{"start":{"line":264,"column":53},"end":{"line":264,"column":68}},"line":264}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":101,"column":22},"end":{"line":101,"column":84}},"type":"binary-expr","locations":[{"start":{"line":101,"column":22},"end":{"line":101,"column":78}},{"start":{"line":101,"column":82},"end":{"line":101,"column":84}}],"line":101},"35":{"loc":{"start":{"line":102,"column":11},"end":{"line":102,"column":82}},"type":"binary-expr","locations":[{"start":{"line":102,"column":11},"end":{"line":102,"column":33}},{"start":{"line":102,"column":37},"end":{"line":102,"column":82}}],"line":102},"36":{"loc":{"start":{"line":129,"column":12},"end":{"line":131,"column":13}},"type":"if","locations":[{"start":{"line":129,"column":12},"end":{"line":131,"column":13}},{"start":{"line":129,"column":12},"end":{"line":131,"column":13}}],"line":129},"37":{"loc":{"start":{"line":129,"column":16},"end":{"line":129,"column":88}},"type":"binary-expr","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":36}},{"start":{"line":129,"column":40},"end":{"line":129,"column":88}}],"line":129},"38":{"loc":{"start":{"line":142,"column":22},"end":{"line":142,"column":35}},"type":"binary-expr","locations":[{"start":{"line":142,"column":22},"end":{"line":142,"column":29}},{"start":{"line":142,"column":33},"end":{"line":142,"column":35}}],"line":142},"39":{"loc":{"start":{"line":161,"column":16},"end":{"line":175,"column":17}},"type":"if","locations":[{"start":{"line":161,"column":16},"end":{"line":175,"column":17}},{"start":{"line":161,"column":16},"end":{"line":175,"column":17}}],"line":161},"40":{"loc":{"start":{"line":161,"column":20},"end":{"line":161,"column":87}},"type":"binary-expr","locations":[{"start":{"line":161,"column":20},"end":{"line":161,"column":31}},{"start":{"line":161,"column":35},"end":{"line":161,"column":87}}],"line":161},"41":{"loc":{"start":{"line":162,"column":20},"end":{"line":165,"column":21}},"type":"if","locations":[{"start":{"line":162,"column":20},"end":{"line":165,"column":21}},{"start":{"line":162,"column":20},"end":{"line":165,"column":21}}],"line":162},"42":{"loc":{"start":{"line":166,"column":20},"end":{"line":168,"column":21}},"type":"if","locations":[{"start":{"line":166,"column":20},"end":{"line":168,"column":21}},{"start":{"line":166,"column":20},"end":{"line":168,"column":21}}],"line":166},"43":{"loc":{"start":{"line":183,"column":12},"end":{"line":194,"column":13}},"type":"if","locations":[{"start":{"line":183,"column":12},"end":{"line":194,"column":13}},{"start":{"line":183,"column":12},"end":{"line":194,"column":13}}],"line":183},"44":{"loc":{"start":{"line":185,"column":16},"end":{"line":187,"column":17}},"type":"if","locations":[{"start":{"line":185,"column":16},"end":{"line":187,"column":17}},{"start":{"line":185,"column":16},"end":{"line":187,"column":17}}],"line":185},"45":{"loc":{"start":{"line":188,"column":16},"end":{"line":190,"column":17}},"type":"if","locations":[{"start":{"line":188,"column":16},"end":{"line":190,"column":17}},{"start":{"line":188,"column":16},"end":{"line":190,"column":17}}],"line":188},"46":{"loc":{"start":{"line":191,"column":16},"end":{"line":193,"column":17}},"type":"if","locations":[{"start":{"line":191,"column":16},"end":{"line":193,"column":17}},{"start":{"line":191,"column":16},"end":{"line":193,"column":17}}],"line":191},"47":{"loc":{"start":{"line":195,"column":12},"end":{"line":197,"column":13}},"type":"if","locations":[{"start":{"line":195,"column":12},"end":{"line":197,"column":13}},{"start":{"line":195,"column":12},"end":{"line":197,"column":13}}],"line":195},"48":{"loc":{"start":{"line":203,"column":12},"end":{"line":204,"column":37}},"type":"if","locations":[{"start":{"line":203,"column":12},"end":{"line":204,"column":37}},{"start":{"line":203,"column":12},"end":{"line":204,"column":37}}],"line":203},"49":{"loc":{"start":{"line":205,"column":12},"end":{"line":207,"column":13}},"type":"if","locations":[{"start":{"line":205,"column":12},"end":{"line":207,"column":13}},{"start":{"line":205,"column":12},"end":{"line":207,"column":13}}],"line":205},"50":{"loc":{"start":{"line":205,"column":16},"end":{"line":205,"column":88}},"type":"binary-expr","locations":[{"start":{"line":205,"column":16},"end":{"line":205,"column":36}},{"start":{"line":205,"column":40},"end":{"line":205,"column":88}}],"line":205},"51":{"loc":{"start":{"line":216,"column":16},"end":{"line":218,"column":17}},"type":"if","locations":[{"start":{"line":216,"column":16},"end":{"line":218,"column":17}},{"start":{"line":216,"column":16},"end":{"line":218,"column":17}}],"line":216},"52":{"loc":{"start":{"line":216,"column":20},"end":{"line":216,"column":68}},"type":"binary-expr","locations":[{"start":{"line":216,"column":20},"end":{"line":216,"column":42}},{"start":{"line":216,"column":46},"end":{"line":216,"column":68}}],"line":216},"53":{"loc":{"start":{"line":219,"column":16},"end":{"line":221,"column":17}},"type":"if","locations":[{"start":{"line":219,"column":16},"end":{"line":221,"column":17}},{"start":{"line":219,"column":16},"end":{"line":221,"column":17}}],"line":219},"54":{"loc":{"start":{"line":219,"column":20},"end":{"line":219,"column":97}},"type":"binary-expr","locations":[{"start":{"line":219,"column":20},"end":{"line":219,"column":42}},{"start":{"line":219,"column":46},"end":{"line":219,"column":97}}],"line":219},"55":{"loc":{"start":{"line":222,"column":16},"end":{"line":225,"column":17}},"type":"if","locations":[{"start":{"line":222,"column":16},"end":{"line":225,"column":17}},{"start":{"line":222,"column":16},"end":{"line":225,"column":17}}],"line":222},"56":{"loc":{"start":{"line":237,"column":12},"end":{"line":238,"column":23}},"type":"if","locations":[{"start":{"line":237,"column":12},"end":{"line":238,"column":23}},{"start":{"line":237,"column":12},"end":{"line":238,"column":23}}],"line":237},"57":{"loc":{"start":{"line":257,"column":37},"end":{"line":259,"column":66}},"type":"cond-expr","locations":[{"start":{"line":259,"column":52},"end":{"line":259,"column":58}},{"start":{"line":259,"column":61},"end":{"line":259,"column":66}}],"line":257},"58":{"loc":{"start":{"line":257,"column":37},"end":{"line":259,"column":49}},"type":"binary-expr","locations":[{"start":{"line":257,"column":37},"end":{"line":259,"column":32}},{"start":{"line":259,"column":36},"end":{"line":259,"column":49}}],"line":257},"59":{"loc":{"start":{"line":257,"column":43},"end":{"line":259,"column":22}},"type":"cond-expr","locations":[{"start":{"line":257,"column":110},"end":{"line":257,"column":116}},{"start":{"line":257,"column":119},"end":{"line":259,"column":22}}],"line":257},"60":{"loc":{"start":{"line":257,"column":43},"end":{"line":257,"column":107}},"type":"binary-expr","locations":[{"start":{"line":257,"column":43},"end":{"line":257,"column":72}},{"start":{"line":257,"column":76},"end":{"line":257,"column":107}}],"line":257}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":40,"36":6,"37":34,"38":40,"39":40,"40":0,"41":0,"42":0,"43":0,"44":72,"45":34,"46":1,"47":2,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":2,"57":2,"58":6,"59":1,"60":142,"61":2,"62":1,"63":2,"64":2,"65":2,"66":2,"67":2,"68":2,"69":2,"70":1,"71":1,"72":0,"73":1,"74":4,"75":4,"76":4,"77":1,"78":1,"79":0,"80":1,"81":1,"82":1,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":18,"106":18,"107":0,"108":18,"109":0,"110":18,"111":18,"112":13,"113":13,"114":5,"115":2,"116":3,"117":1,"118":2,"119":1,"120":1,"121":1,"122":4,"123":4,"124":4,"125":4,"126":4,"127":0,"128":4,"129":4,"130":4,"131":2,"132":4,"133":4,"134":4,"135":4,"136":4,"137":4,"138":4,"139":2,"140":1,"141":1,"142":1,"143":1,"144":1,"145":0,"146":4,"147":1,"148":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":34,"8":40,"9":6,"10":34,"11":40,"12":0,"13":72,"14":2,"15":2,"16":6,"17":142,"18":2,"19":1,"20":2,"21":2,"22":1,"23":1,"24":4,"25":4,"26":4,"27":1,"28":1,"29":0,"30":1,"31":1,"32":0,"33":0,"34":18,"35":18,"36":4,"37":4,"38":4,"39":4,"40":2,"41":4,"42":4,"43":2,"44":1,"45":1,"46":1,"47":0},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[34,6],"28":[34,34],"29":[32,40],"30":[34,34],"31":[1,1,1],"32":[1,1],"33":[2,2],"34":[2,1],"35":[2,1],"36":[0,1],"37":[1,1],"38":[4,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,18],"49":[0,18],"50":[18,18],"51":[2,3],"52":[5,4],"53":[1,2],"54":[3,2],"55":[1,1],"56":[0,4],"57":[0,1],"58":[1,1],"59":[0,1],"60":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/actions.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/actions.ts"],"names":[],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport DefaultAPIHandler, { order } from './default';\nimport log from '../../../logger';\nimport { areArraysEquals, sleep } from '../../utils';\nimport { Asset, Assets, CalculatedChanges } from '../../../types';\n\nconst MAX_ACTION_DEPLOY_RETRY_ATTEMPTS = 60; // 60 * 2s => 2 min timeout\n\nexport type Action = {\n  id: string;\n  name: string;\n  created_at: string;\n  updated_at: string;\n  deployed?: boolean;\n  supported_triggers: {\n    id: string;\n    version: string;\n    status?: string;\n  }[];\n  code?: string;\n  dependencies?: [];\n  runtime?: string;\n  status?: string;\n  secrets?: {\n    name: string;\n    value: string;\n  }[];\n  all_changes_deployed?: boolean;\n  installed_integration_id?: string;\n  integration?: Object;\n};\n\n// With this schema, we can only validate property types but not valid properties on per type basis\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    required: ['name', 'supported_triggers', 'code'],\n    additionalProperties: false,\n    properties: {\n      code: { type: 'string', default: '' },\n      runtime: { type: 'string' },\n      dependencies: {\n        type: 'array',\n        items: {\n          type: 'object',\n          additionalProperties: false,\n          properties: {\n            name: { type: 'string' },\n            version: { type: 'string' },\n            registry_url: { type: 'string' },\n          },\n        },\n      },\n      secrets: {\n        type: 'array',\n        items: {\n          type: 'object',\n          properties: {\n            name: { type: 'string' },\n            value: { type: 'string' },\n            updated_at: { type: 'string', format: 'date-time' },\n          },\n        },\n      },\n      name: { type: 'string', default: '' },\n      supported_triggers: {\n        type: 'array',\n        items: {\n          type: 'object',\n          properties: {\n            id: { type: 'string', default: '' },\n            version: { type: 'string' },\n            url: { type: 'string' },\n          },\n        },\n      },\n      deployed: { type: 'boolean' },\n      status: { type: 'string' },\n    },\n  },\n};\n\nfunction isActionsDisabled(err) {\n  const errorBody = _.get(err, 'originalError.response.body') || {};\n\n  return err.statusCode === 403 && errorBody.errorCode === 'feature_not_enabled';\n}\n\nexport function isMarketplaceAction(action: Action): boolean {\n  return !!action.integration;\n}\n\nexport default class ActionHandler extends DefaultAPIHandler {\n  existing: Action[] | null;\n\n  constructor(options: DefaultAPIHandler) {\n    super({\n      ...options,\n      type: 'actions',\n      functions: {\n        create: (action: Action) => this.createAction(action),\n        delete: (action: Action) => this.deleteAction(action),\n      },\n      stripUpdateFields: ['deployed', 'status'],\n    });\n  }\n\n  async createAction(action: Action) {\n    // Strip the deployed flag\n    const addAction = { ...action };\n    delete addAction.deployed;\n    delete addAction.status;\n    const createdAction = await this.client.actions.create(addAction);\n\n    // Add the action id so we can deploy it later\n    action.id = createdAction.id;\n    return createdAction;\n  }\n\n  async deleteAction(action: Action) {\n    if (!this.client.actions || typeof this.client.actions.delete !== 'function') {\n      return [];\n    }\n    return this.client.actions.delete({ id: action.id, force: true });\n  }\n\n  objString(action) {\n    return super.objString({ id: action.id, name: action.name });\n  }\n\n  async deployActions(actions) {\n    await this.client.pool\n      .addEachTask({\n        data: actions || [],\n        generator: (action) =>\n          this.deployAction(action)\n            .then(() => {\n              log.info(`Deployed [${this.type}]: ${this.objString(action)}`);\n            })\n            .catch((err) => {\n              throw new Error(`Problem Deploying ${this.type} ${this.objString(action)}\\n${err}`);\n            }),\n      })\n      .promise();\n  }\n\n  async deployAction(action) {\n    try {\n      await this.client.actions.deploy({ id: action.id });\n    } catch (err) {\n      // Retry if pending build.\n      if (err.message && err.message.includes(\"must be in the 'built' state\")) {\n        if (!action.retry_count) {\n          log.info(`[${this.type}]: Waiting for build to complete ${this.objString(action)}`);\n          action.retry_count = 1;\n        }\n        if (action.retry_count > MAX_ACTION_DEPLOY_RETRY_ATTEMPTS) {\n          throw err;\n        }\n        await sleep(2000);\n        action.retry_count += 1;\n        await this.deployAction(action);\n      } else {\n        throw err;\n      }\n    }\n  }\n\n  async actionChanges(action, found) {\n    const actionChanges: Asset = {};\n\n    // if action is deployed, should compare against curren_version - calcDeployedVersionChanges method\n    if (!action.deployed) {\n      // name or secrets modifications are not supported yet\n      if (action.code !== found.code) {\n        actionChanges.code = action.code;\n      }\n\n      if (action.runtime !== found.runtime) {\n        actionChanges.runtime = action.runtime;\n      }\n\n      if (!areArraysEquals(action.dependencies, found.dependencies)) {\n        actionChanges.dependencies = action.dependencies;\n      }\n    }\n\n    if (!areArraysEquals(action.supported_triggers, found.supported_triggers)) {\n      actionChanges.supported_triggers = action.supported_triggers;\n    }\n\n    return actionChanges;\n  }\n\n  async getType(): Promise<Asset[] | null> {\n    if (this.existing) return this.existing;\n\n    if (!this.client.actions || typeof this.client.actions.getAll !== 'function') {\n      return [];\n    }\n    // Actions API does not support include_totals param like the other paginate API's.\n    // So we set it to false otherwise it will fail with \"Additional properties not allowed: include_totals\"\n    try {\n      const actions = await this.client.actions.getAll({ paginate: true });\n      this.existing = actions;\n      return actions;\n    } catch (err) {\n      if (err.statusCode === 404 || err.statusCode === 501) {\n        return null;\n      }\n\n      if (err.statusCode === 500 && err.message === 'An internal server error occurred') {\n        throw new Error(\n          \"Cannot process actions because the actions service is currently unavailable. Retrying may result in a successful operation. Alternatively, adding 'actions' to `AUTH0_EXCLUDED` configuration property will provide ability to skip until service is restored to actions service. This is not an issue with the Deploy CLI.\"\n        );\n      }\n\n      if (isActionsDisabled(err)) {\n        log.info('Skipping actions because it is not enabled.');\n        return null;\n      }\n\n      throw err;\n    }\n  }\n\n  @order('60')\n  async processChanges(assets: Assets) {\n    const { actions } = assets;\n\n    // Do nothing if not set\n    if (!actions) return;\n    const changes = await this.calcChanges(assets);\n\n    //Management of marketplace actions not currently supported, see ESD-23225.\n    const changesWithMarketplaceActionsFiltered: CalculatedChanges = (() => {\n      return {\n        ...changes,\n        del: changes.del.filter((action: Action) => !isMarketplaceAction(action)),\n      };\n    })();\n\n    await super.processChanges(assets, changesWithMarketplaceActionsFiltered);\n\n    const postProcessedActions = await (async () => {\n      this.existing = null; //Clear the cache\n      const actions = await this.getType();\n      return actions;\n    })();\n\n    // Deploy actions\n    const deployActions = [\n      ...changes.create\n        .filter((action) => action.deployed)\n        .map((actionWithoutId) => {\n          // Add IDs to just-created actions\n          const actionId = postProcessedActions?.find((postProcessedAction) => {\n            return postProcessedAction.name === actionWithoutId.name;\n          })?.id;\n\n          const actionWithId = {\n            ...actionWithoutId,\n            id: actionId,\n          };\n          return actionWithId;\n        })\n        .filter((action) => !!action.id),\n      ...changes.update.filter((action) => action.deployed),\n    ];\n\n    await this.deployActions(deployActions);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8af69b21204dad6edb1f06555db384305c21dfdf","contentHash":"6f3daf4f5bcff24e815f3eb6100d060d6d2288f9f6c7534e8f97820b98404998"},"/home/circleci/repo/src/tools/auth0/handlers/triggers.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/triggers.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":24}},"50":{"start":{"line":45,"column":17},"end":{"line":45,"column":51}},"51":{"start":{"line":46,"column":18},"end":{"line":46,"column":52}},"52":{"start":{"line":47,"column":20},"end":{"line":47,"column":63}},"53":{"start":{"line":48,"column":17},"end":{"line":48,"column":60}},"54":{"start":{"line":49,"column":16},"end":{"line":49,"column":38}},"55":{"start":{"line":50,"column":0},"end":{"line":65,"column":2}},"56":{"start":{"line":67,"column":22},"end":{"line":67,"column":84}},"57":{"start":{"line":68,"column":4},"end":{"line":68,"column":83}},"58":{"start":{"line":72,"column":8},"end":{"line":72,"column":91}},"59":{"start":{"line":75,"column":8},"end":{"line":112,"column":11}},"60":{"start":{"line":76,"column":12},"end":{"line":78,"column":13}},"61":{"start":{"line":77,"column":16},"end":{"line":77,"column":37}},"62":{"start":{"line":80,"column":12},"end":{"line":82,"column":13}},"63":{"start":{"line":81,"column":16},"end":{"line":81,"column":26}},"64":{"start":{"line":83,"column":36},"end":{"line":83,"column":38}},"65":{"start":{"line":84,"column":12},"end":{"line":111,"column":13}},"66":{"start":{"line":85,"column":28},"end":{"line":85,"column":70}},"67":{"start":{"line":86,"column":33},"end":{"line":86,"column":93}},"68":{"start":{"line":87,"column":16},"end":{"line":98,"column":17}},"69":{"start":{"line":87,"column":29},"end":{"line":87,"column":30}},"70":{"start":{"line":88,"column":38},"end":{"line":88,"column":49}},"71":{"start":{"line":89,"column":41},"end":{"line":91,"column":22}},"72":{"start":{"line":92,"column":20},"end":{"line":97,"column":21}},"73":{"start":{"line":93,"column":24},"end":{"line":96,"column":28}},"74":{"start":{"line":93,"column":80},"end":{"line":96,"column":25}},"75":{"start":{"line":99,"column":16},"end":{"line":99,"column":48}},"76":{"start":{"line":100,"column":16},"end":{"line":100,"column":37}},"77":{"start":{"line":103,"column":16},"end":{"line":105,"column":17}},"78":{"start":{"line":104,"column":20},"end":{"line":104,"column":30}},"79":{"start":{"line":106,"column":16},"end":{"line":109,"column":17}},"80":{"start":{"line":107,"column":20},"end":{"line":107,"column":95}},"81":{"start":{"line":108,"column":20},"end":{"line":108,"column":30}},"82":{"start":{"line":110,"column":16},"end":{"line":110,"column":26}},"83":{"start":{"line":115,"column":8},"end":{"line":134,"column":11}},"84":{"start":{"line":117,"column":33},"end":{"line":117,"column":39}},"85":{"start":{"line":119,"column":12},"end":{"line":120,"column":23}},"86":{"start":{"line":120,"column":16},"end":{"line":120,"column":23}},"87":{"start":{"line":121,"column":12},"end":{"line":121,"column":43}},"88":{"start":{"line":122,"column":12},"end":{"line":133,"column":17}},"89":{"start":{"line":122,"column":77},"end":{"line":133,"column":14}},"90":{"start":{"line":123,"column":33},"end":{"line":129,"column":19}},"91":{"start":{"line":123,"column":56},"end":{"line":129,"column":17}},"92":{"start":{"line":130,"column":16},"end":{"line":130,"column":100}},"93":{"start":{"line":131,"column":16},"end":{"line":131,"column":53}},"94":{"start":{"line":132,"column":16},"end":{"line":132,"column":34}},"95":{"start":{"line":137,"column":0},"end":{"line":139,"column":54}},"96":{"start":{"line":140,"column":0},"end":{"line":140,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"isActionsDisabled","decl":{"start":{"line":66,"column":9},"end":{"line":66,"column":26}},"loc":{"start":{"line":66,"column":32},"end":{"line":69,"column":1}},"line":66},"16":{"name":"(anonymous_16)","decl":{"start":{"line":71,"column":4},"end":{"line":71,"column":5}},"loc":{"start":{"line":71,"column":25},"end":{"line":73,"column":5}},"line":71},"17":{"name":"(anonymous_17)","decl":{"start":{"line":74,"column":4},"end":{"line":74,"column":5}},"loc":{"start":{"line":74,"column":14},"end":{"line":113,"column":5}},"line":74},"18":{"name":"(anonymous_18)","decl":{"start":{"line":75,"column":47},"end":{"line":75,"column":48}},"loc":{"start":{"line":75,"column":60},"end":{"line":112,"column":9}},"line":75},"19":{"name":"(anonymous_19)","decl":{"start":{"line":93,"column":66},"end":{"line":93,"column":67}},"loc":{"start":{"line":93,"column":80},"end":{"line":96,"column":25}},"line":93},"20":{"name":"(anonymous_20)","decl":{"start":{"line":114,"column":4},"end":{"line":114,"column":5}},"loc":{"start":{"line":114,"column":27},"end":{"line":135,"column":5}},"line":114},"21":{"name":"(anonymous_21)","decl":{"start":{"line":115,"column":47},"end":{"line":115,"column":48}},"loc":{"start":{"line":115,"column":60},"end":{"line":134,"column":9}},"line":115},"22":{"name":"(anonymous_22)","decl":{"start":{"line":122,"column":59},"end":{"line":122,"column":60}},"loc":{"start":{"line":122,"column":77},"end":{"line":133,"column":14}},"line":122},"23":{"name":"(anonymous_23)","decl":{"start":{"line":122,"column":109},"end":{"line":122,"column":110}},"loc":{"start":{"line":122,"column":122},"end":{"line":133,"column":13}},"line":122},"24":{"name":"(anonymous_24)","decl":{"start":{"line":123,"column":42},"end":{"line":123,"column":43}},"loc":{"start":{"line":123,"column":56},"end":{"line":129,"column":17}},"line":123}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":67,"column":22},"end":{"line":67,"column":84}},"type":"binary-expr","locations":[{"start":{"line":67,"column":22},"end":{"line":67,"column":78}},{"start":{"line":67,"column":82},"end":{"line":67,"column":84}}],"line":67},"35":{"loc":{"start":{"line":68,"column":11},"end":{"line":68,"column":82}},"type":"binary-expr","locations":[{"start":{"line":68,"column":11},"end":{"line":68,"column":33}},{"start":{"line":68,"column":37},"end":{"line":68,"column":82}}],"line":68},"36":{"loc":{"start":{"line":76,"column":12},"end":{"line":78,"column":13}},"type":"if","locations":[{"start":{"line":76,"column":12},"end":{"line":78,"column":13}},{"start":{"line":76,"column":12},"end":{"line":78,"column":13}}],"line":76},"37":{"loc":{"start":{"line":80,"column":12},"end":{"line":82,"column":13}},"type":"if","locations":[{"start":{"line":80,"column":12},"end":{"line":82,"column":13}},{"start":{"line":80,"column":12},"end":{"line":82,"column":13}}],"line":80},"38":{"loc":{"start":{"line":80,"column":16},"end":{"line":80,"column":96}},"type":"binary-expr","locations":[{"start":{"line":80,"column":16},"end":{"line":80,"column":36}},{"start":{"line":80,"column":40},"end":{"line":80,"column":96}}],"line":80},"39":{"loc":{"start":{"line":92,"column":20},"end":{"line":97,"column":21}},"type":"if","locations":[{"start":{"line":92,"column":20},"end":{"line":97,"column":21}},{"start":{"line":92,"column":20},"end":{"line":97,"column":21}}],"line":92},"40":{"loc":{"start":{"line":103,"column":16},"end":{"line":105,"column":17}},"type":"if","locations":[{"start":{"line":103,"column":16},"end":{"line":105,"column":17}},{"start":{"line":103,"column":16},"end":{"line":105,"column":17}}],"line":103},"41":{"loc":{"start":{"line":103,"column":20},"end":{"line":103,"column":68}},"type":"binary-expr","locations":[{"start":{"line":103,"column":20},"end":{"line":103,"column":42}},{"start":{"line":103,"column":46},"end":{"line":103,"column":68}}],"line":103},"42":{"loc":{"start":{"line":106,"column":16},"end":{"line":109,"column":17}},"type":"if","locations":[{"start":{"line":106,"column":16},"end":{"line":109,"column":17}},{"start":{"line":106,"column":16},"end":{"line":109,"column":17}}],"line":106},"43":{"loc":{"start":{"line":119,"column":12},"end":{"line":120,"column":23}},"type":"if","locations":[{"start":{"line":119,"column":12},"end":{"line":120,"column":23}},{"start":{"line":119,"column":12},"end":{"line":120,"column":23}}],"line":119}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":21,"36":0,"37":26,"38":21,"39":21,"40":0,"41":0,"42":0,"43":0,"44":47,"45":26,"46":1,"47":3,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":1,"58":138,"59":8,"60":8,"61":0,"62":8,"63":7,"64":1,"65":1,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":1,"78":0,"79":1,"80":1,"81":1,"82":0,"83":3,"84":3,"85":3,"86":0,"87":3,"88":3,"89":15,"90":15,"91":3,"92":15,"93":15,"94":15,"95":1,"96":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":26,"8":21,"9":0,"10":26,"11":21,"12":0,"13":47,"14":3,"15":1,"16":138,"17":8,"18":8,"19":0,"20":3,"21":3,"22":15,"23":15,"24":3},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[21,0],"28":[26,26],"29":[26,21],"30":[26,26],"31":[1,1,1],"32":[2,1],"33":[3,3],"34":[1,0],"35":[1,1],"36":[0,8],"37":[7,1],"38":[8,8],"39":[0,0],"40":[0,1],"41":[1,1],"42":[1,0],"43":[0,3]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/triggers.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/triggers.ts"],"names":[],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport DefaultHandler, { order } from './default';\nimport constants from '../../constants';\nimport log from '../../../logger';\nimport { Assets } from '../../../types';\nimport { sleep } from '../../utils';\n\nexport const schema = {\n  type: 'object',\n  items: {\n    type: 'object',\n    additionalProperties: true,\n    properties: {\n      trigger_id: {\n        type: 'object',\n        properties: {\n          action_name: { type: 'string', enum: constants.ACTIONS_TRIGGERS },\n          display_name: { type: 'string', default: '' },\n        },\n      },\n    },\n  },\n};\n\nfunction isActionsDisabled(err): boolean {\n  const errorBody = _.get(err, 'originalError.response.body') || {};\n\n  return err.statusCode === 403 && errorBody.errorCode === 'feature_not_enabled';\n}\n\nexport default class TriggersHandler extends DefaultHandler {\n  existing: {\n    [key: string]: {\n      action_name: string;\n      display_name: string;\n    };\n  };\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'triggers',\n      id: 'name',\n    });\n  }\n\n  async getType(): Promise<DefaultHandler['existing']> {\n    if (this.existing) {\n      return this.existing;\n    }\n\n    // in case client version does not support actions\n    if (!this.client.actions || typeof this.client.actions.getAllTriggers !== 'function') {\n      return [];\n    }\n\n    const triggerBindings = {};\n\n    try {\n      const res = await this.client.actions.getAllTriggers();\n      const triggers: string[] = _(res.triggers).map('id').uniq().value();\n\n      for (let i = 0; i < triggers.length; i++) {\n        const triggerId = triggers[i];\n        const { bindings } = await this.client.actions.getTriggerBindings({\n          trigger_id: triggerId,\n        });\n        if (bindings.length > 0) {\n          triggerBindings[triggerId] = bindings.map((binding) => ({\n            action_name: binding.action.name,\n            display_name: binding.display_name,\n          }));\n        }\n      }\n\n      this.existing = triggerBindings;\n      return this.existing;\n    } catch (err) {\n      if (err.statusCode === 404 || err.statusCode === 501) {\n        return [];\n      }\n\n      if (isActionsDisabled(err)) {\n        log.info('Skipping triggers because Actions is not enabled.');\n        return {};\n      }\n\n      throw err;\n    }\n  }\n\n  @order('80')\n  async processChanges(assets: Assets): Promise<void> {\n    // No API to delete or create triggers, we can only update.\n    const { triggers } = assets;\n\n    // Do nothing if not set\n    if (!triggers) return;\n\n    await sleep(2000); // Delay to allow newly-deployed actions to register in backend\n\n    await Promise.all(\n      Object.entries(triggers).map(async ([name, data]) => {\n        const bindings = data.map((binding) => ({\n          ref: {\n            type: 'action_name',\n            value: binding.action_name,\n          },\n          display_name: binding.display_name,\n        }));\n\n        await this.client.actions.updateTriggerBindings({ trigger_id: name }, { bindings });\n        this.didUpdate({ trigger_id: name });\n        this.updated += 1;\n      })\n    );\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"64a6ffd01c7916f4e800d4c8698d1c501508e9fd","contentHash":"35f01e7e5cb0ff06f31786ccd503fc282db6402cd64f4747d8f400c3453ca0e5"},"/home/circleci/repo/src/tools/auth0/handlers/organizations.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/organizations.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":24}},"50":{"start":{"line":45,"column":17},"end":{"line":45,"column":51}},"51":{"start":{"line":46,"column":18},"end":{"line":46,"column":52}},"52":{"start":{"line":47,"column":27},"end":{"line":47,"column":60}},"53":{"start":{"line":48,"column":17},"end":{"line":48,"column":60}},"54":{"start":{"line":49,"column":0},"end":{"line":71,"column":2}},"55":{"start":{"line":74,"column":8},"end":{"line":74,"column":93}},"56":{"start":{"line":77,"column":8},"end":{"line":79,"column":11}},"57":{"start":{"line":78,"column":12},"end":{"line":78,"column":67}},"58":{"start":{"line":82,"column":8},"end":{"line":103,"column":11}},"59":{"start":{"line":83,"column":12},"end":{"line":102,"column":13}},"60":{"start":{"line":85,"column":16},"end":{"line":97,"column":31}},"61":{"start":{"line":88,"column":41},"end":{"line":95,"column":22}},"62":{"start":{"line":90,"column":24},"end":{"line":90,"column":45}},"63":{"start":{"line":91,"column":24},"end":{"line":91,"column":42}},"64":{"start":{"line":94,"column":24},"end":{"line":94,"column":105}},"65":{"start":{"line":100,"column":16},"end":{"line":101,"column":59}},"66":{"start":{"line":101,"column":26},"end":{"line":101,"column":43}},"67":{"start":{"line":106,"column":8},"end":{"line":114,"column":11}},"68":{"start":{"line":107,"column":33},"end":{"line":107,"column":55}},"69":{"start":{"line":108,"column":12},"end":{"line":108,"column":44}},"70":{"start":{"line":109,"column":28},"end":{"line":109,"column":80}},"71":{"start":{"line":110,"column":12},"end":{"line":112,"column":13}},"72":{"start":{"line":111,"column":16},"end":{"line":111,"column":139}},"73":{"start":{"line":111,"column":64},"end":{"line":111,"column":136}},"74":{"start":{"line":113,"column":12},"end":{"line":113,"column":27}},"75":{"start":{"line":117,"column":8},"end":{"line":131,"column":11}},"76":{"start":{"line":118,"column":12},"end":{"line":130,"column":27}},"77":{"start":{"line":121,"column":37},"end":{"line":128,"column":18}},"78":{"start":{"line":123,"column":20},"end":{"line":123,"column":41}},"79":{"start":{"line":124,"column":20},"end":{"line":124,"column":38}},"80":{"start":{"line":127,"column":20},"end":{"line":127,"column":101}},"81":{"start":{"line":134,"column":8},"end":{"line":163,"column":11}},"82":{"start":{"line":135,"column":57},"end":{"line":135,"column":129}},"83":{"start":{"line":135,"column":99},"end":{"line":135,"column":128}},"84":{"start":{"line":136,"column":27},"end":{"line":136,"column":41}},"85":{"start":{"line":137,"column":36},"end":{"line":137,"column":39}},"86":{"start":{"line":138,"column":12},"end":{"line":138,"column":35}},"87":{"start":{"line":139,"column":12},"end":{"line":139,"column":28}},"88":{"start":{"line":140,"column":12},"end":{"line":140,"column":26}},"89":{"start":{"line":141,"column":12},"end":{"line":141,"column":64}},"90":{"start":{"line":142,"column":40},"end":{"line":142,"column":136}},"91":{"start":{"line":142,"column":74},"end":{"line":142,"column":135}},"92":{"start":{"line":142,"column":99},"end":{"line":142,"column":134}},"93":{"start":{"line":143,"column":37},"end":{"line":143,"column":133}},"94":{"start":{"line":143,"column":63},"end":{"line":143,"column":132}},"95":{"start":{"line":143,"column":96},"end":{"line":143,"column":131}},"96":{"start":{"line":144,"column":40},"end":{"line":145,"column":79}},"97":{"start":{"line":144,"column":66},"end":{"line":145,"column":78}},"98":{"start":{"line":144,"column":98},"end":{"line":145,"column":77}},"99":{"start":{"line":147,"column":12},"end":{"line":151,"column":17}},"100":{"start":{"line":147,"column":64},"end":{"line":151,"column":14}},"101":{"start":{"line":150,"column":16},"end":{"line":150,"column":124}},"102":{"start":{"line":152,"column":12},"end":{"line":156,"column":17}},"103":{"start":{"line":152,"column":61},"end":{"line":156,"column":14}},"104":{"start":{"line":155,"column":16},"end":{"line":155,"column":122}},"105":{"start":{"line":157,"column":12},"end":{"line":161,"column":17}},"106":{"start":{"line":157,"column":64},"end":{"line":161,"column":14}},"107":{"start":{"line":160,"column":16},"end":{"line":160,"column":124}},"108":{"start":{"line":162,"column":12},"end":{"line":162,"column":26}},"109":{"start":{"line":166,"column":8},"end":{"line":180,"column":11}},"110":{"start":{"line":167,"column":12},"end":{"line":179,"column":27}},"111":{"start":{"line":170,"column":37},"end":{"line":177,"column":18}},"112":{"start":{"line":172,"column":20},"end":{"line":172,"column":41}},"113":{"start":{"line":173,"column":20},"end":{"line":173,"column":38}},"114":{"start":{"line":176,"column":20},"end":{"line":176,"column":101}},"115":{"start":{"line":183,"column":8},"end":{"line":210,"column":11}},"116":{"start":{"line":184,"column":12},"end":{"line":186,"column":13}},"117":{"start":{"line":185,"column":16},"end":{"line":185,"column":37}},"118":{"start":{"line":187,"column":12},"end":{"line":189,"column":13}},"119":{"start":{"line":188,"column":16},"end":{"line":188,"column":26}},"120":{"start":{"line":190,"column":12},"end":{"line":209,"column":13}},"121":{"start":{"line":191,"column":38},"end":{"line":194,"column":18}},"122":{"start":{"line":195,"column":16},"end":{"line":200,"column":17}},"123":{"start":{"line":195,"column":33},"end":{"line":195,"column":34}},"124":{"start":{"line":196,"column":40},"end":{"line":198,"column":22}},"125":{"start":{"line":199,"column":20},"end":{"line":199,"column":67}},"126":{"start":{"line":201,"column":16},"end":{"line":201,"column":46}},"127":{"start":{"line":202,"column":16},"end":{"line":202,"column":37}},"128":{"start":{"line":205,"column":16},"end":{"line":207,"column":17}},"129":{"start":{"line":206,"column":20},"end":{"line":206,"column":30}},"130":{"start":{"line":208,"column":16},"end":{"line":208,"column":26}},"131":{"start":{"line":214,"column":8},"end":{"line":264,"column":11}},"132":{"start":{"line":215,"column":38},"end":{"line":215,"column":44}},"133":{"start":{"line":217,"column":12},"end":{"line":218,"column":23}},"134":{"start":{"line":218,"column":16},"end":{"line":218,"column":23}},"135":{"start":{"line":220,"column":29},"end":{"line":220,"column":49}},"136":{"start":{"line":221,"column":40},"end":{"line":224,"column":14}},"137":{"start":{"line":226,"column":12},"end":{"line":234,"column":15}},"138":{"start":{"line":227,"column":16},"end":{"line":233,"column":72}},"139":{"start":{"line":229,"column":37},"end":{"line":229,"column":47}},"140":{"start":{"line":230,"column":20},"end":{"line":230,"column":43}},"141":{"start":{"line":231,"column":20},"end":{"line":231,"column":152}},"142":{"start":{"line":231,"column":122},"end":{"line":231,"column":137}},"143":{"start":{"line":233,"column":44},"end":{"line":233,"column":70}},"144":{"start":{"line":235,"column":28},"end":{"line":241,"column":14}},"145":{"start":{"line":242,"column":12},"end":{"line":242,"column":177}},"146":{"start":{"line":243,"column":30},"end":{"line":247,"column":13}},"147":{"start":{"line":248,"column":12},"end":{"line":263,"column":17}},"148":{"start":{"line":248,"column":56},"end":{"line":263,"column":14}},"149":{"start":{"line":249,"column":16},"end":{"line":262,"column":17}},"150":{"start":{"line":251,"column":24},"end":{"line":251,"column":73}},"151":{"start":{"line":252,"column":24},"end":{"line":252,"column":30}},"152":{"start":{"line":254,"column":24},"end":{"line":254,"column":71}},"153":{"start":{"line":255,"column":24},"end":{"line":255,"column":30}},"154":{"start":{"line":257,"column":24},"end":{"line":258,"column":84}},"155":{"start":{"line":258,"column":28},"end":{"line":258,"column":84}},"156":{"start":{"line":259,"column":24},"end":{"line":259,"column":30}},"157":{"start":{"line":261,"column":24},"end":{"line":261,"column":30}},"158":{"start":{"line":267,"column":0},"end":{"line":269,"column":59}},"159":{"start":{"line":270,"column":0},"end":{"line":270,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"(anonymous_15)","decl":{"start":{"line":73,"column":4},"end":{"line":73,"column":5}},"loc":{"start":{"line":73,"column":24},"end":{"line":75,"column":5}},"line":73},"16":{"name":"(anonymous_16)","decl":{"start":{"line":76,"column":4},"end":{"line":76,"column":5}},"loc":{"start":{"line":76,"column":28},"end":{"line":80,"column":5}},"line":76},"17":{"name":"(anonymous_17)","decl":{"start":{"line":77,"column":47},"end":{"line":77,"column":48}},"loc":{"start":{"line":77,"column":60},"end":{"line":79,"column":9}},"line":77},"18":{"name":"(anonymous_18)","decl":{"start":{"line":81,"column":4},"end":{"line":81,"column":5}},"loc":{"start":{"line":81,"column":30},"end":{"line":104,"column":5}},"line":81},"19":{"name":"(anonymous_19)","decl":{"start":{"line":82,"column":47},"end":{"line":82,"column":48}},"loc":{"start":{"line":82,"column":60},"end":{"line":103,"column":9}},"line":82},"20":{"name":"(anonymous_20)","decl":{"start":{"line":88,"column":31},"end":{"line":88,"column":32}},"loc":{"start":{"line":88,"column":41},"end":{"line":95,"column":22}},"line":88},"21":{"name":"(anonymous_21)","decl":{"start":{"line":89,"column":30},"end":{"line":89,"column":31}},"loc":{"start":{"line":89,"column":36},"end":{"line":92,"column":21}},"line":89},"22":{"name":"(anonymous_22)","decl":{"start":{"line":93,"column":31},"end":{"line":93,"column":32}},"loc":{"start":{"line":93,"column":40},"end":{"line":95,"column":21}},"line":93},"23":{"name":"(anonymous_23)","decl":{"start":{"line":101,"column":19},"end":{"line":101,"column":20}},"loc":{"start":{"line":101,"column":26},"end":{"line":101,"column":43}},"line":101},"24":{"name":"(anonymous_24)","decl":{"start":{"line":105,"column":4},"end":{"line":105,"column":5}},"loc":{"start":{"line":105,"column":28},"end":{"line":115,"column":5}},"line":105},"25":{"name":"(anonymous_25)","decl":{"start":{"line":106,"column":47},"end":{"line":106,"column":48}},"loc":{"start":{"line":106,"column":60},"end":{"line":114,"column":9}},"line":106},"26":{"name":"(anonymous_26)","decl":{"start":{"line":111,"column":54},"end":{"line":111,"column":55}},"loc":{"start":{"line":111,"column":64},"end":{"line":111,"column":136}},"line":111},"27":{"name":"(anonymous_27)","decl":{"start":{"line":116,"column":4},"end":{"line":116,"column":5}},"loc":{"start":{"line":116,"column":33},"end":{"line":132,"column":5}},"line":116},"28":{"name":"(anonymous_28)","decl":{"start":{"line":117,"column":47},"end":{"line":117,"column":48}},"loc":{"start":{"line":117,"column":60},"end":{"line":131,"column":9}},"line":117},"29":{"name":"(anonymous_29)","decl":{"start":{"line":121,"column":27},"end":{"line":121,"column":28}},"loc":{"start":{"line":121,"column":37},"end":{"line":128,"column":18}},"line":121},"30":{"name":"(anonymous_30)","decl":{"start":{"line":122,"column":26},"end":{"line":122,"column":27}},"loc":{"start":{"line":122,"column":36},"end":{"line":125,"column":17}},"line":122},"31":{"name":"(anonymous_31)","decl":{"start":{"line":126,"column":27},"end":{"line":126,"column":28}},"loc":{"start":{"line":126,"column":36},"end":{"line":128,"column":17}},"line":126},"32":{"name":"(anonymous_32)","decl":{"start":{"line":133,"column":4},"end":{"line":133,"column":5}},"loc":{"start":{"line":133,"column":43},"end":{"line":164,"column":5}},"line":133},"33":{"name":"(anonymous_33)","decl":{"start":{"line":134,"column":47},"end":{"line":134,"column":48}},"loc":{"start":{"line":134,"column":60},"end":{"line":163,"column":9}},"line":134},"34":{"name":"(anonymous_34)","decl":{"start":{"line":135,"column":82},"end":{"line":135,"column":83}},"loc":{"start":{"line":135,"column":99},"end":{"line":135,"column":128}},"line":135},"35":{"name":"(anonymous_35)","decl":{"start":{"line":142,"column":67},"end":{"line":142,"column":68}},"loc":{"start":{"line":142,"column":74},"end":{"line":142,"column":135}},"line":142},"36":{"name":"(anonymous_36)","decl":{"start":{"line":142,"column":92},"end":{"line":142,"column":93}},"loc":{"start":{"line":142,"column":99},"end":{"line":142,"column":134}},"line":142},"37":{"name":"(anonymous_37)","decl":{"start":{"line":143,"column":56},"end":{"line":143,"column":57}},"loc":{"start":{"line":143,"column":63},"end":{"line":143,"column":132}},"line":143},"38":{"name":"(anonymous_38)","decl":{"start":{"line":143,"column":89},"end":{"line":143,"column":90}},"loc":{"start":{"line":143,"column":96},"end":{"line":143,"column":131}},"line":143},"39":{"name":"(anonymous_39)","decl":{"start":{"line":144,"column":59},"end":{"line":144,"column":60}},"loc":{"start":{"line":144,"column":66},"end":{"line":145,"column":78}},"line":144},"40":{"name":"(anonymous_40)","decl":{"start":{"line":144,"column":91},"end":{"line":144,"column":92}},"loc":{"start":{"line":144,"column":98},"end":{"line":145,"column":77}},"line":144},"41":{"name":"(anonymous_41)","decl":{"start":{"line":147,"column":54},"end":{"line":147,"column":55}},"loc":{"start":{"line":147,"column":64},"end":{"line":151,"column":14}},"line":147},"42":{"name":"(anonymous_42)","decl":{"start":{"line":149,"column":23},"end":{"line":149,"column":24}},"loc":{"start":{"line":149,"column":29},"end":{"line":151,"column":13}},"line":149},"43":{"name":"(anonymous_43)","decl":{"start":{"line":152,"column":51},"end":{"line":152,"column":52}},"loc":{"start":{"line":152,"column":61},"end":{"line":156,"column":14}},"line":152},"44":{"name":"(anonymous_44)","decl":{"start":{"line":154,"column":23},"end":{"line":154,"column":24}},"loc":{"start":{"line":154,"column":29},"end":{"line":156,"column":13}},"line":154},"45":{"name":"(anonymous_45)","decl":{"start":{"line":157,"column":54},"end":{"line":157,"column":55}},"loc":{"start":{"line":157,"column":64},"end":{"line":161,"column":14}},"line":157},"46":{"name":"(anonymous_46)","decl":{"start":{"line":159,"column":23},"end":{"line":159,"column":24}},"loc":{"start":{"line":159,"column":29},"end":{"line":161,"column":13}},"line":159},"47":{"name":"(anonymous_47)","decl":{"start":{"line":165,"column":4},"end":{"line":165,"column":5}},"loc":{"start":{"line":165,"column":39},"end":{"line":181,"column":5}},"line":165},"48":{"name":"(anonymous_48)","decl":{"start":{"line":166,"column":47},"end":{"line":166,"column":48}},"loc":{"start":{"line":166,"column":60},"end":{"line":180,"column":9}},"line":166},"49":{"name":"(anonymous_49)","decl":{"start":{"line":170,"column":27},"end":{"line":170,"column":28}},"loc":{"start":{"line":170,"column":37},"end":{"line":177,"column":18}},"line":170},"50":{"name":"(anonymous_50)","decl":{"start":{"line":171,"column":26},"end":{"line":171,"column":27}},"loc":{"start":{"line":171,"column":36},"end":{"line":174,"column":17}},"line":171},"51":{"name":"(anonymous_51)","decl":{"start":{"line":175,"column":27},"end":{"line":175,"column":28}},"loc":{"start":{"line":175,"column":36},"end":{"line":177,"column":17}},"line":175},"52":{"name":"(anonymous_52)","decl":{"start":{"line":182,"column":4},"end":{"line":182,"column":5}},"loc":{"start":{"line":182,"column":14},"end":{"line":211,"column":5}},"line":182},"53":{"name":"(anonymous_53)","decl":{"start":{"line":183,"column":47},"end":{"line":183,"column":48}},"loc":{"start":{"line":183,"column":60},"end":{"line":210,"column":9}},"line":183},"54":{"name":"(anonymous_54)","decl":{"start":{"line":213,"column":4},"end":{"line":213,"column":5}},"loc":{"start":{"line":213,"column":27},"end":{"line":265,"column":5}},"line":213},"55":{"name":"(anonymous_55)","decl":{"start":{"line":214,"column":47},"end":{"line":214,"column":48}},"loc":{"start":{"line":214,"column":60},"end":{"line":264,"column":9}},"line":214},"56":{"name":"(anonymous_56)","decl":{"start":{"line":226,"column":34},"end":{"line":226,"column":35}},"loc":{"start":{"line":226,"column":43},"end":{"line":234,"column":13}},"line":226},"57":{"name":"(anonymous_57)","decl":{"start":{"line":228,"column":25},"end":{"line":228,"column":26}},"loc":{"start":{"line":228,"column":41},"end":{"line":232,"column":17}},"line":228},"58":{"name":"(anonymous_58)","decl":{"start":{"line":231,"column":115},"end":{"line":231,"column":116}},"loc":{"start":{"line":231,"column":122},"end":{"line":231,"column":137}},"line":231},"59":{"name":"(anonymous_59)","decl":{"start":{"line":233,"column":28},"end":{"line":233,"column":29}},"loc":{"start":{"line":233,"column":44},"end":{"line":233,"column":70}},"line":233},"60":{"name":"(anonymous_60)","decl":{"start":{"line":248,"column":44},"end":{"line":248,"column":45}},"loc":{"start":{"line":248,"column":56},"end":{"line":263,"column":14}},"line":248},"61":{"name":"(anonymous_61)","decl":{"start":{"line":248,"column":88},"end":{"line":248,"column":89}},"loc":{"start":{"line":248,"column":101},"end":{"line":263,"column":13}},"line":248}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":83,"column":12},"end":{"line":102,"column":13}},"type":"if","locations":[{"start":{"line":83,"column":12},"end":{"line":102,"column":13}},{"start":{"line":83,"column":12},"end":{"line":102,"column":13}}],"line":83},"35":{"loc":{"start":{"line":83,"column":16},"end":{"line":84,"column":58}},"type":"binary-expr","locations":[{"start":{"line":83,"column":16},"end":{"line":83,"column":60}},{"start":{"line":84,"column":16},"end":{"line":84,"column":58}}],"line":83},"36":{"loc":{"start":{"line":87,"column":26},"end":{"line":87,"column":36}},"type":"binary-expr","locations":[{"start":{"line":87,"column":26},"end":{"line":87,"column":30}},{"start":{"line":87,"column":34},"end":{"line":87,"column":36}}],"line":87},"37":{"loc":{"start":{"line":110,"column":12},"end":{"line":112,"column":13}},"type":"if","locations":[{"start":{"line":110,"column":12},"end":{"line":112,"column":13}},{"start":{"line":110,"column":12},"end":{"line":112,"column":13}}],"line":110},"38":{"loc":{"start":{"line":110,"column":16},"end":{"line":110,"column":84}},"type":"binary-expr","locations":[{"start":{"line":110,"column":16},"end":{"line":110,"column":54}},{"start":{"line":110,"column":58},"end":{"line":110,"column":84}}],"line":110},"39":{"loc":{"start":{"line":120,"column":22},"end":{"line":120,"column":35}},"type":"binary-expr","locations":[{"start":{"line":120,"column":22},"end":{"line":120,"column":29}},{"start":{"line":120,"column":33},"end":{"line":120,"column":35}}],"line":120},"40":{"loc":{"start":{"line":144,"column":98},"end":{"line":145,"column":77}},"type":"binary-expr","locations":[{"start":{"line":144,"column":98},"end":{"line":144,"column":133}},{"start":{"line":145,"column":16},"end":{"line":145,"column":77}}],"line":144},"41":{"loc":{"start":{"line":169,"column":22},"end":{"line":169,"column":35}},"type":"binary-expr","locations":[{"start":{"line":169,"column":22},"end":{"line":169,"column":29}},{"start":{"line":169,"column":33},"end":{"line":169,"column":35}}],"line":169},"42":{"loc":{"start":{"line":184,"column":12},"end":{"line":186,"column":13}},"type":"if","locations":[{"start":{"line":184,"column":12},"end":{"line":186,"column":13}},{"start":{"line":184,"column":12},"end":{"line":186,"column":13}}],"line":184},"43":{"loc":{"start":{"line":187,"column":12},"end":{"line":189,"column":13}},"type":"if","locations":[{"start":{"line":187,"column":12},"end":{"line":189,"column":13}},{"start":{"line":187,"column":12},"end":{"line":189,"column":13}}],"line":187},"44":{"loc":{"start":{"line":187,"column":16},"end":{"line":187,"column":100}},"type":"binary-expr","locations":[{"start":{"line":187,"column":16},"end":{"line":187,"column":42}},{"start":{"line":187,"column":46},"end":{"line":187,"column":100}}],"line":187},"45":{"loc":{"start":{"line":205,"column":16},"end":{"line":207,"column":17}},"type":"if","locations":[{"start":{"line":205,"column":16},"end":{"line":207,"column":17}},{"start":{"line":205,"column":16},"end":{"line":207,"column":17}}],"line":205},"46":{"loc":{"start":{"line":205,"column":20},"end":{"line":205,"column":68}},"type":"binary-expr","locations":[{"start":{"line":205,"column":20},"end":{"line":205,"column":42}},{"start":{"line":205,"column":46},"end":{"line":205,"column":68}}],"line":205},"47":{"loc":{"start":{"line":217,"column":12},"end":{"line":218,"column":23}},"type":"if","locations":[{"start":{"line":217,"column":12},"end":{"line":218,"column":23}},{"start":{"line":217,"column":12},"end":{"line":218,"column":23}}],"line":217},"48":{"loc":{"start":{"line":227,"column":35},"end":{"line":227,"column":56}},"type":"binary-expr","locations":[{"start":{"line":227,"column":35},"end":{"line":227,"column":50}},{"start":{"line":227,"column":54},"end":{"line":227,"column":56}}],"line":227},"49":{"loc":{"start":{"line":231,"column":90},"end":{"line":231,"column":144}},"type":"binary-expr","locations":[{"start":{"line":231,"column":90},"end":{"line":231,"column":138}},{"start":{"line":231,"column":142},"end":{"line":231,"column":144}}],"line":231},"50":{"loc":{"start":{"line":249,"column":16},"end":{"line":262,"column":17}},"type":"switch","locations":[{"start":{"line":250,"column":20},"end":{"line":252,"column":30}},{"start":{"line":253,"column":20},"end":{"line":255,"column":30}},{"start":{"line":256,"column":20},"end":{"line":259,"column":30}},{"start":{"line":260,"column":20},"end":{"line":261,"column":30}}],"line":249},"51":{"loc":{"start":{"line":250,"column":25},"end":{"line":250,"column":60}},"type":"binary-expr","locations":[{"start":{"line":250,"column":25},"end":{"line":250,"column":35}},{"start":{"line":250,"column":39},"end":{"line":250,"column":60}}],"line":250},"52":{"loc":{"start":{"line":251,"column":55},"end":{"line":251,"column":71}},"type":"binary-expr","locations":[{"start":{"line":251,"column":55},"end":{"line":251,"column":65}},{"start":{"line":251,"column":69},"end":{"line":251,"column":71}}],"line":251},"53":{"loc":{"start":{"line":253,"column":25},"end":{"line":253,"column":66}},"type":"binary-expr","locations":[{"start":{"line":253,"column":25},"end":{"line":253,"column":38}},{"start":{"line":253,"column":42},"end":{"line":253,"column":66}}],"line":253},"54":{"loc":{"start":{"line":256,"column":25},"end":{"line":256,"column":66}},"type":"binary-expr","locations":[{"start":{"line":256,"column":25},"end":{"line":256,"column":38}},{"start":{"line":256,"column":42},"end":{"line":256,"column":66}}],"line":256},"55":{"loc":{"start":{"line":257,"column":24},"end":{"line":258,"column":84}},"type":"if","locations":[{"start":{"line":257,"column":24},"end":{"line":258,"column":84}},{"start":{"line":257,"column":24},"end":{"line":258,"column":84}}],"line":257}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":162,"36":24,"37":57,"38":162,"39":162,"40":0,"41":0,"42":0,"43":0,"44":218,"45":57,"46":1,"47":2,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":147,"56":1,"57":1,"58":1,"59":1,"60":1,"61":1,"62":1,"63":1,"64":0,"65":0,"66":0,"67":2,"68":2,"69":2,"70":2,"71":2,"72":1,"73":1,"74":2,"75":2,"76":2,"77":2,"78":2,"79":2,"80":0,"81":4,"82":4,"83":4,"84":4,"85":4,"86":4,"87":4,"88":4,"89":4,"90":4,"91":3,"92":3,"93":4,"94":3,"95":3,"96":4,"97":3,"98":3,"99":4,"100":1,"101":0,"102":4,"103":1,"104":0,"105":4,"106":1,"107":0,"108":4,"109":4,"110":4,"111":4,"112":4,"113":4,"114":0,"115":18,"116":18,"117":1,"118":17,"119":5,"120":12,"121":12,"122":9,"123":9,"124":97,"125":97,"126":9,"127":9,"128":3,"129":2,"130":1,"131":7,"132":7,"133":7,"134":1,"135":6,"136":6,"137":6,"138":6,"139":5,"140":5,"141":5,"142":8,"143":5,"144":6,"145":6,"146":6,"147":6,"148":18,"149":18,"150":1,"151":1,"152":2,"153":2,"154":4,"155":4,"156":4,"157":11,"158":1,"159":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":57,"8":162,"9":24,"10":57,"11":162,"12":0,"13":218,"14":2,"15":147,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":0,"23":0,"24":2,"25":2,"26":1,"27":2,"28":2,"29":2,"30":2,"31":0,"32":4,"33":4,"34":4,"35":3,"36":3,"37":3,"38":3,"39":3,"40":3,"41":1,"42":0,"43":1,"44":0,"45":1,"46":0,"47":4,"48":4,"49":4,"50":4,"51":0,"52":18,"53":18,"54":7,"55":7,"56":6,"57":5,"58":8,"59":5,"60":18,"61":18},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[138,24],"28":[57,57],"29":[56,162],"30":[57,57],"31":[1,1,1],"32":[1,1],"33":[2,2],"34":[1,0],"35":[1,1],"36":[1,0],"37":[1,1],"38":[2,2],"39":[2,0],"40":[3,2],"41":[4,0],"42":[1,17],"43":[5,12],"44":[17,12],"45":[2,1],"46":[3,2],"47":[1,6],"48":[6,2],"49":[5,1],"50":[1,2,4,11],"51":[18,6],"52":[1,0],"53":[17,6],"54":[15,6],"55":[4,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/organizations.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/organizations.ts"],"names":[],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport DefaultHandler, { order } from './default';\nimport { calculateChanges } from '../../calculateChanges';\nimport log from '../../../logger';\nimport { Asset, Assets, CalculatedChanges } from '../../../types';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      name: { type: 'string' },\n      display_name: { type: 'string' },\n      branding: { type: 'object' },\n      metadata: { type: 'object' },\n      connections: {\n        type: 'array',\n        items: {\n          type: 'object',\n          properties: {\n            connection_id: { type: 'string' },\n            assign_membership_on_login: { type: 'boolean' },\n          },\n        },\n      },\n    },\n    required: ['name'],\n  },\n};\n\nexport default class OrganizationsHandler extends DefaultHandler {\n  existing: Asset[];\n\n  constructor(config: DefaultHandler) {\n    super({\n      ...config,\n      type: 'organizations',\n      id: 'id',\n    });\n  }\n\n  async deleteOrganization(org): Promise<void> {\n    await this.client.organizations.delete({ id: org.id });\n  }\n\n  async deleteOrganizations(data: Asset[]): Promise<void> {\n    if (\n      this.config('AUTH0_ALLOW_DELETE') === 'true' ||\n      this.config('AUTH0_ALLOW_DELETE') === true\n    ) {\n      await this.client.pool\n        .addEachTask({\n          data: data || [],\n          generator: (item) =>\n            this.deleteOrganization(item)\n              .then(() => {\n                this.didDelete(item);\n                this.deleted += 1;\n              })\n              .catch((err) => {\n                throw new Error(`Problem deleting ${this.type} ${this.objString(item)}\\n${err}`);\n              }),\n        })\n        .promise();\n    } else {\n      log.warn(`Detected the following organizations should be deleted. Doing so may be destructive.\\nYou can enable deletes by setting 'AUTH0_ALLOW_DELETE' to true in the config\n      \\n${data.map((i) => this.objString(i)).join('\\n')}`);\n    }\n  }\n\n  async createOrganization(org): Promise<Asset> {\n    const organization = { ...org };\n    delete organization.connections;\n\n    const created = await this.client.organizations.create(organization);\n\n    if (typeof org.connections !== 'undefined' && org.connections.length > 0) {\n      await Promise.all(\n        org.connections.map((conn) =>\n          this.client.organizations.addEnabledConnection({ id: created.id }, conn)\n        )\n      );\n    }\n\n    return created;\n  }\n\n  async createOrganizations(creates: CalculatedChanges['create']) {\n    await this.client.pool\n      .addEachTask({\n        data: creates || [],\n        generator: (item) =>\n          this.createOrganization(item)\n            .then((data) => {\n              this.didCreate(data);\n              this.created += 1;\n            })\n            .catch((err) => {\n              throw new Error(`Problem creating ${this.type} ${this.objString(item)}\\n${err}`);\n            }),\n      })\n      .promise();\n  }\n\n  async updateOrganization(org, organizations) {\n    const { connections: existingConnections } = await organizations.find(\n      (orgToUpdate) => orgToUpdate.name === org.name\n    );\n\n    const params = { id: org.id };\n    const { connections } = org;\n\n    delete org.connections;\n    delete org.name;\n    delete org.id;\n\n    await this.client.organizations.update(params, org);\n\n    const connectionsToRemove = existingConnections.filter(\n      (c) => !connections.find((x) => x.connection_id === c.connection_id)\n    );\n    const connectionsToAdd = connections.filter(\n      (c) => !existingConnections.find((x) => x.connection_id === c.connection_id)\n    );\n    const connectionsToUpdate = connections.filter((c) =>\n      existingConnections.find(\n        (x) =>\n          x.connection_id === c.connection_id &&\n          x.assign_membership_on_login !== c.assign_membership_on_login\n      )\n    );\n\n    // Handle updates first\n    await Promise.all(\n      connectionsToUpdate.map((conn) =>\n        this.client.organizations\n          .updateEnabledConnection(\n            { connection_id: conn.connection_id, ...params },\n            { assign_membership_on_login: conn.assign_membership_on_login }\n          )\n          .catch(() => {\n            throw new Error(\n              `Problem updating Enabled Connection ${conn.connection_id} for organizations ${params.id}`\n            );\n          })\n      )\n    );\n\n    await Promise.all(\n      connectionsToAdd.map((conn) =>\n        this.client.organizations\n          .addEnabledConnection(params, _.omit(conn, 'connection'))\n          .catch(() => {\n            throw new Error(\n              `Problem adding Enabled Connection ${conn.connection_id} for organizations ${params.id}`\n            );\n          })\n      )\n    );\n\n    await Promise.all(\n      connectionsToRemove.map((conn) =>\n        this.client.organizations\n          .removeEnabledConnection({ connection_id: conn.connection_id, ...params })\n          .catch(() => {\n            throw new Error(\n              `Problem removing Enabled Connection ${conn.connection_id} for organizations ${params.id}`\n            );\n          })\n      )\n    );\n\n    return params;\n  }\n\n  async updateOrganizations(updates: CalculatedChanges['update'], orgs: Asset[]): Promise<void> {\n    await this.client.pool\n      .addEachTask({\n        data: updates || [],\n        generator: (item) =>\n          this.updateOrganization(item, orgs)\n            .then((data) => {\n              this.didUpdate(data);\n              this.updated += 1;\n            })\n            .catch((err) => {\n              throw new Error(`Problem updating ${this.type} ${this.objString(item)}\\n${err}`);\n            }),\n      })\n      .promise();\n  }\n\n  async getType(): Promise<Asset[]> {\n    if (this.existing) {\n      return this.existing;\n    }\n\n    if (!this.client.organizations || typeof this.client.organizations.getAll !== 'function') {\n      return [];\n    }\n\n    try {\n      const organizations = await this.client.organizations.getAll({\n        checkpoint: true,\n        include_totals: true,\n      });\n      for (let index = 0; index < organizations.length; index++) {\n        const connections = await this.client.organizations.connections.get({\n          id: organizations[index].id,\n        });\n        organizations[index].connections = connections;\n      }\n      this.existing = organizations;\n      return this.existing;\n    } catch (err) {\n      if (err.statusCode === 404 || err.statusCode === 501) {\n        return [];\n      }\n      throw err;\n    }\n  }\n\n  // Run after connections\n  @order('70')\n  async processChanges(assets: Assets): Promise<void> {\n    const { organizations } = assets;\n    // Do nothing if not set\n    if (!organizations) return;\n    // Gets organizations from destination tenant\n    const existing = await this.getType();\n    const existingConnections = await this.client.connections.getAll({\n      paginate: true,\n      include_totals: true,\n    });\n\n    // We need to get the connection ids for the names configured so we can link them together\n    organizations.forEach((org) => {\n      org.connections = (org.connections || [])\n        .map((connection) => {\n          const { name } = connection;\n          delete connection.name;\n\n          return {\n            ...connection,\n            connection_id: (existingConnections.find((c) => c.name === name) || {}).id,\n          };\n        })\n        .filter((connection) => !!connection.connection_id);\n    });\n\n    const changes = calculateChanges({\n      handler: this,\n      assets: organizations,\n      existing,\n      identifiers: this.identifiers,\n      allowDelete: !!this.config('AUTH0_ALLOW_DELETE'),\n    });\n\n    log.debug(\n      `Start processChanges for organizations [delete:${changes.del.length}] [update:${changes.update.length}], [create:${changes.create.length}]`\n    );\n\n    const myChanges = [\n      { del: changes.del },\n      { create: changes.create },\n      { update: changes.update },\n    ];\n\n    await Promise.all(\n      myChanges.map(async (change) => {\n        switch (true) {\n          case change.del && change.del.length > 0:\n            await this.deleteOrganizations(change.del || []);\n            break;\n          case change.create && change.create.length > 0:\n            await this.createOrganizations(changes.create);\n            break;\n          case change.update && change.update.length > 0:\n            if (change.update) await this.updateOrganizations(change.update, existing);\n            break;\n          default:\n            break;\n        }\n      })\n    );\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"60d713d165555fc950b28b4d659a3ec64f07fc9a","contentHash":"e707dc0dcd3d043066c5a016f5170f624adb0d5b42e6a422b4b04d49ef85b611"},"/home/circleci/repo/src/tools/auth0/handlers/attackProtection.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/attackProtection.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":0},"end":{"line":31,"column":2}},"18":{"start":{"line":34,"column":8},"end":{"line":34,"column":86}},"19":{"start":{"line":37,"column":29},"end":{"line":56,"column":12}},"20":{"start":{"line":39,"column":22},"end":{"line":39,"column":24}},"21":{"start":{"line":40,"column":12},"end":{"line":44,"column":13}},"22":{"start":{"line":41,"column":16},"end":{"line":43,"column":18}},"23":{"start":{"line":45,"column":12},"end":{"line":49,"column":13}},"24":{"start":{"line":46,"column":16},"end":{"line":48,"column":18}},"25":{"start":{"line":50,"column":12},"end":{"line":54,"column":13}},"26":{"start":{"line":51,"column":16},"end":{"line":53,"column":18}},"27":{"start":{"line":55,"column":12},"end":{"line":55,"column":23}},"28":{"start":{"line":57,"column":8},"end":{"line":57,"column":45}},"29":{"start":{"line":60,"column":8},"end":{"line":75,"column":11}},"30":{"start":{"line":61,"column":12},"end":{"line":63,"column":13}},"31":{"start":{"line":62,"column":16},"end":{"line":62,"column":37}},"32":{"start":{"line":64,"column":94},"end":{"line":68,"column":14}},"33":{"start":{"line":69,"column":12},"end":{"line":73,"column":14}},"34":{"start":{"line":74,"column":12},"end":{"line":74,"column":33}},"35":{"start":{"line":78,"column":8},"end":{"line":90,"column":11}},"36":{"start":{"line":79,"column":41},"end":{"line":79,"column":47}},"37":{"start":{"line":80,"column":12},"end":{"line":82,"column":13}},"38":{"start":{"line":81,"column":16},"end":{"line":81,"column":23}},"39":{"start":{"line":83,"column":12},"end":{"line":87,"column":15}},"40":{"start":{"line":88,"column":12},"end":{"line":88,"column":30}},"41":{"start":{"line":89,"column":12},"end":{"line":89,"column":45}},"42":{"start":{"line":93,"column":0},"end":{"line":93,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":33,"column":4},"end":{"line":33,"column":5}},"loc":{"start":{"line":33,"column":24},"end":{"line":35,"column":5}},"line":33},"9":{"name":"(anonymous_9)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":20},"end":{"line":58,"column":5}},"line":36},"10":{"name":"(anonymous_10)","decl":{"start":{"line":37,"column":30},"end":{"line":37,"column":31}},"loc":{"start":{"line":37,"column":36},"end":{"line":56,"column":9}},"line":37},"11":{"name":"(anonymous_11)","decl":{"start":{"line":59,"column":4},"end":{"line":59,"column":5}},"loc":{"start":{"line":59,"column":14},"end":{"line":76,"column":5}},"line":59},"12":{"name":"(anonymous_12)","decl":{"start":{"line":60,"column":47},"end":{"line":60,"column":48}},"loc":{"start":{"line":60,"column":60},"end":{"line":75,"column":9}},"line":60},"13":{"name":"(anonymous_13)","decl":{"start":{"line":77,"column":4},"end":{"line":77,"column":5}},"loc":{"start":{"line":77,"column":27},"end":{"line":91,"column":5}},"line":77},"14":{"name":"(anonymous_14)","decl":{"start":{"line":78,"column":47},"end":{"line":78,"column":48}},"loc":{"start":{"line":78,"column":60},"end":{"line":90,"column":9}},"line":78}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":40,"column":12},"end":{"line":44,"column":13}},"type":"if","locations":[{"start":{"line":40,"column":12},"end":{"line":44,"column":13}},{"start":{"line":40,"column":12},"end":{"line":44,"column":13}}],"line":40},"9":{"loc":{"start":{"line":40,"column":16},"end":{"line":40,"column":101}},"type":"cond-expr","locations":[{"start":{"line":40,"column":82},"end":{"line":40,"column":88}},{"start":{"line":40,"column":91},"end":{"line":40,"column":101}}],"line":40},"10":{"loc":{"start":{"line":40,"column":16},"end":{"line":40,"column":79}},"type":"binary-expr","locations":[{"start":{"line":40,"column":16},"end":{"line":40,"column":62}},{"start":{"line":40,"column":66},"end":{"line":40,"column":79}}],"line":40},"11":{"loc":{"start":{"line":45,"column":12},"end":{"line":49,"column":13}},"type":"if","locations":[{"start":{"line":45,"column":12},"end":{"line":49,"column":13}},{"start":{"line":45,"column":12},"end":{"line":49,"column":13}}],"line":45},"12":{"loc":{"start":{"line":45,"column":16},"end":{"line":45,"column":96}},"type":"cond-expr","locations":[{"start":{"line":45,"column":77},"end":{"line":45,"column":83}},{"start":{"line":45,"column":86},"end":{"line":45,"column":96}}],"line":45},"13":{"loc":{"start":{"line":45,"column":16},"end":{"line":45,"column":74}},"type":"binary-expr","locations":[{"start":{"line":45,"column":16},"end":{"line":45,"column":57}},{"start":{"line":45,"column":61},"end":{"line":45,"column":74}}],"line":45},"14":{"loc":{"start":{"line":50,"column":12},"end":{"line":54,"column":13}},"type":"if","locations":[{"start":{"line":50,"column":12},"end":{"line":54,"column":13}},{"start":{"line":50,"column":12},"end":{"line":54,"column":13}}],"line":50},"15":{"loc":{"start":{"line":50,"column":16},"end":{"line":50,"column":98}},"type":"cond-expr","locations":[{"start":{"line":50,"column":79},"end":{"line":50,"column":85}},{"start":{"line":50,"column":88},"end":{"line":50,"column":98}}],"line":50},"16":{"loc":{"start":{"line":50,"column":16},"end":{"line":50,"column":76}},"type":"binary-expr","locations":[{"start":{"line":50,"column":16},"end":{"line":50,"column":59}},{"start":{"line":50,"column":63},"end":{"line":50,"column":76}}],"line":50},"17":{"loc":{"start":{"line":61,"column":12},"end":{"line":63,"column":13}},"type":"if","locations":[{"start":{"line":61,"column":12},"end":{"line":63,"column":13}},{"start":{"line":61,"column":12},"end":{"line":63,"column":13}}],"line":61},"18":{"loc":{"start":{"line":80,"column":12},"end":{"line":82,"column":13}},"type":"if","locations":[{"start":{"line":80,"column":12},"end":{"line":82,"column":13}},{"start":{"line":80,"column":12},"end":{"line":82,"column":13}}],"line":80},"19":{"loc":{"start":{"line":80,"column":16},"end":{"line":80,"column":74}},"type":"binary-expr","locations":[{"start":{"line":80,"column":16},"end":{"line":80,"column":33}},{"start":{"line":80,"column":37},"end":{"line":80,"column":74}}],"line":80}},"s":{"0":1,"1":5,"2":0,"3":6,"4":5,"5":5,"6":0,"7":0,"8":0,"9":0,"10":11,"11":6,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":132,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":5,"30":5,"31":0,"32":5,"33":5,"34":5,"35":1,"36":1,"37":1,"38":0,"39":1,"40":1,"41":1,"42":1},"f":{"0":6,"1":5,"2":0,"3":6,"4":5,"5":0,"6":11,"7":1,"8":132,"9":1,"10":1,"11":5,"12":5,"13":1,"14":1},"b":{"0":[1,1,1],"1":[5,0],"2":[6,6],"3":[6,5],"4":[6,6],"5":[1,1,1],"6":[1,0],"7":[1,1],"8":[1,0],"9":[0,1],"10":[1,1],"11":[1,0],"12":[0,1],"13":[1,1],"14":[1,0],"15":[0,1],"16":[1,1],"17":[0,5],"18":[0,1],"19":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/attackProtection.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/attackProtection.ts"],"names":[],"mappings":"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","sourcesContent":["import DefaultAPIHandler from './default';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'object',\n  properties: {\n    breachedPasswordDetection: {\n      type: 'object',\n    },\n    bruteForceProtection: {\n      type: 'object',\n    },\n    suspiciousIpThrottling: {\n      type: 'object',\n    },\n  },\n  additionalProperties: false,\n};\n\nexport default class AttackProtectionHandler extends DefaultAPIHandler {\n  existing: {\n    breachedPasswordDetection: any;\n    bruteForceProtection: any;\n    suspiciousIpThrottling: any;\n  } | null;\n\n  constructor(config: DefaultAPIHandler) {\n    super({\n      ...config,\n      type: 'attackProtection',\n    });\n  }\n\n  objString(item: Asset): string {\n    const objectString = (() => {\n      let obj = {};\n      if (item.breachedPasswordDetection?.enabled) {\n        obj['breached-password-protection'] = {\n          enabled: item.breachedPasswordDetection.enabled,\n        };\n      }\n      if (item.bruteForceProtection?.enabled) {\n        obj['brute-force-protection'] = {\n          enabled: item.bruteForceProtection.enabled,\n        };\n      }\n      if (item.suspiciousIpThrottling?.enabled) {\n        obj['suspicious-ip-throttling'] = {\n          enabled: item.suspiciousIpThrottling.enabled,\n        };\n      }\n      return obj;\n    })();\n\n    return super.objString(objectString);\n  }\n\n  async getType(): Promise<Asset> {\n    if (this.existing) {\n      return this.existing;\n    }\n\n    const [breachedPasswordDetection, bruteForceProtection, suspiciousIpThrottling] =\n      await Promise.all([\n        this.client.attackProtection.getBreachedPasswordDetectionConfig(),\n        this.client.attackProtection.getBruteForceConfig(),\n        this.client.attackProtection.getSuspiciousIpThrottlingConfig(),\n      ]);\n\n    this.existing = {\n      breachedPasswordDetection,\n      bruteForceProtection,\n      suspiciousIpThrottling,\n    };\n\n    return this.existing;\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    const { attackProtection } = assets;\n\n    if (!attackProtection || !Object.keys(attackProtection).length) {\n      return;\n    }\n\n    Promise.all([\n      this.client.attackProtection.updateBreachedPasswordDetectionConfig(\n        {},\n        attackProtection.breachedPasswordDetection\n      ),\n      this.client.attackProtection.updateSuspiciousIpThrottlingConfig(\n        {},\n        attackProtection.suspiciousIpThrottling\n      ),\n      this.client.attackProtection.updateBruteForceConfig(\n        {},\n        attackProtection.bruteForceProtection\n      ),\n    ]);\n\n    this.updated += 1;\n    this.didUpdate(attackProtection);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"659c64b0c6ef924a8e1f63aba860eae5d367436d","contentHash":"e57387c80e8812a69c676d642e807a6d8aaa34677be5368688aca2af33a2a023"},"/home/circleci/repo/src/tools/auth0/handlers/logStreams.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/logStreams.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":0},"end":{"line":15,"column":24}},"16":{"start":{"line":16,"column":18},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":0},"end":{"line":36,"column":2}},"18":{"start":{"line":39,"column":8},"end":{"line":43,"column":18}},"19":{"start":{"line":46,"column":8},"end":{"line":46,"column":42}},"20":{"start":{"line":49,"column":8},"end":{"line":60,"column":11}},"21":{"start":{"line":50,"column":12},"end":{"line":52,"column":13}},"22":{"start":{"line":51,"column":16},"end":{"line":51,"column":37}},"23":{"start":{"line":53,"column":31},"end":{"line":57,"column":15}},"24":{"start":{"line":53,"column":109},"end":{"line":57,"column":14}},"25":{"start":{"line":54,"column":16},"end":{"line":55,"column":44}},"26":{"start":{"line":55,"column":20},"end":{"line":55,"column":44}},"27":{"start":{"line":56,"column":16},"end":{"line":56,"column":33}},"28":{"start":{"line":58,"column":12},"end":{"line":58,"column":39}},"29":{"start":{"line":59,"column":12},"end":{"line":59,"column":30}},"30":{"start":{"line":63,"column":23},"end":{"line":65,"column":10}},"31":{"start":{"line":64,"column":41},"end":{"line":64,"column":61}},"32":{"start":{"line":66,"column":8},"end":{"line":85,"column":11}},"33":{"start":{"line":67,"column":35},"end":{"line":67,"column":41}},"34":{"start":{"line":68,"column":12},"end":{"line":69,"column":23}},"35":{"start":{"line":69,"column":16},"end":{"line":69,"column":23}},"36":{"start":{"line":70,"column":28},"end":{"line":83,"column":14}},"37":{"start":{"line":71,"column":16},"end":{"line":82,"column":26}},"38":{"start":{"line":72,"column":24},"end":{"line":74,"column":25}},"39":{"start":{"line":73,"column":28},"end":{"line":73,"column":47}},"40":{"start":{"line":75,"column":24},"end":{"line":80,"column":25}},"41":{"start":{"line":79,"column":28},"end":{"line":79,"column":49}},"42":{"start":{"line":81,"column":24},"end":{"line":81,"column":38}},"43":{"start":{"line":84,"column":12},"end":{"line":84,"column":68}},"44":{"start":{"line":88,"column":0},"end":{"line":88,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":38,"column":4},"end":{"line":38,"column":5}},"loc":{"start":{"line":38,"column":24},"end":{"line":44,"column":5}},"line":38},"9":{"name":"(anonymous_9)","decl":{"start":{"line":45,"column":4},"end":{"line":45,"column":5}},"loc":{"start":{"line":45,"column":20},"end":{"line":47,"column":5}},"line":45},"10":{"name":"(anonymous_10)","decl":{"start":{"line":48,"column":4},"end":{"line":48,"column":5}},"loc":{"start":{"line":48,"column":14},"end":{"line":61,"column":5}},"line":48},"11":{"name":"(anonymous_11)","decl":{"start":{"line":49,"column":47},"end":{"line":49,"column":48}},"loc":{"start":{"line":49,"column":60},"end":{"line":60,"column":9}},"line":49},"12":{"name":"(anonymous_12)","decl":{"start":{"line":53,"column":93},"end":{"line":53,"column":94}},"loc":{"start":{"line":53,"column":109},"end":{"line":57,"column":14}},"line":53},"13":{"name":"(anonymous_13)","decl":{"start":{"line":53,"column":124},"end":{"line":53,"column":125}},"loc":{"start":{"line":53,"column":139},"end":{"line":57,"column":13}},"line":53},"14":{"name":"(anonymous_14)","decl":{"start":{"line":62,"column":4},"end":{"line":62,"column":5}},"loc":{"start":{"line":62,"column":27},"end":{"line":86,"column":5}},"line":62},"15":{"name":"(anonymous_15)","decl":{"start":{"line":64,"column":35},"end":{"line":64,"column":36}},"loc":{"start":{"line":64,"column":41},"end":{"line":64,"column":61}},"line":64},"16":{"name":"(anonymous_16)","decl":{"start":{"line":66,"column":47},"end":{"line":66,"column":48}},"loc":{"start":{"line":66,"column":60},"end":{"line":85,"column":9}},"line":66},"17":{"name":"(anonymous_17)","decl":{"start":{"line":70,"column":64},"end":{"line":70,"column":65}},"loc":{"start":{"line":70,"column":77},"end":{"line":83,"column":13}},"line":70},"18":{"name":"(anonymous_18)","decl":{"start":{"line":71,"column":94},"end":{"line":71,"column":95}},"loc":{"start":{"line":71,"column":106},"end":{"line":82,"column":21}},"line":71}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":50,"column":12},"end":{"line":52,"column":13}},"type":"if","locations":[{"start":{"line":50,"column":12},"end":{"line":52,"column":13}},{"start":{"line":50,"column":12},"end":{"line":52,"column":13}}],"line":50},"9":{"loc":{"start":{"line":54,"column":16},"end":{"line":55,"column":44}},"type":"if","locations":[{"start":{"line":54,"column":16},"end":{"line":55,"column":44}},{"start":{"line":54,"column":16},"end":{"line":55,"column":44}}],"line":54},"10":{"loc":{"start":{"line":68,"column":12},"end":{"line":69,"column":23}},"type":"if","locations":[{"start":{"line":68,"column":12},"end":{"line":69,"column":23}},{"start":{"line":68,"column":12},"end":{"line":69,"column":23}}],"line":68},"11":{"loc":{"start":{"line":72,"column":24},"end":{"line":74,"column":25}},"type":"if","locations":[{"start":{"line":72,"column":24},"end":{"line":74,"column":25}},{"start":{"line":72,"column":24},"end":{"line":74,"column":25}}],"line":72},"12":{"loc":{"start":{"line":72,"column":28},"end":{"line":72,"column":88}},"type":"binary-expr","locations":[{"start":{"line":72,"column":28},"end":{"line":72,"column":57}},{"start":{"line":72,"column":61},"end":{"line":72,"column":88}}],"line":72},"13":{"loc":{"start":{"line":75,"column":24},"end":{"line":80,"column":25}},"type":"if","locations":[{"start":{"line":75,"column":24},"end":{"line":80,"column":25}},{"start":{"line":75,"column":24},"end":{"line":80,"column":25}}],"line":75}},"s":{"0":1,"1":8,"2":0,"3":7,"4":8,"5":8,"6":0,"7":0,"8":0,"9":0,"10":15,"11":7,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":132,"19":4,"20":6,"21":6,"22":0,"23":6,"24":6,"25":8,"26":1,"27":8,"28":6,"29":6,"30":1,"31":1,"32":1,"33":1,"34":1,"35":0,"36":1,"37":1,"38":4,"39":0,"40":4,"41":0,"42":4,"43":1,"44":1},"f":{"0":7,"1":8,"2":0,"3":7,"4":8,"5":0,"6":15,"7":1,"8":132,"9":4,"10":6,"11":6,"12":6,"13":8,"14":1,"15":1,"16":1,"17":1,"18":4},"b":{"0":[1,1,1],"1":[8,0],"2":[7,7],"3":[7,8],"4":[7,7],"5":[1,1,1],"6":[1,0],"7":[1,1],"8":[0,6],"9":[1,7],"10":[0,1],"11":[0,4],"12":[4,4],"13":[0,4]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/logStreams.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/logStreams.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,wDAA0C;AAG7B,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,OAAO;IACb,KAAK,EAAE;QACL,IAAI,EAAE,QAAQ;QACd,UAAU,EAAE;YACV,EAAE,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE;YACtB,IAAI,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE;YACxB,IAAI,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE;YACxB,MAAM,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,WAAW,CAAC,EAAE;YACnE,IAAI,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE;YACxB,OAAO,EAAE;gBACP,IAAI,EAAE,OAAO;gBACb,KAAK,EAAE;oBACL,IAAI,EAAE,QAAQ;iBACf;aACF;SACF;QACD,QAAQ,EAAE,CAAC,MAAM,CAAC;KACnB;CACF,CAAC;AAYF,MAAqB,iBAAkB,SAAQ,iBAAiB;IAG9D,YAAY,MAAyB;QACnC,KAAK,iCACA,MAAM,KACT,IAAI,EAAE,YAAY,EAClB,iBAAiB,EAAE,CAAC,MAAM,CAAC,EAC3B,iBAAiB,EAAE,CAAC,QAAQ,EAAE,4BAA4B,CAAC,EAC3D,0BAA0B,EAAE;gBAC1B,wBAAwB;gBACxB,kBAAkB;gBAClB,oBAAoB;aACrB,IACD,CAAC;IACL,CAAC;IAED,SAAS,CAAC,IAAW;QACnB,OAAO,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACpC,CAAC;IAEK,OAAO;;YACX,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;YAED,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE,EAAE,CAC9F,UAAU,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,EAAE;gBAC3B,IAAI,SAAS,CAAC,MAAM,KAAK,WAAW;oBAAE,OAAO,SAAS,CAAC,MAAM,CAAC;gBAC9D,OAAO,SAAS,CAAC;YACnB,CAAC,CAAC,CACH,CAAC;YAEF,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC;YAE3B,OAAO,UAAU,CAAC;QACpB,CAAC;KAAA;IAEK,cAAc,CAAC,MAAc;;;;;YACjC,MAAM,EAAE,UAAU,EAAE,GAAG,MAAM,CAAC;YAE9B,IAAI,CAAC,UAAU;gBAAE,OAAO;YAExB,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,EAAE;gBAC9D,uCACK,OAAO,KACV,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,MAAiB,EAAE,EAAE;wBAC/C,IAAI,MAAM,CAAC,IAAI,KAAK,aAAa,IAAI,MAAM,CAAC,IAAI,KAAK,WAAW,EAAE;4BAChE,OAAO,MAAM,CAAC,IAAI,CAAC;yBACpB;wBACD,IAAI,MAAM,CAAC,MAAM,KAAK,WAAW,EAAE;4BACjC,kGAAkG;4BAClG,yFAAyF;4BACzF,oEAAoE;4BACpE,OAAO,MAAM,CAAC,MAAM,CAAC;yBACtB;wBACD,OAAO,MAAM,CAAC;oBAChB,CAAC,CAAC,IACF;YACJ,CAAC,CAAC,CAAC;YAEH,MAAM,OAAM,cAAc,YAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QAC9C,CAAC;KAAA;CACF;AA/DD,oCA+DC","sourcesContent":["import DefaultAPIHandler from './default';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      id: { type: 'string' },\n      type: { type: 'string' },\n      name: { type: 'string' },\n      status: { type: 'string', enum: ['active', 'paused', 'suspended'] },\n      sink: { type: 'object' },\n      filters: {\n        type: 'array',\n        items: {\n          type: 'object',\n        },\n      },\n    },\n    required: ['name'],\n  },\n};\n\nexport type LogStream = {\n  type: 'eventbridge' | 'eventgrid' | 'datadog' | 'http' | 'splunk' | 'sumo';\n  name: string;\n  id: string;\n  status?: 'active' | 'suspended' | 'paused';\n  sink?: {\n    [key: string]: string | boolean;\n  };\n};\n\nexport default class LogStreamsHandler extends DefaultAPIHandler {\n  existing: Asset[] | null;\n\n  constructor(config: DefaultAPIHandler) {\n    super({\n      ...config,\n      type: 'logStreams',\n      stripUpdateFields: ['type'],\n      stripCreateFields: ['status', 'sink.awsPartnerEventSource'],\n      sensitiveFieldsToObfuscate: [\n        'sink.httpAuthorization',\n        'sink.splunkToken',\n        'sink.datadogApiKey',\n      ],\n    });\n  }\n\n  objString(item: Asset): string {\n    return super.objString(item.name);\n  }\n\n  async getType(): Promise<Asset> {\n    if (this.existing) {\n      return this.existing;\n    }\n\n    const logStreams = await this.client.logStreams.getAll({ paginate: false }).then((logStreams) =>\n      logStreams.map((logStream) => {\n        if (logStream.status === 'suspended') delete logStream.status;\n        return logStream;\n      })\n    );\n\n    this.existing = logStreams;\n\n    return logStreams;\n  }\n\n  async processChanges(assets: Assets): Promise<void> {\n    const { logStreams } = assets;\n\n    if (!logStreams) return;\n\n    const changes = await this.calcChanges(assets).then((changes) => {\n      return {\n        ...changes,\n        update: changes.update.map((update: LogStream) => {\n          if (update.type === 'eventbridge' || update.type === 'eventgrid') {\n            delete update.sink;\n          }\n          if (update.status === 'suspended') {\n            // @ts-ignore because while status is usually expected for update payloads, it is ok to be omitted\n            // for suspended log streams. Setting as `active` in these instances would probably be ok\n            // but bit presumptuous, let suspended log streams remain suspended.\n            delete update.status;\n          }\n          return update;\n        }),\n      };\n    });\n\n    await super.processChanges(assets, changes);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a1d70525ad262efde215f6a8f77d13fbc61f2ad4","contentHash":"4f92113845af09e44a34fb47043a37719bd17661d9414271ea878069d9756818"},"/home/circleci/repo/src/tools/auth0/handlers/customDomains.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/customDomains.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":0},"end":{"line":40,"column":62}},"47":{"start":{"line":41,"column":0},"end":{"line":41,"column":24}},"48":{"start":{"line":42,"column":18},"end":{"line":42,"column":52}},"49":{"start":{"line":43,"column":0},"end":{"line":62,"column":2}},"50":{"start":{"line":65,"column":8},"end":{"line":67,"column":18}},"51":{"start":{"line":66,"column":34},"end":{"line":66,"column":97}},"52":{"start":{"line":70,"column":8},"end":{"line":70,"column":44}},"53":{"start":{"line":73,"column":8},"end":{"line":90,"column":11}},"54":{"start":{"line":74,"column":12},"end":{"line":89,"column":13}},"55":{"start":{"line":75,"column":16},"end":{"line":77,"column":17}},"56":{"start":{"line":76,"column":20},"end":{"line":76,"column":41}},"57":{"start":{"line":78,"column":38},"end":{"line":78,"column":97}},"58":{"start":{"line":79,"column":16},"end":{"line":79,"column":46}},"59":{"start":{"line":80,"column":16},"end":{"line":80,"column":37}},"60":{"start":{"line":83,"column":16},"end":{"line":87,"column":17}},"61":{"start":{"line":86,"column":20},"end":{"line":86,"column":32}},"62":{"start":{"line":88,"column":16},"end":{"line":88,"column":26}},"63":{"start":{"line":93,"column":23},"end":{"line":95,"column":10}},"64":{"start":{"line":94,"column":41},"end":{"line":94,"column":61}},"65":{"start":{"line":96,"column":8},"end":{"line":115,"column":11}},"66":{"start":{"line":97,"column":38},"end":{"line":97,"column":44}},"67":{"start":{"line":98,"column":12},"end":{"line":99,"column":23}},"68":{"start":{"line":99,"column":16},"end":{"line":99,"column":23}},"69":{"start":{"line":100,"column":28},"end":{"line":113,"column":14}},"70":{"start":{"line":101,"column":46},"end":{"line":111,"column":37}},"71":{"start":{"line":102,"column":48},"end":{"line":102,"column":87}},"72":{"start":{"line":103,"column":24},"end":{"line":105,"column":25}},"73":{"start":{"line":104,"column":28},"end":{"line":104,"column":75}},"74":{"start":{"line":106,"column":24},"end":{"line":106,"column":47}},"75":{"start":{"line":108,"column":58},"end":{"line":108,"column":143}},"76":{"start":{"line":109,"column":24},"end":{"line":109,"column":77}},"77":{"start":{"line":110,"column":24},"end":{"line":110,"column":57}},"78":{"start":{"line":112,"column":16},"end":{"line":112,"column":45}},"79":{"start":{"line":114,"column":12},"end":{"line":114,"column":68}},"80":{"start":{"line":118,"column":0},"end":{"line":120,"column":59}},"81":{"start":{"line":121,"column":0},"end":{"line":121,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":64,"column":4},"end":{"line":64,"column":5}},"loc":{"start":{"line":64,"column":24},"end":{"line":68,"column":5}},"line":64},"15":{"name":"(anonymous_15)","decl":{"start":{"line":66,"column":24},"end":{"line":66,"column":25}},"loc":{"start":{"line":66,"column":34},"end":{"line":66,"column":97}},"line":66},"16":{"name":"(anonymous_16)","decl":{"start":{"line":69,"column":4},"end":{"line":69,"column":5}},"loc":{"start":{"line":69,"column":20},"end":{"line":71,"column":5}},"line":69},"17":{"name":"(anonymous_17)","decl":{"start":{"line":72,"column":4},"end":{"line":72,"column":5}},"loc":{"start":{"line":72,"column":14},"end":{"line":91,"column":5}},"line":72},"18":{"name":"(anonymous_18)","decl":{"start":{"line":73,"column":47},"end":{"line":73,"column":48}},"loc":{"start":{"line":73,"column":60},"end":{"line":90,"column":9}},"line":73},"19":{"name":"(anonymous_19)","decl":{"start":{"line":92,"column":4},"end":{"line":92,"column":5}},"loc":{"start":{"line":92,"column":27},"end":{"line":116,"column":5}},"line":92},"20":{"name":"(anonymous_20)","decl":{"start":{"line":94,"column":35},"end":{"line":94,"column":36}},"loc":{"start":{"line":94,"column":41},"end":{"line":94,"column":61}},"line":94},"21":{"name":"(anonymous_21)","decl":{"start":{"line":96,"column":47},"end":{"line":96,"column":48}},"loc":{"start":{"line":96,"column":60},"end":{"line":115,"column":9}},"line":96},"22":{"name":"(anonymous_22)","decl":{"start":{"line":100,"column":64},"end":{"line":100,"column":65}},"loc":{"start":{"line":100,"column":77},"end":{"line":113,"column":13}},"line":100},"23":{"name":"(anonymous_23)","decl":{"start":{"line":101,"column":117},"end":{"line":101,"column":118}},"loc":{"start":{"line":101,"column":143},"end":{"line":107,"column":21}},"line":101},"24":{"name":"(anonymous_24)","decl":{"start":{"line":107,"column":48},"end":{"line":107,"column":49}},"loc":{"start":{"line":107,"column":66},"end":{"line":111,"column":21}},"line":107}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":75,"column":16},"end":{"line":77,"column":17}},"type":"if","locations":[{"start":{"line":75,"column":16},"end":{"line":77,"column":17}},{"start":{"line":75,"column":16},"end":{"line":77,"column":17}}],"line":75},"32":{"loc":{"start":{"line":83,"column":16},"end":{"line":87,"column":17}},"type":"if","locations":[{"start":{"line":83,"column":16},"end":{"line":87,"column":17}},{"start":{"line":83,"column":16},"end":{"line":87,"column":17}}],"line":83},"33":{"loc":{"start":{"line":83,"column":20},"end":{"line":85,"column":111}},"type":"binary-expr","locations":[{"start":{"line":83,"column":20},"end":{"line":83,"column":42}},{"start":{"line":84,"column":20},"end":{"line":85,"column":111}}],"line":83},"34":{"loc":{"start":{"line":98,"column":12},"end":{"line":99,"column":23}},"type":"if","locations":[{"start":{"line":98,"column":12},"end":{"line":99,"column":23}},{"start":{"line":98,"column":12},"end":{"line":99,"column":23}}],"line":98},"35":{"loc":{"start":{"line":103,"column":24},"end":{"line":105,"column":25}},"type":"if","locations":[{"start":{"line":103,"column":24},"end":{"line":105,"column":25}},{"start":{"line":103,"column":24},"end":{"line":105,"column":25}}],"line":103}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":22,"36":0,"37":17,"38":19,"39":19,"40":0,"41":3,"42":3,"43":0,"44":39,"45":17,"46":1,"47":1,"48":1,"49":1,"50":138,"51":1,"52":4,"53":12,"54":12,"55":12,"56":0,"57":12,"58":9,"59":9,"60":3,"61":3,"62":0,"63":5,"64":5,"65":5,"66":5,"67":5,"68":0,"69":5,"70":5,"71":2,"72":2,"73":0,"74":2,"75":2,"76":2,"77":2,"78":5,"79":5,"80":1,"81":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":17,"8":22,"9":0,"10":17,"11":19,"12":3,"13":39,"14":138,"15":1,"16":4,"17":12,"18":12,"19":5,"20":5,"21":5,"22":5,"23":2,"24":2},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[22,0],"28":[17,17],"29":[17,22],"30":[17,17],"31":[0,12],"32":[3,0],"33":[3,3],"34":[0,5],"35":[0,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/customDomains.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/customDomains.ts"],"names":[],"mappings":"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","sourcesContent":["import DefaultAPIHandler, { order } from './default';\nimport { Asset, Assets } from '../../../types';\n\nexport const schema = {\n  type: 'array',\n  items: {\n    type: 'object',\n    properties: {\n      custom_domain_id: { type: 'string' },\n      custom_client_ip_header: {\n        type: 'string',\n        nullable: true,\n        enum: ['true-client-ip', 'cf-connecting-ip', 'x-forwarded-for', null],\n      },\n      domain: { type: 'string' },\n      primary: { type: 'boolean' },\n      status: { type: 'string', enum: ['pending_verification', 'ready', 'disabled', 'pending'] },\n      type: { type: 'string', enum: ['auth0_managed_certs', 'self_managed_certs'] },\n      verification: { type: 'object' },\n    },\n    required: ['domain', 'type'],\n  },\n};\n\nexport default class CustomDomainsHadnler extends DefaultAPIHandler {\n  existing: Asset[] | null;\n\n  constructor(config: DefaultAPIHandler) {\n    super({\n      ...config,\n      type: 'customDomains',\n      id: 'custom_domain_id',\n      identifiers: ['domain'],\n      stripCreateFields: ['status', 'primary', 'verification'],\n      functions: {\n        delete: (args) => this.client.customDomains.delete({ id: args.custom_domain_id }),\n      },\n    });\n  }\n\n  objString(item: Asset): string {\n    return super.objString(item.domain);\n  }\n\n  async getType(): Promise<Asset | null> {\n    try {\n      if (this.existing) {\n        return this.existing;\n      }\n\n      const customDomains = await this.client.customDomains.getAll({ paginate: false });\n\n      this.existing = customDomains;\n\n      return customDomains;\n    } catch (err) {\n      if (\n        err.statusCode === 403 &&\n        err.message ===\n          'The account is not allowed to perform this operation, please contact our support team'\n      ) {\n        return null;\n      }\n      throw err;\n    }\n  }\n\n  @order('50')\n  async processChanges(assets: Assets): Promise<void> {\n    const { customDomains } = assets;\n\n    if (!customDomains) return;\n    const changes = await this.calcChanges(assets).then((changes) => {\n      const changesWithoutUpdates = {\n        ...changes,\n        create: changes.create.map((customDomainToCreate) => {\n          const newCustomDomain = { ...customDomainToCreate };\n          if (customDomainToCreate.custom_client_ip_header === null) {\n            delete newCustomDomain.custom_client_ip_header;\n          }\n\n          return newCustomDomain;\n        }),\n        delete: changes.del.map((deleteToMake) => {\n          const deleteWithSDKCompatibleID = {\n            ...deleteToMake,\n            id: deleteToMake.custom_domain_id,\n          };\n          delete deleteWithSDKCompatibleID['custom_domain_id'];\n          return deleteWithSDKCompatibleID;\n        }),\n        update: [], //Do not perform custom domain updates because not supported by SDK\n      };\n      return changesWithoutUpdates;\n    });\n\n    await super.processChanges(assets, changes);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"88a3671e10df2e62d9bc47b6fb594c32a5ae686d","contentHash":"7599fd192fd9ea5420bea255a9b15d63834a66fc1b8dcfced0c7b5acff430c92"},"/home/circleci/repo/src/tools/auth0/handlers/themes.ts":{"path":"/home/circleci/repo/src/tools/auth0/handlers/themes.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":28}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"17":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"18":{"start":{"line":20,"column":79},"end":{"line":20,"column":131}},"19":{"start":{"line":21,"column":9},"end":{"line":21,"column":150}},"20":{"start":{"line":21,"column":22},"end":{"line":21,"column":43}},"21":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"22":{"start":{"line":21,"column":81},"end":{"line":21,"column":150}},"23":{"start":{"line":22,"column":4},"end":{"line":22,"column":66}},"24":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"25":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"26":{"start":{"line":25,"column":31},"end":{"line":25,"column":42}},"27":{"start":{"line":26,"column":17},"end":{"line":26,"column":19}},"28":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"29":{"start":{"line":27,"column":21},"end":{"line":27,"column":141}},"30":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"31":{"start":{"line":27,"column":109},"end":{"line":27,"column":141}},"32":{"start":{"line":28,"column":4},"end":{"line":28,"column":36}},"33":{"start":{"line":29,"column":4},"end":{"line":29,"column":18}},"34":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"35":{"start":{"line":32,"column":28},"end":{"line":32,"column":110}},"36":{"start":{"line":32,"column":91},"end":{"line":32,"column":106}},"37":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"38":{"start":{"line":34,"column":36},"end":{"line":34,"column":97}},"39":{"start":{"line":34,"column":42},"end":{"line":34,"column":70}},"40":{"start":{"line":34,"column":85},"end":{"line":34,"column":95}},"41":{"start":{"line":35,"column":35},"end":{"line":35,"column":100}},"42":{"start":{"line":35,"column":41},"end":{"line":35,"column":73}},"43":{"start":{"line":35,"column":88},"end":{"line":35,"column":98}},"44":{"start":{"line":36,"column":32},"end":{"line":36,"column":116}},"45":{"start":{"line":37,"column":8},"end":{"line":37,"column":78}},"46":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"47":{"start":{"line":41,"column":4},"end":{"line":41,"column":62}},"48":{"start":{"line":43,"column":0},"end":{"line":43,"column":62}},"49":{"start":{"line":44,"column":0},"end":{"line":44,"column":24}},"50":{"start":{"line":45,"column":17},"end":{"line":45,"column":60}},"51":{"start":{"line":46,"column":18},"end":{"line":46,"column":52}},"52":{"start":{"line":49,"column":8},"end":{"line":49,"column":92}},"53":{"start":{"line":52,"column":8},"end":{"line":52,"column":58}},"54":{"start":{"line":55,"column":8},"end":{"line":60,"column":11}},"55":{"start":{"line":56,"column":12},"end":{"line":58,"column":13}},"56":{"start":{"line":57,"column":16},"end":{"line":57,"column":55}},"57":{"start":{"line":59,"column":12},"end":{"line":59,"column":33}},"58":{"start":{"line":63,"column":8},"end":{"line":74,"column":11}},"59":{"start":{"line":64,"column":31},"end":{"line":64,"column":37}},"60":{"start":{"line":66,"column":12},"end":{"line":68,"column":13}},"61":{"start":{"line":67,"column":16},"end":{"line":67,"column":23}},"62":{"start":{"line":70,"column":12},"end":{"line":72,"column":13}},"63":{"start":{"line":71,"column":16},"end":{"line":71,"column":43}},"64":{"start":{"line":73,"column":12},"end":{"line":73,"column":45}},"65":{"start":{"line":77,"column":8},"end":{"line":90,"column":11}},"66":{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},"67":{"start":{"line":79,"column":16},"end":{"line":79,"column":23}},"68":{"start":{"line":82,"column":34},"end":{"line":82,"column":56}},"69":{"start":{"line":83,"column":12},"end":{"line":85,"column":13}},"70":{"start":{"line":84,"column":16},"end":{"line":84,"column":23}},"71":{"start":{"line":86,"column":33},"end":{"line":86,"column":49}},"72":{"start":{"line":87,"column":12},"end":{"line":87,"column":81}},"73":{"start":{"line":88,"column":12},"end":{"line":88,"column":30}},"74":{"start":{"line":89,"column":12},"end":{"line":89,"column":41}},"75":{"start":{"line":93,"column":8},"end":{"line":116,"column":11}},"76":{"start":{"line":94,"column":12},"end":{"line":96,"column":13}},"77":{"start":{"line":95,"column":16},"end":{"line":95,"column":80}},"78":{"start":{"line":97,"column":34},"end":{"line":97,"column":56}},"79":{"start":{"line":98,"column":36},"end":{"line":105,"column":16}},"80":{"start":{"line":101,"column":32},"end":{"line":101,"column":41}},"81":{"start":{"line":103,"column":16},"end":{"line":103,"column":39}},"82":{"start":{"line":104,"column":16},"end":{"line":104,"column":31}},"83":{"start":{"line":106,"column":12},"end":{"line":113,"column":13}},"84":{"start":{"line":107,"column":16},"end":{"line":107,"column":72}},"85":{"start":{"line":110,"column":37},"end":{"line":110,"column":53}},"86":{"start":{"line":112,"column":16},"end":{"line":112,"column":102}},"87":{"start":{"line":114,"column":12},"end":{"line":114,"column":30}},"88":{"start":{"line":115,"column":12},"end":{"line":115,"column":38}},"89":{"start":{"line":119,"column":8},"end":{"line":132,"column":11}},"90":{"start":{"line":120,"column":12},"end":{"line":131,"column":13}},"91":{"start":{"line":121,"column":30},"end":{"line":121,"column":74}},"92":{"start":{"line":122,"column":16},"end":{"line":122,"column":31}},"93":{"start":{"line":125,"column":16},"end":{"line":126,"column":30}},"94":{"start":{"line":126,"column":20},"end":{"line":126,"column":30}},"95":{"start":{"line":127,"column":16},"end":{"line":128,"column":32}},"96":{"start":{"line":128,"column":20},"end":{"line":128,"column":32}},"97":{"start":{"line":130,"column":16},"end":{"line":130,"column":26}},"98":{"start":{"line":135,"column":0},"end":{"line":137,"column":52}},"99":{"start":{"line":138,"column":0},"end":{"line":138,"column":32}},"100":{"start":{"line":142,"column":0},"end":{"line":540,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":46},"end":{"line":18,"column":47}},"loc":{"start":{"line":18,"column":87},"end":{"line":23,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":24,"column":50},"end":{"line":24,"column":51}},"loc":{"start":{"line":24,"column":65},"end":{"line":30,"column":1}},"line":24},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":44},"end":{"line":31,"column":45}},"loc":{"start":{"line":31,"column":89},"end":{"line":39,"column":1}},"line":31},"8":{"name":"adopt","decl":{"start":{"line":32,"column":13},"end":{"line":32,"column":18}},"loc":{"start":{"line":32,"column":26},"end":{"line":32,"column":112}},"line":32},"9":{"name":"(anonymous_9)","decl":{"start":{"line":32,"column":70},"end":{"line":32,"column":71}},"loc":{"start":{"line":32,"column":89},"end":{"line":32,"column":108}},"line":32},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":36},"end":{"line":33,"column":37}},"loc":{"start":{"line":33,"column":63},"end":{"line":38,"column":5}},"line":33},"11":{"name":"fulfilled","decl":{"start":{"line":34,"column":17},"end":{"line":34,"column":26}},"loc":{"start":{"line":34,"column":34},"end":{"line":34,"column":99}},"line":34},"12":{"name":"rejected","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":25}},"loc":{"start":{"line":35,"column":33},"end":{"line":35,"column":102}},"line":35},"13":{"name":"step","decl":{"start":{"line":36,"column":17},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":30},"end":{"line":36,"column":118}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":40,"column":56},"end":{"line":40,"column":57}},"loc":{"start":{"line":40,"column":71},"end":{"line":42,"column":1}},"line":40},"15":{"name":"(anonymous_15)","decl":{"start":{"line":48,"column":4},"end":{"line":48,"column":5}},"loc":{"start":{"line":48,"column":25},"end":{"line":50,"column":5}},"line":48},"16":{"name":"(anonymous_16)","decl":{"start":{"line":51,"column":4},"end":{"line":51,"column":5}},"loc":{"start":{"line":51,"column":21},"end":{"line":53,"column":5}},"line":51},"17":{"name":"(anonymous_17)","decl":{"start":{"line":54,"column":4},"end":{"line":54,"column":5}},"loc":{"start":{"line":54,"column":14},"end":{"line":61,"column":5}},"line":54},"18":{"name":"(anonymous_18)","decl":{"start":{"line":55,"column":47},"end":{"line":55,"column":48}},"loc":{"start":{"line":55,"column":60},"end":{"line":60,"column":9}},"line":55},"19":{"name":"(anonymous_19)","decl":{"start":{"line":62,"column":4},"end":{"line":62,"column":5}},"loc":{"start":{"line":62,"column":27},"end":{"line":75,"column":5}},"line":62},"20":{"name":"(anonymous_20)","decl":{"start":{"line":63,"column":47},"end":{"line":63,"column":48}},"loc":{"start":{"line":63,"column":60},"end":{"line":74,"column":9}},"line":63},"21":{"name":"(anonymous_21)","decl":{"start":{"line":76,"column":4},"end":{"line":76,"column":5}},"loc":{"start":{"line":76,"column":19},"end":{"line":91,"column":5}},"line":76},"22":{"name":"(anonymous_22)","decl":{"start":{"line":77,"column":47},"end":{"line":77,"column":48}},"loc":{"start":{"line":77,"column":60},"end":{"line":90,"column":9}},"line":77},"23":{"name":"(anonymous_23)","decl":{"start":{"line":92,"column":4},"end":{"line":92,"column":5}},"loc":{"start":{"line":92,"column":25},"end":{"line":117,"column":5}},"line":92},"24":{"name":"(anonymous_24)","decl":{"start":{"line":93,"column":47},"end":{"line":93,"column":48}},"loc":{"start":{"line":93,"column":60},"end":{"line":116,"column":9}},"line":93},"25":{"name":"(anonymous_25)","decl":{"start":{"line":98,"column":37},"end":{"line":98,"column":38}},"loc":{"start":{"line":98,"column":43},"end":{"line":105,"column":13}},"line":98},"26":{"name":"(anonymous_26)","decl":{"start":{"line":118,"column":4},"end":{"line":118,"column":5}},"loc":{"start":{"line":118,"column":16},"end":{"line":133,"column":5}},"line":118},"27":{"name":"(anonymous_27)","decl":{"start":{"line":119,"column":47},"end":{"line":119,"column":48}},"loc":{"start":{"line":119,"column":60},"end":{"line":132,"column":9}},"line":119}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":17},"end":{"line":23,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":22}},{"start":{"line":18,"column":26},"end":{"line":18,"column":41}},{"start":{"line":18,"column":46},"end":{"line":23,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":42},"end":{"line":19,"column":48}},{"start":{"line":19,"column":51},"end":{"line":19,"column":125}}],"line":19},"12":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":125}},"type":"cond-expr","locations":[{"start":{"line":19,"column":67},"end":{"line":19,"column":118}},{"start":{"line":19,"column":121},"end":{"line":19,"column":125}}],"line":19},"13":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":150}},{"start":{"line":20,"column":4},"end":{"line":21,"column":150}}],"line":20},"14":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":77}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},{"start":{"line":20,"column":39},"end":{"line":20,"column":77}}],"line":20},"15":{"loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},"type":"if","locations":[{"start":{"line":21,"column":58},"end":{"line":21,"column":150}},{"start":{"line":21,"column":58},"end":{"line":21,"column":150}}],"line":21},"16":{"loc":{"start":{"line":21,"column":85},"end":{"line":21,"column":149}},"type":"binary-expr","locations":[{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},{"start":{"line":21,"column":148},"end":{"line":21,"column":149}}],"line":21},"17":{"loc":{"start":{"line":21,"column":86},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":94},"end":{"line":21,"column":98}},{"start":{"line":21,"column":101},"end":{"line":21,"column":143}}],"line":21},"18":{"loc":{"start":{"line":21,"column":101},"end":{"line":21,"column":143}},"type":"cond-expr","locations":[{"start":{"line":21,"column":109},"end":{"line":21,"column":126}},{"start":{"line":21,"column":129},"end":{"line":21,"column":143}}],"line":21},"19":{"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":62}},"type":"binary-expr","locations":[{"start":{"line":22,"column":11},"end":{"line":22,"column":16}},{"start":{"line":22,"column":20},"end":{"line":22,"column":21}},{"start":{"line":22,"column":25},"end":{"line":22,"column":62}}],"line":22},"20":{"loc":{"start":{"line":24,"column":19},"end":{"line":30,"column":1}},"type":"binary-expr","locations":[{"start":{"line":24,"column":20},"end":{"line":24,"column":24}},{"start":{"line":24,"column":28},"end":{"line":24,"column":45}},{"start":{"line":24,"column":50},"end":{"line":30,"column":1}}],"line":24},"21":{"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},{"start":{"line":25,"column":4},"end":{"line":25,"column":42}}],"line":25},"22":{"loc":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"type":"binary-expr","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":11}},{"start":{"line":25,"column":15},"end":{"line":25,"column":29}}],"line":25},"23":{"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":4},"end":{"line":27,"column":141}},{"start":{"line":27,"column":4},"end":{"line":27,"column":141}}],"line":27},"24":{"loc":{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},"type":"if","locations":[{"start":{"line":27,"column":40},"end":{"line":27,"column":141}},{"start":{"line":27,"column":40},"end":{"line":27,"column":141}}],"line":27},"25":{"loc":{"start":{"line":27,"column":44},"end":{"line":27,"column":107}},"type":"binary-expr","locations":[{"start":{"line":27,"column":44},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":107}}],"line":27},"26":{"loc":{"start":{"line":31,"column":16},"end":{"line":39,"column":1}},"type":"binary-expr","locations":[{"start":{"line":31,"column":17},"end":{"line":31,"column":21}},{"start":{"line":31,"column":25},"end":{"line":31,"column":39}},{"start":{"line":31,"column":44},"end":{"line":39,"column":1}}],"line":31},"27":{"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":109}},"type":"cond-expr","locations":[{"start":{"line":32,"column":56},"end":{"line":32,"column":61}},{"start":{"line":32,"column":64},"end":{"line":32,"column":109}}],"line":32},"28":{"loc":{"start":{"line":33,"column":16},"end":{"line":33,"column":34}},"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":17}},{"start":{"line":33,"column":22},"end":{"line":33,"column":33}}],"line":33},"29":{"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":115}},"type":"cond-expr","locations":[{"start":{"line":36,"column":46},"end":{"line":36,"column":67}},{"start":{"line":36,"column":70},"end":{"line":36,"column":115}}],"line":36},"30":{"loc":{"start":{"line":37,"column":51},"end":{"line":37,"column":67}},"type":"binary-expr","locations":[{"start":{"line":37,"column":51},"end":{"line":37,"column":61}},{"start":{"line":37,"column":65},"end":{"line":37,"column":67}}],"line":37},"31":{"loc":{"start":{"line":40,"column":22},"end":{"line":42,"column":1}},"type":"binary-expr","locations":[{"start":{"line":40,"column":23},"end":{"line":40,"column":27}},{"start":{"line":40,"column":31},"end":{"line":40,"column":51}},{"start":{"line":40,"column":56},"end":{"line":42,"column":1}}],"line":40},"32":{"loc":{"start":{"line":41,"column":11},"end":{"line":41,"column":61}},"type":"cond-expr","locations":[{"start":{"line":41,"column":37},"end":{"line":41,"column":40}},{"start":{"line":41,"column":43},"end":{"line":41,"column":61}}],"line":41},"33":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":33}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":15}},{"start":{"line":41,"column":19},"end":{"line":41,"column":33}}],"line":41},"34":{"loc":{"start":{"line":52,"column":15},"end":{"line":52,"column":57}},"type":"binary-expr","locations":[{"start":{"line":52,"column":15},"end":{"line":52,"column":32}},{"start":{"line":52,"column":36},"end":{"line":52,"column":57}}],"line":52},"35":{"loc":{"start":{"line":56,"column":12},"end":{"line":58,"column":13}},"type":"if","locations":[{"start":{"line":56,"column":12},"end":{"line":58,"column":13}},{"start":{"line":56,"column":12},"end":{"line":58,"column":13}}],"line":56},"36":{"loc":{"start":{"line":66,"column":12},"end":{"line":68,"column":13}},"type":"if","locations":[{"start":{"line":66,"column":12},"end":{"line":68,"column":13}},{"start":{"line":66,"column":12},"end":{"line":68,"column":13}}],"line":66},"37":{"loc":{"start":{"line":70,"column":12},"end":{"line":72,"column":13}},"type":"if","locations":[{"start":{"line":70,"column":12},"end":{"line":72,"column":13}},{"start":{"line":70,"column":12},"end":{"line":72,"column":13}}],"line":70},"38":{"loc":{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},"type":"if","locations":[{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},{"start":{"line":78,"column":12},"end":{"line":80,"column":13}}],"line":78},"39":{"loc":{"start":{"line":83,"column":12},"end":{"line":85,"column":13}},"type":"if","locations":[{"start":{"line":83,"column":12},"end":{"line":85,"column":13}},{"start":{"line":83,"column":12},"end":{"line":85,"column":13}}],"line":83},"40":{"loc":{"start":{"line":83,"column":16},"end":{"line":83,"column":68}},"type":"binary-expr","locations":[{"start":{"line":83,"column":16},"end":{"line":83,"column":38}},{"start":{"line":83,"column":42},"end":{"line":83,"column":68}}],"line":83},"41":{"loc":{"start":{"line":94,"column":12},"end":{"line":96,"column":13}},"type":"if","locations":[{"start":{"line":94,"column":12},"end":{"line":96,"column":13}},{"start":{"line":94,"column":12},"end":{"line":96,"column":13}}],"line":94},"42":{"loc":{"start":{"line":106,"column":12},"end":{"line":113,"column":13}},"type":"if","locations":[{"start":{"line":106,"column":12},"end":{"line":113,"column":13}},{"start":{"line":106,"column":12},"end":{"line":113,"column":13}}],"line":106},"43":{"loc":{"start":{"line":106,"column":16},"end":{"line":106,"column":68}},"type":"binary-expr","locations":[{"start":{"line":106,"column":16},"end":{"line":106,"column":38}},{"start":{"line":106,"column":42},"end":{"line":106,"column":68}}],"line":106},"44":{"loc":{"start":{"line":125,"column":16},"end":{"line":126,"column":30}},"type":"if","locations":[{"start":{"line":125,"column":16},"end":{"line":126,"column":30}},{"start":{"line":125,"column":16},"end":{"line":126,"column":30}}],"line":125},"45":{"loc":{"start":{"line":127,"column":16},"end":{"line":128,"column":32}},"type":"if","locations":[{"start":{"line":127,"column":16},"end":{"line":128,"column":32}},{"start":{"line":127,"column":16},"end":{"line":128,"column":32}}],"line":127}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":1,"35":25,"36":1,"37":27,"38":16,"39":16,"40":0,"41":9,"42":9,"43":2,"44":50,"45":27,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":138,"53":3,"54":8,"55":8,"56":8,"57":7,"58":4,"59":4,"60":4,"61":0,"62":4,"63":2,"64":2,"65":2,"66":2,"67":1,"68":1,"69":1,"70":0,"71":1,"72":1,"73":1,"74":1,"75":2,"76":2,"77":0,"78":2,"79":2,"80":2,"81":2,"82":2,"83":2,"84":1,"85":1,"86":1,"87":2,"88":2,"89":11,"90":11,"91":11,"92":3,"93":8,"94":6,"95":2,"96":1,"97":1,"98":1,"99":1,"100":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":1,"7":27,"8":25,"9":1,"10":27,"11":16,"12":9,"13":50,"14":1,"15":138,"16":3,"17":8,"18":8,"19":4,"20":4,"21":2,"22":2,"23":2,"24":2,"25":2,"26":11,"27":11},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[1,0],"16":[1,0],"17":[0,1],"18":[1,0],"19":[1,1,1],"20":[1,1,1],"21":[1,0],"22":[1,1],"23":[0,0],"24":[0,0],"25":[0,0],"26":[1,1,1],"27":[24,1],"28":[27,27],"29":[25,25],"30":[27,27],"31":[1,1,1],"32":[1,0],"33":[1,1],"34":[3,0],"35":[8,0],"36":[0,4],"37":[2,2],"38":[1,1],"39":[0,1],"40":[1,1],"41":[0,2],"42":[1,1],"43":[2,2],"44":[6,2],"45":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/tools/auth0/handlers/themes.ts","sources":["/home/circleci/repo/src/tools/auth0/handlers/themes.ts"],"names":[],"mappings":"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","sourcesContent":["import { Assets } from '../../../types';\nimport log from '../../../logger';\nimport DefaultHandler, { order } from './default';\n\nexport default class ThemesHandler extends DefaultHandler {\n  existing: Theme[] | null;\n\n  constructor(options: DefaultHandler) {\n    super({\n      ...options,\n      type: 'themes',\n      id: 'themeId',\n    });\n  }\n\n  objString(theme: Theme): string {\n    return theme.displayName || JSON.stringify(theme);\n  }\n\n  async getType(): Promise<Theme[] | null> {\n    if (!this.existing) {\n      this.existing = await this.getThemes();\n    }\n\n    return this.existing;\n  }\n\n  @order('60') // Run after custom domains.\n  async processChanges(assets: Assets): Promise<void> {\n    const { themes } = assets;\n\n    // Non existing section means themes doesn't need to be processed\n    if (!themes) {\n      return;\n    }\n\n    // Empty array means themes should be deleted\n    if (themes.length === 0) {\n      return this.deleteThemes();\n    }\n\n    return this.updateThemes(themes);\n  }\n\n  async deleteThemes(): Promise<void> {\n    if (!this.config('AUTH0_ALLOW_DELETE')) {\n      return;\n    }\n\n    // if theme exists we need to delete it\n    const currentThemes = await this.getThemes();\n    if (currentThemes === null || currentThemes.length === 0) {\n      return;\n    }\n\n    const currentTheme = currentThemes[0];\n    await this.client.branding.deleteTheme({ id: currentTheme.themeId });\n\n    this.deleted += 1;\n    this.didDelete(currentTheme);\n  }\n\n  async updateThemes(themes: Theme[]): Promise<void> {\n    if (themes.length > 1) {\n      log.warn('Only one theme is supported per tenant');\n    }\n\n    const currentThemes = await this.getThemes();\n\n    const themeReqPayload = ((): Omit<Theme, 'themeId'> => {\n      // Removing themeId from update and create payloads, otherwise API will error\n      // Theme ID may be required to handle if `--export_ids=true`\n      const payload = themes[0];\n      //@ts-ignore to quell non-optional themeId property, but we know that it's ok to delete\n      delete payload.themeId;\n      return payload;\n    })();\n\n    if (currentThemes === null || currentThemes.length === 0) {\n      await this.client.branding.createTheme(themeReqPayload);\n    } else {\n      const currentTheme = currentThemes[0];\n      // if theme exists, overwrite it otherwise create it\n      await this.client.branding.updateTheme({ id: currentTheme.themeId }, themeReqPayload);\n    }\n\n    this.updated += 1;\n    this.didUpdate(themes[0]);\n  }\n\n  async getThemes(): Promise<Theme[] | null> {\n    try {\n      const theme = await this.client.branding.getDefaultTheme();\n      return [theme];\n    } catch (err) {\n      if (err.statusCode === 404) return [];\n      if (err.statusCode === 400) return null;\n\n      // Errors other than 404 (theme doesn't exist) or 400 (no-code not enabled) shouldn't be expected\n      throw err;\n    }\n  }\n}\n\n/**\n * Schema\n */\nexport const schema = {\n  type: 'array',\n  items: {\n    additionalProperties: true,\n    properties: {\n      borders: {\n        additionalProperties: false,\n        properties: {\n          button_border_radius: {\n            description: 'Button border radius',\n            maximum: 10,\n            minimum: 1,\n            type: 'number',\n          },\n          button_border_weight: {\n            description: 'Button border weight',\n            maximum: 10,\n            minimum: 0,\n            type: 'number',\n          },\n          buttons_style: {\n            description: 'Buttons style',\n            enum: ['pill', 'rounded', 'sharp'],\n            type: 'string',\n          },\n          input_border_radius: {\n            description: 'Input border radius',\n            maximum: 10,\n            minimum: 0,\n            type: 'number',\n          },\n          input_border_weight: {\n            description: 'Input border weight',\n            maximum: 3,\n            minimum: 0,\n            type: 'number',\n          },\n          inputs_style: {\n            description: 'Inputs style',\n            enum: ['pill', 'rounded', 'sharp'],\n            type: 'string',\n          },\n          show_widget_shadow: {\n            description: 'Show widget shadow',\n            type: 'boolean',\n          },\n          widget_border_weight: {\n            description: 'Widget border weight',\n            maximum: 10,\n            minimum: 0,\n            type: 'number',\n          },\n          widget_corner_radius: {\n            description: 'Widget corner radius',\n            maximum: 50,\n            minimum: 0,\n            type: 'number',\n          },\n        },\n        required: [\n          'button_border_radius',\n          'button_border_weight',\n          'buttons_style',\n          'input_border_radius',\n          'input_border_weight',\n          'inputs_style',\n          'show_widget_shadow',\n          'widget_border_weight',\n          'widget_corner_radius',\n        ],\n        type: 'object',\n      },\n      colors: {\n        additionalProperties: false,\n        properties: {\n          base_focus_color: {\n            description: 'Base Focus Color',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          base_hover_color: {\n            description: 'Base Hover Color',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          body_text: {\n            description: 'Body text',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          error: {\n            description: 'Error',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          header: {\n            description: 'Header',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          icons: {\n            description: 'Icons',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          input_background: {\n            description: 'Input background',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          input_border: {\n            description: 'Input border',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          input_filled_text: {\n            description: 'Input filled text',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          input_labels_placeholders: {\n            description: 'Input labels & placeholders',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          links_focused_components: {\n            description: 'Links & focused components',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          primary_button: {\n            description: 'Primary button',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          primary_button_label: {\n            description: 'Primary button label',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          secondary_button_border: {\n            description: 'Secondary button border',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          secondary_button_label: {\n            description: 'Secondary button label',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          success: {\n            description: 'Success',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          widget_background: {\n            description: 'Widget background',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          widget_border: {\n            description: 'Widget border',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n        },\n        required: [\n          'body_text',\n          'error',\n          'header',\n          'icons',\n          'input_background',\n          'input_border',\n          'input_filled_text',\n          'input_labels_placeholders',\n          'links_focused_components',\n          'primary_button',\n          'primary_button_label',\n          'secondary_button_border',\n          'secondary_button_label',\n          'success',\n          'widget_background',\n          'widget_border',\n        ],\n        type: 'object',\n      },\n      displayName: {\n        description: 'Display Name',\n        maxLength: 2048,\n        pattern: '^[^<>]*$',\n        type: 'string',\n      },\n      fonts: {\n        additionalProperties: false,\n        properties: {\n          body_text: {\n            additionalProperties: false,\n            description: 'Body text',\n            properties: {\n              bold: {\n                description: 'Body text bold',\n                type: 'boolean',\n              },\n              size: {\n                description: 'Body text size',\n                maximum: 150,\n                minimum: 0,\n                type: 'number',\n              },\n            },\n            required: ['bold', 'size'],\n            type: 'object',\n          },\n          buttons_text: {\n            additionalProperties: false,\n            description: 'Buttons text',\n            properties: {\n              bold: {\n                description: 'Buttons text bold',\n                type: 'boolean',\n              },\n              size: {\n                description: 'Buttons text size',\n                maximum: 150,\n                minimum: 0,\n                type: 'number',\n              },\n            },\n            required: ['bold', 'size'],\n            type: 'object',\n          },\n          font_url: {\n            description: 'Font URL',\n            pattern:\n              \"^$|^(?=.)(?!https?:\\\\/(?:$|[^/]))(?!https?:\\\\/\\\\/\\\\/)(?!https?:[^/])(?:(?:https):(?:(?:\\\\/\\\\/(?:[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:]*@)?(?:\\\\[(?:(?:(?:[\\\\dA-Fa-f]{1,4}:){6}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|::(?:[\\\\dA-Fa-f]{1,4}:){5}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:){4}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,1}[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:){3}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,2}[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:){2}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,3}[\\\\dA-Fa-f]{1,4})?::[\\\\dA-Fa-f]{1,4}:(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,4}[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,5}[\\\\dA-Fa-f]{1,4})?::[\\\\dA-Fa-f]{1,4}|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,6}[\\\\dA-Fa-f]{1,4})?::)|v[\\\\dA-Fa-f]+\\\\.[\\\\w-\\\\.~!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:]+)\\\\]|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])|[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=]{1,255})(?::\\\\d*)?(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*)|\\\\/(?:[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]+(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*)?|[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]+(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*|(?:\\\\/\\\\/\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*)))(?:\\\\?[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@\\\\/\\\\?]*(?=#|$))?(?:#[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@\\\\/\\\\?]*)?$\",\n            type: 'string',\n          },\n          input_labels: {\n            additionalProperties: false,\n            description: 'Input Labels',\n            properties: {\n              bold: {\n                description: 'Input Labels bold',\n                type: 'boolean',\n              },\n              size: {\n                description: 'Input Labels size',\n                maximum: 150,\n                minimum: 0,\n                type: 'number',\n              },\n            },\n            required: ['bold', 'size'],\n            type: 'object',\n          },\n          links: {\n            additionalProperties: false,\n            description: 'Links',\n            properties: {\n              bold: {\n                description: 'Links bold',\n                type: 'boolean',\n              },\n              size: {\n                description: 'Links size',\n                maximum: 150,\n                minimum: 0,\n                type: 'number',\n              },\n            },\n            required: ['bold', 'size'],\n            type: 'object',\n          },\n          links_style: {\n            description: 'Links style',\n            enum: ['normal', 'underlined'],\n            type: 'string',\n          },\n          reference_text_size: {\n            description: 'Reference text size',\n            maximum: 24,\n            minimum: 12,\n            type: 'number',\n          },\n          subtitle: {\n            additionalProperties: false,\n            description: 'Subtitle',\n            properties: {\n              bold: {\n                description: 'Subtitle bold',\n                type: 'boolean',\n              },\n              size: {\n                description: 'Subtitle size',\n                maximum: 150,\n                minimum: 0,\n                type: 'number',\n              },\n            },\n            required: ['bold', 'size'],\n            type: 'object',\n          },\n          title: {\n            additionalProperties: false,\n            description: 'Title',\n            properties: {\n              bold: {\n                description: 'Title bold',\n                type: 'boolean',\n              },\n              size: {\n                description: 'Title size',\n                maximum: 150,\n                minimum: 75,\n                type: 'number',\n              },\n            },\n            required: ['bold', 'size'],\n            type: 'object',\n          },\n        },\n        required: [\n          'body_text',\n          'buttons_text',\n          'font_url',\n          'input_labels',\n          'links',\n          'links_style',\n          'reference_text_size',\n          'subtitle',\n          'title',\n        ],\n        type: 'object',\n      },\n      page_background: {\n        additionalProperties: false,\n        properties: {\n          background_color: {\n            description: 'Background color',\n            pattern: '^#(([0-9a-fA-F]{3}){1,2}|([0-9a-fA-F]{4}){1,2})$',\n            type: 'string',\n          },\n          background_image_url: {\n            description: 'Background image url',\n            pattern:\n              \"^$|^(?=.)(?!https?:\\\\/(?:$|[^/]))(?!https?:\\\\/\\\\/\\\\/)(?!https?:[^/])(?:(?:https):(?:(?:\\\\/\\\\/(?:[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:]*@)?(?:\\\\[(?:(?:(?:[\\\\dA-Fa-f]{1,4}:){6}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|::(?:[\\\\dA-Fa-f]{1,4}:){5}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:){4}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,1}[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:){3}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,2}[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:){2}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,3}[\\\\dA-Fa-f]{1,4})?::[\\\\dA-Fa-f]{1,4}:(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,4}[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,5}[\\\\dA-Fa-f]{1,4})?::[\\\\dA-Fa-f]{1,4}|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,6}[\\\\dA-Fa-f]{1,4})?::)|v[\\\\dA-Fa-f]+\\\\.[\\\\w-\\\\.~!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:]+)\\\\]|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])|[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=]{1,255})(?::\\\\d*)?(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*)|\\\\/(?:[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]+(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*)?|[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]+(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*|(?:\\\\/\\\\/\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*)))(?:\\\\?[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@\\\\/\\\\?]*(?=#|$))?(?:#[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@\\\\/\\\\?]*)?$\",\n            type: 'string',\n          },\n          page_layout: {\n            description: 'Page Layout',\n            enum: ['center', 'left', 'right'],\n            type: 'string',\n          },\n        },\n        required: ['background_color', 'background_image_url', 'page_layout'],\n        type: 'object',\n      },\n      widget: {\n        additionalProperties: false,\n        properties: {\n          header_text_alignment: {\n            description: 'Header text alignment',\n            enum: ['center', 'left', 'right'],\n            type: 'string',\n          },\n          logo_height: {\n            description: 'Logo height',\n            maximum: 100,\n            minimum: 1,\n            type: 'number',\n          },\n          logo_position: {\n            description: 'Logo position',\n            enum: ['center', 'left', 'none', 'right'],\n            type: 'string',\n          },\n          logo_url: {\n            description: 'Logo url',\n            pattern:\n              \"^$|^(?=.)(?!https?:\\\\/(?:$|[^/]))(?!https?:\\\\/\\\\/\\\\/)(?!https?:[^/])(?:(?:https):(?:(?:\\\\/\\\\/(?:[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:]*@)?(?:\\\\[(?:(?:(?:[\\\\dA-Fa-f]{1,4}:){6}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|::(?:[\\\\dA-Fa-f]{1,4}:){5}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:){4}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,1}[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:){3}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,2}[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:){2}(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,3}[\\\\dA-Fa-f]{1,4})?::[\\\\dA-Fa-f]{1,4}:(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,4}[\\\\dA-Fa-f]{1,4})?::(?:[\\\\dA-Fa-f]{1,4}:[\\\\dA-Fa-f]{1,4}|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5]))|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,5}[\\\\dA-Fa-f]{1,4})?::[\\\\dA-Fa-f]{1,4}|(?:(?:[\\\\dA-Fa-f]{1,4}:){0,6}[\\\\dA-Fa-f]{1,4})?::)|v[\\\\dA-Fa-f]+\\\\.[\\\\w-\\\\.~!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:]+)\\\\]|(?:(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])\\\\.){3}(?:0{0,2}\\\\d|0?[1-9]\\\\d|1\\\\d\\\\d|2[0-4]\\\\d|25[0-5])|[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=]{1,255})(?::\\\\d*)?(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*)|\\\\/(?:[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]+(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*)?|[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]+(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*|(?:\\\\/\\\\/\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*(?:\\\\/[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@]*)*)))(?:\\\\?[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@\\\\/\\\\?]*(?=#|$))?(?:#[\\\\w-\\\\.~%\\\\dA-Fa-f!\\\\$&'\\\\(\\\\)\\\\*\\\\+,;=:@\\\\/\\\\?]*)?$\",\n            type: 'string',\n          },\n          social_buttons_layout: {\n            description: 'Social buttons layout',\n            enum: ['bottom', 'top'],\n            type: 'string',\n          },\n        },\n        required: [\n          'header_text_alignment',\n          'logo_height',\n          'logo_position',\n          'logo_url',\n          'social_buttons_layout',\n        ],\n        type: 'object',\n      },\n    },\n    required: ['borders', 'colors', 'fonts', 'page_background', 'widget'],\n    type: 'object',\n  },\n};\n\n/**\n * Utility types\n */\n\nexport interface Colors {\n  primary_button: string;\n  primary_button_label: string;\n  secondary_button_border: string;\n  secondary_button_label: string;\n  links_focused_components: string;\n  header: string;\n  body_text: string;\n  widget_background: string;\n  widget_border: string;\n  input_labels_placeholders: string;\n  input_filled_text: string;\n  input_border: string;\n  input_background: string;\n  icons: string;\n  error: string;\n  success: string;\n  base_focus_color?: string;\n  base_hover_color?: string;\n}\n\nexport interface Fonts {\n  font_url: string;\n  reference_text_size: number;\n  title: {\n    size: number;\n    bold: boolean;\n  };\n  subtitle: {\n    size: number;\n    bold: boolean;\n  };\n  body_text: {\n    size: number;\n    bold: boolean;\n  };\n  buttons_text: {\n    size: number;\n    bold: boolean;\n  };\n  input_labels: {\n    size: number;\n    bold: boolean;\n  };\n  links: {\n    size: number;\n    bold: boolean;\n  };\n  links_style: 'normal' | 'underlined';\n}\n\nexport interface Borders {\n  button_border_weight: number;\n  buttons_style: 'sharp' | 'pill' | 'rounded';\n  button_border_radius: number;\n  input_border_weight: number;\n  inputs_style: 'sharp' | 'pill' | 'rounded';\n  input_border_radius: number;\n  widget_corner_radius: number;\n  widget_border_weight: number;\n  show_widget_shadow: boolean;\n}\n\nexport interface Widget {\n  logo_position: 'left' | 'center' | 'right' | 'none';\n  logo_url: string;\n  logo_height: number;\n  header_text_alignment: 'left' | 'center' | 'right';\n  social_buttons_layout: 'top' | 'bottom';\n}\n\nexport interface PageBackground {\n  page_layout: 'left' | 'center' | 'right';\n  background_color: string;\n  background_image_url: string;\n}\n\nexport interface Theme {\n  colors: Colors;\n  fonts: Fonts;\n  borders: Borders;\n  widget: Widget;\n  page_background: PageBackground;\n  themeId: string;\n  displayName?: string;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fc08553e4e52890091f2a5c1838950ef02cdd117","contentHash":"273a73bc412332d5a05274c0b26a31e51ec4eaa85aa274628efea1d5745f322a"},"/home/circleci/repo/src/utils.ts":{"path":"/home/circleci/repo/src/utils.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":385}},"4":{"start":{"line":7,"column":15},"end":{"line":7,"column":47}},"5":{"start":{"line":8,"column":19},"end":{"line":8,"column":55}},"6":{"start":{"line":9,"column":28},"end":{"line":9,"column":73}},"7":{"start":{"line":10,"column":19},"end":{"line":10,"column":55}},"8":{"start":{"line":11,"column":16},"end":{"line":11,"column":34}},"9":{"start":{"line":12,"column":17},"end":{"line":12,"column":53}},"10":{"start":{"line":14,"column":4},"end":{"line":19,"column":5}},"11":{"start":{"line":15,"column":8},"end":{"line":15,"column":91}},"12":{"start":{"line":18,"column":8},"end":{"line":18,"column":21}},"13":{"start":{"line":21,"column":0},"end":{"line":21,"column":34}},"14":{"start":{"line":23,"column":4},"end":{"line":28,"column":5}},"15":{"start":{"line":24,"column":8},"end":{"line":24,"column":86}},"16":{"start":{"line":27,"column":8},"end":{"line":27,"column":21}},"17":{"start":{"line":30,"column":0},"end":{"line":30,"column":24}},"18":{"start":{"line":32,"column":4},"end":{"line":37,"column":5}},"19":{"start":{"line":33,"column":8},"end":{"line":36,"column":82}},"20":{"start":{"line":35,"column":24},"end":{"line":35,"column":54}},"21":{"start":{"line":36,"column":27},"end":{"line":36,"column":80}},"22":{"start":{"line":38,"column":4},"end":{"line":38,"column":14}},"23":{"start":{"line":40,"column":0},"end":{"line":40,"column":28}},"24":{"start":{"line":45,"column":4},"end":{"line":54,"column":5}},"25":{"start":{"line":46,"column":24},"end":{"line":49,"column":10}},"26":{"start":{"line":50,"column":8},"end":{"line":50,"column":35}},"27":{"start":{"line":53,"column":8},"end":{"line":53,"column":97}},"28":{"start":{"line":56,"column":0},"end":{"line":56,"column":28}},"29":{"start":{"line":58,"column":4},"end":{"line":65,"column":5}},"30":{"start":{"line":59,"column":8},"end":{"line":59,"column":49}},"31":{"start":{"line":60,"column":25},"end":{"line":60,"column":58}},"32":{"start":{"line":61,"column":8},"end":{"line":61,"column":101}},"33":{"start":{"line":64,"column":8},"end":{"line":64,"column":95}},"34":{"start":{"line":67,"column":0},"end":{"line":67,"column":28}},"35":{"start":{"line":69,"column":4},"end":{"line":74,"column":5}},"36":{"start":{"line":70,"column":8},"end":{"line":72,"column":9}},"37":{"start":{"line":71,"column":12},"end":{"line":71,"column":81}},"38":{"start":{"line":73,"column":8},"end":{"line":73,"column":20}},"39":{"start":{"line":75,"column":4},"end":{"line":75,"column":17}},"40":{"start":{"line":77,"column":0},"end":{"line":77,"column":42}},"41":{"start":{"line":79,"column":4},"end":{"line":79,"column":30}},"42":{"start":{"line":79,"column":20},"end":{"line":79,"column":29}},"43":{"start":{"line":81,"column":0},"end":{"line":81,"column":32}},"44":{"start":{"line":83,"column":20},"end":{"line":83,"column":45}},"45":{"start":{"line":86,"column":19},"end":{"line":93,"column":5}},"46":{"start":{"line":95,"column":4},"end":{"line":107,"column":7}},"47":{"start":{"line":96,"column":8},"end":{"line":97,"column":19}},"48":{"start":{"line":97,"column":12},"end":{"line":97,"column":19}},"49":{"start":{"line":98,"column":22},"end":{"line":98,"column":37}},"50":{"start":{"line":100,"column":8},"end":{"line":106,"column":9}},"51":{"start":{"line":101,"column":12},"end":{"line":105,"column":15}},"52":{"start":{"line":102,"column":31},"end":{"line":102,"column":51}},"53":{"start":{"line":103,"column":16},"end":{"line":103,"column":36}},"54":{"start":{"line":104,"column":16},"end":{"line":104,"column":30}},"55":{"start":{"line":108,"column":4},"end":{"line":108,"column":19}},"56":{"start":{"line":110,"column":0},"end":{"line":110,"column":44}},"57":{"start":{"line":112,"column":4},"end":{"line":112,"column":71}},"58":{"start":{"line":114,"column":0},"end":{"line":114,"column":28}},"59":{"start":{"line":116,"column":4},"end":{"line":118,"column":5}},"60":{"start":{"line":117,"column":8},"end":{"line":117,"column":20}},"61":{"start":{"line":119,"column":28},"end":{"line":129,"column":5}},"62":{"start":{"line":130,"column":19},"end":{"line":130,"column":53}},"63":{"start":{"line":131,"column":4},"end":{"line":135,"column":7}},"64":{"start":{"line":134,"column":8},"end":{"line":134,"column":28}},"65":{"start":{"line":136,"column":4},"end":{"line":139,"column":7}},"66":{"start":{"line":137,"column":8},"end":{"line":138,"column":31}},"67":{"start":{"line":138,"column":12},"end":{"line":138,"column":31}},"68":{"start":{"line":140,"column":4},"end":{"line":140,"column":18}},"69":{"start":{"line":142,"column":0},"end":{"line":142,"column":38}},"70":{"start":{"line":144,"column":28},"end":{"line":144,"column":68}},"71":{"start":{"line":145,"column":4},"end":{"line":150,"column":5}},"72":{"start":{"line":145,"column":17},"end":{"line":145,"column":18}},"73":{"start":{"line":146,"column":20},"end":{"line":146,"column":38}},"74":{"start":{"line":147,"column":8},"end":{"line":149,"column":9}},"75":{"start":{"line":148,"column":12},"end":{"line":148,"column":44}},"76":{"start":{"line":151,"column":4},"end":{"line":151,"column":13}},"77":{"start":{"line":153,"column":0},"end":{"line":153,"column":38}},"78":{"start":{"line":155,"column":4},"end":{"line":157,"column":5}},"79":{"start":{"line":156,"column":8},"end":{"line":156,"column":28}},"80":{"start":{"line":159,"column":0},"end":{"line":159,"column":44}},"81":{"start":{"line":161,"column":18},"end":{"line":161,"column":20}},"82":{"start":{"line":162,"column":4},"end":{"line":164,"column":5}},"83":{"start":{"line":163,"column":8},"end":{"line":163,"column":50}},"84":{"start":{"line":166,"column":0},"end":{"line":166,"column":32}},"85":{"start":{"line":168,"column":25},"end":{"line":168,"column":99}},"86":{"start":{"line":170,"column":4},"end":{"line":175,"column":7}},"87":{"start":{"line":171,"column":8},"end":{"line":174,"column":9}},"88":{"start":{"line":173,"column":12},"end":{"line":173,"column":30}},"89":{"start":{"line":176,"column":4},"end":{"line":176,"column":18}},"90":{"start":{"line":178,"column":0},"end":{"line":178,"column":46}},"91":{"start":{"line":180,"column":4},"end":{"line":186,"column":5}},"92":{"start":{"line":181,"column":22},"end":{"line":181,"column":72}},"93":{"start":{"line":181,"column":47},"end":{"line":181,"column":71}},"94":{"start":{"line":182,"column":8},"end":{"line":182,"column":49}},"95":{"start":{"line":185,"column":8},"end":{"line":185,"column":24}},"96":{"start":{"line":188,"column":0},"end":{"line":188,"column":54}},"97":{"start":{"line":190,"column":4},"end":{"line":192,"column":69}},"98":{"start":{"line":191,"column":52},"end":{"line":191,"column":97}},"99":{"start":{"line":192,"column":21},"end":{"line":192,"column":67}},"100":{"start":{"line":194,"column":0},"end":{"line":194,"column":56}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"isDirectory","decl":{"start":{"line":13,"column":9},"end":{"line":13,"column":20}},"loc":{"start":{"line":13,"column":31},"end":{"line":20,"column":1}},"line":13},"2":{"name":"isFile","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":15}},"loc":{"start":{"line":22,"column":26},"end":{"line":29,"column":1}},"line":22},"3":{"name":"getFiles","decl":{"start":{"line":31,"column":9},"end":{"line":31,"column":17}},"loc":{"start":{"line":31,"column":32},"end":{"line":39,"column":1}},"line":31},"4":{"name":"(anonymous_4)","decl":{"start":{"line":35,"column":17},"end":{"line":35,"column":18}},"loc":{"start":{"line":35,"column":24},"end":{"line":35,"column":54}},"line":35},"5":{"name":"(anonymous_5)","decl":{"start":{"line":36,"column":20},"end":{"line":36,"column":21}},"loc":{"start":{"line":36,"column":27},"end":{"line":36,"column":80}},"line":36},"6":{"name":"loadJSON","decl":{"start":{"line":41,"column":9},"end":{"line":41,"column":17}},"loc":{"start":{"line":44,"column":3},"end":{"line":55,"column":1}},"line":44},"7":{"name":"dumpJSON","decl":{"start":{"line":57,"column":9},"end":{"line":57,"column":17}},"loc":{"start":{"line":57,"column":34},"end":{"line":66,"column":1}},"line":57},"8":{"name":"existsMustBeDir","decl":{"start":{"line":68,"column":9},"end":{"line":68,"column":24}},"loc":{"start":{"line":68,"column":33},"end":{"line":76,"column":1}},"line":68},"9":{"name":"toConfigFn","decl":{"start":{"line":78,"column":9},"end":{"line":78,"column":19}},"loc":{"start":{"line":78,"column":26},"end":{"line":80,"column":1}},"line":78},"10":{"name":"(anonymous_10)","decl":{"start":{"line":79,"column":11},"end":{"line":79,"column":12}},"loc":{"start":{"line":79,"column":20},"end":{"line":79,"column":29}},"line":79},"11":{"name":"stripIdentifiers","decl":{"start":{"line":82,"column":9},"end":{"line":82,"column":25}},"loc":{"start":{"line":82,"column":41},"end":{"line":109,"column":1}},"line":82},"12":{"name":"(anonymous_12)","decl":{"start":{"line":95,"column":27},"end":{"line":95,"column":28}},"loc":{"start":{"line":95,"column":34},"end":{"line":107,"column":5}},"line":95},"13":{"name":"(anonymous_13)","decl":{"start":{"line":101,"column":40},"end":{"line":101,"column":41}},"loc":{"start":{"line":101,"column":47},"end":{"line":105,"column":13}},"line":101},"14":{"name":"sanitize","decl":{"start":{"line":111,"column":9},"end":{"line":111,"column":17}},"loc":{"start":{"line":111,"column":23},"end":{"line":113,"column":1}},"line":111},"15":{"name":"formatResults","decl":{"start":{"line":115,"column":9},"end":{"line":115,"column":22}},"loc":{"start":{"line":115,"column":29},"end":{"line":141,"column":1}},"line":115},"16":{"name":"(anonymous_16)","decl":{"start":{"line":133,"column":17},"end":{"line":133,"column":18}},"loc":{"start":{"line":133,"column":35},"end":{"line":135,"column":5}},"line":133},"17":{"name":"(anonymous_17)","decl":{"start":{"line":136,"column":41},"end":{"line":136,"column":42}},"loc":{"start":{"line":136,"column":50},"end":{"line":139,"column":5}},"line":136},"18":{"name":"recordsSorter","decl":{"start":{"line":143,"column":9},"end":{"line":143,"column":22}},"loc":{"start":{"line":143,"column":29},"end":{"line":152,"column":1}},"line":143},"19":{"name":"clearTenantFlags","decl":{"start":{"line":154,"column":9},"end":{"line":154,"column":25}},"loc":{"start":{"line":154,"column":34},"end":{"line":158,"column":1}},"line":154},"20":{"name":"ensureProp","decl":{"start":{"line":160,"column":9},"end":{"line":160,"column":19}},"loc":{"start":{"line":160,"column":32},"end":{"line":165,"column":1}},"line":160},"21":{"name":"clearClientArrays","decl":{"start":{"line":167,"column":9},"end":{"line":167,"column":26}},"loc":{"start":{"line":167,"column":35},"end":{"line":177,"column":1}},"line":167},"22":{"name":"(anonymous_22)","decl":{"start":{"line":170,"column":32},"end":{"line":170,"column":33}},"loc":{"start":{"line":170,"column":42},"end":{"line":175,"column":5}},"line":170},"23":{"name":"convertClientIdToName","decl":{"start":{"line":179,"column":9},"end":{"line":179,"column":30}},"loc":{"start":{"line":179,"column":60},"end":{"line":187,"column":1}},"line":179},"24":{"name":"(anonymous_24)","decl":{"start":{"line":181,"column":40},"end":{"line":181,"column":41}},"loc":{"start":{"line":181,"column":47},"end":{"line":181,"column":71}},"line":181},"25":{"name":"mapClientID2NameSorted","decl":{"start":{"line":189,"column":9},"end":{"line":189,"column":31}},"loc":{"start":{"line":189,"column":62},"end":{"line":193,"column":1}},"line":189},"26":{"name":"(anonymous_26)","decl":{"start":{"line":191,"column":38},"end":{"line":191,"column":39}},"loc":{"start":{"line":191,"column":52},"end":{"line":191,"column":97}},"line":191},"27":{"name":"(anonymous_27)","decl":{"start":{"line":192,"column":11},"end":{"line":192,"column":12}},"loc":{"start":{"line":192,"column":21},"end":{"line":192,"column":67}},"line":192}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":32,"column":4},"end":{"line":37,"column":5}},"type":"if","locations":[{"start":{"line":32,"column":4},"end":{"line":37,"column":5}},{"start":{"line":32,"column":4},"end":{"line":37,"column":5}}],"line":32},"4":{"loc":{"start":{"line":36,"column":27},"end":{"line":36,"column":80}},"type":"binary-expr","locations":[{"start":{"line":36,"column":27},"end":{"line":36,"column":36}},{"start":{"line":36,"column":40},"end":{"line":36,"column":80}}],"line":36},"5":{"loc":{"start":{"line":41,"column":24},"end":{"line":44,"column":1}},"type":"default-arg","locations":[{"start":{"line":41,"column":31},"end":{"line":44,"column":1}}],"line":41},"6":{"loc":{"start":{"line":61,"column":47},"end":{"line":61,"column":99}},"type":"cond-expr","locations":[{"start":{"line":61,"column":73},"end":{"line":61,"column":81}},{"start":{"line":61,"column":84},"end":{"line":61,"column":99}}],"line":61},"7":{"loc":{"start":{"line":69,"column":4},"end":{"line":74,"column":5}},"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":74,"column":5}},{"start":{"line":69,"column":4},"end":{"line":74,"column":5}}],"line":69},"8":{"loc":{"start":{"line":70,"column":8},"end":{"line":72,"column":9}},"type":"if","locations":[{"start":{"line":70,"column":8},"end":{"line":72,"column":9}},{"start":{"line":70,"column":8},"end":{"line":72,"column":9}}],"line":70},"9":{"loc":{"start":{"line":96,"column":8},"end":{"line":97,"column":19}},"type":"if","locations":[{"start":{"line":96,"column":8},"end":{"line":97,"column":19}},{"start":{"line":96,"column":8},"end":{"line":97,"column":19}}],"line":96},"10":{"loc":{"start":{"line":100,"column":8},"end":{"line":106,"column":9}},"type":"if","locations":[{"start":{"line":100,"column":8},"end":{"line":106,"column":9}},{"start":{"line":100,"column":8},"end":{"line":106,"column":9}}],"line":100},"11":{"loc":{"start":{"line":116,"column":4},"end":{"line":118,"column":5}},"type":"if","locations":[{"start":{"line":116,"column":4},"end":{"line":118,"column":5}},{"start":{"line":116,"column":4},"end":{"line":118,"column":5}}],"line":116},"12":{"loc":{"start":{"line":116,"column":8},"end":{"line":116,"column":41}},"type":"binary-expr","locations":[{"start":{"line":116,"column":8},"end":{"line":116,"column":13}},{"start":{"line":116,"column":17},"end":{"line":116,"column":41}}],"line":116},"13":{"loc":{"start":{"line":137,"column":8},"end":{"line":138,"column":31}},"type":"if","locations":[{"start":{"line":137,"column":8},"end":{"line":138,"column":31}},{"start":{"line":137,"column":8},"end":{"line":138,"column":31}}],"line":137},"14":{"loc":{"start":{"line":147,"column":8},"end":{"line":149,"column":9}},"type":"if","locations":[{"start":{"line":147,"column":8},"end":{"line":149,"column":9}},{"start":{"line":147,"column":8},"end":{"line":149,"column":9}}],"line":147},"15":{"loc":{"start":{"line":147,"column":12},"end":{"line":147,"column":28}},"type":"binary-expr","locations":[{"start":{"line":147,"column":12},"end":{"line":147,"column":18}},{"start":{"line":147,"column":22},"end":{"line":147,"column":28}}],"line":147},"16":{"loc":{"start":{"line":148,"column":19},"end":{"line":148,"column":43}},"type":"cond-expr","locations":[{"start":{"line":148,"column":37},"end":{"line":148,"column":38}},{"start":{"line":148,"column":41},"end":{"line":148,"column":43}}],"line":148},"17":{"loc":{"start":{"line":155,"column":4},"end":{"line":157,"column":5}},"type":"if","locations":[{"start":{"line":155,"column":4},"end":{"line":157,"column":5}},{"start":{"line":155,"column":4},"end":{"line":157,"column":5}}],"line":155},"18":{"loc":{"start":{"line":155,"column":8},"end":{"line":155,"column":57}},"type":"binary-expr","locations":[{"start":{"line":155,"column":8},"end":{"line":155,"column":20}},{"start":{"line":155,"column":24},"end":{"line":155,"column":57}}],"line":155},"19":{"loc":{"start":{"line":162,"column":4},"end":{"line":164,"column":5}},"type":"if","locations":[{"start":{"line":162,"column":4},"end":{"line":164,"column":5}},{"start":{"line":162,"column":4},"end":{"line":164,"column":5}}],"line":162},"20":{"loc":{"start":{"line":171,"column":8},"end":{"line":174,"column":9}},"type":"if","locations":[{"start":{"line":171,"column":8},"end":{"line":174,"column":9}},{"start":{"line":171,"column":8},"end":{"line":174,"column":9}}],"line":171},"21":{"loc":{"start":{"line":171,"column":12},"end":{"line":171,"column":60}},"type":"binary-expr","locations":[{"start":{"line":171,"column":12},"end":{"line":171,"column":43}},{"start":{"line":171,"column":47},"end":{"line":171,"column":60}}],"line":171},"22":{"loc":{"start":{"line":179,"column":41},"end":{"line":179,"column":58}},"type":"default-arg","locations":[{"start":{"line":179,"column":56},"end":{"line":179,"column":58}}],"line":179},"23":{"loc":{"start":{"line":182,"column":15},"end":{"line":182,"column":48}},"type":"binary-expr","locations":[{"start":{"line":182,"column":16},"end":{"line":182,"column":21}},{"start":{"line":182,"column":25},"end":{"line":182,"column":35}},{"start":{"line":182,"column":40},"end":{"line":182,"column":48}}],"line":182},"24":{"loc":{"start":{"line":191,"column":12},"end":{"line":191,"column":32}},"type":"binary-expr","locations":[{"start":{"line":191,"column":12},"end":{"line":191,"column":26}},{"start":{"line":191,"column":30},"end":{"line":191,"column":32}}],"line":191}},"s":{"0":1,"1":5,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":308,"11":308,"12":6,"13":1,"14":280,"15":280,"16":149,"17":1,"18":39,"19":37,"20":101,"21":101,"22":2,"23":1,"24":139,"25":139,"26":138,"27":1,"28":1,"29":58,"30":58,"31":58,"32":58,"33":1,"34":1,"35":1602,"36":188,"37":12,"38":176,"39":1414,"40":1,"41":49,"42":2788,"43":1,"44":6,"45":6,"46":6,"47":119,"48":24,"49":95,"50":95,"51":44,"52":11,"53":11,"54":11,"55":6,"56":1,"57":73,"58":1,"59":96,"60":1,"61":95,"62":95,"63":95,"64":247,"65":95,"66":855,"67":782,"68":95,"69":1,"70":118,"71":118,"72":118,"73":463,"74":463,"75":118,"76":0,"77":1,"78":19,"79":12,"80":1,"81":6,"82":6,"83":0,"84":1,"85":13,"86":13,"87":50,"88":4,"89":13,"90":1,"91":31,"92":31,"93":25,"94":26,"95":5,"96":1,"97":20,"98":20,"99":17,"100":1},"f":{"0":5,"1":308,"2":280,"3":39,"4":101,"5":101,"6":139,"7":58,"8":1602,"9":49,"10":2788,"11":6,"12":119,"13":11,"14":73,"15":96,"16":247,"17":855,"18":118,"19":19,"20":6,"21":13,"22":50,"23":31,"24":25,"25":20,"26":20,"27":17},"b":{"0":[1,1,1],"1":[1,4],"2":[5,5],"3":[37,2],"4":[101,100],"5":[54],"6":[0,58],"7":[188,1414],"8":[12,176],"9":[24,95],"10":[44,51],"11":[1,95],"12":[96,96],"13":[782,73],"14":[118,345],"15":[463,118],"16":[48,70],"17":[12,7],"18":[19,12],"19":[0,6],"20":[4,46],"21":[50,8],"22":[1],"23":[26,6,20],"24":[20,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/utils.ts","sources":["/home/circleci/repo/src/utils.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport sanitizeName from 'sanitize-filename';\nimport dotProp from 'dot-prop';\nimport { loadFileAndReplaceKeywords, Auth0 } from './tools';\nimport log from './logger';\nimport { Asset, Assets, Config, KeywordMappings } from './types';\n\nexport function isDirectory(filePath: string): boolean {\n  try {\n    return fs.statSync(path.resolve(filePath)).isDirectory();\n  } catch (err) {\n    return false;\n  }\n}\n\nexport function isFile(filePath: string): boolean {\n  try {\n    return fs.statSync(path.resolve(filePath)).isFile();\n  } catch (err) {\n    return false;\n  }\n}\n\nexport function getFiles(folder: string, exts: string[]): string[] {\n  if (isDirectory(folder)) {\n    return fs\n      .readdirSync(folder)\n      .map((f) => path.join(folder, f))\n      .filter((f) => isFile(f) && exts.includes(path.extname(f)));\n  }\n  return [];\n}\n\nexport function loadJSON(\n  file: string,\n  opts: { disableKeywordReplacement: boolean; mappings: KeywordMappings } = {\n    disableKeywordReplacement: false,\n    mappings: {},\n  }\n): any {\n  try {\n    const content = loadFileAndReplaceKeywords(file, {\n      mappings: opts.mappings,\n      disableKeywordReplacement: opts.disableKeywordReplacement,\n    });\n    return JSON.parse(content);\n  } catch (e) {\n    throw new Error(`Error parsing JSON from metadata file: ${file}, because: ${e.message}`);\n  }\n}\n\nexport function dumpJSON(file: string, mappings: { [key: string]: any }): void {\n  try {\n    log.info(`Writing ${file}`);\n    const jsonBody = JSON.stringify(mappings, null, 2);\n    fs.writeFileSync(file, jsonBody.endsWith('\\n') ? jsonBody : `${jsonBody}\\n`);\n  } catch (e) {\n    throw new Error(`Error writing JSON to metadata file: ${file}, because: ${e.message}`);\n  }\n}\n\nexport function existsMustBeDir(folder: string): boolean {\n  if (fs.existsSync(folder)) {\n    if (!isDirectory(folder)) {\n      throw new Error(`Expected ${folder} to be a folder but got a file?`);\n    }\n    return true;\n  }\n  return false;\n}\n\nexport function toConfigFn(data: Config): (arg0: keyof Config) => any {\n  return (key) => data[key];\n}\n\nexport function stripIdentifiers(auth0: Auth0, assets: Assets) {\n  const updated = { ...assets };\n\n  // Some of the object identifiers are required to perform updates.\n  // Don't strip these object id's\n  const ignore = [\n    'actions',\n    'rulesConfigs',\n    'emailTemplates',\n    'guardianFactors',\n    'guardianFactorProviders',\n    'guardianFactorTemplates',\n  ];\n\n  // Optionally Strip identifiers\n  auth0.handlers.forEach((h) => {\n    if (ignore.includes(h.type)) return;\n    const exist = updated[h.type];\n    // All objects with the identifier field is an array. This could change in future.\n    if (Array.isArray(exist)) {\n      updated[h.type] = exist.map((o) => {\n        const newObj = { ...o };\n        delete newObj[h.id];\n        return newObj;\n      });\n    }\n  });\n\n  return updated;\n}\n\nexport function sanitize(str: string): string {\n  return sanitizeName(str, { replacement: '-' });\n}\n\ntype ImportantFields = {\n  name: string | null;\n  client_id: string | null;\n  audience: string | null;\n  template: string | null;\n  identifier: string | null;\n  strategy: string | null;\n  script: string | null;\n  stage: string | null;\n  id: string | null;\n};\n\nexport function formatResults(item: any): Partial<ImportantFields> {\n  if (!item || typeof item !== 'object') {\n    return item;\n  }\n  const importantFields: ImportantFields = {\n    name: null,\n    client_id: null,\n    audience: null,\n    template: null,\n    identifier: null,\n    strategy: null,\n    script: null,\n    stage: null,\n    id: null,\n  };\n  const result = { ...importantFields };\n\n  Object.entries(item)\n    .sort()\n    .forEach(([key, value]) => {\n      result[key] = value;\n    });\n\n  Object.keys(importantFields).forEach((key) => {\n    if (result[key] === null) delete result[key];\n  });\n\n  return result;\n}\n\nexport function recordsSorter(a: Partial<ImportantFields>, b: Partial<ImportantFields>): number {\n  const importantFields = ['name', 'key', 'client_id', 'template'];\n\n  for (let i = 0; i < importantFields.length; i += 1) {\n    const key = importantFields[i];\n\n    if (a[key] && b[key]) {\n      return a[key] > b[key] ? 1 : -1;\n    }\n  }\n\n  return 0;\n}\n\nexport function clearTenantFlags(tenant: Asset): void {\n  if (tenant.flags && !Object.keys(tenant.flags).length) {\n    delete tenant.flags;\n  }\n}\n\nexport function ensureProp(obj: Asset, props: string): void {\n  const value = '';\n  if (!dotProp.has(obj, props)) {\n    dotProp.set(obj, props, value);\n  }\n}\n\nexport function clearClientArrays(client: Asset): Asset {\n  const propsToClear = ['allowed_clients', 'allowed_logout_urls', 'allowed_origins', 'callbacks'];\n  //If designated properties are null, set them as empty arrays instead\n  Object.keys(client).forEach((prop) => {\n    if (propsToClear.indexOf(prop) >= 0 && !client[prop]) {\n      //TODO: understand why setting as empty array instead of deleting null prop. Ex: `delete client[prop]`\n      client[prop] = [];\n    }\n  });\n\n  return client;\n}\n\nexport function convertClientIdToName(clientId: string, knownClients: Asset[] = []): string {\n  try {\n    const found = knownClients.find((c) => c.client_id === clientId);\n    return (found && found.name) || clientId;\n  } catch (e) {\n    return clientId;\n  }\n}\n\nexport function mapClientID2NameSorted(enabledClients: string[], knownClients: Asset[]): string[] {\n  return [\n    ...(enabledClients || []).map((clientId) => convertClientIdToName(clientId, knownClients)),\n  ].sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7aeb0e0a07c24a8db55ebb4f17f8d1b175b45419","contentHash":"beb5fbe827358a5a76a33aa25373858349eb846d393e56281b16ed5c6c7d50f9"},"/home/circleci/repo/src/context/yaml/handlers/index.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":16},"end":{"line":6,"column":51}},"4":{"start":{"line":7,"column":16},"end":{"line":7,"column":51}},"5":{"start":{"line":8,"column":16},"end":{"line":8,"column":51}},"6":{"start":{"line":9,"column":18},"end":{"line":9,"column":55}},"7":{"start":{"line":10,"column":17},"end":{"line":10,"column":53}},"8":{"start":{"line":11,"column":24},"end":{"line":11,"column":67}},"9":{"start":{"line":12,"column":22},"end":{"line":12,"column":63}},"10":{"start":{"line":13,"column":20},"end":{"line":13,"column":59}},"11":{"start":{"line":14,"column":25},"end":{"line":14,"column":69}},"12":{"start":{"line":15,"column":23},"end":{"line":15,"column":65}},"13":{"start":{"line":16,"column":23},"end":{"line":16,"column":65}},"14":{"start":{"line":17,"column":26},"end":{"line":17,"column":71}},"15":{"start":{"line":18,"column":26},"end":{"line":18,"column":71}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":87}},"17":{"start":{"line":20,"column":34},"end":{"line":20,"column":87}},"18":{"start":{"line":21,"column":42},"end":{"line":21,"column":103}},"19":{"start":{"line":22,"column":46},"end":{"line":22,"column":111}},"20":{"start":{"line":23,"column":27},"end":{"line":23,"column":73}},"21":{"start":{"line":24,"column":16},"end":{"line":24,"column":51}},"22":{"start":{"line":25,"column":24},"end":{"line":25,"column":67}},"23":{"start":{"line":26,"column":21},"end":{"line":26,"column":61}},"24":{"start":{"line":27,"column":18},"end":{"line":27,"column":55}},"25":{"start":{"line":28,"column":19},"end":{"line":28,"column":57}},"26":{"start":{"line":29,"column":27},"end":{"line":29,"column":73}},"27":{"start":{"line":30,"column":19},"end":{"line":30,"column":57}},"28":{"start":{"line":31,"column":21},"end":{"line":31,"column":61}},"29":{"start":{"line":32,"column":18},"end":{"line":32,"column":55}},"30":{"start":{"line":33,"column":24},"end":{"line":33,"column":67}},"31":{"start":{"line":34,"column":17},"end":{"line":34,"column":53}},"32":{"start":{"line":35,"column":21},"end":{"line":65,"column":1}},"33":{"start":{"line":66,"column":0},"end":{"line":66,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":29,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1},"f":{"0":29},"b":{"0":[1,1,1],"1":[29,0],"2":[29,29]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/index.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/index.ts"],"names":[],"mappings":";;;;;AAAA,oDAA4B;AAC5B,oDAA4B;AAC5B,oDAA4B;AAC5B,wDAAgC;AAChC,sDAA8B;AAC9B,oEAA4C;AAC5C,gEAAwC;AACxC,4DAAoC;AACpC,sEAA8C;AAC9C,kEAA0C;AAC1C,kEAA0C;AAC1C,wEAAgD;AAChD,wEAAgD;AAChD,wFAAgE;AAChE,wFAAgE;AAChE,wGAAgF;AAChF,gHAAwF;AACxF,0EAAkD;AAClD,oDAA4B;AAC5B,oEAA4C;AAC5C,8DAAsC;AACtC,wDAAgC;AAChC,0DAAkC;AAClC,0EAAkD;AAClD,0DAAkC;AAClC,8DAAsC;AACtC,wDAAgC;AAChC,oEAA4C;AAC5C,sDAA8B;AAU9B,MAAM,YAAY,GAAqE;IACrF,KAAK,EAAL,eAAK;IACL,KAAK,EAAL,eAAK;IACL,YAAY,EAAZ,sBAAY;IACZ,KAAK,EAAL,eAAK;IACL,SAAS,EAAT,mBAAS;IACT,YAAY,EAAZ,sBAAY;IACZ,eAAe,EAAf,yBAAe;IACf,OAAO,EAAP,iBAAO;IACP,WAAW,EAAX,qBAAW;IACX,MAAM,EAAN,gBAAM;IACN,aAAa,EAAb,uBAAa;IACb,cAAc,EAAd,wBAAc;IACd,eAAe,EAAf,yBAAe;IACf,uBAAuB,EAAvB,iCAAuB;IACvB,uBAAuB,EAAvB,iCAAuB;IACvB,KAAK,EAAL,eAAK;IACL,UAAU,EAAV,oBAAU;IACV,+BAA+B,EAA/B,yCAA+B;IAC/B,mCAAmC,EAAnC,6CAAmC;IACnC,gBAAgB,EAAhB,0BAAgB;IAChB,OAAO,EAAP,iBAAO;IACP,aAAa,EAAb,uBAAa;IACb,QAAQ,EAAR,kBAAQ;IACR,gBAAgB,EAAhB,0BAAgB;IAChB,QAAQ,EAAR,kBAAQ;IACR,UAAU,EAAV,oBAAU;IACV,OAAO,EAAP,iBAAO;IACP,aAAa,EAAb,uBAAa;IACb,MAAM,EAAN,gBAAM;CACP,CAAC;AAEF,kBAAe,YAAY,CAAC","sourcesContent":["import pages from './pages';\nimport rules from './rules';\nimport hooks from './hooks';\nimport clients from './clients';\nimport tenant from './tenant';\nimport emailProvider from './emailProvider';\nimport connections from './connections';\nimport databases from './databases';\nimport emailTemplates from './emailTemplates';\nimport clientGrants from './clientGrants';\nimport rulesConfigs from './rulesConfigs';\nimport resourceServers from './resourceServers';\nimport guardianFactors from './guardianFactors';\nimport guardianFactorProviders from './guardianFactorProviders';\nimport guardianFactorTemplates from './guardianFactorTemplates';\nimport guardianPhoneFactorMessageTypes from './guardianPhoneFactorMessageTypes';\nimport guardianPhoneFactorSelectedProvider from './guardianPhoneFactorSelectedProvider';\nimport guardianPolicies from './guardianPolicies';\nimport roles from './roles';\nimport organizations from './organizations';\nimport migrations from './migrations';\nimport actions from './actions';\nimport triggers from './triggers';\nimport attackProtection from './attackProtection';\nimport branding from './branding';\nimport logStreams from './logStreams';\nimport prompts from './prompts';\nimport customDomains from './customDomains';\nimport themes from './themes';\n\nimport YAMLContext from '..';\nimport { AssetTypes } from '../../../types';\n\nexport type YAMLHandler<T> = {\n  dump: (context: YAMLContext) => Promise<T>;\n  parse: (context: YAMLContext) => Promise<T>;\n};\n\nconst yamlHandlers: { [key in AssetTypes]: YAMLHandler<{ [key: string]: unknown }> } = {\n  rules,\n  hooks,\n  rulesConfigs,\n  pages,\n  databases,\n  clientGrants,\n  resourceServers,\n  clients,\n  connections,\n  tenant,\n  emailProvider,\n  emailTemplates,\n  guardianFactors,\n  guardianFactorProviders,\n  guardianFactorTemplates,\n  roles,\n  migrations,\n  guardianPhoneFactorMessageTypes,\n  guardianPhoneFactorSelectedProvider,\n  guardianPolicies,\n  actions,\n  organizations,\n  triggers,\n  attackProtection,\n  branding,\n  logStreams,\n  prompts,\n  customDomains,\n  themes,\n};\n\nexport default yamlHandlers;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"36ab6af67be290553a7452cd5c7a3e780d74a644","contentHash":"607b7ad2ffc0f009849895afa42ea72bd97288f22182110611c8a83473564358"},"/home/circleci/repo/src/context/yaml/handlers/pages.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/pages.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":17},"end":{"line":17,"column":60}},"18":{"start":{"line":19,"column":4},"end":{"line":29,"column":7}},"19":{"start":{"line":21,"column":26},"end":{"line":21,"column":40}},"20":{"start":{"line":22,"column":8},"end":{"line":23,"column":35}},"21":{"start":{"line":23,"column":12},"end":{"line":23,"column":35}},"22":{"start":{"line":24,"column":8},"end":{"line":28,"column":10}},"23":{"start":{"line":26,"column":40},"end":{"line":26,"column":134}},"24":{"start":{"line":32,"column":4},"end":{"line":49,"column":7}},"25":{"start":{"line":33,"column":20},"end":{"line":33,"column":40}},"26":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"27":{"start":{"line":35,"column":12},"end":{"line":35,"column":35}},"28":{"start":{"line":37,"column":28},"end":{"line":37,"column":74}},"29":{"start":{"line":38,"column":8},"end":{"line":38,"column":54}},"30":{"start":{"line":39,"column":8},"end":{"line":47,"column":11}},"31":{"start":{"line":40,"column":12},"end":{"line":42,"column":13}},"32":{"start":{"line":41,"column":16},"end":{"line":41,"column":28}},"33":{"start":{"line":43,"column":29},"end":{"line":43,"column":82}},"34":{"start":{"line":44,"column":12},"end":{"line":44,"column":57}},"35":{"start":{"line":45,"column":12},"end":{"line":45,"column":66}},"36":{"start":{"line":46,"column":12},"end":{"line":46,"column":97}},"37":{"start":{"line":48,"column":8},"end":{"line":48,"column":25}},"38":{"start":{"line":51,"column":21},"end":{"line":54,"column":1}},"39":{"start":{"line":55,"column":0},"end":{"line":55,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":18,"column":9},"end":{"line":18,"column":14}},"loc":{"start":{"line":18,"column":24},"end":{"line":30,"column":1}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":19,"column":43},"end":{"line":19,"column":44}},"loc":{"start":{"line":19,"column":56},"end":{"line":29,"column":5}},"line":19},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":29},"end":{"line":26,"column":30}},"loc":{"start":{"line":26,"column":40},"end":{"line":26,"column":134}},"line":26},"11":{"name":"dump","decl":{"start":{"line":31,"column":9},"end":{"line":31,"column":13}},"loc":{"start":{"line":31,"column":23},"end":{"line":50,"column":1}},"line":31},"12":{"name":"(anonymous_12)","decl":{"start":{"line":32,"column":43},"end":{"line":32,"column":44}},"loc":{"start":{"line":32,"column":56},"end":{"line":49,"column":5}},"line":32},"13":{"name":"(anonymous_13)","decl":{"start":{"line":39,"column":26},"end":{"line":39,"column":27}},"loc":{"start":{"line":39,"column":36},"end":{"line":47,"column":9}},"line":39}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":8},"end":{"line":23,"column":35}},"type":"if","locations":[{"start":{"line":22,"column":8},"end":{"line":23,"column":35}},{"start":{"line":22,"column":8},"end":{"line":23,"column":35}}],"line":22},"9":{"loc":{"start":{"line":26,"column":87},"end":{"line":26,"column":131}},"type":"cond-expr","locations":[{"start":{"line":26,"column":99},"end":{"line":26,"column":126}},{"start":{"line":26,"column":129},"end":{"line":26,"column":131}}],"line":26},"10":{"loc":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},{"start":{"line":34,"column":8},"end":{"line":36,"column":9}}],"line":34},"11":{"loc":{"start":{"line":40,"column":12},"end":{"line":42,"column":13}},"type":"if","locations":[{"start":{"line":40,"column":12},"end":{"line":42,"column":13}},{"start":{"line":40,"column":12},"end":{"line":42,"column":13}}],"line":40}},"s":{"0":1,"1":0,"2":0,"3":49,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":49,"11":49,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":41,"19":41,"20":41,"21":39,"22":2,"23":5,"24":8,"25":8,"26":8,"27":0,"28":8,"29":8,"30":8,"31":11,"32":2,"33":9,"34":9,"35":9,"36":9,"37":8,"38":1,"39":1},"f":{"0":49,"1":0,"2":0,"3":49,"4":0,"5":0,"6":49,"7":3,"8":41,"9":41,"10":5,"11":8,"12":8,"13":11},"b":{"0":[1,1,1],"1":[0,0],"2":[49,49],"3":[49,0],"4":[49,49],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[39,2],"9":[4,1],"10":[0,8],"11":[2,9]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/pages.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/pages.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAE1B,6DAAkC;AAQlC,SAAe,KAAK,CAAC,OAAoB;;QACvC,mCAAmC;QACnC,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEjC,IAAI,CAAC,KAAK;YAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;QAEnC,OAAO;YACL,KAAK,EAAE;gBACL,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,iCAClB,IAAI,KACP,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,IAClD,CAAC;aACJ;SACF,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,IAAI,KAAK,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QAEjC,IAAI,CAAC,KAAK,EAAE;YACV,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;SACxB;QAED,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACzD,kBAAE,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QAE9B,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;YACzB,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS,EAAE;gBAC3B,OAAO,IAAI,CAAC;aACb;YAED,MAAM,QAAQ,GAAG,cAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,IAAI,OAAO,CAAC,CAAC;YAC7D,gBAAG,CAAC,IAAI,CAAC,WAAW,QAAQ,EAAE,CAAC,CAAC;YAChC,kBAAE,CAAC,aAAa,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;YACtC,uCACK,IAAI,KACP,IAAI,EAAE,WAAW,IAAI,CAAC,IAAI,OAAO,IACjC;QACJ,CAAC,CAAC,CAAC;QAEH,OAAO,EAAE,KAAK,EAAE,CAAC;IACnB,CAAC;CAAA;AAED,MAAM,YAAY,GAA6B;IAC7C,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,YAAY,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\n\nimport log from '../../../logger';\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { Page } from '../../../tools/auth0/handlers/pages';\n\ntype ParsedPages = ParsedAsset<'pages', Page[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedPages> {\n  // Load the HTML file for each page\n  const { pages } = context.assets;\n\n  if (!pages) return { pages: null };\n\n  return {\n    pages: [\n      ...pages.map((page) => ({\n        ...page,\n        html: page.html ? context.loadFile(page.html) : '',\n      })),\n    ],\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedPages> {\n  let pages = context.assets.pages;\n\n  if (!pages) {\n    return { pages: null };\n  }\n\n  const pagesFolder = path.join(context.basePath, 'pages');\n  fs.ensureDirSync(pagesFolder);\n\n  pages = pages.map((page) => {\n    if (page.html === undefined) {\n      return page;\n    }\n\n    const htmlFile = path.join(pagesFolder, `${page.name}.html`);\n    log.info(`Writing ${htmlFile}`);\n    fs.writeFileSync(htmlFile, page.html);\n    return {\n      ...page,\n      html: `./pages/${page.name}.html`,\n    };\n  });\n\n  return { pages };\n}\n\nconst pagesHandler: YAMLHandler<ParsedPages> = {\n  parse,\n  dump,\n};\n\nexport default pagesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7f3856c617a6468e917e0d494ba85dd0522b0066","contentHash":"c21cd9f23b4de20d9a5e3cb25b17cf49846316e37f648c92b37bed2c528b7b11"},"/home/circleci/repo/src/context/yaml/handlers/rules.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/rules.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":20,"column":4},"end":{"line":29,"column":7}},"20":{"start":{"line":21,"column":26},"end":{"line":21,"column":40}},"21":{"start":{"line":22,"column":8},"end":{"line":23,"column":35}},"22":{"start":{"line":23,"column":12},"end":{"line":23,"column":35}},"23":{"start":{"line":24,"column":8},"end":{"line":28,"column":10}},"24":{"start":{"line":26,"column":40},"end":{"line":26,"column":121}},"25":{"start":{"line":32,"column":4},"end":{"line":49,"column":7}},"26":{"start":{"line":33,"column":24},"end":{"line":33,"column":38}},"27":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"28":{"start":{"line":35,"column":12},"end":{"line":35,"column":35}},"29":{"start":{"line":38,"column":28},"end":{"line":38,"column":74}},"30":{"start":{"line":39,"column":8},"end":{"line":39,"column":54}},"31":{"start":{"line":40,"column":8},"end":{"line":47,"column":11}},"32":{"start":{"line":42,"column":31},"end":{"line":42,"column":71}},"33":{"start":{"line":43,"column":31},"end":{"line":43,"column":75}},"34":{"start":{"line":44,"column":12},"end":{"line":44,"column":59}},"35":{"start":{"line":45,"column":12},"end":{"line":45,"column":70}},"36":{"start":{"line":46,"column":12},"end":{"line":46,"column":95}},"37":{"start":{"line":48,"column":8},"end":{"line":48,"column":25}},"38":{"start":{"line":51,"column":21},"end":{"line":54,"column":1}},"39":{"start":{"line":55,"column":0},"end":{"line":55,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":30,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":20,"column":43},"end":{"line":20,"column":44}},"loc":{"start":{"line":20,"column":56},"end":{"line":29,"column":5}},"line":20},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":29},"end":{"line":26,"column":30}},"loc":{"start":{"line":26,"column":40},"end":{"line":26,"column":121}},"line":26},"11":{"name":"dump","decl":{"start":{"line":31,"column":9},"end":{"line":31,"column":13}},"loc":{"start":{"line":31,"column":23},"end":{"line":50,"column":1}},"line":31},"12":{"name":"(anonymous_12)","decl":{"start":{"line":32,"column":43},"end":{"line":32,"column":44}},"loc":{"start":{"line":32,"column":56},"end":{"line":49,"column":5}},"line":32},"13":{"name":"(anonymous_13)","decl":{"start":{"line":40,"column":26},"end":{"line":40,"column":27}},"loc":{"start":{"line":40,"column":36},"end":{"line":47,"column":9}},"line":40}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":8},"end":{"line":23,"column":35}},"type":"if","locations":[{"start":{"line":22,"column":8},"end":{"line":23,"column":35}},{"start":{"line":22,"column":8},"end":{"line":23,"column":35}}],"line":22},"9":{"loc":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},{"start":{"line":34,"column":8},"end":{"line":36,"column":9}}],"line":34}},"s":{"0":1,"1":0,"2":0,"3":47,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":47,"11":47,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":41,"20":41,"21":41,"22":39,"23":2,"24":1,"25":6,"26":6,"27":6,"28":0,"29":6,"30":6,"31":6,"32":2,"33":2,"34":2,"35":2,"36":2,"37":6,"38":1,"39":1},"f":{"0":47,"1":0,"2":0,"3":47,"4":0,"5":0,"6":47,"7":3,"8":41,"9":41,"10":1,"11":6,"12":6,"13":2},"b":{"0":[1,1,1],"1":[0,0],"2":[47,47],"3":[47,0],"4":[47,47],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[39,2],"9":[0,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/rules.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/rules.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAE1B,0CAA0C;AAC1C,6DAAkC;AAQlC,SAAe,KAAK,CAAC,OAAoB;;QACvC,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEjC,IAAI,CAAC,KAAK;YAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;QAEnC,OAAO;YACL,KAAK,EAAE;gBACL,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,iCAClB,IAAI,KACP,MAAM,EAAE,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,IACrC,CAAC;aACJ;SACF,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,IAAI,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE/B,IAAI,CAAC,KAAK,EAAE;YACV,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;SACxB;QAED,sBAAsB;QACtB,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACzD,kBAAE,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QAE9B,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;YACzB,oBAAoB;YACpB,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,GAAG,IAAI,CAAC,IAAI,KAAK,CAAC,CAAC;YAC/C,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC;YACtD,gBAAG,CAAC,IAAI,CAAC,WAAW,UAAU,EAAE,CAAC,CAAC;YAClC,kBAAE,CAAC,aAAa,CAAC,UAAU,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YAC1C,uCAAY,IAAI,KAAE,MAAM,EAAE,WAAW,UAAU,EAAE,IAAG;QACtD,CAAC,CAAC,CAAC;QAEH,OAAO,EAAE,KAAK,EAAE,CAAC;IACnB,CAAC;CAAA;AAED,MAAM,YAAY,GAA6B;IAC7C,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,YAAY,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\n\nimport { sanitize } from '../../../utils';\nimport log from '../../../logger';\n\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedRules = ParsedAsset<'rules', Asset[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedRules> {\n  const { rules } = context.assets;\n\n  if (!rules) return { rules: null };\n\n  return {\n    rules: [\n      ...rules.map((rule) => ({\n        ...rule,\n        script: context.loadFile(rule.script),\n      })),\n    ],\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedRules> {\n  let { rules } = context.assets;\n\n  if (!rules) {\n    return { rules: null };\n  }\n\n  // Create Rules folder\n  const rulesFolder = path.join(context.basePath, 'rules');\n  fs.ensureDirSync(rulesFolder);\n\n  rules = rules.map((rule) => {\n    // Dump rule to file\n    const scriptName = sanitize(`${rule.name}.js`);\n    const scriptFile = path.join(rulesFolder, scriptName);\n    log.info(`Writing ${scriptFile}`);\n    fs.writeFileSync(scriptFile, rule.script);\n    return { ...rule, script: `./rules/${scriptName}` };\n  });\n\n  return { rules };\n}\n\nconst rulesHandler: YAMLHandler<ParsedRules> = {\n  parse,\n  dump,\n};\n\nexport default rulesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1ebfaaee956bc01793b5f8a633de424191897e35","contentHash":"59cb976da7b93658c5c2cfb4ded0b4029427f062b79207f3cc20758a407d179c"},"/home/circleci/repo/src/context/yaml/handlers/hooks.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/hooks.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":19,"column":17},"end":{"line":19,"column":60}},"20":{"start":{"line":21,"column":4},"end":{"line":37,"column":7}},"21":{"start":{"line":22,"column":26},"end":{"line":22,"column":40}},"22":{"start":{"line":23,"column":8},"end":{"line":24,"column":35}},"23":{"start":{"line":24,"column":12},"end":{"line":24,"column":35}},"24":{"start":{"line":25,"column":8},"end":{"line":36,"column":10}},"25":{"start":{"line":28,"column":20},"end":{"line":31,"column":21}},"26":{"start":{"line":30,"column":24},"end":{"line":30,"column":103}},"27":{"start":{"line":32,"column":20},"end":{"line":32,"column":76}},"28":{"start":{"line":33,"column":20},"end":{"line":33,"column":51}},"29":{"start":{"line":40,"column":4},"end":{"line":59,"column":7}},"30":{"start":{"line":41,"column":20},"end":{"line":41,"column":40}},"31":{"start":{"line":42,"column":8},"end":{"line":44,"column":9}},"32":{"start":{"line":43,"column":12},"end":{"line":43,"column":35}},"33":{"start":{"line":46,"column":28},"end":{"line":46,"column":74}},"34":{"start":{"line":47,"column":8},"end":{"line":47,"column":54}},"35":{"start":{"line":48,"column":8},"end":{"line":57,"column":11}},"36":{"start":{"line":51,"column":12},"end":{"line":51,"column":45}},"37":{"start":{"line":52,"column":29},"end":{"line":52,"column":69}},"38":{"start":{"line":53,"column":29},"end":{"line":53,"column":71}},"39":{"start":{"line":54,"column":12},"end":{"line":54,"column":57}},"40":{"start":{"line":55,"column":12},"end":{"line":55,"column":68}},"41":{"start":{"line":56,"column":12},"end":{"line":56,"column":93}},"42":{"start":{"line":58,"column":8},"end":{"line":58,"column":25}},"43":{"start":{"line":61,"column":21},"end":{"line":64,"column":1}},"44":{"start":{"line":65,"column":0},"end":{"line":65,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":38,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":21,"column":43},"end":{"line":21,"column":44}},"loc":{"start":{"line":21,"column":56},"end":{"line":37,"column":5}},"line":21},"10":{"name":"(anonymous_10)","decl":{"start":{"line":27,"column":29},"end":{"line":27,"column":30}},"loc":{"start":{"line":27,"column":39},"end":{"line":34,"column":17}},"line":27},"11":{"name":"dump","decl":{"start":{"line":39,"column":9},"end":{"line":39,"column":13}},"loc":{"start":{"line":39,"column":23},"end":{"line":60,"column":1}},"line":39},"12":{"name":"(anonymous_12)","decl":{"start":{"line":40,"column":43},"end":{"line":40,"column":44}},"loc":{"start":{"line":40,"column":56},"end":{"line":59,"column":5}},"line":40},"13":{"name":"(anonymous_13)","decl":{"start":{"line":48,"column":26},"end":{"line":48,"column":27}},"loc":{"start":{"line":48,"column":36},"end":{"line":57,"column":9}},"line":48}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":23,"column":8},"end":{"line":24,"column":35}},"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":24,"column":35}},{"start":{"line":23,"column":8},"end":{"line":24,"column":35}}],"line":23},"9":{"loc":{"start":{"line":28,"column":20},"end":{"line":31,"column":21}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":31,"column":21}},{"start":{"line":28,"column":20},"end":{"line":31,"column":21}}],"line":28},"10":{"loc":{"start":{"line":42,"column":8},"end":{"line":44,"column":9}},"type":"if","locations":[{"start":{"line":42,"column":8},"end":{"line":44,"column":9}},{"start":{"line":42,"column":8},"end":{"line":44,"column":9}}],"line":42},"11":{"loc":{"start":{"line":51,"column":24},"end":{"line":51,"column":44}},"type":"binary-expr","locations":[{"start":{"line":51,"column":24},"end":{"line":51,"column":33}},{"start":{"line":51,"column":37},"end":{"line":51,"column":44}}],"line":51}},"s":{"0":1,"1":0,"2":0,"3":47,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":47,"11":47,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":41,"21":41,"22":41,"23":39,"24":2,"25":1,"26":1,"27":1,"28":1,"29":6,"30":6,"31":6,"32":0,"33":6,"34":6,"35":6,"36":3,"37":3,"38":3,"39":3,"40":3,"41":3,"42":6,"43":1,"44":1},"f":{"0":47,"1":0,"2":0,"3":47,"4":0,"5":0,"6":47,"7":3,"8":41,"9":41,"10":1,"11":6,"12":6,"13":3},"b":{"0":[1,1,1],"1":[0,0],"2":[47,47],"3":[47,0],"4":[47,47],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[39,2],"9":[1,0],"10":[0,6],"11":[3,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/hooks.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/hooks.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAE3C,0CAA0C;AAC1C,6DAAkC;AAQlC,SAAe,KAAK,CAAC,OAAoB;;QACvC,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QACjC,IAAI,CAAC,KAAK;YAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;QAEnC,OAAO;YACL,KAAK,EAAE;gBACL,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;oBACpB,IAAI,IAAI,CAAC,MAAM,EAAE;wBACf,iGAAiG;wBACjG,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,iBAAS,CAAC,eAAe,CAAC,CAAC;qBACxE;oBAED,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;oBAExD,yBAAY,IAAI,EAAG;gBACrB,CAAC,CAAC;aACH;SACF,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,IAAI,KAAK,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QAEjC,IAAI,CAAC,KAAK,EAAE;YACV,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;SACxB;QAED,sBAAsB;QACtB,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACzD,kBAAE,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QAE9B,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;YACzB,yBAAyB;YACzB,wDAAwD;YACxD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,EAAE,CAAC;YACjC,MAAM,QAAQ,GAAG,IAAA,gBAAQ,EAAC,GAAG,IAAI,CAAC,IAAI,KAAK,CAAC,CAAC;YAC7C,MAAM,QAAQ,GAAG,cAAI,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;YAClD,gBAAG,CAAC,IAAI,CAAC,WAAW,QAAQ,EAAE,CAAC,CAAC;YAChC,kBAAE,CAAC,aAAa,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YAExC,uCAAY,IAAI,KAAE,MAAM,EAAE,WAAW,QAAQ,EAAE,IAAG;QACpD,CAAC,CAAC,CAAC;QAEH,OAAO,EAAE,KAAK,EAAE,CAAC;IACnB,CAAC;CAAA;AAED,MAAM,YAAY,GAA6B;IAC7C,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,YAAY,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport { sanitize } from '../../../utils';\nimport log from '../../../logger';\n\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedHooks = ParsedAsset<'hooks', Asset[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedHooks> {\n  const { hooks } = context.assets;\n  if (!hooks) return { hooks: null };\n\n  return {\n    hooks: [\n      ...hooks.map((hook) => {\n        if (hook.script) {\n          //@ts-ignore TODO: understand why two arguments are passed when context.loadFile only accepts one\n          hook.script = context.loadFile(hook.script, constants.HOOKS_DIRECTORY);\n        }\n\n        hook.name = hook.name.toLowerCase().replace(/\\s/g, '-');\n\n        return { ...hook };\n      }),\n    ],\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedHooks> {\n  let hooks = context.assets.hooks;\n\n  if (!hooks) {\n    return { hooks: null };\n  }\n\n  // Create hooks folder\n  const hooksFolder = path.join(context.basePath, 'hooks');\n  fs.ensureDirSync(hooksFolder);\n\n  hooks = hooks.map((hook) => {\n    // Dump hook code to file\n    // For cases when hook does not have `meta['hook-name']`\n    hook.name = hook.name || hook.id;\n    const codeName = sanitize(`${hook.name}.js`);\n    const codeFile = path.join(hooksFolder, codeName);\n    log.info(`Writing ${codeFile}`);\n    fs.writeFileSync(codeFile, hook.script);\n\n    return { ...hook, script: `./hooks/${codeName}` };\n  });\n\n  return { hooks };\n}\n\nconst hooksHandler: YAMLHandler<ParsedHooks> = {\n  parse,\n  dump,\n};\n\nexport default hooksHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"81750c83cb8ae022dab30953af0f8a129fa5cc94","contentHash":"02d66276f5dbcf33190fadcd2a0f31a2cc4dd0d673c413985029a20396674c54"},"/home/circleci/repo/src/context/yaml/handlers/clients.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/clients.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"20":{"start":{"line":21,"column":4},"end":{"line":41,"column":7}},"21":{"start":{"line":23,"column":28},"end":{"line":23,"column":42}},"22":{"start":{"line":24,"column":30},"end":{"line":24,"column":104}},"23":{"start":{"line":25,"column":8},"end":{"line":27,"column":9}},"24":{"start":{"line":26,"column":12},"end":{"line":26,"column":37}},"25":{"start":{"line":28,"column":8},"end":{"line":40,"column":10}},"26":{"start":{"line":31,"column":20},"end":{"line":36,"column":21}},"27":{"start":{"line":32,"column":45},"end":{"line":32,"column":105}},"28":{"start":{"line":33,"column":24},"end":{"line":35,"column":25}},"29":{"start":{"line":34,"column":28},"end":{"line":34,"column":86}},"30":{"start":{"line":37,"column":20},"end":{"line":37,"column":34}},"31":{"start":{"line":44,"column":4},"end":{"line":66,"column":7}},"32":{"start":{"line":46,"column":30},"end":{"line":46,"column":104}},"33":{"start":{"line":47,"column":28},"end":{"line":47,"column":42}},"34":{"start":{"line":48,"column":8},"end":{"line":49,"column":37}},"35":{"start":{"line":49,"column":12},"end":{"line":49,"column":37}},"36":{"start":{"line":50,"column":8},"end":{"line":65,"column":10}},"37":{"start":{"line":53,"column":20},"end":{"line":61,"column":21}},"38":{"start":{"line":54,"column":43},"end":{"line":54,"column":77}},"39":{"start":{"line":55,"column":37},"end":{"line":55,"column":61}},"40":{"start":{"line":56,"column":48},"end":{"line":56,"column":122}},"41":{"start":{"line":57,"column":24},"end":{"line":57,"column":76}},"42":{"start":{"line":58,"column":24},"end":{"line":58,"column":72}},"43":{"start":{"line":59,"column":24},"end":{"line":59,"column":80}},"44":{"start":{"line":60,"column":24},"end":{"line":60,"column":92}},"45":{"start":{"line":62,"column":20},"end":{"line":62,"column":66}},"46":{"start":{"line":68,"column":23},"end":{"line":71,"column":1}},"47":{"start":{"line":72,"column":0},"end":{"line":72,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":42,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":21,"column":43},"end":{"line":21,"column":44}},"loc":{"start":{"line":21,"column":56},"end":{"line":41,"column":5}},"line":21},"10":{"name":"(anonymous_10)","decl":{"start":{"line":30,"column":31},"end":{"line":30,"column":32}},"loc":{"start":{"line":30,"column":43},"end":{"line":38,"column":17}},"line":30},"11":{"name":"dump","decl":{"start":{"line":43,"column":9},"end":{"line":43,"column":13}},"loc":{"start":{"line":43,"column":23},"end":{"line":67,"column":1}},"line":43},"12":{"name":"(anonymous_12)","decl":{"start":{"line":44,"column":43},"end":{"line":44,"column":44}},"loc":{"start":{"line":44,"column":56},"end":{"line":66,"column":5}},"line":44},"13":{"name":"(anonymous_13)","decl":{"start":{"line":52,"column":31},"end":{"line":52,"column":32}},"loc":{"start":{"line":52,"column":43},"end":{"line":63,"column":17}},"line":52}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":25,"column":8},"end":{"line":27,"column":9}},"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":27,"column":9}},{"start":{"line":25,"column":8},"end":{"line":27,"column":9}}],"line":25},"9":{"loc":{"start":{"line":31,"column":20},"end":{"line":36,"column":21}},"type":"if","locations":[{"start":{"line":31,"column":20},"end":{"line":36,"column":21}},{"start":{"line":31,"column":20},"end":{"line":36,"column":21}}],"line":31},"10":{"loc":{"start":{"line":33,"column":24},"end":{"line":35,"column":25}},"type":"if","locations":[{"start":{"line":33,"column":24},"end":{"line":35,"column":25}},{"start":{"line":33,"column":24},"end":{"line":35,"column":25}}],"line":33},"11":{"loc":{"start":{"line":48,"column":8},"end":{"line":49,"column":37}},"type":"if","locations":[{"start":{"line":48,"column":8},"end":{"line":49,"column":37}},{"start":{"line":48,"column":8},"end":{"line":49,"column":37}}],"line":48},"12":{"loc":{"start":{"line":53,"column":20},"end":{"line":61,"column":21}},"type":"if","locations":[{"start":{"line":53,"column":20},"end":{"line":61,"column":21}},{"start":{"line":53,"column":20},"end":{"line":61,"column":21}}],"line":53}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":41,"21":41,"22":41,"23":41,"24":40,"25":1,"26":3,"27":1,"28":1,"29":1,"30":3,"31":5,"32":5,"33":5,"34":5,"35":0,"36":5,"37":6,"38":5,"39":5,"40":5,"41":5,"42":5,"43":5,"44":5,"45":6,"46":1,"47":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":3,"8":41,"9":41,"10":3,"11":5,"12":5,"13":6},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[40,1],"9":[1,2],"10":[1,0],"11":[0,5],"12":[5,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/clients.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/clients.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAC3C,6DAAkC;AAClC,0CAAqE;AAQrE,SAAe,KAAK,CAAC,OAAoB;;QACvC,2CAA2C;QAE3C,MAAM,EAAE,OAAO,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QACnC,MAAM,aAAa,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,iBAAiB,CAAC,CAAC;QAE/E,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;SAC1B;QAED,OAAO;YACL,OAAO,EAAE;gBACP,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE;oBACxB,IAAI,MAAM,CAAC,iBAAiB,EAAE;wBAC5B,MAAM,YAAY,GAAG,cAAI,CAAC,IAAI,CAAC,aAAa,EAAE,MAAM,CAAC,iBAAiB,CAAC,CAAC;wBAExE,IAAI,IAAA,cAAM,EAAC,YAAY,CAAC,EAAE;4BACxB,MAAM,CAAC,iBAAiB,GAAG,OAAO,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;yBAC3D;qBACF;oBAED,OAAO,MAAM,CAAC;gBAChB,CAAC,CAAC;aACH;SACF,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,iDAAiD;QACjD,MAAM,aAAa,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,iBAAiB,CAAC,CAAC;QAE/E,MAAM,EAAE,OAAO,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QACnC,IAAI,CAAC,OAAO;YAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;QAEvC,OAAO;YACL,OAAO,EAAE;gBACP,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE;oBACxB,IAAI,MAAM,CAAC,iBAAiB,EAAE;wBAC5B,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC;wBACzC,MAAM,IAAI,GAAG,MAAM,CAAC,iBAAiB,CAAC;wBACtC,MAAM,eAAe,GAAG,cAAI,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,UAAU,yBAAyB,CAAC,CAAC;wBAEzF,gBAAG,CAAC,IAAI,CAAC,WAAW,eAAe,EAAE,CAAC,CAAC;wBACvC,kBAAE,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;wBAChC,kBAAE,CAAC,aAAa,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;wBAExC,MAAM,CAAC,iBAAiB,GAAG,KAAK,UAAU,yBAAyB,CAAC;qBACrE;oBAED,OAAO,IAAA,yBAAiB,EAAC,MAAM,CAAW,CAAC;gBAC7C,CAAC,CAAC;aACH;SACF,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,cAAc,GAA+B;IACjD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,cAAc,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport log from '../../../logger';\nimport { isFile, sanitize, clearClientArrays } from '../../../utils';\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { Client } from '../../../tools/auth0/handlers/clients';\n\ntype ParsedClients = ParsedAsset<'clients', Client[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedClients> {\n  // Load the HTML file for custom_login_page\n\n  const { clients } = context.assets;\n  const clientsFolder = path.join(context.basePath, constants.CLIENTS_DIRECTORY);\n\n  if (!clients) {\n    return { clients: null };\n  }\n\n  return {\n    clients: [\n      ...clients.map((client) => {\n        if (client.custom_login_page) {\n          const htmlFileName = path.join(clientsFolder, client.custom_login_page);\n\n          if (isFile(htmlFileName)) {\n            client.custom_login_page = context.loadFile(htmlFileName);\n          }\n        }\n\n        return client;\n      }),\n    ],\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedClients> {\n  // Save custom_login_page to a separate html file\n  const clientsFolder = path.join(context.basePath, constants.CLIENTS_DIRECTORY);\n\n  const { clients } = context.assets;\n  if (!clients) return { clients: null };\n\n  return {\n    clients: [\n      ...clients.map((client) => {\n        if (client.custom_login_page) {\n          const clientName = sanitize(client.name);\n          const html = client.custom_login_page;\n          const customLoginHtml = path.join(clientsFolder, `${clientName}_custom_login_page.html`);\n\n          log.info(`Writing ${customLoginHtml}`);\n          fs.ensureDirSync(clientsFolder);\n          fs.writeFileSync(customLoginHtml, html);\n\n          client.custom_login_page = `./${clientName}_custom_login_page.html`;\n        }\n\n        return clearClientArrays(client) as Client;\n      }),\n    ],\n  };\n}\n\nconst clientsHandler: YAMLHandler<ParsedClients> = {\n  parse,\n  dump,\n};\n\nexport default clientsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"84d19c93a252d72245988657eb31322f4f1ea94b","contentHash":"6fe62353596f77125184061e9549d8b9d89946bfe324862ece4c68abcb271b4e"},"/home/circleci/repo/src/context/yaml/handlers/tenant.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/tenant.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":14}},"14":{"start":{"line":13,"column":4},"end":{"line":14,"column":20}},"15":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"16":{"start":{"line":14,"column":8},"end":{"line":14,"column":20}},"17":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"18":{"start":{"line":16,"column":8},"end":{"line":19,"column":9}},"19":{"start":{"line":16,"column":21},"end":{"line":16,"column":22}},"20":{"start":{"line":16,"column":28},"end":{"line":16,"column":59}},"21":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"22":{"start":{"line":18,"column":16},"end":{"line":18,"column":34}},"23":{"start":{"line":20,"column":4},"end":{"line":20,"column":13}},"24":{"start":{"line":22,"column":0},"end":{"line":22,"column":62}},"25":{"start":{"line":23,"column":16},"end":{"line":23,"column":41}},"26":{"start":{"line":24,"column":36},"end":{"line":24,"column":81}},"27":{"start":{"line":26,"column":4},"end":{"line":36,"column":7}},"28":{"start":{"line":27,"column":8},"end":{"line":28,"column":36}},"29":{"start":{"line":28,"column":12},"end":{"line":28,"column":36}},"30":{"start":{"line":30,"column":19},"end":{"line":30,"column":40}},"31":{"start":{"line":30,"column":88},"end":{"line":30,"column":90}},"32":{"start":{"line":30,"column":101},"end":{"line":30,"column":158}},"33":{"start":{"line":31,"column":8},"end":{"line":31,"column":46}},"34":{"start":{"line":32,"column":33},"end":{"line":32,"column":136}},"35":{"start":{"line":33,"column":8},"end":{"line":35,"column":10}},"36":{"start":{"line":39,"column":4},"end":{"line":45,"column":7}},"37":{"start":{"line":40,"column":23},"end":{"line":40,"column":44}},"38":{"start":{"line":41,"column":8},"end":{"line":42,"column":36}},"39":{"start":{"line":42,"column":12},"end":{"line":42,"column":36}},"40":{"start":{"line":43,"column":8},"end":{"line":43,"column":46}},"41":{"start":{"line":44,"column":8},"end":{"line":44,"column":26}},"42":{"start":{"line":47,"column":22},"end":{"line":50,"column":1}},"43":{"start":{"line":51,"column":0},"end":{"line":51,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":38},"end":{"line":11,"column":39}},"loc":{"start":{"line":11,"column":54},"end":{"line":21,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":25,"column":9},"end":{"line":25,"column":14}},"loc":{"start":{"line":25,"column":24},"end":{"line":37,"column":1}},"line":25},"9":{"name":"(anonymous_9)","decl":{"start":{"line":26,"column":43},"end":{"line":26,"column":44}},"loc":{"start":{"line":26,"column":56},"end":{"line":36,"column":5}},"line":26},"10":{"name":"dump","decl":{"start":{"line":38,"column":9},"end":{"line":38,"column":13}},"loc":{"start":{"line":38,"column":23},"end":{"line":46,"column":1}},"line":38},"11":{"name":"(anonymous_11)","decl":{"start":{"line":39,"column":43},"end":{"line":39,"column":44}},"loc":{"start":{"line":39,"column":56},"end":{"line":45,"column":5}},"line":39}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":14},"end":{"line":11,"column":18}},{"start":{"line":11,"column":22},"end":{"line":11,"column":33}},{"start":{"line":11,"column":38},"end":{"line":21,"column":1}}],"line":11},"6":{"loc":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"type":"if","locations":[{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},{"start":{"line":13,"column":21},"end":{"line":14,"column":20}}],"line":13},"7":{"loc":{"start":{"line":13,"column":25},"end":{"line":13,"column":87}},"type":"binary-expr","locations":[{"start":{"line":13,"column":25},"end":{"line":13,"column":67}},{"start":{"line":13,"column":71},"end":{"line":13,"column":87}}],"line":13},"8":{"loc":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"type":"if","locations":[{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},{"start":{"line":15,"column":4},"end":{"line":19,"column":9}}],"line":15},"9":{"loc":{"start":{"line":15,"column":8},"end":{"line":15,"column":71}},"type":"binary-expr","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":17}},{"start":{"line":15,"column":21},"end":{"line":15,"column":71}}],"line":15},"10":{"loc":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},{"start":{"line":17,"column":12},"end":{"line":18,"column":34}}],"line":17},"11":{"loc":{"start":{"line":17,"column":16},"end":{"line":17,"column":90}},"type":"binary-expr","locations":[{"start":{"line":17,"column":16},"end":{"line":17,"column":35}},{"start":{"line":17,"column":39},"end":{"line":17,"column":90}}],"line":17},"12":{"loc":{"start":{"line":27,"column":8},"end":{"line":28,"column":36}},"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":28,"column":36}},{"start":{"line":27,"column":8},"end":{"line":28,"column":36}}],"line":27},"13":{"loc":{"start":{"line":41,"column":8},"end":{"line":42,"column":36}},"type":"if","locations":[{"start":{"line":41,"column":8},"end":{"line":42,"column":36}},{"start":{"line":41,"column":8},"end":{"line":42,"column":36}}],"line":41}},"s":{"0":1,"1":0,"2":0,"3":48,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":48,"11":48,"12":1,"13":4,"14":4,"15":11,"16":9,"17":4,"18":4,"19":4,"20":4,"21":0,"22":0,"23":4,"24":1,"25":1,"26":1,"27":41,"28":41,"29":37,"30":4,"31":4,"32":4,"33":4,"34":4,"35":4,"36":7,"37":7,"38":7,"39":0,"40":7,"41":7,"42":1,"43":1},"f":{"0":48,"1":0,"2":0,"3":48,"4":0,"5":0,"6":48,"7":4,"8":41,"9":41,"10":7,"11":7},"b":{"0":[1,1,1],"1":[0,0],"2":[48,48],"3":[48,0],"4":[48,48],"5":[1,1,1],"6":[9,2],"7":[11,11],"8":[4,0],"9":[4,4],"10":[0,0],"11":[0,0],"12":[37,4],"13":[0,7]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/tenant.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/tenant.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,0CAAkD;AAClD,kFAA+E;AAO/E,SAAe,KAAK,CAAC,OAAoB;;QACvC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM;YAAE,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;QAEpD,8BAA8B;QAC9B,MAAM,KAQF,OAAO,CAAC,MAAM,CAAC,MAAM,EARnB,EACJ,gBAAgB,EAChB,qBAAqB,OAME,EALpB,MAAM,cAHL,6CAIL,CAIwB,CAAC;QAE1B,IAAA,wBAAgB,EAAC,MAAM,CAAC,CAAC;QAEzB,MAAM,gBAAgB,GAAG,IAAA,qDAAyB,EAAC,EAAE,gBAAgB,EAAE,qBAAqB,EAAE,CAAC,CAAC;QAEhG,OAAO;YACL,MAAM,kCACD,MAAM,GACN,gBAAgB,CACpB;SACF,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,MAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC;QAErC,IAAI,CAAC,MAAM;YAAE,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;QAErC,IAAA,wBAAgB,EAAC,MAAM,CAAC,CAAC;QAEzB,OAAO,EAAE,MAAM,EAAE,CAAC;IACpB,CAAC;CAAA;AAED,MAAM,aAAa,GAA8B;IAC/C,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,aAAa,CAAC","sourcesContent":["import { clearTenantFlags } from '../../../utils';\nimport { sessionDurationsToMinutes } from '../../../sessionDurationsToMinutes';\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedTenant = ParsedAsset<'tenant', Asset>;\n\nasync function parse(context: YAMLContext): Promise<ParsedTenant> {\n  if (!context.assets.tenant) return { tenant: null };\n\n  /* eslint-disable camelcase */\n  const {\n    session_lifetime,\n    idle_session_lifetime,\n    ...tenant\n  }: {\n    session_lifetime?: number;\n    idle_session_lifetime?: number;\n    [key: string]: any;\n  } = context.assets.tenant;\n\n  clearTenantFlags(tenant);\n\n  const sessionDurations = sessionDurationsToMinutes({ session_lifetime, idle_session_lifetime });\n\n  return {\n    tenant: {\n      ...tenant,\n      ...sessionDurations,\n    },\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedTenant> {\n  const tenant = context.assets.tenant;\n\n  if (!tenant) return { tenant: null };\n\n  clearTenantFlags(tenant);\n\n  return { tenant };\n}\n\nconst tenantHandler: YAMLHandler<ParsedTenant> = {\n  parse,\n  dump,\n};\n\nexport default tenantHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"65b6761f983da15a1fffa983e55b491b59073228","contentHash":"8c51268ece0b3111392ccc45f0e4f1f42f73a9c64d551ab3ce8643b49619caf0"},"/home/circleci/repo/src/sessionDurationsToMinutes.ts":{"path":"/home/circleci/repo/src/sessionDurationsToMinutes.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":43}},"2":{"start":{"line":5,"column":4},"end":{"line":5,"column":34}},"3":{"start":{"line":7,"column":34},"end":{"line":14,"column":1}},"4":{"start":{"line":8,"column":29},"end":{"line":8,"column":31}},"5":{"start":{"line":9,"column":4},"end":{"line":10,"column":88}},"6":{"start":{"line":10,"column":8},"end":{"line":10,"column":88}},"7":{"start":{"line":11,"column":4},"end":{"line":12,"column":98}},"8":{"start":{"line":12,"column":8},"end":{"line":12,"column":98}},"9":{"start":{"line":13,"column":4},"end":{"line":13,"column":28}},"10":{"start":{"line":15,"column":0},"end":{"line":15,"column":62}}},"fnMap":{"0":{"name":"hoursToMinutes","decl":{"start":{"line":4,"column":9},"end":{"line":4,"column":23}},"loc":{"start":{"line":4,"column":31},"end":{"line":6,"column":1}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":34},"end":{"line":7,"column":35}},"loc":{"start":{"line":7,"column":84},"end":{"line":14,"column":1}},"line":7}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":4},"end":{"line":10,"column":88}},"type":"if","locations":[{"start":{"line":9,"column":4},"end":{"line":10,"column":88}},{"start":{"line":9,"column":4},"end":{"line":10,"column":88}}],"line":9},"1":{"loc":{"start":{"line":11,"column":4},"end":{"line":12,"column":98}},"type":"if","locations":[{"start":{"line":11,"column":4},"end":{"line":12,"column":98}},{"start":{"line":11,"column":4},"end":{"line":12,"column":98}}],"line":11}},"s":{"0":1,"1":1,"2":8,"3":1,"4":13,"5":13,"6":4,"7":13,"8":4,"9":13,"10":1},"f":{"0":8,"1":13},"b":{"0":[4,9],"1":[4,9]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/sessionDurationsToMinutes.ts","sources":["/home/circleci/repo/src/sessionDurationsToMinutes.ts"],"names":[],"mappings":";;;AAAA,SAAS,cAAc,CAAC,KAAa;IACnC,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC;AAChC,CAAC;AAEM,MAAM,yBAAyB,GAAG,CAAC,EACxC,gBAAgB,EAChB,qBAAqB,GAItB,EAAuF,EAAE;IACxF,MAAM,gBAAgB,GAGlB,EAAE,CAAC;IAEP,IAAI,CAAC,CAAC,gBAAgB;QACpB,gBAAgB,CAAC,2BAA2B,GAAG,cAAc,CAAC,gBAAgB,CAAC,CAAC;IAClF,IAAI,CAAC,CAAC,qBAAqB;QACzB,gBAAgB,CAAC,gCAAgC,GAAG,cAAc,CAAC,qBAAqB,CAAC,CAAC;IAE5F,OAAO,gBAAgB,CAAC;AAC1B,CAAC,CAAC;AAlBW,QAAA,yBAAyB,6BAkBpC","sourcesContent":["function hoursToMinutes(hours: number): number {\n  return Math.round(hours * 60);\n}\n\nexport const sessionDurationsToMinutes = ({\n  session_lifetime,\n  idle_session_lifetime,\n}: {\n  session_lifetime?: number;\n  idle_session_lifetime?: number;\n}): { session_lifetime_in_minutes?: number; idle_session_lifetime_in_minutes?: number } => {\n  const sessionDurations: {\n    session_lifetime_in_minutes?: number;\n    idle_session_lifetime_in_minutes?: number;\n  } = {};\n\n  if (!!session_lifetime)\n    sessionDurations.session_lifetime_in_minutes = hoursToMinutes(session_lifetime);\n  if (!!idle_session_lifetime)\n    sessionDurations.idle_session_lifetime_in_minutes = hoursToMinutes(idle_session_lifetime);\n\n  return sessionDurations;\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"70f046552312a8cb5bd4e2eec0d9255088fb4a0c","contentHash":"36db65718dd7c7c9ffef9f91c7f8f1f5f460b0cf814b448dcc4d194defd105c8"},"/home/circleci/repo/src/context/yaml/handlers/emailProvider.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/emailProvider.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":19},"end":{"line":12,"column":44}},"14":{"start":{"line":14,"column":4},"end":{"line":21,"column":7}},"15":{"start":{"line":15,"column":34},"end":{"line":15,"column":48}},"16":{"start":{"line":16,"column":8},"end":{"line":17,"column":43}},"17":{"start":{"line":17,"column":12},"end":{"line":17,"column":43}},"18":{"start":{"line":18,"column":8},"end":{"line":20,"column":10}},"19":{"start":{"line":24,"column":4},"end":{"line":40,"column":7}},"20":{"start":{"line":25,"column":8},"end":{"line":26,"column":43}},"21":{"start":{"line":26,"column":12},"end":{"line":26,"column":43}},"22":{"start":{"line":27,"column":30},"end":{"line":36,"column":12}},"23":{"start":{"line":29,"column":38},"end":{"line":29,"column":52}},"24":{"start":{"line":30,"column":37},"end":{"line":30,"column":123}},"25":{"start":{"line":31,"column":12},"end":{"line":34,"column":13}},"26":{"start":{"line":33,"column":16},"end":{"line":33,"column":76}},"27":{"start":{"line":35,"column":12},"end":{"line":35,"column":33}},"28":{"start":{"line":37,"column":8},"end":{"line":39,"column":10}},"29":{"start":{"line":42,"column":29},"end":{"line":45,"column":1}},"30":{"start":{"line":46,"column":0},"end":{"line":46,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parse","decl":{"start":{"line":13,"column":9},"end":{"line":13,"column":14}},"loc":{"start":{"line":13,"column":24},"end":{"line":22,"column":1}},"line":13},"8":{"name":"(anonymous_8)","decl":{"start":{"line":14,"column":43},"end":{"line":14,"column":44}},"loc":{"start":{"line":14,"column":56},"end":{"line":21,"column":5}},"line":14},"9":{"name":"dump","decl":{"start":{"line":23,"column":9},"end":{"line":23,"column":13}},"loc":{"start":{"line":23,"column":23},"end":{"line":41,"column":1}},"line":23},"10":{"name":"(anonymous_10)","decl":{"start":{"line":24,"column":43},"end":{"line":24,"column":44}},"loc":{"start":{"line":24,"column":56},"end":{"line":40,"column":5}},"line":24},"11":{"name":"(anonymous_11)","decl":{"start":{"line":27,"column":31},"end":{"line":27,"column":32}},"loc":{"start":{"line":27,"column":37},"end":{"line":36,"column":9}},"line":27}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":16,"column":8},"end":{"line":17,"column":43}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":17,"column":43}},{"start":{"line":16,"column":8},"end":{"line":17,"column":43}}],"line":16},"6":{"loc":{"start":{"line":25,"column":8},"end":{"line":26,"column":43}},"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":26,"column":43}},{"start":{"line":25,"column":8},"end":{"line":26,"column":43}}],"line":25},"7":{"loc":{"start":{"line":30,"column":37},"end":{"line":30,"column":123}},"type":"binary-expr","locations":[{"start":{"line":30,"column":38},"end":{"line":30,"column":116}},{"start":{"line":30,"column":121},"end":{"line":30,"column":123}}],"line":30},"8":{"loc":{"start":{"line":30,"column":38},"end":{"line":30,"column":116}},"type":"cond-expr","locations":[{"start":{"line":30,"column":96},"end":{"line":30,"column":102}},{"start":{"line":30,"column":105},"end":{"line":30,"column":116}}],"line":30},"9":{"loc":{"start":{"line":30,"column":38},"end":{"line":30,"column":93}},"type":"binary-expr","locations":[{"start":{"line":30,"column":38},"end":{"line":30,"column":76}},{"start":{"line":30,"column":80},"end":{"line":30,"column":93}}],"line":30},"10":{"loc":{"start":{"line":31,"column":12},"end":{"line":34,"column":13}},"type":"if","locations":[{"start":{"line":31,"column":12},"end":{"line":34,"column":13}},{"start":{"line":31,"column":12},"end":{"line":34,"column":13}}],"line":31},"11":{"loc":{"start":{"line":31,"column":16},"end":{"line":31,"column":76}},"type":"binary-expr","locations":[{"start":{"line":31,"column":16},"end":{"line":31,"column":29}},{"start":{"line":31,"column":33},"end":{"line":31,"column":76}}],"line":31}},"s":{"0":1,"1":0,"2":0,"3":47,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":47,"11":47,"12":1,"13":1,"14":41,"15":41,"16":41,"17":40,"18":1,"19":6,"20":6,"21":0,"22":6,"23":6,"24":6,"25":6,"26":4,"27":2,"28":6,"29":1,"30":1},"f":{"0":47,"1":0,"2":0,"3":47,"4":0,"5":0,"6":47,"7":41,"8":41,"9":6,"10":6,"11":6},"b":{"0":[1,1,1],"1":[0,0],"2":[47,47],"3":[47,0],"4":[47,47],"5":[40,1],"6":[0,6],"7":[6,0],"8":[0,6],"9":[6,6],"10":[4,2],"11":[6,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/emailProvider.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/emailProvider.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,6CAAuD;AAOvD,SAAe,KAAK,CAAC,OAAoB;;QACvC,MAAM,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEzC,IAAI,CAAC,aAAa;YAAE,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC;QAEnD,OAAO;YACL,aAAa;SACd,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,aAAa;YAAE,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC;QAElE,MAAM,aAAa,GAAG,CAAC,GAAG,EAAE;;YAC1B,MAAM,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;YACzC,MAAM,gBAAgB,GAAG,CAAA,MAAA,OAAO,CAAC,MAAM,CAAC,OAAO,0CAAE,QAAQ,KAAI,EAAE,CAAC;YAChE,IAAI,aAAa,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,eAAe,CAAC,EAAE;gBAChE,6DAA6D;gBAC7D,OAAO,IAAA,gCAAqB,EAAC,aAAa,CAAC,CAAC;aAC7C;YACD,OAAO,aAAa,CAAC;QACvB,CAAC,CAAC,EAAE,CAAC;QAEL,OAAO;YACL,aAAa;SACd,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,oBAAoB,GAAqC;IAC7D,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,oBAAoB,CAAC","sourcesContent":["import { emailProviderDefaults } from '../../defaults';\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedEmailProvider = ParsedAsset<'emailProvider', Asset>;\n\nasync function parse(context: YAMLContext): Promise<ParsedEmailProvider> {\n  const { emailProvider } = context.assets;\n\n  if (!emailProvider) return { emailProvider: null };\n\n  return {\n    emailProvider,\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedEmailProvider> {\n  if (!context.assets.emailProvider) return { emailProvider: null };\n\n  const emailProvider = (() => {\n    const { emailProvider } = context.assets;\n    const excludedDefaults = context.assets.exclude?.defaults || [];\n    if (emailProvider && !excludedDefaults.includes('emailProvider')) {\n      // Add placeholder for credentials as they cannot be exported\n      return emailProviderDefaults(emailProvider);\n    }\n    return emailProvider;\n  })();\n\n  return {\n    emailProvider,\n  };\n}\n\nconst emailProviderHandler: YAMLHandler<ParsedEmailProvider> = {\n  parse,\n  dump,\n};\n\nexport default emailProviderHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a29aaabc09c6af86a973f7b059191be72917eb09","contentHash":"dd45a59405572f0554a0a3adf4d6718574a28d91745de79e159fec4a11f44db2"},"/home/circleci/repo/src/context/defaults.ts":{"path":"/home/circleci/repo/src/context/defaults.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":39}},"2":{"start":{"line":6,"column":20},"end":{"line":6,"column":52}},"3":{"start":{"line":7,"column":28},"end":{"line":7,"column":76}},"4":{"start":{"line":9,"column":21},"end":{"line":9,"column":28}},"5":{"start":{"line":10,"column":4},"end":{"line":12,"column":5}},"6":{"start":{"line":11,"column":8},"end":{"line":11,"column":123}},"7":{"start":{"line":13,"column":4},"end":{"line":15,"column":5}},"8":{"start":{"line":14,"column":8},"end":{"line":14,"column":193}},"9":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"10":{"start":{"line":17,"column":8},"end":{"line":17,"column":191}},"11":{"start":{"line":19,"column":4},"end":{"line":19,"column":19}},"12":{"start":{"line":21,"column":0},"end":{"line":21,"column":54}}},"fnMap":{"0":{"name":"emailProviderDefaults","decl":{"start":{"line":4,"column":9},"end":{"line":4,"column":30}},"loc":{"start":{"line":4,"column":46},"end":{"line":20,"column":1}},"line":4}},"branchMap":{"0":{"loc":{"start":{"line":10,"column":4},"end":{"line":12,"column":5}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":12,"column":5}},{"start":{"line":10,"column":4},"end":{"line":12,"column":5}}],"line":10},"1":{"loc":{"start":{"line":11,"column":95},"end":{"line":11,"column":120}},"type":"binary-expr","locations":[{"start":{"line":11,"column":95},"end":{"line":11,"column":114}},{"start":{"line":11,"column":118},"end":{"line":11,"column":120}}],"line":11},"2":{"loc":{"start":{"line":13,"column":4},"end":{"line":15,"column":5}},"type":"if","locations":[{"start":{"line":13,"column":4},"end":{"line":15,"column":5}},{"start":{"line":13,"column":4},"end":{"line":15,"column":5}}],"line":13},"3":{"loc":{"start":{"line":14,"column":165},"end":{"line":14,"column":190}},"type":"binary-expr","locations":[{"start":{"line":14,"column":165},"end":{"line":14,"column":184}},{"start":{"line":14,"column":188},"end":{"line":14,"column":190}}],"line":14},"4":{"loc":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},{"start":{"line":16,"column":4},"end":{"line":18,"column":5}}],"line":16},"5":{"loc":{"start":{"line":17,"column":163},"end":{"line":17,"column":188}},"type":"binary-expr","locations":[{"start":{"line":17,"column":163},"end":{"line":17,"column":182}},{"start":{"line":17,"column":186},"end":{"line":17,"column":188}}],"line":17}},"s":{"0":1,"1":1,"2":11,"3":11,"4":11,"5":11,"6":4,"7":11,"8":6,"9":11,"10":1,"11":11,"12":1},"f":{"0":11},"b":{"0":[4,7],"1":[4,4],"2":[6,5],"3":[6,6],"4":[1,10],"5":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/defaults.ts","sources":["/home/circleci/repo/src/context/defaults.ts"],"names":[],"mappings":";;;AAAA,SAAgB,qBAAqB,CAAC,aAAa;IACjD,sBAAsB;IACtB,MAAM,OAAO,qBAAQ,aAAa,CAAE,CAAC;IAErC,MAAM,eAAe,GAAG,CAAC,SAAS,EAAE,UAAU,EAAE,UAAU,EAAE,WAAW,CAAC,CAAC;IAEzE,6DAA6D;IAC7D,MAAM,EAAE,IAAI,EAAE,GAAG,OAAO,CAAC;IAEzB,IAAI,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;QAClC,OAAO,CAAC,WAAW,mBACjB,OAAO,EAAE,KAAK,IAAI,CAAC,WAAW,EAAE,YAAY,IACzC,CAAC,OAAO,CAAC,WAAW,IAAI,EAAE,CAAC,CAC/B,CAAC;KACH;IAED,IAAI,IAAI,KAAK,MAAM,EAAE;QACnB,OAAO,CAAC,WAAW,mBACjB,SAAS,EAAE,mBAAmB,EAC9B,SAAS,EAAE,eAAe,EAC1B,SAAS,EAAE,eAAe,EAC1B,SAAS,EAAE,eAAe,IACvB,CAAC,OAAO,CAAC,WAAW,IAAI,EAAE,CAAC,CAC/B,CAAC;KACH;IAED,IAAI,IAAI,KAAK,KAAK,EAAE;QAClB,OAAO,CAAC,WAAW,mBACjB,WAAW,EAAE,uBAAuB,EACpC,eAAe,EAAE,2BAA2B,EAC5C,MAAM,EAAE,oBAAoB,IACzB,CAAC,OAAO,CAAC,WAAW,IAAI,EAAE,CAAC,CAC/B,CAAC;KACH;IAED,OAAO,OAAO,CAAC;AACjB,CAAC;AApCD,sDAoCC","sourcesContent":["export function emailProviderDefaults(emailProvider) {\n  // eslint-disable-line\n  const updated = { ...emailProvider };\n\n  const apiKeyProviders = ['mailgun', 'mandrill', 'sendgrid', 'sparkpost'];\n\n  // Add placeholder for credentials as they cannot be exported\n  const { name } = updated;\n\n  if (apiKeyProviders.includes(name)) {\n    updated.credentials = {\n      api_key: `##${name.toUpperCase()}_API_KEY##`,\n      ...(updated.credentials || {}),\n    };\n  }\n\n  if (name === 'smtp') {\n    updated.credentials = {\n      smtp_host: '##SMTP_HOSTNAME##',\n      smtp_port: '##SMTP_PORT##',\n      smtp_user: '##SMTP_USER##',\n      smtp_pass: '##SMTP_PASS##',\n      ...(updated.credentials || {}),\n    };\n  }\n\n  if (name === 'ses') {\n    updated.credentials = {\n      accessKeyId: '##SES_ACCESS_KEY_ID##',\n      secretAccessKey: '##SES_ACCESS_SECRET_KEY##',\n      region: '##SES_AWS_REGION##',\n      ...(updated.credentials || {}),\n    };\n  }\n\n  return updated;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b15a1e5df22372094287d936b7fc9825051ade6d","contentHash":"19a0fd7271282503adbbfc504bff1c6965c93a11bfd6bb12b8e2e327fc15ff3a"},"/home/circleci/repo/src/context/yaml/handlers/connections.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/connections.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"20":{"start":{"line":21,"column":4},"end":{"line":44,"column":7}},"21":{"start":{"line":22,"column":32},"end":{"line":22,"column":46}},"22":{"start":{"line":23,"column":34},"end":{"line":23,"column":112}},"23":{"start":{"line":24,"column":8},"end":{"line":26,"column":9}},"24":{"start":{"line":25,"column":12},"end":{"line":25,"column":41}},"25":{"start":{"line":27,"column":8},"end":{"line":43,"column":10}},"26":{"start":{"line":30,"column":20},"end":{"line":39,"column":21}},"27":{"start":{"line":31,"column":24},"end":{"line":31,"column":82}},"28":{"start":{"line":32,"column":45},"end":{"line":32,"column":114}},"29":{"start":{"line":33,"column":24},"end":{"line":37,"column":25}},"30":{"start":{"line":34,"column":64},"end":{"line":34,"column":225}},"31":{"start":{"line":35,"column":28},"end":{"line":35,"column":80}},"32":{"start":{"line":36,"column":28},"end":{"line":36,"column":73}},"33":{"start":{"line":38,"column":24},"end":{"line":38,"column":87}},"34":{"start":{"line":40,"column":20},"end":{"line":40,"column":38}},"35":{"start":{"line":46,"column":28},"end":{"line":55,"column":1}},"36":{"start":{"line":47,"column":4},"end":{"line":54,"column":5}},"37":{"start":{"line":48,"column":8},"end":{"line":50,"column":10}},"38":{"start":{"line":53,"column":8},"end":{"line":53,"column":18}},"39":{"start":{"line":57,"column":4},"end":{"line":80,"column":7}},"40":{"start":{"line":58,"column":41},"end":{"line":58,"column":55}},"41":{"start":{"line":59,"column":8},"end":{"line":60,"column":41}},"42":{"start":{"line":60,"column":12},"end":{"line":60,"column":41}},"43":{"start":{"line":61,"column":8},"end":{"line":79,"column":10}},"44":{"start":{"line":63,"column":41},"end":{"line":65,"column":19}},"45":{"start":{"line":66,"column":16},"end":{"line":76,"column":17}},"46":{"start":{"line":67,"column":20},"end":{"line":67,"column":78}},"47":{"start":{"line":68,"column":46},"end":{"line":68,"column":124}},"48":{"start":{"line":69,"column":43},"end":{"line":69,"column":87}},"49":{"start":{"line":70,"column":33},"end":{"line":70,"column":68}},"50":{"start":{"line":71,"column":48},"end":{"line":71,"column":112}},"51":{"start":{"line":72,"column":20},"end":{"line":72,"column":76}},"52":{"start":{"line":73,"column":20},"end":{"line":73,"column":72}},"53":{"start":{"line":74,"column":20},"end":{"line":74,"column":80}},"54":{"start":{"line":75,"column":20},"end":{"line":75,"column":85}},"55":{"start":{"line":77,"column":16},"end":{"line":77,"column":40}},"56":{"start":{"line":82,"column":27},"end":{"line":85,"column":1}},"57":{"start":{"line":86,"column":0},"end":{"line":86,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":45,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":21,"column":43},"end":{"line":21,"column":44}},"loc":{"start":{"line":21,"column":56},"end":{"line":44,"column":5}},"line":21},"10":{"name":"(anonymous_10)","decl":{"start":{"line":29,"column":35},"end":{"line":29,"column":36}},"loc":{"start":{"line":29,"column":51},"end":{"line":41,"column":17}},"line":29},"11":{"name":"(anonymous_11)","decl":{"start":{"line":46,"column":28},"end":{"line":46,"column":29}},"loc":{"start":{"line":46,"column":53},"end":{"line":55,"column":1}},"line":46},"12":{"name":"dump","decl":{"start":{"line":56,"column":9},"end":{"line":56,"column":13}},"loc":{"start":{"line":56,"column":23},"end":{"line":81,"column":1}},"line":56},"13":{"name":"(anonymous_13)","decl":{"start":{"line":57,"column":43},"end":{"line":57,"column":44}},"loc":{"start":{"line":57,"column":56},"end":{"line":80,"column":5}},"line":57},"14":{"name":"(anonymous_14)","decl":{"start":{"line":62,"column":41},"end":{"line":62,"column":42}},"loc":{"start":{"line":62,"column":57},"end":{"line":78,"column":13}},"line":62}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":24,"column":8},"end":{"line":26,"column":9}},"type":"if","locations":[{"start":{"line":24,"column":8},"end":{"line":26,"column":9}},{"start":{"line":24,"column":8},"end":{"line":26,"column":9}}],"line":24},"9":{"loc":{"start":{"line":30,"column":20},"end":{"line":39,"column":21}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":39,"column":21}},{"start":{"line":30,"column":20},"end":{"line":39,"column":21}}],"line":30},"10":{"loc":{"start":{"line":33,"column":24},"end":{"line":37,"column":25}},"type":"if","locations":[{"start":{"line":33,"column":24},"end":{"line":37,"column":25}},{"start":{"line":33,"column":24},"end":{"line":37,"column":25}}],"line":33},"11":{"loc":{"start":{"line":59,"column":8},"end":{"line":60,"column":41}},"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":60,"column":41}},{"start":{"line":59,"column":8},"end":{"line":60,"column":41}}],"line":59},"12":{"loc":{"start":{"line":63,"column":144},"end":{"line":65,"column":17}},"type":"binary-expr","locations":[{"start":{"line":63,"column":144},"end":{"line":63,"column":170}},{"start":{"line":63,"column":174},"end":{"line":65,"column":17}}],"line":63},"13":{"loc":{"start":{"line":64,"column":101},"end":{"line":64,"column":114}},"type":"binary-expr","locations":[{"start":{"line":64,"column":101},"end":{"line":64,"column":108}},{"start":{"line":64,"column":112},"end":{"line":64,"column":114}}],"line":64},"14":{"loc":{"start":{"line":66,"column":16},"end":{"line":76,"column":17}},"type":"if","locations":[{"start":{"line":66,"column":16},"end":{"line":76,"column":17}},{"start":{"line":66,"column":16},"end":{"line":76,"column":17}}],"line":66}},"s":{"0":1,"1":0,"2":0,"3":47,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":47,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":41,"21":41,"22":41,"23":41,"24":38,"25":3,"26":5,"27":2,"28":2,"29":2,"30":1,"31":1,"32":1,"33":1,"34":4,"35":1,"36":6,"37":6,"38":3,"39":6,"40":6,"41":6,"42":0,"43":6,"44":6,"45":6,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":6,"56":1,"57":1},"f":{"0":47,"1":0,"2":0,"3":47,"4":0,"5":0,"6":46,"7":3,"8":41,"9":41,"10":5,"11":6,"12":6,"13":6,"14":6},"b":{"0":[1,1,1],"1":[0,0],"2":[47,47],"3":[46,0],"4":[47,47],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[38,3],"9":[2,3],"10":[1,1],"11":[0,6],"12":[6,5],"13":[5,0],"14":[1,5]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/connections.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/connections.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport log from '../../../logger';\nimport {\n  isFile,\n  sanitize,\n  ensureProp,\n  convertClientIdToName,\n  mapClientID2NameSorted,\n} from '../../../utils';\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedConnections = ParsedAsset<'connections', Asset[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedConnections> {\n  const { connections } = context.assets;\n  const connectionsFolder = path.join(context.basePath, constants.CONNECTIONS_DIRECTORY);\n\n  if (!connections) {\n    return { connections: null };\n  }\n\n  return {\n    connections: [\n      ...connections.map((connection) => {\n        if (connection.strategy === 'email') {\n          ensureProp(connection, 'options.email.body');\n          const htmlFileName = path.join(connectionsFolder, connection.options.email.body);\n\n          if (!isFile(htmlFileName)) {\n            const missingTemplateErrorMessage = `Passwordless email template purportedly located at ${htmlFileName} does not exist for connection. Ensure the existence of this file to proceed with deployment.`;\n            log.error(missingTemplateErrorMessage);\n            throw new Error(missingTemplateErrorMessage);\n          }\n          connection.options.email.body = context.loadFile(htmlFileName);\n        }\n\n        return connection;\n      }),\n    ],\n  };\n}\n\nconst getFormattedOptions = (connection, clients) => {\n  try {\n    return {\n      options: {\n        ...connection.options,\n        idpinitiated: {\n          ...connection.options.idpinitiated,\n          client_id: convertClientIdToName(connection.options.idpinitiated.client_id, clients),\n        },\n      },\n    };\n  } catch (e) {\n    return {};\n  }\n};\n\nasync function dump(context: YAMLContext): Promise<ParsedConnections> {\n  const { connections, clients } = context.assets;\n\n  if (!connections) return { connections: null };\n\n  return {\n    connections: connections.map((connection) => {\n      const dumpedConnection = {\n        ...connection,\n        ...getFormattedOptions(connection, clients),\n        ...(connection.enabled_clients && {\n          enabled_clients: mapClientID2NameSorted(connection.enabled_clients, clients || []),\n        }),\n      };\n\n      if (dumpedConnection.strategy === 'email') {\n        ensureProp(connection, 'options.email.body');\n        const connectionsFolder = path.join(context.basePath, constants.CONNECTIONS_DIRECTORY);\n        const connectionName = sanitize(dumpedConnection.name);\n        const html = dumpedConnection.options.email.body;\n        const emailConnectionHtml = path.join(connectionsFolder, `${connectionName}.html`);\n\n        log.info(`Writing ${emailConnectionHtml}`);\n        fs.ensureDirSync(connectionsFolder);\n        fs.writeFileSync(emailConnectionHtml, html);\n\n        dumpedConnection.options.email.body = `./${connectionName}.html`;\n      }\n\n      return dumpedConnection;\n    }),\n  };\n}\n\nconst connectionsHandler: YAMLHandler<ParsedConnections> = {\n  parse,\n  dump,\n};\n\nexport default connectionsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e6ed90c299c45b8ef107f8289493934f64c30678","contentHash":"4e9f9eab56e97fc8305f491a0b031a14e9a18905a583cce32dfbc42a1da2d742"},"/home/circleci/repo/src/context/yaml/handlers/databases.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/databases.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":20,"column":4},"end":{"line":32,"column":7}},"20":{"start":{"line":22,"column":30},"end":{"line":22,"column":44}},"21":{"start":{"line":23,"column":8},"end":{"line":24,"column":39}},"22":{"start":{"line":24,"column":12},"end":{"line":24,"column":39}},"23":{"start":{"line":25,"column":8},"end":{"line":31,"column":10}},"24":{"start":{"line":27,"column":48},"end":{"line":29,"column":26}},"25":{"start":{"line":28,"column":123},"end":{"line":28,"column":202}},"26":{"start":{"line":35,"column":4},"end":{"line":69,"column":7}},"27":{"start":{"line":36,"column":39},"end":{"line":36,"column":53}},"28":{"start":{"line":37,"column":8},"end":{"line":38,"column":39}},"29":{"start":{"line":38,"column":12},"end":{"line":38,"column":39}},"30":{"start":{"line":39,"column":34},"end":{"line":43,"column":9}},"31":{"start":{"line":40,"column":12},"end":{"line":41,"column":25}},"32":{"start":{"line":41,"column":16},"end":{"line":41,"column":25}},"33":{"start":{"line":42,"column":12},"end":{"line":42,"column":42}},"34":{"start":{"line":44,"column":8},"end":{"line":68,"column":10}},"35":{"start":{"line":46,"column":48},"end":{"line":66,"column":26}},"36":{"start":{"line":54,"column":43},"end":{"line":54,"column":79}},"37":{"start":{"line":55,"column":45},"end":{"line":55,"column":126}},"38":{"start":{"line":56,"column":28},"end":{"line":56,"column":71}},"39":{"start":{"line":58,"column":47},"end":{"line":58,"column":74}},"40":{"start":{"line":59,"column":47},"end":{"line":59,"column":96}},"41":{"start":{"line":60,"column":28},"end":{"line":60,"column":75}},"42":{"start":{"line":62,"column":28},"end":{"line":62,"column":81}},"43":{"start":{"line":63,"column":28},"end":{"line":63,"column":85}},"44":{"start":{"line":64,"column":28},"end":{"line":64,"column":43}},"45":{"start":{"line":71,"column":25},"end":{"line":74,"column":1}},"46":{"start":{"line":75,"column":0},"end":{"line":75,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":20,"column":43},"end":{"line":20,"column":44}},"loc":{"start":{"line":20,"column":56},"end":{"line":32,"column":5}},"line":20},"10":{"name":"(anonymous_10)","decl":{"start":{"line":27,"column":33},"end":{"line":27,"column":34}},"loc":{"start":{"line":27,"column":48},"end":{"line":29,"column":26}},"line":27},"11":{"name":"(anonymous_11)","decl":{"start":{"line":28,"column":93},"end":{"line":28,"column":94}},"loc":{"start":{"line":28,"column":123},"end":{"line":28,"column":202}},"line":28},"12":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":70,"column":1}},"line":34},"13":{"name":"(anonymous_13)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":69,"column":5}},"line":35},"14":{"name":"(anonymous_14)","decl":{"start":{"line":39,"column":34},"end":{"line":39,"column":35}},"loc":{"start":{"line":39,"column":56},"end":{"line":43,"column":9}},"line":39},"15":{"name":"(anonymous_15)","decl":{"start":{"line":46,"column":33},"end":{"line":46,"column":34}},"loc":{"start":{"line":46,"column":48},"end":{"line":66,"column":26}},"line":46},"16":{"name":"(anonymous_16)","decl":{"start":{"line":52,"column":36},"end":{"line":52,"column":37}},"loc":{"start":{"line":52,"column":65},"end":{"line":65,"column":25}},"line":52}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":23,"column":8},"end":{"line":24,"column":39}},"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":24,"column":39}},{"start":{"line":23,"column":8},"end":{"line":24,"column":39}}],"line":23},"9":{"loc":{"start":{"line":27,"column":154},"end":{"line":29,"column":21}},"type":"binary-expr","locations":[{"start":{"line":27,"column":154},"end":{"line":27,"column":184}},{"start":{"line":27,"column":188},"end":{"line":29,"column":21}}],"line":27},"10":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":39}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":39}},{"start":{"line":37,"column":8},"end":{"line":38,"column":39}}],"line":37},"11":{"loc":{"start":{"line":40,"column":12},"end":{"line":41,"column":25}},"type":"if","locations":[{"start":{"line":40,"column":12},"end":{"line":41,"column":25}},{"start":{"line":40,"column":12},"end":{"line":41,"column":25}}],"line":40},"12":{"loc":{"start":{"line":42,"column":19},"end":{"line":42,"column":41}},"type":"cond-expr","locations":[{"start":{"line":42,"column":35},"end":{"line":42,"column":36}},{"start":{"line":42,"column":39},"end":{"line":42,"column":41}}],"line":42},"13":{"loc":{"start":{"line":46,"column":106},"end":{"line":48,"column":17}},"type":"binary-expr","locations":[{"start":{"line":46,"column":106},"end":{"line":46,"column":130}},{"start":{"line":46,"column":134},"end":{"line":48,"column":17}}],"line":46},"14":{"loc":{"start":{"line":47,"column":99},"end":{"line":47,"column":112}},"type":"binary-expr","locations":[{"start":{"line":47,"column":99},"end":{"line":47,"column":106}},{"start":{"line":47,"column":110},"end":{"line":47,"column":112}}],"line":47},"15":{"loc":{"start":{"line":48,"column":84},"end":{"line":66,"column":21}},"type":"binary-expr","locations":[{"start":{"line":48,"column":84},"end":{"line":48,"column":114}},{"start":{"line":48,"column":118},"end":{"line":66,"column":21}}],"line":48}},"s":{"0":1,"1":0,"2":0,"3":48,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":48,"11":48,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":41,"20":41,"21":41,"22":39,"23":2,"24":2,"25":7,"26":7,"27":7,"28":7,"29":0,"30":7,"31":6,"32":0,"33":6,"34":7,"35":3,"36":8,"37":8,"38":8,"39":8,"40":8,"41":8,"42":8,"43":8,"44":8,"45":1,"46":1},"f":{"0":48,"1":0,"2":0,"3":48,"4":0,"5":0,"6":48,"7":3,"8":41,"9":41,"10":2,"11":7,"12":7,"13":7,"14":6,"15":3,"16":8},"b":{"0":[1,1,1],"1":[0,0],"2":[48,48],"3":[48,0],"4":[48,48],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[39,2],"9":[2,1],"10":[0,7],"11":[0,6],"12":[6,0],"13":[3,3],"14":[3,3],"15":[3,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/databases.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/databases.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { mapClientID2NameSorted, sanitize } from '../../../utils';\nimport log from '../../../logger';\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedDatabases = ParsedAsset<'databases', Asset[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedDatabases> {\n  // Load the script file for custom db\n  const { databases } = context.assets;\n\n  if (!databases) return { databases: null };\n\n  return {\n    databases: [\n      ...databases.map((database) => ({\n        ...database,\n        options: {\n          ...database.options,\n          // customScripts option only written if there are scripts\n          ...(database.options.customScripts && {\n            customScripts: Object.entries(database.options.customScripts).reduce(\n              (scripts, [name, script]) => ({\n                ...scripts,\n                [name]: context.loadFile(script),\n              }),\n              {}\n            ),\n          }),\n        },\n      })),\n    ],\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedDatabases> {\n  const { databases, clients } = context.assets;\n\n  if (!databases) return { databases: null };\n\n  const sortCustomScripts = ([name1]: [string, Function], [name2]: [string, Function]): number => {\n    if (name1 === name2) return 0;\n    return name1 > name2 ? 1 : -1;\n  };\n\n  return {\n    databases: [\n      ...databases.map((database) => ({\n        ...database,\n        ...(database.enabled_clients && {\n          enabled_clients: mapClientID2NameSorted(database.enabled_clients, clients || []),\n        }),\n        options: {\n          ...database.options,\n          // customScripts option only written if there are scripts\n          ...(database.options.customScripts && {\n            customScripts: Object.entries(database.options.customScripts)\n              //@ts-ignore because we'll fix this in subsequent PR\n              .sort(sortCustomScripts)\n              .reduce((scripts, [name, script]) => {\n                // Create Database folder\n                const dbName = sanitize(database.name);\n                const dbFolder = path.join(context.basePath, 'databases', sanitize(dbName));\n                fs.ensureDirSync(dbFolder);\n\n                // Dump custom script to file\n                const scriptName = sanitize(name);\n                const scriptFile = path.join(dbFolder, `${scriptName}.js`);\n                log.info(`Writing ${scriptFile}`);\n                //@ts-ignore because we'll fix this in subsequent PR\n                fs.writeFileSync(scriptFile, script);\n                scripts[name] = `./databases/${dbName}/${scriptName}.js`;\n                return scripts;\n              }, {}),\n          }),\n        },\n      })),\n    ],\n  };\n}\nconst databasesHandler: YAMLHandler<ParsedDatabases> = {\n  parse,\n  dump,\n};\n\nexport default databasesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"668a270f84874b93de7f09c1142a0ec2ea29e160","contentHash":"e39f491ce8377b0b7602615f9816dc49a24596bb2f557a0e6897f4156ddde586"},"/home/circleci/repo/src/context/yaml/handlers/emailTemplates.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/emailTemplates.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":17},"end":{"line":17,"column":60}},"18":{"start":{"line":19,"column":4},"end":{"line":29,"column":7}},"19":{"start":{"line":21,"column":35},"end":{"line":21,"column":49}},"20":{"start":{"line":22,"column":8},"end":{"line":23,"column":44}},"21":{"start":{"line":23,"column":12},"end":{"line":23,"column":44}},"22":{"start":{"line":24,"column":8},"end":{"line":28,"column":10}},"23":{"start":{"line":26,"column":47},"end":{"line":26,"column":120}},"24":{"start":{"line":32,"column":4},"end":{"line":48,"column":7}},"25":{"start":{"line":33,"column":29},"end":{"line":33,"column":58}},"26":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"27":{"start":{"line":35,"column":12},"end":{"line":35,"column":44}},"28":{"start":{"line":38,"column":32},"end":{"line":38,"column":87}},"29":{"start":{"line":39,"column":8},"end":{"line":39,"column":58}},"30":{"start":{"line":40,"column":8},"end":{"line":46,"column":11}},"31":{"start":{"line":42,"column":33},"end":{"line":42,"column":98}},"32":{"start":{"line":43,"column":12},"end":{"line":43,"column":61}},"33":{"start":{"line":44,"column":12},"end":{"line":44,"column":74}},"34":{"start":{"line":45,"column":12},"end":{"line":45,"column":118}},"35":{"start":{"line":47,"column":8},"end":{"line":47,"column":34}},"36":{"start":{"line":50,"column":30},"end":{"line":53,"column":1}},"37":{"start":{"line":54,"column":0},"end":{"line":54,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":18,"column":9},"end":{"line":18,"column":14}},"loc":{"start":{"line":18,"column":24},"end":{"line":30,"column":1}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":19,"column":43},"end":{"line":19,"column":44}},"loc":{"start":{"line":19,"column":56},"end":{"line":29,"column":5}},"line":19},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":38},"end":{"line":26,"column":39}},"loc":{"start":{"line":26,"column":47},"end":{"line":26,"column":120}},"line":26},"11":{"name":"dump","decl":{"start":{"line":31,"column":9},"end":{"line":31,"column":13}},"loc":{"start":{"line":31,"column":23},"end":{"line":49,"column":1}},"line":31},"12":{"name":"(anonymous_12)","decl":{"start":{"line":32,"column":43},"end":{"line":32,"column":44}},"loc":{"start":{"line":32,"column":56},"end":{"line":48,"column":5}},"line":32},"13":{"name":"(anonymous_13)","decl":{"start":{"line":40,"column":44},"end":{"line":40,"column":45}},"loc":{"start":{"line":40,"column":58},"end":{"line":46,"column":9}},"line":40}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":8},"end":{"line":23,"column":44}},"type":"if","locations":[{"start":{"line":22,"column":8},"end":{"line":23,"column":44}},{"start":{"line":22,"column":8},"end":{"line":23,"column":44}}],"line":22},"9":{"loc":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},{"start":{"line":34,"column":8},"end":{"line":36,"column":9}}],"line":34}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":41,"19":41,"20":41,"21":40,"22":1,"23":2,"24":5,"25":5,"26":5,"27":0,"28":5,"29":5,"30":5,"31":46,"32":46,"33":46,"34":46,"35":5,"36":1,"37":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":3,"8":41,"9":41,"10":2,"11":5,"12":5,"13":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[40,1],"9":[0,5]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/emailTemplates.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/emailTemplates.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,6DAAkC;AAOlC,SAAe,KAAK,CAAC,OAAoB;;QACvC,mCAAmC;QACnC,MAAM,EAAE,cAAc,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE1C,IAAI,CAAC,cAAc;YAAE,OAAO,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC;QAErD,OAAO;YACL,cAAc,EAAE;gBACd,GAAG,cAAc,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,iCACzB,EAAE,KACL,IAAI,EAAE,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,IAC/B,CAAC;aACJ;SACF,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,IAAI,cAAc,GAAG,OAAO,CAAC,MAAM,CAAC,cAAc,CAAC;QAEnD,IAAI,CAAC,cAAc,EAAE;YACnB,OAAO,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC;SACjC;QAED,0BAA0B;QAC1B,MAAM,eAAe,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,gBAAgB,CAAC,CAAC;QACtE,kBAAE,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;QAClC,cAAc,GAAG,cAAc,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,EAAE;YAC/C,wBAAwB;YACxB,MAAM,YAAY,GAAG,cAAI,CAAC,IAAI,CAAC,eAAe,EAAE,GAAG,QAAQ,CAAC,QAAQ,OAAO,CAAC,CAAC;YAC7E,gBAAG,CAAC,IAAI,CAAC,WAAW,YAAY,EAAE,CAAC,CAAC;YACpC,kBAAE,CAAC,aAAa,CAAC,YAAY,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC;YAC9C,uCAAY,QAAQ,KAAE,IAAI,EAAE,oBAAoB,QAAQ,CAAC,QAAQ,OAAO,IAAG;QAC7E,CAAC,CAAC,CAAC;QAEH,OAAO,EAAE,cAAc,EAAE,CAAC;IAC5B,CAAC;CAAA;AAED,MAAM,qBAAqB,GAAsC;IAC/D,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,qBAAqB,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport log from '../../../logger';\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedEmailTemplates = ParsedAsset<'emailTemplates', Asset[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedEmailTemplates> {\n  // Load the HTML file for each page\n  const { emailTemplates } = context.assets;\n\n  if (!emailTemplates) return { emailTemplates: null };\n\n  return {\n    emailTemplates: [\n      ...emailTemplates.map((et) => ({\n        ...et,\n        body: context.loadFile(et.body),\n      })),\n    ],\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedEmailTemplates> {\n  let emailTemplates = context.assets.emailTemplates;\n\n  if (!emailTemplates) {\n    return { emailTemplates: null };\n  }\n\n  // Create Templates folder\n  const templatesFolder = path.join(context.basePath, 'emailTemplates');\n  fs.ensureDirSync(templatesFolder);\n  emailTemplates = emailTemplates.map((template) => {\n    // Dump template to file\n    const templateFile = path.join(templatesFolder, `${template.template}.html`);\n    log.info(`Writing ${templateFile}`);\n    fs.writeFileSync(templateFile, template.body);\n    return { ...template, body: `./emailTemplates/${template.template}.html` };\n  });\n\n  return { emailTemplates };\n}\n\nconst emailTemplatesHandler: YAMLHandler<ParsedEmailTemplates> = {\n  parse,\n  dump,\n};\n\nexport default emailTemplatesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3f68d43f3c8e2f5d1e0ec3fbbcbbafed5fbbc541","contentHash":"87b201f9044b3f5577b41269e7307f2de54f2a74db55476d72fcdf6bda83bc25"},"/home/circleci/repo/src/context/yaml/handlers/clientGrants.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/clientGrants.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":16},"end":{"line":12,"column":41}},"14":{"start":{"line":14,"column":4},"end":{"line":21,"column":7}},"15":{"start":{"line":15,"column":33},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":8},"end":{"line":17,"column":42}},"17":{"start":{"line":17,"column":12},"end":{"line":17,"column":42}},"18":{"start":{"line":18,"column":8},"end":{"line":20,"column":10}},"19":{"start":{"line":24,"column":4},"end":{"line":36,"column":7}},"20":{"start":{"line":25,"column":42},"end":{"line":25,"column":56}},"21":{"start":{"line":26,"column":8},"end":{"line":27,"column":42}},"22":{"start":{"line":27,"column":12},"end":{"line":27,"column":42}},"23":{"start":{"line":29,"column":8},"end":{"line":35,"column":10}},"24":{"start":{"line":31,"column":34},"end":{"line":31,"column":58}},"25":{"start":{"line":32,"column":16},"end":{"line":32,"column":109}},"26":{"start":{"line":33,"column":16},"end":{"line":33,"column":33}},"27":{"start":{"line":38,"column":28},"end":{"line":41,"column":1}},"28":{"start":{"line":42,"column":0},"end":{"line":42,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parse","decl":{"start":{"line":13,"column":9},"end":{"line":13,"column":14}},"loc":{"start":{"line":13,"column":24},"end":{"line":22,"column":1}},"line":13},"8":{"name":"(anonymous_8)","decl":{"start":{"line":14,"column":43},"end":{"line":14,"column":44}},"loc":{"start":{"line":14,"column":56},"end":{"line":21,"column":5}},"line":14},"9":{"name":"dump","decl":{"start":{"line":23,"column":9},"end":{"line":23,"column":13}},"loc":{"start":{"line":23,"column":23},"end":{"line":37,"column":1}},"line":23},"10":{"name":"(anonymous_10)","decl":{"start":{"line":24,"column":43},"end":{"line":24,"column":44}},"loc":{"start":{"line":24,"column":56},"end":{"line":36,"column":5}},"line":24},"11":{"name":"(anonymous_11)","decl":{"start":{"line":30,"column":43},"end":{"line":30,"column":44}},"loc":{"start":{"line":30,"column":54},"end":{"line":34,"column":13}},"line":30}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":16,"column":8},"end":{"line":17,"column":42}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":17,"column":42}},{"start":{"line":16,"column":8},"end":{"line":17,"column":42}}],"line":16},"6":{"loc":{"start":{"line":26,"column":8},"end":{"line":27,"column":42}},"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":27,"column":42}},{"start":{"line":26,"column":8},"end":{"line":27,"column":42}}],"line":26},"7":{"loc":{"start":{"line":32,"column":94},"end":{"line":32,"column":107}},"type":"binary-expr","locations":[{"start":{"line":32,"column":94},"end":{"line":32,"column":101}},{"start":{"line":32,"column":105},"end":{"line":32,"column":107}}],"line":32}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":1,"14":41,"15":41,"16":41,"17":40,"18":1,"19":5,"20":5,"21":5,"22":0,"23":5,"24":1,"25":1,"26":1,"27":1,"28":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":41,"8":41,"9":5,"10":5,"11":1},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,1],"6":[0,5],"7":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/clientGrants.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/clientGrants.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,0CAAuD;AAQvD,SAAe,KAAK,CAAC,OAAoB;;QACvC,MAAM,EAAE,YAAY,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAExC,IAAI,CAAC,YAAY;YAAE,OAAO,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;QAEjD,OAAO;YACL,YAAY;SACb,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,MAAM,EAAE,YAAY,EAAE,OAAO,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEjD,IAAI,CAAC,YAAY;YAAE,OAAO,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;QAEjD,uDAAuD;QACvD,OAAO;YACL,YAAY,EAAE,YAAY,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE;gBACvC,MAAM,SAAS,qBAAQ,KAAK,CAAE,CAAC;gBAC/B,SAAS,CAAC,SAAS,GAAG,IAAA,6BAAqB,EAAC,SAAS,CAAC,SAAS,EAAE,OAAO,IAAI,EAAE,CAAC,CAAC;gBAChF,OAAO,SAAS,CAAC;YACnB,CAAC,CAAC;SACH,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,mBAAmB,GAAoC;IAC3D,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,mBAAmB,CAAC","sourcesContent":["import { convertClientIdToName } from '../../../utils';\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { ClientGrant } from '../../../tools/auth0/handlers/clientGrants';\n\ntype ParsedClientGrants = ParsedAsset<'clientGrants', ClientGrant[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedClientGrants> {\n  const { clientGrants } = context.assets;\n\n  if (!clientGrants) return { clientGrants: null };\n\n  return {\n    clientGrants,\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedClientGrants> {\n  const { clientGrants, clients } = context.assets;\n\n  if (!clientGrants) return { clientGrants: null };\n\n  // Convert client_id to the client name for readability\n  return {\n    clientGrants: clientGrants.map((grant) => {\n      const dumpGrant = { ...grant };\n      dumpGrant.client_id = convertClientIdToName(dumpGrant.client_id, clients || []);\n      return dumpGrant;\n    }),\n  };\n}\n\nconst clientGrantsHandler: YAMLHandler<ParsedClientGrants> = {\n  parse,\n  dump,\n};\n\nexport default clientGrantsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"83a2a1cdb36335204c5f3b6c2d924e96ce9397cc","contentHash":"c253cbf8725f2e0c7b0e97f55b9bd46faa6c2b8ac5146487d8c9b758c3672e7c"},"/home/circleci/repo/src/context/yaml/handlers/rulesConfigs.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/rulesConfigs.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":33},"end":{"line":14,"column":47}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":42}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":42}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":23,"column":4},"end":{"line":30,"column":7}},"19":{"start":{"line":24,"column":33},"end":{"line":24,"column":47}},"20":{"start":{"line":25,"column":8},"end":{"line":26,"column":42}},"21":{"start":{"line":26,"column":12},"end":{"line":26,"column":42}},"22":{"start":{"line":27,"column":8},"end":{"line":29,"column":10}},"23":{"start":{"line":32,"column":28},"end":{"line":35,"column":1}},"24":{"start":{"line":36,"column":0},"end":{"line":36,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parse","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":14}},"loc":{"start":{"line":12,"column":24},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13},"9":{"name":"dump","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":13}},"loc":{"start":{"line":22,"column":23},"end":{"line":31,"column":1}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":23,"column":43},"end":{"line":23,"column":44}},"loc":{"start":{"line":23,"column":56},"end":{"line":30,"column":5}},"line":23}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":42}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":42}},{"start":{"line":15,"column":8},"end":{"line":16,"column":42}}],"line":15},"6":{"loc":{"start":{"line":25,"column":8},"end":{"line":26,"column":42}},"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":26,"column":42}},{"start":{"line":25,"column":8},"end":{"line":26,"column":42}}],"line":25}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":41,"14":41,"15":41,"16":40,"17":1,"18":5,"19":5,"20":5,"21":0,"22":5,"23":1,"24":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":41,"8":41,"9":5,"10":5},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,1],"6":[0,5]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/rulesConfigs.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/rulesConfigs.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,KAAK,CAAC,OAAoB;;QACvC,MAAM,EAAE,YAAY,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAExC,IAAI,CAAC,YAAY;YAAE,OAAO,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;QAEjD,OAAO;YACL,YAAY;SACb,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,MAAM,EAAE,YAAY,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAExC,IAAI,CAAC,YAAY;YAAE,OAAO,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;QAEjD,OAAO;YACL,YAAY,EAAE,EAAE,EAAE,mFAAmF;SACtG,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,mBAAmB,GAAoC;IAC3D,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,mBAAmB,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedRulesConfigs = ParsedAsset<'rulesConfigs', Asset[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedRulesConfigs> {\n  const { rulesConfigs } = context.assets;\n\n  if (!rulesConfigs) return { rulesConfigs: null };\n\n  return {\n    rulesConfigs,\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedRulesConfigs> {\n  const { rulesConfigs } = context.assets;\n\n  if (!rulesConfigs) return { rulesConfigs: null };\n\n  return {\n    rulesConfigs: [], // even if they exist, do not export rulesConfigs as its values cannot be extracted\n  };\n}\n\nconst rulesConfigsHandler: YAMLHandler<ParsedRulesConfigs> = {\n  parse,\n  dump,\n};\n\nexport default rulesConfigsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"73301eb75c94dfe2eebe16b5865b0edef6a3a498","contentHash":"b9b68c40c1b9636468adae8fc0ebb555cf67c7e376f4a9b60bd3f72d37e795ec"},"/home/circleci/repo/src/context/yaml/handlers/resourceServers.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/resourceServers.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":21,"column":7}},"14":{"start":{"line":14,"column":36},"end":{"line":14,"column":50}},"15":{"start":{"line":15,"column":8},"end":{"line":17,"column":9}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":45}},"17":{"start":{"line":18,"column":8},"end":{"line":20,"column":10}},"18":{"start":{"line":23,"column":31},"end":{"line":26,"column":1}},"19":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"dumpAndParse","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":22,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":21,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":17,"column":9}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":17,"column":9}},{"start":{"line":15,"column":8},"end":{"line":17,"column":9}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/resourceServers.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/resourceServers.ts"],"names":[],"mappings":";;;;;;;;;;;AAOA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,eAAe,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE3C,IAAI,CAAC,eAAe,EAAE;YACpB,OAAO,EAAE,eAAe,EAAE,IAAI,EAAE,CAAC;SAClC;QACD,OAAO;YACL,eAAe;SAChB,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,sBAAsB,GAAuC;IACjE,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,sBAAsB,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { ResourceServer } from '../../../tools/auth0/handlers/resourceServers';\n\ntype ParsedResourceServers = ParsedAsset<'resourceServers', ResourceServer[]>;\n\nasync function dumpAndParse(context: YAMLContext): Promise<ParsedResourceServers> {\n  const { resourceServers } = context.assets;\n\n  if (!resourceServers) {\n    return { resourceServers: null };\n  }\n  return {\n    resourceServers,\n  };\n}\n\nconst resourceServersHandler: YAMLHandler<ParsedResourceServers> = {\n  parse: dumpAndParse,\n  dump: dumpAndParse,\n};\n\nexport default resourceServersHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"31c6988eca6c4d008cbbbebd587346f553fff199","contentHash":"301969dd964e0d73a8ba9a7b56354c31623eabb81317d3cc42454fcdd67dc678"},"/home/circleci/repo/src/context/yaml/handlers/guardianFactors.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/guardianFactors.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":36},"end":{"line":14,"column":50}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":45}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":45}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":31},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":45}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":45}},{"start":{"line":15,"column":8},"end":{"line":16,"column":45}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/guardianFactors.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/guardianFactors.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,eAAe,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE3C,IAAI,CAAC,eAAe;YAAE,OAAO,EAAE,eAAe,EAAE,IAAI,EAAE,CAAC;QAEvD,OAAO;YACL,eAAe;SAChB,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,sBAAsB,GAAuC;IACjE,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,sBAAsB,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianFactors = ParsedAsset<'guardianFactors', Asset[]>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedGuardianFactors> {\n  const { guardianFactors } = context.assets;\n\n  if (!guardianFactors) return { guardianFactors: null };\n\n  return {\n    guardianFactors,\n  };\n}\n\nconst guardianFactorsHandler: YAMLHandler<ParsedGuardianFactors> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default guardianFactorsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"32e20f5bb486e9ddec29bd686717be2808f61f6c","contentHash":"9558b89967f425515f864986be4261e8f6ff127be404c55676212ed7ef8da059"},"/home/circleci/repo/src/context/yaml/handlers/guardianFactorProviders.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/guardianFactorProviders.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":44},"end":{"line":14,"column":58}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":53}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":53}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":39},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":49}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":53}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":53}},{"start":{"line":15,"column":8},"end":{"line":16,"column":53}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/guardianFactorProviders.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/guardianFactorProviders.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,uBAAuB,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEnD,IAAI,CAAC,uBAAuB;YAAE,OAAO,EAAE,uBAAuB,EAAE,IAAI,EAAE,CAAC;QAEvE,OAAO;YACL,uBAAuB;SACxB,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,8BAA8B,GAA+C;IACjF,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,8BAA8B,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianFactorProviders = ParsedAsset<'guardianFactorProviders', Asset[]>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedGuardianFactorProviders> {\n  const { guardianFactorProviders } = context.assets;\n\n  if (!guardianFactorProviders) return { guardianFactorProviders: null };\n\n  return {\n    guardianFactorProviders,\n  };\n}\n\nconst guardianFactorProvidersHandler: YAMLHandler<ParsedGuardianFactorProviders> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default guardianFactorProvidersHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cd3f3a917100b8f8e9a32fa5444b17bae100eab4","contentHash":"b961e8983e4d76616b61c73d6bfaef66d35596e0f73659bebc2884ce08c4e221"},"/home/circleci/repo/src/context/yaml/handlers/guardianFactorTemplates.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/guardianFactorTemplates.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":44},"end":{"line":14,"column":58}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":53}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":53}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":39},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":49}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":53}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":53}},{"start":{"line":15,"column":8},"end":{"line":16,"column":53}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/guardianFactorTemplates.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/guardianFactorTemplates.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,uBAAuB,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEnD,IAAI,CAAC,uBAAuB;YAAE,OAAO,EAAE,uBAAuB,EAAE,IAAI,EAAE,CAAC;QAEvE,OAAO;YACL,uBAAuB;SACxB,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,8BAA8B,GAA+C;IACjF,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,8BAA8B,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianFactorTemplates = ParsedAsset<'guardianFactorTemplates', Asset[]>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedGuardianFactorTemplates> {\n  const { guardianFactorTemplates } = context.assets;\n\n  if (!guardianFactorTemplates) return { guardianFactorTemplates: null };\n\n  return {\n    guardianFactorTemplates,\n  };\n}\n\nconst guardianFactorTemplatesHandler: YAMLHandler<ParsedGuardianFactorTemplates> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default guardianFactorTemplatesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3e293a48002ec2d92d05e5492c4af37f59b833d9","contentHash":"7412a83e9f2bd4bccd183bc77b67f91ba06f3841013837e841a48221e9e2ec21"},"/home/circleci/repo/src/context/yaml/handlers/guardianPhoneFactorMessageTypes.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/guardianPhoneFactorMessageTypes.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":52},"end":{"line":14,"column":66}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":61}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":61}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":47},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":57}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":61}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":61}},{"start":{"line":15,"column":8},"end":{"line":16,"column":61}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/guardianPhoneFactorMessageTypes.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/guardianPhoneFactorMessageTypes.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,+BAA+B,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE3D,IAAI,CAAC,+BAA+B;YAAE,OAAO,EAAE,+BAA+B,EAAE,IAAI,EAAE,CAAC;QAEvF,OAAO;YACL,+BAA+B;SAChC,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,sCAAsC,GAAkD;IAC5F,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,sCAAsC,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianFactorMessageTypes = ParsedAsset<'guardianPhoneFactorMessageTypes', Asset>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedGuardianFactorMessageTypes> {\n  const { guardianPhoneFactorMessageTypes } = context.assets;\n\n  if (!guardianPhoneFactorMessageTypes) return { guardianPhoneFactorMessageTypes: null };\n\n  return {\n    guardianPhoneFactorMessageTypes,\n  };\n}\n\nconst guardianPhoneFactorMessageTypesHandler: YAMLHandler<ParsedGuardianFactorMessageTypes> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default guardianPhoneFactorMessageTypesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1470fe32e0c20be248a0e358fa8134134d1ecb7b","contentHash":"6a46933063b6027a72041a39e0671e9a41fce0afed302ab3838ce1def7187fbd"},"/home/circleci/repo/src/context/yaml/handlers/guardianPhoneFactorSelectedProvider.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/guardianPhoneFactorSelectedProvider.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":56},"end":{"line":14,"column":70}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":65}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":65}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":51},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":61}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":65}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":65}},{"start":{"line":15,"column":8},"end":{"line":16,"column":65}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/guardianPhoneFactorSelectedProvider.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/guardianPhoneFactorSelectedProvider.ts"],"names":[],"mappings":";;;;;;;;;;;AASA,SAAe,YAAY,CACzB,OAAoB;;QAEpB,MAAM,EAAE,mCAAmC,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE/D,IAAI,CAAC,mCAAmC;YAAE,OAAO,EAAE,mCAAmC,EAAE,IAAI,EAAE,CAAC;QAE/F,OAAO;YACL,mCAAmC;SACpC,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,0CAA0C,GAC9C;IACE,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEJ,kBAAe,0CAA0C,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianPhoneFactorSelectedProvider = ParsedAsset<\n  'guardianPhoneFactorSelectedProvider',\n  Asset\n>;\n\nasync function parseAndDump(\n  context: YAMLContext\n): Promise<ParsedGuardianPhoneFactorSelectedProvider> {\n  const { guardianPhoneFactorSelectedProvider } = context.assets;\n\n  if (!guardianPhoneFactorSelectedProvider) return { guardianPhoneFactorSelectedProvider: null };\n\n  return {\n    guardianPhoneFactorSelectedProvider,\n  };\n}\n\nconst guardianPhoneFactorSelectedProviderHandler: YAMLHandler<ParsedGuardianPhoneFactorSelectedProvider> =\n  {\n    parse: parseAndDump,\n    dump: parseAndDump,\n  };\n\nexport default guardianPhoneFactorSelectedProviderHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7b33bf4ce575f7d58a0defccac4a603d7ec6230c","contentHash":"d7f7403e315062ac62c33def3cedaf00482485731bf386fb5c03bb6ad551fcf3"},"/home/circleci/repo/src/context/yaml/handlers/guardianPolicies.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/guardianPolicies.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":37},"end":{"line":14,"column":51}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":46}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":46}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":32},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":46}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":46}},{"start":{"line":15,"column":8},"end":{"line":16,"column":46}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":39,"17":7,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[39,7]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/guardianPolicies.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/guardianPolicies.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,gBAAgB,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE5C,IAAI,CAAC,gBAAgB;YAAE,OAAO,EAAE,gBAAgB,EAAE,IAAI,EAAE,CAAC;QAEzD,OAAO;YACL,gBAAgB;SACjB,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,uBAAuB,GAAwC;IACnE,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,uBAAuB,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianPolicies = ParsedAsset<'guardianPolicies', { policies: Asset[] }>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedGuardianPolicies> {\n  const { guardianPolicies } = context.assets;\n\n  if (!guardianPolicies) return { guardianPolicies: null };\n\n  return {\n    guardianPolicies,\n  };\n}\n\nconst guardianPoliciesHandler: YAMLHandler<ParsedGuardianPolicies> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default guardianPoliciesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"aa4e50040fe7877b627749017656498f93977394","contentHash":"c191d1fc28e08cf4423e4dec1386a09d3c4069461c49263eebaae8f62d5aa7e6"},"/home/circleci/repo/src/context/yaml/handlers/roles.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/roles.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":26},"end":{"line":14,"column":40}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":35}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":35}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":23,"column":4},"end":{"line":35,"column":7}},"19":{"start":{"line":24,"column":26},"end":{"line":24,"column":40}},"20":{"start":{"line":25,"column":8},"end":{"line":26,"column":35}},"21":{"start":{"line":26,"column":12},"end":{"line":26,"column":35}},"22":{"start":{"line":27,"column":8},"end":{"line":34,"column":10}},"23":{"start":{"line":29,"column":16},"end":{"line":31,"column":17}},"24":{"start":{"line":30,"column":20},"end":{"line":30,"column":44}},"25":{"start":{"line":32,"column":16},"end":{"line":32,"column":28}},"26":{"start":{"line":37,"column":21},"end":{"line":40,"column":1}},"27":{"start":{"line":41,"column":0},"end":{"line":41,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parse","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":14}},"loc":{"start":{"line":12,"column":24},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13},"9":{"name":"dump","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":13}},"loc":{"start":{"line":22,"column":23},"end":{"line":36,"column":1}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":23,"column":43},"end":{"line":23,"column":44}},"loc":{"start":{"line":23,"column":56},"end":{"line":35,"column":5}},"line":23},"11":{"name":"(anonymous_11)","decl":{"start":{"line":28,"column":29},"end":{"line":28,"column":30}},"loc":{"start":{"line":28,"column":39},"end":{"line":33,"column":13}},"line":28}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":35}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":35}},{"start":{"line":15,"column":8},"end":{"line":16,"column":35}}],"line":15},"6":{"loc":{"start":{"line":25,"column":8},"end":{"line":26,"column":35}},"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":26,"column":35}},{"start":{"line":25,"column":8},"end":{"line":26,"column":35}}],"line":25},"7":{"loc":{"start":{"line":29,"column":16},"end":{"line":31,"column":17}},"type":"if","locations":[{"start":{"line":29,"column":16},"end":{"line":31,"column":17}},{"start":{"line":29,"column":16},"end":{"line":31,"column":17}}],"line":29}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":41,"14":41,"15":41,"16":40,"17":1,"18":5,"19":5,"20":5,"21":0,"22":5,"23":6,"24":0,"25":6,"26":1,"27":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":41,"8":41,"9":5,"10":5,"11":6},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,1],"6":[0,5],"7":[0,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/roles.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/roles.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,KAAK,CAAC,OAAoB;;QACvC,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEjC,IAAI,CAAC,KAAK;YAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;QAEnC,OAAO;YACL,KAAK;SACN,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEjC,IAAI,CAAC,KAAK;YAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;QAEnC,OAAO;YACL,KAAK,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;gBACxB,IAAI,IAAI,CAAC,WAAW,KAAK,IAAI,EAAE;oBAC7B,OAAO,IAAI,CAAC,WAAW,CAAC;iBACzB;gBAED,OAAO,IAAI,CAAC;YACd,CAAC,CAAC;SACH,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,YAAY,GAA6B;IAC7C,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,YAAY,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedRoles = ParsedAsset<'roles', Asset[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedRoles> {\n  const { roles } = context.assets;\n\n  if (!roles) return { roles: null };\n\n  return {\n    roles,\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedRoles> {\n  const { roles } = context.assets;\n\n  if (!roles) return { roles: null };\n\n  return {\n    roles: roles.map((role) => {\n      if (role.description === null) {\n        delete role.description;\n      }\n\n      return role;\n    }),\n  };\n}\n\nconst rolesHandler: YAMLHandler<ParsedRoles> = {\n  parse,\n  dump,\n};\n\nexport default rolesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"875e55721aa7e6129056198481ddf5d1ad80eb85","contentHash":"d49ca18a1ab6fc76bc788cd0d541c53e5c85b29265abce053acc382450169381"},"/home/circleci/repo/src/context/yaml/handlers/organizations.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/organizations.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":34},"end":{"line":14,"column":48}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":43}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":43}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":23,"column":4},"end":{"line":41,"column":7}},"19":{"start":{"line":24,"column":34},"end":{"line":24,"column":48}},"20":{"start":{"line":25,"column":8},"end":{"line":26,"column":43}},"21":{"start":{"line":26,"column":12},"end":{"line":26,"column":43}},"22":{"start":{"line":27,"column":8},"end":{"line":40,"column":10}},"23":{"start":{"line":29,"column":16},"end":{"line":37,"column":17}},"24":{"start":{"line":30,"column":20},"end":{"line":36,"column":23}},"25":{"start":{"line":32,"column":37},"end":{"line":32,"column":70}},"26":{"start":{"line":33,"column":24},"end":{"line":33,"column":47}},"27":{"start":{"line":34,"column":24},"end":{"line":34,"column":44}},"28":{"start":{"line":35,"column":24},"end":{"line":35,"column":58}},"29":{"start":{"line":38,"column":16},"end":{"line":38,"column":27}},"30":{"start":{"line":43,"column":29},"end":{"line":46,"column":1}},"31":{"start":{"line":47,"column":0},"end":{"line":47,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parse","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":14}},"loc":{"start":{"line":12,"column":24},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13},"9":{"name":"dump","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":13}},"loc":{"start":{"line":22,"column":23},"end":{"line":42,"column":1}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":23,"column":43},"end":{"line":23,"column":44}},"loc":{"start":{"line":23,"column":56},"end":{"line":41,"column":5}},"line":23},"11":{"name":"(anonymous_11)","decl":{"start":{"line":28,"column":45},"end":{"line":28,"column":46}},"loc":{"start":{"line":28,"column":54},"end":{"line":39,"column":13}},"line":28},"12":{"name":"(anonymous_12)","decl":{"start":{"line":30,"column":58},"end":{"line":30,"column":59}},"loc":{"start":{"line":30,"column":65},"end":{"line":36,"column":21}},"line":30}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":43}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":43}},{"start":{"line":15,"column":8},"end":{"line":16,"column":43}}],"line":15},"6":{"loc":{"start":{"line":25,"column":8},"end":{"line":26,"column":43}},"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":26,"column":43}},{"start":{"line":25,"column":8},"end":{"line":26,"column":43}}],"line":25},"7":{"loc":{"start":{"line":29,"column":16},"end":{"line":37,"column":17}},"type":"if","locations":[{"start":{"line":29,"column":16},"end":{"line":37,"column":17}},{"start":{"line":29,"column":16},"end":{"line":37,"column":17}}],"line":29},"8":{"loc":{"start":{"line":32,"column":37},"end":{"line":32,"column":70}},"type":"binary-expr","locations":[{"start":{"line":32,"column":37},"end":{"line":32,"column":49}},{"start":{"line":32,"column":53},"end":{"line":32,"column":70}}],"line":32}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":41,"14":41,"15":41,"16":40,"17":1,"18":5,"19":5,"20":5,"21":0,"22":5,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":41,"8":41,"9":5,"10":5,"11":1,"12":1},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,1],"6":[0,5],"7":[1,0],"8":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/organizations.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/organizations.ts"],"names":[],"mappings":";;;;;;;;;;;AAQA,SAAe,KAAK,CAAC,OAAoB;;QACvC,MAAM,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEzC,IAAI,CAAC,aAAa;YAAE,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC;QAEnD,OAAO;YACL,aAAa;SACd,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,MAAM,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEzC,IAAI,CAAC,aAAa;YAAE,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC;QAEnD,OAAO;YACL,aAAa,EAAE,aAAa,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE;gBACvC,IAAI,GAAG,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC9B,GAAG,CAAC,WAAW,GAAG,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;wBAC1C,iCAAiC;wBACjC,MAAM,IAAI,GAAG,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC;wBAC/C,OAAO,CAAC,CAAC,aAAa,CAAC;wBACvB,OAAO,CAAC,CAAC,UAAU,CAAC;wBAEpB,uBACE,IAAI,IACD,CAAC,EACJ;oBACJ,CAAC,CAAC,CAAC;iBACJ;gBAED,OAAO,GAAG,CAAC;YACb,CAAC,CAAC;SACH,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,oBAAoB,GAAqC;IAC7D,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,oBAAoB,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedOrganizations = {\n  organizations: Asset[] | null;\n};\n\nasync function parse(context: YAMLContext): Promise<ParsedOrganizations> {\n  const { organizations } = context.assets;\n\n  if (!organizations) return { organizations: null };\n\n  return {\n    organizations,\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedOrganizations> {\n  const { organizations } = context.assets;\n\n  if (!organizations) return { organizations: null };\n\n  return {\n    organizations: organizations.map((org) => {\n      if (org.connections.length > 0) {\n        org.connections = org.connections.map((c) => {\n          // connection is a computed field\n          const name = c.connection && c.connection.name;\n          delete c.connection_id;\n          delete c.connection;\n\n          return {\n            name,\n            ...c,\n          };\n        });\n      }\n\n      return org;\n    }),\n  };\n}\n\nconst organizationsHandler: YAMLHandler<ParsedOrganizations> = {\n  parse,\n  dump,\n};\n\nexport default organizationsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cd3d1b2628e371fe92a8d4f6ec13f23e46a2be6a","contentHash":"12017b5c4d83274547bfefd38b1920d815f5e4292e49c8bd43d72f9992e0392a"},"/home/circleci/repo/src/context/yaml/handlers/migrations.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/migrations.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":18,"column":7}},"14":{"start":{"line":14,"column":31},"end":{"line":14,"column":45}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":40}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":40}},"17":{"start":{"line":17,"column":8},"end":{"line":17,"column":30}},"18":{"start":{"line":20,"column":26},"end":{"line":23,"column":1}},"19":{"start":{"line":24,"column":0},"end":{"line":24,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":19,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":18,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":40}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":40}},{"start":{"line":15,"column":8},"end":{"line":16,"column":40}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":47,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":47,"11":47,"12":1,"13":47,"14":47,"15":47,"16":40,"17":7,"18":1,"19":1},"f":{"0":47,"1":0,"2":0,"3":47,"4":0,"5":0,"6":47,"7":47,"8":47},"b":{"0":[1,1,1],"1":[0,0],"2":[47,47],"3":[47,0],"4":[47,47],"5":[40,7]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/migrations.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/migrations.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,UAAU,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEtC,IAAI,CAAC,UAAU;YAAE,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;QAE7C,OAAO,EAAE,UAAU,EAAE,CAAC;IACxB,CAAC;CAAA;AAED,MAAM,iBAAiB,GAAkC;IACvD,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,iBAAiB,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedMigrations = ParsedAsset<'migrations', Asset[]>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedMigrations> {\n  const { migrations } = context.assets;\n\n  if (!migrations) return { migrations: null };\n\n  return { migrations };\n}\n\nconst migrationsHandler: YAMLHandler<ParsedMigrations> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default migrationsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"793577c398027dc4f6e9e67a7a50fc1cef8c6110","contentHash":"b5e992bf96c2abfe02a20bd42879c411c71f564156a8dddd733a519abefe7c1c"},"/home/circleci/repo/src/context/yaml/handlers/actions.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/actions.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":16,"column":15},"end":{"line":16,"column":47}},"16":{"start":{"line":17,"column":19},"end":{"line":17,"column":55}},"17":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"18":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"19":{"start":{"line":20,"column":17},"end":{"line":20,"column":60}},"20":{"start":{"line":21,"column":18},"end":{"line":21,"column":66}},"21":{"start":{"line":23,"column":4},"end":{"line":26,"column":5}},"22":{"start":{"line":25,"column":8},"end":{"line":25,"column":75}},"23":{"start":{"line":29,"column":4},"end":{"line":39,"column":7}},"24":{"start":{"line":31,"column":28},"end":{"line":31,"column":42}},"25":{"start":{"line":32,"column":8},"end":{"line":33,"column":37}},"26":{"start":{"line":33,"column":12},"end":{"line":33,"column":37}},"27":{"start":{"line":34,"column":8},"end":{"line":38,"column":10}},"28":{"start":{"line":36,"column":44},"end":{"line":36,"column":133}},"29":{"start":{"line":42,"column":4},"end":{"line":44,"column":5}},"30":{"start":{"line":43,"column":8},"end":{"line":43,"column":85}},"31":{"start":{"line":43,"column":40},"end":{"line":43,"column":82}},"32":{"start":{"line":45,"column":4},"end":{"line":45,"column":14}},"33":{"start":{"line":48,"column":21},"end":{"line":48,"column":27}},"34":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"35":{"start":{"line":50,"column":8},"end":{"line":50,"column":18}},"36":{"start":{"line":52,"column":23},"end":{"line":52,"column":57}},"37":{"start":{"line":53,"column":33},"end":{"line":53,"column":111}},"38":{"start":{"line":54,"column":4},"end":{"line":54,"column":59}},"39":{"start":{"line":55,"column":21},"end":{"line":55,"column":73}},"40":{"start":{"line":56,"column":4},"end":{"line":56,"column":49}},"41":{"start":{"line":57,"column":4},"end":{"line":57,"column":53}},"42":{"start":{"line":58,"column":4},"end":{"line":58,"column":76}},"43":{"start":{"line":61,"column":4},"end":{"line":86,"column":7}},"44":{"start":{"line":62,"column":28},"end":{"line":62,"column":42}},"45":{"start":{"line":63,"column":8},"end":{"line":64,"column":37}},"46":{"start":{"line":64,"column":12},"end":{"line":64,"column":37}},"47":{"start":{"line":66,"column":32},"end":{"line":72,"column":10}},"48":{"start":{"line":67,"column":12},"end":{"line":70,"column":13}},"49":{"start":{"line":68,"column":16},"end":{"line":68,"column":160}},"50":{"start":{"line":69,"column":16},"end":{"line":69,"column":29}},"51":{"start":{"line":71,"column":12},"end":{"line":71,"column":24}},"52":{"start":{"line":73,"column":8},"end":{"line":85,"column":10}},"53":{"start":{"line":74,"column":54},"end":{"line":84,"column":13}},"54":{"start":{"line":88,"column":23},"end":{"line":91,"column":1}},"55":{"start":{"line":92,"column":0},"end":{"line":92,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parseCode","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":18}},"loc":{"start":{"line":22,"column":34},"end":{"line":27,"column":1}},"line":22},"9":{"name":"parse","decl":{"start":{"line":28,"column":9},"end":{"line":28,"column":14}},"loc":{"start":{"line":28,"column":24},"end":{"line":40,"column":1}},"line":28},"10":{"name":"(anonymous_10)","decl":{"start":{"line":29,"column":43},"end":{"line":29,"column":44}},"loc":{"start":{"line":29,"column":56},"end":{"line":39,"column":5}},"line":29},"11":{"name":"(anonymous_11)","decl":{"start":{"line":36,"column":31},"end":{"line":36,"column":32}},"loc":{"start":{"line":36,"column":44},"end":{"line":36,"column":133}},"line":36},"12":{"name":"mapSecrets","decl":{"start":{"line":41,"column":9},"end":{"line":41,"column":19}},"loc":{"start":{"line":41,"column":29},"end":{"line":46,"column":1}},"line":41},"13":{"name":"(anonymous_13)","decl":{"start":{"line":43,"column":27},"end":{"line":43,"column":28}},"loc":{"start":{"line":43,"column":40},"end":{"line":43,"column":82}},"line":43},"14":{"name":"mapActionCode","decl":{"start":{"line":47,"column":9},"end":{"line":47,"column":22}},"loc":{"start":{"line":47,"column":41},"end":{"line":59,"column":1}},"line":47},"15":{"name":"dump","decl":{"start":{"line":60,"column":9},"end":{"line":60,"column":13}},"loc":{"start":{"line":60,"column":23},"end":{"line":87,"column":1}},"line":60},"16":{"name":"(anonymous_16)","decl":{"start":{"line":61,"column":43},"end":{"line":61,"column":44}},"loc":{"start":{"line":61,"column":56},"end":{"line":86,"column":5}},"line":61},"17":{"name":"(anonymous_17)","decl":{"start":{"line":66,"column":47},"end":{"line":66,"column":48}},"loc":{"start":{"line":66,"column":59},"end":{"line":72,"column":9}},"line":66},"18":{"name":"(anonymous_18)","decl":{"start":{"line":74,"column":41},"end":{"line":74,"column":42}},"loc":{"start":{"line":74,"column":54},"end":{"line":84,"column":13}},"line":74}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":23,"column":4},"end":{"line":26,"column":5}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":26,"column":5}},{"start":{"line":23,"column":4},"end":{"line":26,"column":5}}],"line":23},"9":{"loc":{"start":{"line":32,"column":8},"end":{"line":33,"column":37}},"type":"if","locations":[{"start":{"line":32,"column":8},"end":{"line":33,"column":37}},{"start":{"line":32,"column":8},"end":{"line":33,"column":37}}],"line":32},"10":{"loc":{"start":{"line":36,"column":112},"end":{"line":36,"column":129}},"type":"binary-expr","locations":[{"start":{"line":36,"column":112},"end":{"line":36,"column":123}},{"start":{"line":36,"column":127},"end":{"line":36,"column":129}}],"line":36},"11":{"loc":{"start":{"line":42,"column":4},"end":{"line":44,"column":5}},"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":44,"column":5}},{"start":{"line":42,"column":4},"end":{"line":44,"column":5}}],"line":42},"12":{"loc":{"start":{"line":42,"column":8},"end":{"line":42,"column":37}},"type":"binary-expr","locations":[{"start":{"line":42,"column":8},"end":{"line":42,"column":15}},{"start":{"line":42,"column":19},"end":{"line":42,"column":37}}],"line":42},"13":{"loc":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},{"start":{"line":49,"column":4},"end":{"line":51,"column":5}}],"line":49},"14":{"loc":{"start":{"line":63,"column":8},"end":{"line":64,"column":37}},"type":"if","locations":[{"start":{"line":63,"column":8},"end":{"line":64,"column":37}},{"start":{"line":63,"column":8},"end":{"line":64,"column":37}}],"line":63},"15":{"loc":{"start":{"line":67,"column":12},"end":{"line":70,"column":13}},"type":"if","locations":[{"start":{"line":67,"column":12},"end":{"line":70,"column":13}},{"start":{"line":67,"column":12},"end":{"line":70,"column":13}}],"line":67},"16":{"loc":{"start":{"line":76,"column":26},"end":{"line":76,"column":76}},"type":"binary-expr","locations":[{"start":{"line":76,"column":26},"end":{"line":76,"column":43}},{"start":{"line":76,"column":47},"end":{"line":76,"column":76}}],"line":76},"17":{"loc":{"start":{"line":80,"column":30},"end":{"line":80,"column":55}},"type":"binary-expr","locations":[{"start":{"line":80,"column":30},"end":{"line":80,"column":49}},{"start":{"line":80,"column":53},"end":{"line":80,"column":55}}],"line":80},"18":{"loc":{"start":{"line":82,"column":25},"end":{"line":82,"column":111}},"type":"cond-expr","locations":[{"start":{"line":82,"column":62},"end":{"line":82,"column":76}},{"start":{"line":82,"column":79},"end":{"line":82,"column":111}}],"line":82},"19":{"loc":{"start":{"line":82,"column":90},"end":{"line":82,"column":110}},"type":"binary-expr","locations":[{"start":{"line":82,"column":90},"end":{"line":82,"column":104}},{"start":{"line":82,"column":108},"end":{"line":82,"column":110}}],"line":82}},"s":{"0":1,"1":0,"2":0,"3":47,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":47,"11":47,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":41,"24":41,"25":41,"26":38,"27":3,"28":1,"29":1,"30":0,"31":0,"32":1,"33":1,"34":1,"35":0,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":6,"44":6,"45":6,"46":0,"47":6,"48":2,"49":1,"50":1,"51":1,"52":6,"53":1,"54":1,"55":1},"f":{"0":47,"1":0,"2":0,"3":47,"4":0,"5":0,"6":47,"7":3,"8":1,"9":41,"10":41,"11":1,"12":1,"13":0,"14":1,"15":6,"16":6,"17":2,"18":1},"b":{"0":[1,1,1],"1":[0,0],"2":[47,47],"3":[47,0],"4":[47,47],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[1,0],"9":[38,3],"10":[1,0],"11":[0,1],"12":[1,1],"13":[0,1],"14":[0,6],"15":[1,1],"16":[1,0],"17":[1,0],"18":[0,1],"19":[1,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/actions.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/actions.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable consistent-return */\nimport path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { sanitize } from '../../../utils';\nimport log from '../../../logger';\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { Action, isMarketplaceAction } from '../../../tools/auth0/handlers/actions';\n\ntype ParsedActions = ParsedAsset<'actions', Partial<Action>[]>;\n\ntype Secret = { name: string; value: string };\n\nfunction parseCode(context: YAMLContext, code: string) {\n  if (code) {\n    //@ts-ignore TODO: understand why two arguments are passed when context.loadFile only accepts one\n    return context.loadFile(code, constants.ACTIONS_DIRECTORY);\n  }\n}\n\nasync function parse(context: YAMLContext): Promise<ParsedActions> {\n  // Load the script file for each action\n  const { actions } = context.assets;\n\n  if (!actions) return { actions: null };\n\n  return {\n    actions: [\n      ...actions.map((action) => ({\n        ...action,\n        code: parseCode(context, action.code || ''),\n      })),\n    ],\n  };\n}\n\nfunction mapSecrets(secrets: { name: string; value: string }[]): Secret[] {\n  if (secrets && secrets.length > 0) {\n    return secrets.map((secret) => ({ name: secret.name, value: secret.value }));\n  }\n  return [];\n}\n\nfunction mapActionCode(basePath: string, action: { code: string; name: string }): string {\n  const { code } = action;\n\n  if (!code) {\n    return '';\n  }\n\n  const actionName = sanitize(action.name);\n  const actionVersionsFolder = path.join(basePath, constants.ACTIONS_DIRECTORY, actionName);\n  fs.ensureDirSync(actionVersionsFolder);\n\n  const codeFile = path.join(actionVersionsFolder, 'code.js');\n  log.info(`Writing ${codeFile}`);\n  fs.writeFileSync(codeFile, code);\n\n  return `./${constants.ACTIONS_DIRECTORY}/${actionName}/code.js`;\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedActions> {\n  const { actions } = context.assets;\n\n  if (!actions) return { actions: null };\n\n  // Marketplace actions are not currently supported for management (See ESD-23225)\n  const filteredActions = actions.filter((action) => {\n    if (isMarketplaceAction(action)) {\n      log.warn(\n        `Skipping export of marketplace action \"${action.name}\". Management of marketplace actions are not currently supported.`\n      );\n      return false;\n    }\n    return true;\n  });\n\n  return {\n    actions: filteredActions.map((action) => ({\n      name: action.name,\n      deployed: !!action.deployed || !!action.all_changes_deployed,\n      //@ts-ignore because Action resource needs to be typed more accurately\n      code: mapActionCode(context.basePath, action),\n      runtime: action.runtime,\n      dependencies: action.dependencies || [],\n      status: action.status,\n      secrets:\n        typeof action.secrets === 'string' ? action.secrets : mapSecrets(action.secrets || []), //Enables keyword preservation to operate on action secrets\n      supported_triggers: action.supported_triggers,\n    })),\n  };\n}\n\nconst ActionsHandler: YAMLHandler<ParsedActions> = {\n  parse,\n  dump,\n};\n\nexport default ActionsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8753a0184b3ffbc417626c08077dec8bc21a3f9f","contentHash":"fd86442223046a1555592a756ac2ec60eab0be27195b52dd4a9fb7f61708c734"},"/home/circleci/repo/src/context/yaml/handlers/triggers.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/triggers.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":15,"column":8},"end":{"line":16,"column":38}},"15":{"start":{"line":16,"column":12},"end":{"line":16,"column":38}},"16":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"17":{"start":{"line":23,"column":4},"end":{"line":31,"column":7}},"18":{"start":{"line":24,"column":29},"end":{"line":24,"column":43}},"19":{"start":{"line":26,"column":8},"end":{"line":27,"column":38}},"20":{"start":{"line":27,"column":12},"end":{"line":27,"column":38}},"21":{"start":{"line":28,"column":8},"end":{"line":30,"column":10}},"22":{"start":{"line":33,"column":24},"end":{"line":36,"column":1}},"23":{"start":{"line":37,"column":0},"end":{"line":37,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parse","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":14}},"loc":{"start":{"line":12,"column":24},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13},"9":{"name":"dump","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":13}},"loc":{"start":{"line":22,"column":23},"end":{"line":32,"column":1}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":23,"column":43},"end":{"line":23,"column":44}},"loc":{"start":{"line":23,"column":56},"end":{"line":31,"column":5}},"line":23}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":38}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":38}},{"start":{"line":15,"column":8},"end":{"line":16,"column":38}}],"line":15},"6":{"loc":{"start":{"line":26,"column":8},"end":{"line":27,"column":38}},"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":27,"column":38}},{"start":{"line":26,"column":8},"end":{"line":27,"column":38}}],"line":26}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":41,"14":41,"15":40,"16":1,"17":5,"18":5,"19":5,"20":0,"21":5,"22":1,"23":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":41,"8":41,"9":5,"10":5},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,1],"6":[0,5]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/triggers.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/triggers.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,KAAK,CAAC,OAAoB;;QACvC,uCAAuC;QACvC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ;YAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;QACxD,OAAO;YACL,QAAQ,EAAE,OAAO,CAAC,MAAM,CAAC,QAAQ;SAClC,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,MAAM,EAAE,QAAQ,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QACpC,gBAAgB;QAChB,IAAI,CAAC,QAAQ;YAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;QACzC,OAAO;YACL,QAAQ,EAAE,QAAQ;SACnB,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,eAAe,GAAgC;IACnD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,eAAe,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedTriggers = ParsedAsset<'triggers', Asset[]>;\n\nasync function parse(context: YAMLContext): Promise<ParsedTriggers> {\n  // Load the script file for each action\n  if (!context.assets.triggers) return { triggers: null };\n  return {\n    triggers: context.assets.triggers,\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedTriggers> {\n  const { triggers } = context.assets;\n  // Nothing to do\n  if (!triggers) return { triggers: null };\n  return {\n    triggers: triggers,\n  };\n}\n\nconst triggersHandler: YAMLHandler<ParsedTriggers> = {\n  parse,\n  dump,\n};\n\nexport default triggersHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"81941a4781b22c30e41498e5a0af8880b5179c31","contentHash":"19a310342690e5775b0cdd01376d45ed4e0c207374335d6017c78889e99b2173"},"/home/circleci/repo/src/context/yaml/handlers/attackProtection.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/attackProtection.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":25,"column":7}},"14":{"start":{"line":14,"column":37},"end":{"line":14,"column":51}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":46}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":46}},"17":{"start":{"line":17,"column":92},"end":{"line":17,"column":108}},"18":{"start":{"line":18,"column":8},"end":{"line":24,"column":10}},"19":{"start":{"line":27,"column":32},"end":{"line":30,"column":1}},"20":{"start":{"line":31,"column":0},"end":{"line":31,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":26,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":25,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":46}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":46}},{"start":{"line":15,"column":8},"end":{"line":16,"column":46}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":6,"19":1,"20":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/attackProtection.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/attackProtection.ts"],"names":[],"mappings":";;;;;;;;;;;AAaA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,gBAAgB,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE5C,IAAI,CAAC,gBAAgB;YAAE,OAAO,EAAE,gBAAgB,EAAE,IAAI,EAAE,CAAC;QAEzD,MAAM,EAAE,sBAAsB,EAAE,yBAAyB,EAAE,oBAAoB,EAAE,GAC/E,gBAAgB,CAAC;QAEnB,OAAO;YACL,gBAAgB,EAAE;gBAChB,sBAAsB;gBACtB,yBAAyB;gBACzB,oBAAoB;aACrB;SACF,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,uBAAuB,GAAwC;IACnE,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,uBAAuB,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedAttackProtection = ParsedAsset<\n  'attackProtection',\n  {\n    breachedPasswordDetection: Asset;\n    bruteForceProtection: Asset;\n    suspiciousIpThrottling: Asset;\n  }\n>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedAttackProtection> {\n  const { attackProtection } = context.assets;\n\n  if (!attackProtection) return { attackProtection: null };\n\n  const { suspiciousIpThrottling, breachedPasswordDetection, bruteForceProtection } =\n    attackProtection;\n\n  return {\n    attackProtection: {\n      suspiciousIpThrottling,\n      breachedPasswordDetection,\n      bruteForceProtection,\n    },\n  };\n}\n\nconst attackProtectionHandler: YAMLHandler<ParsedAttackProtection> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default attackProtectionHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"eb1a379cff4ef5d72021c9e2d4ed42273a10f57e","contentHash":"94ed139acc8b21ffa00a4f8ec1838c56bbe7be9a46bd8cfc73be7d7cfc01ea97"},"/home/circleci/repo/src/context/yaml/handlers/branding.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/branding.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":14}},"14":{"start":{"line":13,"column":4},"end":{"line":14,"column":20}},"15":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"16":{"start":{"line":14,"column":8},"end":{"line":14,"column":20}},"17":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"18":{"start":{"line":16,"column":8},"end":{"line":19,"column":9}},"19":{"start":{"line":16,"column":21},"end":{"line":16,"column":22}},"20":{"start":{"line":16,"column":28},"end":{"line":16,"column":59}},"21":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"22":{"start":{"line":18,"column":16},"end":{"line":18,"column":34}},"23":{"start":{"line":20,"column":4},"end":{"line":20,"column":13}},"24":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"25":{"start":{"line":23,"column":4},"end":{"line":23,"column":62}},"26":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"27":{"start":{"line":26,"column":15},"end":{"line":26,"column":47}},"28":{"start":{"line":27,"column":19},"end":{"line":27,"column":55}},"29":{"start":{"line":28,"column":16},"end":{"line":28,"column":41}},"30":{"start":{"line":30,"column":4},"end":{"line":50,"column":7}},"31":{"start":{"line":31,"column":8},"end":{"line":32,"column":38}},"32":{"start":{"line":32,"column":12},"end":{"line":32,"column":38}},"33":{"start":{"line":33,"column":19},"end":{"line":33,"column":42}},"34":{"start":{"line":33,"column":60},"end":{"line":33,"column":62}},"35":{"start":{"line":33,"column":75},"end":{"line":33,"column":100}},"36":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"37":{"start":{"line":35,"column":12},"end":{"line":35,"column":61}},"38":{"start":{"line":37,"column":32},"end":{"line":46,"column":10}},"39":{"start":{"line":38,"column":31},"end":{"line":38,"column":93}},"40":{"start":{"line":39,"column":12},"end":{"line":45,"column":14}},"41":{"start":{"line":47,"column":8},"end":{"line":49,"column":10}},"42":{"start":{"line":53,"column":4},"end":{"line":78,"column":7}},"43":{"start":{"line":54,"column":8},"end":{"line":55,"column":38}},"44":{"start":{"line":55,"column":12},"end":{"line":55,"column":38}},"45":{"start":{"line":56,"column":19},"end":{"line":56,"column":42}},"46":{"start":{"line":56,"column":76},"end":{"line":56,"column":78}},"47":{"start":{"line":56,"column":91},"end":{"line":56,"column":116}},"48":{"start":{"line":57,"column":24},"end":{"line":57,"column":44}},"49":{"start":{"line":59,"column":8},"end":{"line":76,"column":9}},"50":{"start":{"line":60,"column":44},"end":{"line":60,"column":134}},"51":{"start":{"line":61,"column":12},"end":{"line":61,"column":70}},"52":{"start":{"line":62,"column":12},"end":{"line":75,"column":15}},"53":{"start":{"line":63,"column":29},"end":{"line":63,"column":66}},"54":{"start":{"line":64,"column":43},"end":{"line":64,"column":93}},"55":{"start":{"line":65,"column":31},"end":{"line":65,"column":54}},"56":{"start":{"line":66,"column":16},"end":{"line":71,"column":17}},"57":{"start":{"line":67,"column":20},"end":{"line":67,"column":81}},"58":{"start":{"line":70,"column":20},"end":{"line":70,"column":122}},"59":{"start":{"line":73,"column":16},"end":{"line":73,"column":148}},"60":{"start":{"line":74,"column":16},"end":{"line":74,"column":42}},"61":{"start":{"line":77,"column":8},"end":{"line":77,"column":68}},"62":{"start":{"line":80,"column":24},"end":{"line":83,"column":1}},"63":{"start":{"line":84,"column":0},"end":{"line":84,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":38},"end":{"line":11,"column":39}},"loc":{"start":{"line":11,"column":54},"end":{"line":21,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":22,"column":56},"end":{"line":22,"column":57}},"loc":{"start":{"line":22,"column":71},"end":{"line":24,"column":1}},"line":22},"9":{"name":"parse","decl":{"start":{"line":29,"column":9},"end":{"line":29,"column":14}},"loc":{"start":{"line":29,"column":24},"end":{"line":51,"column":1}},"line":29},"10":{"name":"(anonymous_10)","decl":{"start":{"line":30,"column":43},"end":{"line":30,"column":44}},"loc":{"start":{"line":30,"column":56},"end":{"line":50,"column":5}},"line":30},"11":{"name":"(anonymous_11)","decl":{"start":{"line":37,"column":46},"end":{"line":37,"column":47}},"loc":{"start":{"line":37,"column":70},"end":{"line":46,"column":9}},"line":37},"12":{"name":"dump","decl":{"start":{"line":52,"column":9},"end":{"line":52,"column":13}},"loc":{"start":{"line":52,"column":23},"end":{"line":79,"column":1}},"line":52},"13":{"name":"(anonymous_13)","decl":{"start":{"line":53,"column":43},"end":{"line":53,"column":44}},"loc":{"start":{"line":53,"column":56},"end":{"line":78,"column":5}},"line":53},"14":{"name":"(anonymous_14)","decl":{"start":{"line":62,"column":38},"end":{"line":62,"column":39}},"loc":{"start":{"line":62,"column":62},"end":{"line":75,"column":13}},"line":62}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":14},"end":{"line":11,"column":18}},{"start":{"line":11,"column":22},"end":{"line":11,"column":33}},{"start":{"line":11,"column":38},"end":{"line":21,"column":1}}],"line":11},"6":{"loc":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"type":"if","locations":[{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},{"start":{"line":13,"column":21},"end":{"line":14,"column":20}}],"line":13},"7":{"loc":{"start":{"line":13,"column":25},"end":{"line":13,"column":87}},"type":"binary-expr","locations":[{"start":{"line":13,"column":25},"end":{"line":13,"column":67}},{"start":{"line":13,"column":71},"end":{"line":13,"column":87}}],"line":13},"8":{"loc":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"type":"if","locations":[{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},{"start":{"line":15,"column":4},"end":{"line":19,"column":9}}],"line":15},"9":{"loc":{"start":{"line":15,"column":8},"end":{"line":15,"column":71}},"type":"binary-expr","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":17}},{"start":{"line":15,"column":21},"end":{"line":15,"column":71}}],"line":15},"10":{"loc":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},{"start":{"line":17,"column":12},"end":{"line":18,"column":34}}],"line":17},"11":{"loc":{"start":{"line":17,"column":16},"end":{"line":17,"column":90}},"type":"binary-expr","locations":[{"start":{"line":17,"column":16},"end":{"line":17,"column":35}},{"start":{"line":17,"column":39},"end":{"line":17,"column":90}}],"line":17},"12":{"loc":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":22,"column":23},"end":{"line":22,"column":27}},{"start":{"line":22,"column":31},"end":{"line":22,"column":51}},{"start":{"line":22,"column":56},"end":{"line":24,"column":1}}],"line":22},"13":{"loc":{"start":{"line":23,"column":11},"end":{"line":23,"column":61}},"type":"cond-expr","locations":[{"start":{"line":23,"column":37},"end":{"line":23,"column":40}},{"start":{"line":23,"column":43},"end":{"line":23,"column":61}}],"line":23},"14":{"loc":{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},"type":"binary-expr","locations":[{"start":{"line":23,"column":12},"end":{"line":23,"column":15}},{"start":{"line":23,"column":19},"end":{"line":23,"column":33}}],"line":23},"15":{"loc":{"start":{"line":31,"column":8},"end":{"line":32,"column":38}},"type":"if","locations":[{"start":{"line":31,"column":8},"end":{"line":32,"column":38}},{"start":{"line":31,"column":8},"end":{"line":32,"column":38}}],"line":31},"16":{"loc":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},{"start":{"line":34,"column":8},"end":{"line":36,"column":9}}],"line":34},"17":{"loc":{"start":{"line":54,"column":8},"end":{"line":55,"column":38}},"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":55,"column":38}},{"start":{"line":54,"column":8},"end":{"line":55,"column":38}}],"line":54},"18":{"loc":{"start":{"line":57,"column":24},"end":{"line":57,"column":44}},"type":"binary-expr","locations":[{"start":{"line":57,"column":24},"end":{"line":57,"column":38}},{"start":{"line":57,"column":42},"end":{"line":57,"column":44}}],"line":57},"19":{"loc":{"start":{"line":59,"column":8},"end":{"line":76,"column":9}},"type":"if","locations":[{"start":{"line":59,"column":8},"end":{"line":76,"column":9}},{"start":{"line":59,"column":8},"end":{"line":76,"column":9}}],"line":59}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":6,"14":6,"15":6,"16":4,"17":6,"18":6,"19":6,"20":6,"21":0,"22":0,"23":6,"24":1,"25":2,"26":1,"27":1,"28":1,"29":1,"30":41,"31":41,"32":40,"33":1,"34":1,"35":1,"36":1,"37":0,"38":1,"39":1,"40":1,"41":1,"42":5,"43":5,"44":0,"45":5,"46":5,"47":5,"48":5,"49":5,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":1,"58":0,"59":1,"60":1,"61":5,"62":1,"63":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":6,"8":2,"9":41,"10":41,"11":1,"12":5,"13":5,"14":1},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[1,1,1],"6":[4,2],"7":[6,6],"8":[6,0],"9":[6,6],"10":[0,0],"11":[0,0],"12":[1,1,1],"13":[0,2],"14":[2,2],"15":[40,1],"16":[0,1],"17":[0,5],"18":[5,4],"19":[1,4]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/branding.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/branding.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAAuE;AAkBvE,SAAe,KAAK,CAAC,OAAoB;;QACvC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ;YAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;QAExD,MACE,KACE,OAAO,CAAC,MAAM,SADoB,EAApC,EAAY,SAAS,OAAe,EAAV,QAAQ,cAAxB,aAA0B,CACpB,CAAC;QAEnB,IAAI,CAAC,SAAS,EAAE;YACd,OAAO,EAAE,QAAQ,oBAAO,QAAQ,CAAE,EAAE,CAAC;SACtC;QAED,MAAM,eAAe,GAAuB,SAAS,CAAC,GAAG,CACvD,CAAC,kBAAoC,EAAoB,EAAE;YACzD,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,kBAAkB,CAAC,IAAI,CAAC,CAAC;YACxE,OAAO;gBACL,QAAQ,EAAE,kBAAkB,CAAC,QAAQ;gBACrC,IAAI,EAAE,IAAA,kCAA0B,EAAC,UAAU,EAAE;oBAC3C,QAAQ,EAAE,OAAO,CAAC,QAAQ;oBAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;iBAC7D,CAAC;aACH,CAAC;QACJ,CAAC,CACF,CAAC;QAEF,OAAO;YACL,QAAQ,kCACH,QAAQ,KACX,SAAS,EAAE,eAAe,GAC3B;SACF,CAAC;IACJ,CAAC;CAAA;AAED,SAAe,IAAI,CAAC,OAAoB;;QACtC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ;YAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;QAExD,MAAM,KAA6C,OAAO,CAAC,MAAM,CAAC,QAAQ,EAApE,EAAE,SAAS,EAAE,cAAc,OAAyC,EAApC,QAAQ,cAAxC,aAA0C,CAA0B,CAAC;QAE3E,IAAI,SAAS,GAAG,cAAc,IAAI,EAAE,CAAC;QAErC,0BAA0B;QAC1B,IAAI,SAAS,CAAC,MAAM,EAAE;YACpB,MAAM,uBAAuB,GAAG,cAAI,CAAC,IAAI,CACvC,OAAO,CAAC,QAAQ,EAChB,iBAAS,CAAC,iCAAiC,CAC5C,CAAC;YACF,kBAAE,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC;YAE1C,SAAS,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,kBAAkB,EAAE,EAAE;gBAC/C,MAAM,IAAI,GAAG,GAAG,kBAAkB,CAAC,QAAQ,OAAO,CAAC;gBACnD,MAAM,kBAAkB,GAAG,cAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE,IAAI,CAAC,CAAC;gBACpE,MAAM,MAAM,GAAG,kBAAkB,CAAC,IAAI,CAAC;gBACvC,IAAI;oBACF,kBAAE,CAAC,aAAa,CAAC,kBAAkB,EAAE,MAAM,CAAC,CAAC;iBAC9C;gBAAC,OAAO,CAAC,EAAE;oBACV,MAAM,IAAI,KAAK,CACb,gCAAgC,kBAAkB,CAAC,QAAQ,cAAc,CAAC,CAAC,OAAO,EAAE,CACrF,CAAC;iBACH;gBAED,sCAAsC;gBACtC,kBAAkB,CAAC,IAAI,GAAG,IAAI,cAAI,CAAC,GAAG,GAAG,cAAI,CAAC,IAAI,CAChD,iBAAS,CAAC,iCAAiC,EAC3C,IAAI,CACL,EAAE,CAAC;gBACJ,OAAO,kBAAkB,CAAC;YAC5B,CAAC,CAAC,CAAC;SACJ;QAED,OAAO,EAAE,QAAQ,kBAAI,SAAS,IAAK,QAAQ,CAAE,EAAE,CAAC;IAClD,CAAC;CAAA;AAED,MAAM,eAAe,GAAgC;IACnD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,eAAe,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants, loadFileAndReplaceKeywords } from '../../../tools';\n\nimport { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype BrandingTemplate = {\n  template: string;\n  body: string;\n};\n\ntype ParsedBranding = ParsedAsset<\n  'branding',\n  { [key: string]: Asset } & {\n    templates?: BrandingTemplate[];\n  }\n>;\n\nasync function parse(context: YAMLContext): Promise<ParsedBranding> {\n  if (!context.assets.branding) return { branding: null };\n\n  const {\n    branding: { templates, ...branding },\n  } = context.assets;\n\n  if (!templates) {\n    return { branding: { ...branding } };\n  }\n\n  const parsedTemplates: BrandingTemplate[] = templates.map(\n    (templateDefinition: BrandingTemplate): BrandingTemplate => {\n      const markupFile = path.join(context.basePath, templateDefinition.body);\n      return {\n        template: templateDefinition.template,\n        body: loadFileAndReplaceKeywords(markupFile, {\n          mappings: context.mappings,\n          disableKeywordReplacement: context.disableKeywordReplacement,\n        }),\n      };\n    }\n  );\n\n  return {\n    branding: {\n      ...branding,\n      templates: parsedTemplates,\n    },\n  };\n}\n\nasync function dump(context: YAMLContext): Promise<ParsedBranding> {\n  if (!context.assets.branding) return { branding: null };\n\n  const { templates: templateConfig, ...branding } = context.assets.branding;\n\n  let templates = templateConfig || [];\n\n  // create templates folder\n  if (templates.length) {\n    const brandingTemplatesFolder = path.join(\n      context.basePath,\n      constants.BRANDING_TEMPLATES_YAML_DIRECTORY\n    );\n    fs.ensureDirSync(brandingTemplatesFolder);\n\n    templates = templates.map((templateDefinition) => {\n      const file = `${templateDefinition.template}.html`;\n      const templateMarkupFile = path.join(brandingTemplatesFolder, file);\n      const markup = templateDefinition.body;\n      try {\n        fs.writeFileSync(templateMarkupFile, markup);\n      } catch (e) {\n        throw new Error(\n          `Error writing template file: ${templateDefinition.template}, because: ${e.message}`\n        );\n      }\n\n      // save the location as relative file.\n      templateDefinition.body = `.${path.sep}${path.join(\n        constants.BRANDING_TEMPLATES_YAML_DIRECTORY,\n        file\n      )}`;\n      return templateDefinition;\n    });\n  }\n\n  return { branding: { templates, ...branding } };\n}\n\nconst brandingHandler: YAMLHandler<ParsedBranding> = {\n  parse,\n  dump,\n};\n\nexport default brandingHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"19593f42341651058073b48b14c30ca741abd830","contentHash":"1efd99fb923d86108a42e496e3c2d1af8b1bbd227e5dba145da55f643cb9f9f6"},"/home/circleci/repo/src/context/yaml/handlers/logStreams.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/logStreams.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":31},"end":{"line":14,"column":45}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":40}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":40}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":26},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":40}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":40}},{"start":{"line":15,"column":8},"end":{"line":16,"column":40}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/logStreams.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/logStreams.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,UAAU,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEtC,IAAI,CAAC,UAAU;YAAE,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;QAE7C,OAAO;YACL,UAAU;SACX,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,iBAAiB,GAAkC;IACvD,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,iBAAiB,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedLogStreams = ParsedAsset<'logStreams', Asset[]>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedLogStreams> {\n  const { logStreams } = context.assets;\n\n  if (!logStreams) return { logStreams: null };\n\n  return {\n    logStreams,\n  };\n}\n\nconst logStreamsHandler: YAMLHandler<ParsedLogStreams> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default logStreamsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"41983defd08684b7b5927ef882e4ad85c3fee077","contentHash":"3d8e8ca0b5ee87c9ad6511264a1de2b1c137b20895b2a1d2bf5fbf8f9f9b2ec9"},"/home/circleci/repo/src/context/yaml/handlers/prompts.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/prompts.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":28},"end":{"line":14,"column":42}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":37}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":37}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":23},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":37}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":37}},{"start":{"line":15,"column":8},"end":{"line":16,"column":37}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/prompts.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/prompts.ts"],"names":[],"mappings":";;;;;;;;;;;AAOA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,OAAO,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEnC,IAAI,CAAC,OAAO;YAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;QAEvC,OAAO;YACL,OAAO;SACR,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,cAAc,GAA+B;IACjD,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,cAAc,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { Prompts } from '../../../tools/auth0/handlers/prompts';\n\ntype ParsedPrompts = ParsedAsset<'prompts', Prompts>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedPrompts> {\n  const { prompts } = context.assets;\n\n  if (!prompts) return { prompts: null };\n\n  return {\n    prompts,\n  };\n}\n\nconst promptsHandler: YAMLHandler<ParsedPrompts> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default promptsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7df1c3b27b013909961cfab866cb234ce4f76bc5","contentHash":"7f5989fd8457bb22601566c4dbef50b7e3706d29346dd1128514153a4cdbdaf6"},"/home/circleci/repo/src/context/yaml/handlers/customDomains.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/customDomains.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":34},"end":{"line":14,"column":48}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":43}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":43}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":29},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":43}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":43}},{"start":{"line":15,"column":8},"end":{"line":16,"column":43}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":46,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":46,"11":46,"12":1,"13":46,"14":46,"15":46,"16":40,"17":6,"18":1,"19":1},"f":{"0":46,"1":0,"2":0,"3":46,"4":0,"5":0,"6":46,"7":46,"8":46},"b":{"0":[1,1,1],"1":[0,0],"2":[46,46],"3":[46,0],"4":[46,46],"5":[40,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/customDomains.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/customDomains.ts"],"names":[],"mappings":";;;;;;;;;;;AAMA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEzC,IAAI,CAAC,aAAa;YAAE,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC;QAEnD,OAAO;YACL,aAAa;SACd,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,oBAAoB,GAAqC;IAC7D,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,oBAAoB,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedCustomDomains = ParsedAsset<'customDomains', Asset[]>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedCustomDomains> {\n  const { customDomains } = context.assets;\n\n  if (!customDomains) return { customDomains: null };\n\n  return {\n    customDomains,\n  };\n}\n\nconst customDomainsHandler: YAMLHandler<ParsedCustomDomains> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default customDomainsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5f161db811f976b47049a1d6d79070d1f284c16c","contentHash":"90219d0ecd70b5232ea785e60513c2a7e6c89a17b6db7ad87b65b9794969b306"},"/home/circleci/repo/src/context/yaml/handlers/themes.ts":{"path":"/home/circleci/repo/src/context/yaml/handlers/themes.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":13,"column":4},"end":{"line":20,"column":7}},"14":{"start":{"line":14,"column":27},"end":{"line":14,"column":41}},"15":{"start":{"line":15,"column":8},"end":{"line":16,"column":36}},"16":{"start":{"line":16,"column":12},"end":{"line":16,"column":36}},"17":{"start":{"line":17,"column":8},"end":{"line":19,"column":10}},"18":{"start":{"line":22,"column":22},"end":{"line":25,"column":1}},"19":{"start":{"line":26,"column":0},"end":{"line":26,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"parseAndDump","decl":{"start":{"line":12,"column":9},"end":{"line":12,"column":21}},"loc":{"start":{"line":12,"column":31},"end":{"line":21,"column":1}},"line":12},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":43},"end":{"line":13,"column":44}},"loc":{"start":{"line":13,"column":56},"end":{"line":20,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":15,"column":8},"end":{"line":16,"column":36}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":16,"column":36}},{"start":{"line":15,"column":8},"end":{"line":16,"column":36}}],"line":15}},"s":{"0":1,"1":0,"2":0,"3":47,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":47,"11":47,"12":1,"13":47,"14":47,"15":47,"16":39,"17":8,"18":1,"19":1},"f":{"0":47,"1":0,"2":0,"3":47,"4":0,"5":0,"6":47,"7":47,"8":47},"b":{"0":[1,1,1],"1":[0,0],"2":[47,47],"3":[47,0],"4":[47,47],"5":[39,8]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/yaml/handlers/themes.ts","sources":["/home/circleci/repo/src/context/yaml/handlers/themes.ts"],"names":[],"mappings":";;;;;;;;;;;AAOA,SAAe,YAAY,CAAC,OAAoB;;QAC9C,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAElC,IAAI,CAAC,MAAM;YAAE,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;QAErC,OAAO;YACL,MAAM;SACP,CAAC;IACJ,CAAC;CAAA;AAED,MAAM,aAAa,GAA8B;IAC/C,KAAK,EAAE,YAAY;IACnB,IAAI,EAAE,YAAY;CACnB,CAAC;AAEF,kBAAe,aAAa,CAAC","sourcesContent":["import { YAMLHandler } from '.';\nimport YAMLContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { Theme } from '../../../tools/auth0/handlers/themes';\n\ntype ParsedThemes = ParsedAsset<'themes', Theme[]>;\n\nasync function parseAndDump(context: YAMLContext): Promise<ParsedThemes> {\n  const { themes } = context.assets;\n\n  if (!themes) return { themes: null };\n\n  return {\n    themes,\n  };\n}\n\nconst themesHandler: YAMLHandler<ParsedThemes> = {\n  parse: parseAndDump,\n  dump: parseAndDump,\n};\n\nexport default themesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9962b24ee6eb40f507dc7c231acb9b7c563a3e77","contentHash":"56b0ec04bda6008d7a1f2e519758cd94ddb3524b98cae70b532dfe93280d81a1"},"/home/circleci/repo/src/readonly.ts":{"path":"/home/circleci/repo/src/readonly.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":19},"end":{"line":6,"column":55}},"4":{"start":{"line":7,"column":17},"end":{"line":7,"column":51}},"5":{"start":{"line":9,"column":23},"end":{"line":30,"column":1}},"6":{"start":{"line":32,"column":27},"end":{"line":32,"column":60}},"7":{"start":{"line":33,"column":65},"end":{"line":33,"column":71}},"8":{"start":{"line":34,"column":4},"end":{"line":35,"column":22}},"9":{"start":{"line":35,"column":8},"end":{"line":35,"column":22}},"10":{"start":{"line":36,"column":4},"end":{"line":37,"column":22}},"11":{"start":{"line":37,"column":8},"end":{"line":37,"column":22}},"12":{"start":{"line":38,"column":4},"end":{"line":45,"column":7}},"13":{"start":{"line":40,"column":30},"end":{"line":40,"column":116}},"14":{"start":{"line":40,"column":55},"end":{"line":40,"column":115}},"15":{"start":{"line":41,"column":8},"end":{"line":43,"column":9}},"16":{"start":{"line":42,"column":12},"end":{"line":42,"column":159}},"17":{"start":{"line":44,"column":8},"end":{"line":44,"column":75}},"18":{"start":{"line":46,"column":4},"end":{"line":50,"column":7}},"19":{"start":{"line":47,"column":8},"end":{"line":49,"column":9}},"20":{"start":{"line":48,"column":12},"end":{"line":48,"column":99}},"21":{"start":{"line":48,"column":74},"end":{"line":48,"column":97}},"22":{"start":{"line":51,"column":4},"end":{"line":51,"column":26}},"23":{"start":{"line":54,"column":19},"end":{"line":54,"column":41}},"24":{"start":{"line":55,"column":4},"end":{"line":55,"column":62}},"25":{"start":{"line":55,"column":24},"end":{"line":55,"column":60}},"26":{"start":{"line":56,"column":4},"end":{"line":56,"column":18}},"27":{"start":{"line":59,"column":20},"end":{"line":59,"column":45}},"28":{"start":{"line":60,"column":27},"end":{"line":60,"column":52}},"29":{"start":{"line":61,"column":4},"end":{"line":73,"column":7}},"30":{"start":{"line":62,"column":20},"end":{"line":62,"column":33}},"31":{"start":{"line":63,"column":8},"end":{"line":64,"column":19}},"32":{"start":{"line":64,"column":12},"end":{"line":64,"column":19}},"33":{"start":{"line":65,"column":8},"end":{"line":72,"column":9}},"34":{"start":{"line":67,"column":12},"end":{"line":67,"column":66}},"35":{"start":{"line":67,"column":43},"end":{"line":67,"column":64}},"36":{"start":{"line":71,"column":12},"end":{"line":71,"column":62}},"37":{"start":{"line":74,"column":4},"end":{"line":74,"column":71}},"38":{"start":{"line":76,"column":0},"end":{"line":76,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"getExcludedFields","decl":{"start":{"line":31,"column":9},"end":{"line":31,"column":26}},"loc":{"start":{"line":31,"column":35},"end":{"line":52,"column":1}},"line":31},"2":{"name":"(anonymous_2)","decl":{"start":{"line":38,"column":37},"end":{"line":38,"column":38}},"loc":{"start":{"line":38,"column":57},"end":{"line":45,"column":5}},"line":38},"3":{"name":"(anonymous_3)","decl":{"start":{"line":40,"column":44},"end":{"line":40,"column":45}},"loc":{"start":{"line":40,"column":55},"end":{"line":40,"column":115}},"line":40},"4":{"name":"(anonymous_4)","decl":{"start":{"line":46,"column":37},"end":{"line":46,"column":38}},"loc":{"start":{"line":46,"column":57},"end":{"line":50,"column":5}},"line":46},"5":{"name":"(anonymous_5)","decl":{"start":{"line":48,"column":63},"end":{"line":48,"column":64}},"loc":{"start":{"line":48,"column":74},"end":{"line":48,"column":97}},"line":48},"6":{"name":"deleteKeys","decl":{"start":{"line":53,"column":9},"end":{"line":53,"column":19}},"loc":{"start":{"line":53,"column":31},"end":{"line":57,"column":1}},"line":53},"7":{"name":"(anonymous_7)","decl":{"start":{"line":55,"column":17},"end":{"line":55,"column":18}},"loc":{"start":{"line":55,"column":24},"end":{"line":55,"column":60}},"line":55},"8":{"name":"cleanAssets","decl":{"start":{"line":58,"column":9},"end":{"line":58,"column":20}},"loc":{"start":{"line":58,"column":37},"end":{"line":75,"column":1}},"line":58},"9":{"name":"(anonymous_9)","decl":{"start":{"line":61,"column":43},"end":{"line":61,"column":44}},"loc":{"start":{"line":61,"column":63},"end":{"line":73,"column":5}},"line":61},"10":{"name":"(anonymous_10)","decl":{"start":{"line":67,"column":36},"end":{"line":67,"column":37}},"loc":{"start":{"line":67,"column":43},"end":{"line":67,"column":64}},"line":67}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":34,"column":4},"end":{"line":35,"column":22}},"type":"if","locations":[{"start":{"line":34,"column":4},"end":{"line":35,"column":22}},{"start":{"line":34,"column":4},"end":{"line":35,"column":22}}],"line":34},"4":{"loc":{"start":{"line":36,"column":4},"end":{"line":37,"column":22}},"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":37,"column":22}},{"start":{"line":36,"column":4},"end":{"line":37,"column":22}}],"line":36},"5":{"loc":{"start":{"line":40,"column":55},"end":{"line":40,"column":115}},"type":"binary-expr","locations":[{"start":{"line":40,"column":55},"end":{"line":40,"column":63}},{"start":{"line":40,"column":67},"end":{"line":40,"column":81}},{"start":{"line":40,"column":85},"end":{"line":40,"column":115}}],"line":40},"6":{"loc":{"start":{"line":41,"column":8},"end":{"line":43,"column":9}},"type":"if","locations":[{"start":{"line":41,"column":8},"end":{"line":43,"column":9}},{"start":{"line":41,"column":8},"end":{"line":43,"column":9}}],"line":41},"7":{"loc":{"start":{"line":44,"column":32},"end":{"line":44,"column":58}},"type":"binary-expr","locations":[{"start":{"line":44,"column":32},"end":{"line":44,"column":52}},{"start":{"line":44,"column":56},"end":{"line":44,"column":58}}],"line":44},"8":{"loc":{"start":{"line":47,"column":8},"end":{"line":49,"column":9}},"type":"if","locations":[{"start":{"line":47,"column":8},"end":{"line":49,"column":9}},{"start":{"line":47,"column":8},"end":{"line":49,"column":9}}],"line":47},"9":{"loc":{"start":{"line":63,"column":8},"end":{"line":64,"column":19}},"type":"if","locations":[{"start":{"line":63,"column":8},"end":{"line":64,"column":19}},{"start":{"line":63,"column":8},"end":{"line":64,"column":19}}],"line":63},"10":{"loc":{"start":{"line":65,"column":8},"end":{"line":72,"column":9}},"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":72,"column":9}},{"start":{"line":65,"column":8},"end":{"line":72,"column":9}}],"line":65}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":7,"7":7,"8":7,"9":5,"10":7,"11":5,"12":7,"13":3,"14":4,"15":3,"16":1,"17":2,"18":6,"19":1,"20":1,"21":9,"22":6,"23":11,"24":11,"25":53,"26":11,"27":7,"28":7,"29":6,"30":31,"31":31,"32":11,"33":20,"34":14,"35":5,"36":6,"37":6,"38":1},"f":{"0":2,"1":7,"2":3,"3":4,"4":1,"5":9,"6":11,"7":53,"8":7,"9":31,"10":5},"b":{"0":[1,1,1],"1":[0,2],"2":[2,2],"3":[5,2],"4":[5,2],"5":[4,4,3],"6":[1,2],"7":[2,1],"8":[1,0],"9":[11,20],"10":[14,6]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/readonly.ts","sources":["/home/circleci/repo/src/readonly.ts"],"names":[],"mappings":"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","sourcesContent":["import dotProp from 'dot-prop';\nimport _ from 'lodash';\nimport { Asset, Assets, AssetTypes, Config } from './types';\n\n// Filter out known read only fields during dump\nconst readOnlyFields: Partial<Record<AssetTypes, string[]>> = {\n  guardianFactors: ['trial_expired'],\n  connections: ['provisioning_ticket_url', 'realms'],\n  databases: ['options.configuration'],\n  tenant: [\n    'sandbox_versions_available',\n    'flags.allow_changing_enable_sso',\n    'flags.enable_sso',\n    'flags.disable_impersonation',\n    'flags.remove_stale_idp_attributes',\n  ],\n  clients: [\n    'client_secret',\n    'callback_url_template',\n    'signing_keys',\n    'global',\n    'tenant',\n    'custom_login_page_preview',\n    'config_route',\n    'owners',\n  ],\n};\n\nfunction getExcludedFields(config: Config) {\n  const strippedFields = { ...readOnlyFields };\n\n  let { EXCLUDED_PROPS: excluded, INCLUDED_PROPS: included } = config;\n  if (typeof excluded !== 'object') excluded = {};\n  if (typeof included !== 'object') included = {};\n\n  Object.entries(excluded).forEach(([name, fields]) => {\n    // Do not allow same field to be included and excluded at the same time\n    const intersections = fields.filter(\n      (field) => included && included[name] && included[name].includes(field)\n    );\n    if (intersections.length > 0) {\n      throw new Error(\n        `EXCLUDED_PROPS should NOT have any intersections with INCLUDED_PROPS. Intersections found: ${name}: ${intersections.join(\n          ', '\n        )}`\n      );\n    }\n    strippedFields[name] = (strippedFields[name] || []).concat(fields);\n  });\n\n  Object.entries(included).forEach(([name, fields]) => {\n    if (strippedFields[name]) {\n      strippedFields[name] = strippedFields[name].filter(\n        (field: string) => !fields.includes(field)\n      );\n    }\n  });\n\n  return strippedFields;\n}\n\nfunction deleteKeys(obj: Asset, keys: string[]): { [key: string]: any } {\n  const newObj = { ...obj };\n  keys.forEach((k) => dotProp.delete(newObj, k));\n  return newObj;\n}\n\nexport default function cleanAssets(assets: Assets, config: Config): Assets {\n  const cleaned = { ...assets };\n  const excludedFields = getExcludedFields(config);\n\n  Object.entries(excludedFields).forEach(([name, fields]: [AssetTypes, string[]]) => {\n    const obj = cleaned[name];\n    if (!obj) return;\n\n    if (Array.isArray(obj)) {\n      //@ts-ignore because `message_types` and `policies` on guardianPhoneFactorMessageTypes and guardianPolicies don't adhere to the expect types\n      cleaned[name] = obj.map((o) => deleteKeys(o, fields));\n    } else {\n      //@ts-ignore because `message_types` and `policies` on guardianPhoneFactorMessageTypes and guardianPolicies don't adhere to the expect types\n      cleaned[name] = deleteKeys(cleaned[name], fields);\n    }\n  });\n\n  return _.pickBy(cleaned, _.identity) as Assets;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"eca1da3f553b5721be668dffe422765e0274b67b","contentHash":"6165e0d1d018fe2ee0478ec3f8424c034e3317170eaeca612a9c1f65d3935d2e"},"/home/circleci/repo/src/keywordPreservation.ts":{"path":"/home/circleci/repo/src/keywordPreservation.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":211}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":38}},"3":{"start":{"line":5,"column":16},"end":{"line":5,"column":40}},"4":{"start":{"line":6,"column":16},"end":{"line":6,"column":40}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":34}},"6":{"start":{"line":12,"column":30},"end":{"line":18,"column":1}},"7":{"start":{"line":13,"column":4},"end":{"line":17,"column":7}},"8":{"start":{"line":14,"column":31},"end":{"line":14,"column":91}},"9":{"start":{"line":15,"column":32},"end":{"line":15,"column":93}},"10":{"start":{"line":16,"column":8},"end":{"line":16,"column":51}},"11":{"start":{"line":19,"column":0},"end":{"line":19,"column":54}},"12":{"start":{"line":20,"column":39},"end":{"line":68,"column":1}},"13":{"start":{"line":21,"column":4},"end":{"line":26,"column":5}},"14":{"start":{"line":22,"column":8},"end":{"line":24,"column":9}},"15":{"start":{"line":23,"column":12},"end":{"line":23,"column":29}},"16":{"start":{"line":25,"column":8},"end":{"line":25,"column":18}},"17":{"start":{"line":27,"column":28},"end":{"line":27,"column":42}},"18":{"start":{"line":28,"column":4},"end":{"line":56,"column":5}},"19":{"start":{"line":29,"column":8},"end":{"line":55,"column":20}},"20":{"start":{"line":31,"column":40},"end":{"line":37,"column":16}},"21":{"start":{"line":32,"column":36},"end":{"line":32,"column":72}},"22":{"start":{"line":33,"column":16},"end":{"line":35,"column":17}},"23":{"start":{"line":34,"column":20},"end":{"line":34,"column":39}},"24":{"start":{"line":36,"column":16},"end":{"line":36,"column":37}},"25":{"start":{"line":38,"column":36},"end":{"line":49,"column":18}},"26":{"start":{"line":39,"column":16},"end":{"line":39,"column":53}},"27":{"start":{"line":40,"column":16},"end":{"line":41,"column":32}},"28":{"start":{"line":41,"column":20},"end":{"line":41,"column":32}},"29":{"start":{"line":42,"column":45},"end":{"line":42,"column":74}},"30":{"start":{"line":43,"column":16},"end":{"line":44,"column":32}},"31":{"start":{"line":44,"column":20},"end":{"line":44,"column":32}},"32":{"start":{"line":45,"column":16},"end":{"line":47,"column":17}},"33":{"start":{"line":46,"column":20},"end":{"line":46,"column":75}},"34":{"start":{"line":48,"column":16},"end":{"line":48,"column":92}},"35":{"start":{"line":50,"column":12},"end":{"line":52,"column":13}},"36":{"start":{"line":51,"column":16},"end":{"line":51,"column":26}},"37":{"start":{"line":53,"column":12},"end":{"line":53,"column":183}},"38":{"start":{"line":57,"column":4},"end":{"line":66,"column":5}},"39":{"start":{"line":58,"column":8},"end":{"line":65,"column":20}},"40":{"start":{"line":60,"column":26},"end":{"line":60,"column":36}},"41":{"start":{"line":61,"column":12},"end":{"line":62,"column":26}},"42":{"start":{"line":62,"column":16},"end":{"line":62,"column":26}},"43":{"start":{"line":63,"column":12},"end":{"line":63,"column":165}},"44":{"start":{"line":67,"column":4},"end":{"line":67,"column":14}},"45":{"start":{"line":69,"column":0},"end":{"line":69,"column":72}},"46":{"start":{"line":76,"column":32},"end":{"line":102,"column":1}},"47":{"start":{"line":79,"column":29},"end":{"line":79,"column":56}},"48":{"start":{"line":80,"column":4},"end":{"line":82,"column":5}},"49":{"start":{"line":81,"column":8},"end":{"line":81,"column":52}},"50":{"start":{"line":85,"column":23},"end":{"line":85,"column":55}},"51":{"start":{"line":88,"column":4},"end":{"line":100,"column":5}},"52":{"start":{"line":89,"column":8},"end":{"line":90,"column":29}},"53":{"start":{"line":90,"column":12},"end":{"line":90,"column":29}},"54":{"start":{"line":91,"column":23},"end":{"line":98,"column":10}},"55":{"start":{"line":92,"column":26},"end":{"line":92,"column":77}},"56":{"start":{"line":93,"column":12},"end":{"line":97,"column":15}},"57":{"start":{"line":94,"column":35},"end":{"line":94,"column":53}},"58":{"start":{"line":95,"column":40},"end":{"line":95,"column":58}},"59":{"start":{"line":96,"column":16},"end":{"line":96,"column":60}},"60":{"start":{"line":99,"column":8},"end":{"line":99,"column":91}},"61":{"start":{"line":101,"column":4},"end":{"line":101,"column":123}},"62":{"start":{"line":103,"column":0},"end":{"line":103,"column":58}},"63":{"start":{"line":108,"column":36},"end":{"line":131,"column":1}},"64":{"start":{"line":109,"column":4},"end":{"line":110,"column":20}},"65":{"start":{"line":110,"column":8},"end":{"line":110,"column":20}},"66":{"start":{"line":111,"column":23},"end":{"line":111,"column":55}},"67":{"start":{"line":112,"column":4},"end":{"line":113,"column":33}},"68":{"start":{"line":113,"column":8},"end":{"line":113,"column":33}},"69":{"start":{"line":114,"column":4},"end":{"line":129,"column":5}},"70":{"start":{"line":115,"column":28},"end":{"line":115,"column":79}},"71":{"start":{"line":116,"column":26},"end":{"line":116,"column":28}},"72":{"start":{"line":117,"column":8},"end":{"line":125,"column":11}},"73":{"start":{"line":118,"column":12},"end":{"line":124,"column":13}},"74":{"start":{"line":119,"column":35},"end":{"line":119,"column":53}},"75":{"start":{"line":120,"column":40},"end":{"line":120,"column":58}},"76":{"start":{"line":121,"column":16},"end":{"line":121,"column":60}},"77":{"start":{"line":123,"column":16},"end":{"line":123,"column":36}},"78":{"start":{"line":126,"column":8},"end":{"line":127,"column":24}},"79":{"start":{"line":127,"column":12},"end":{"line":127,"column":24}},"80":{"start":{"line":128,"column":8},"end":{"line":128,"column":147}},"81":{"start":{"line":130,"column":4},"end":{"line":130,"column":211}},"82":{"start":{"line":132,"column":0},"end":{"line":132,"column":66}},"83":{"start":{"line":133,"column":30},"end":{"line":143,"column":1}},"84":{"start":{"line":134,"column":31},"end":{"line":134,"column":88}},"85":{"start":{"line":135,"column":4},"end":{"line":136,"column":22}},"86":{"start":{"line":136,"column":8},"end":{"line":136,"column":22}},"87":{"start":{"line":137,"column":30},"end":{"line":137,"column":91}},"88":{"start":{"line":138,"column":4},"end":{"line":140,"column":5}},"89":{"start":{"line":139,"column":8},"end":{"line":139,"column":22}},"90":{"start":{"line":141,"column":4},"end":{"line":141,"column":62}},"91":{"start":{"line":142,"column":4},"end":{"line":142,"column":18}},"92":{"start":{"line":144,"column":0},"end":{"line":144,"column":54}},"93":{"start":{"line":148,"column":25},"end":{"line":190,"column":1}},"94":{"start":{"line":149,"column":4},"end":{"line":150,"column":28}},"95":{"start":{"line":150,"column":8},"end":{"line":150,"column":28}},"96":{"start":{"line":151,"column":40},"end":{"line":155,"column":10}},"97":{"start":{"line":152,"column":8},"end":{"line":154,"column":21}},"98":{"start":{"line":153,"column":16},"end":{"line":153,"column":50}},"99":{"start":{"line":156,"column":22},"end":{"line":156,"column":128}},"100":{"start":{"line":157,"column":30},"end":{"line":157,"column":67}},"101":{"start":{"line":158,"column":4},"end":{"line":188,"column":7}},"102":{"start":{"line":159,"column":27},"end":{"line":159,"column":85}},"103":{"start":{"line":160,"column":36},"end":{"line":166,"column":12}},"104":{"start":{"line":161,"column":43},"end":{"line":161,"column":103}},"105":{"start":{"line":162,"column":12},"end":{"line":164,"column":13}},"106":{"start":{"line":163,"column":16},"end":{"line":163,"column":77}},"107":{"start":{"line":165,"column":12},"end":{"line":165,"column":27}},"108":{"start":{"line":167,"column":28},"end":{"line":167,"column":99}},"109":{"start":{"line":168,"column":42},"end":{"line":168,"column":98}},"110":{"start":{"line":169,"column":45},"end":{"line":174,"column":12}},"111":{"start":{"line":170,"column":12},"end":{"line":172,"column":13}},"112":{"start":{"line":171,"column":16},"end":{"line":171,"column":65}},"113":{"start":{"line":175,"column":8},"end":{"line":177,"column":9}},"114":{"start":{"line":176,"column":12},"end":{"line":176,"column":198}},"115":{"start":{"line":184,"column":8},"end":{"line":185,"column":20}},"116":{"start":{"line":186,"column":8},"end":{"line":187,"column":20}},"117":{"start":{"line":189,"column":4},"end":{"line":189,"column":31}},"118":{"start":{"line":191,"column":0},"end":{"line":191,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":59},"end":{"line":18,"column":1}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":47},"end":{"line":13,"column":48}},"loc":{"start":{"line":13,"column":60},"end":{"line":17,"column":5}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":39},"end":{"line":20,"column":40}},"loc":{"start":{"line":20,"column":110},"end":{"line":68,"column":1}},"line":20},"3":{"name":"(anonymous_3)","decl":{"start":{"line":30,"column":17},"end":{"line":30,"column":18}},"loc":{"start":{"line":30,"column":32},"end":{"line":54,"column":9}},"line":30},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":41},"end":{"line":31,"column":42}},"loc":{"start":{"line":31,"column":47},"end":{"line":37,"column":13}},"line":31},"5":{"name":"(anonymous_5)","decl":{"start":{"line":38,"column":63},"end":{"line":38,"column":64}},"loc":{"start":{"line":38,"column":105},"end":{"line":49,"column":13}},"line":38},"6":{"name":"(anonymous_6)","decl":{"start":{"line":59,"column":17},"end":{"line":59,"column":18}},"loc":{"start":{"line":59,"column":26},"end":{"line":64,"column":9}},"line":59},"7":{"name":"(anonymous_7)","decl":{"start":{"line":76,"column":32},"end":{"line":76,"column":33}},"loc":{"start":{"line":76,"column":53},"end":{"line":102,"column":1}},"line":76},"8":{"name":"(anonymous_8)","decl":{"start":{"line":91,"column":35},"end":{"line":91,"column":36}},"loc":{"start":{"line":91,"column":45},"end":{"line":98,"column":9}},"line":91},"9":{"name":"(anonymous_9)","decl":{"start":{"line":93,"column":31},"end":{"line":93,"column":32}},"loc":{"start":{"line":93,"column":41},"end":{"line":97,"column":13}},"line":93},"10":{"name":"(anonymous_10)","decl":{"start":{"line":108,"column":36},"end":{"line":108,"column":37}},"loc":{"start":{"line":108,"column":81},"end":{"line":131,"column":1}},"line":108},"11":{"name":"(anonymous_11)","decl":{"start":{"line":117,"column":23},"end":{"line":117,"column":24}},"loc":{"start":{"line":117,"column":40},"end":{"line":125,"column":9}},"line":117},"12":{"name":"(anonymous_12)","decl":{"start":{"line":118,"column":34},"end":{"line":118,"column":35}},"loc":{"start":{"line":118,"column":44},"end":{"line":122,"column":13}},"line":118},"13":{"name":"(anonymous_13)","decl":{"start":{"line":133,"column":30},"end":{"line":133,"column":31}},"loc":{"start":{"line":133,"column":61},"end":{"line":143,"column":1}},"line":133},"14":{"name":"(anonymous_14)","decl":{"start":{"line":148,"column":25},"end":{"line":148,"column":26}},"loc":{"start":{"line":148,"column":93},"end":{"line":190,"column":1}},"line":148},"15":{"name":"(anonymous_15)","decl":{"start":{"line":151,"column":61},"end":{"line":151,"column":62}},"loc":{"start":{"line":151,"column":79},"end":{"line":155,"column":5}},"line":151},"16":{"name":"(anonymous_16)","decl":{"start":{"line":152,"column":98},"end":{"line":152,"column":99}},"loc":{"start":{"line":152,"column":115},"end":{"line":154,"column":13}},"line":152},"17":{"name":"(anonymous_17)","decl":{"start":{"line":158,"column":22},"end":{"line":158,"column":23}},"loc":{"start":{"line":158,"column":35},"end":{"line":188,"column":5}},"line":158},"18":{"name":"(anonymous_18)","decl":{"start":{"line":160,"column":37},"end":{"line":160,"column":38}},"loc":{"start":{"line":160,"column":43},"end":{"line":166,"column":9}},"line":160},"19":{"name":"(anonymous_19)","decl":{"start":{"line":169,"column":46},"end":{"line":169,"column":47}},"loc":{"start":{"line":169,"column":52},"end":{"line":174,"column":9}},"line":169}},"branchMap":{"0":{"loc":{"start":{"line":16,"column":15},"end":{"line":16,"column":50}},"type":"binary-expr","locations":[{"start":{"line":16,"column":15},"end":{"line":16,"column":30}},{"start":{"line":16,"column":34},"end":{"line":16,"column":50}}],"line":16},"1":{"loc":{"start":{"line":20,"column":93},"end":{"line":20,"column":105}},"type":"default-arg","locations":[{"start":{"line":20,"column":103},"end":{"line":20,"column":105}}],"line":20},"2":{"loc":{"start":{"line":21,"column":4},"end":{"line":26,"column":5}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":26,"column":5}},{"start":{"line":21,"column":4},"end":{"line":26,"column":5}}],"line":21},"3":{"loc":{"start":{"line":22,"column":8},"end":{"line":24,"column":9}},"type":"if","locations":[{"start":{"line":22,"column":8},"end":{"line":24,"column":9}},{"start":{"line":22,"column":8},"end":{"line":24,"column":9}}],"line":22},"4":{"loc":{"start":{"line":28,"column":4},"end":{"line":56,"column":5}},"type":"if","locations":[{"start":{"line":28,"column":4},"end":{"line":56,"column":5}},{"start":{"line":28,"column":4},"end":{"line":56,"column":5}}],"line":28},"5":{"loc":{"start":{"line":33,"column":16},"end":{"line":35,"column":17}},"type":"if","locations":[{"start":{"line":33,"column":16},"end":{"line":35,"column":17}},{"start":{"line":33,"column":16},"end":{"line":35,"column":17}}],"line":33},"6":{"loc":{"start":{"line":40,"column":16},"end":{"line":41,"column":32}},"type":"if","locations":[{"start":{"line":40,"column":16},"end":{"line":41,"column":32}},{"start":{"line":40,"column":16},"end":{"line":41,"column":32}}],"line":40},"7":{"loc":{"start":{"line":43,"column":16},"end":{"line":44,"column":32}},"type":"if","locations":[{"start":{"line":43,"column":16},"end":{"line":44,"column":32}},{"start":{"line":43,"column":16},"end":{"line":44,"column":32}}],"line":43},"8":{"loc":{"start":{"line":45,"column":16},"end":{"line":47,"column":17}},"type":"if","locations":[{"start":{"line":45,"column":16},"end":{"line":47,"column":17}},{"start":{"line":45,"column":16},"end":{"line":47,"column":17}}],"line":45},"9":{"loc":{"start":{"line":50,"column":12},"end":{"line":52,"column":13}},"type":"if","locations":[{"start":{"line":50,"column":12},"end":{"line":52,"column":13}},{"start":{"line":50,"column":12},"end":{"line":52,"column":13}}],"line":50},"10":{"loc":{"start":{"line":53,"column":133},"end":{"line":53,"column":159}},"type":"cond-expr","locations":[{"start":{"line":53,"column":151},"end":{"line":53,"column":154}},{"start":{"line":53,"column":157},"end":{"line":53,"column":159}}],"line":53},"11":{"loc":{"start":{"line":57,"column":4},"end":{"line":66,"column":5}},"type":"if","locations":[{"start":{"line":57,"column":4},"end":{"line":66,"column":5}},{"start":{"line":57,"column":4},"end":{"line":66,"column":5}}],"line":57},"12":{"loc":{"start":{"line":61,"column":12},"end":{"line":62,"column":26}},"type":"if","locations":[{"start":{"line":61,"column":12},"end":{"line":62,"column":26}},{"start":{"line":61,"column":12},"end":{"line":62,"column":26}}],"line":61},"13":{"loc":{"start":{"line":61,"column":16},"end":{"line":61,"column":53}},"type":"binary-expr","locations":[{"start":{"line":61,"column":16},"end":{"line":61,"column":35}},{"start":{"line":61,"column":39},"end":{"line":61,"column":53}}],"line":61},"14":{"loc":{"start":{"line":63,"column":129},"end":{"line":63,"column":155}},"type":"cond-expr","locations":[{"start":{"line":63,"column":147},"end":{"line":63,"column":150}},{"start":{"line":63,"column":153},"end":{"line":63,"column":155}}],"line":63},"15":{"loc":{"start":{"line":80,"column":4},"end":{"line":82,"column":5}},"type":"if","locations":[{"start":{"line":80,"column":4},"end":{"line":82,"column":5}},{"start":{"line":80,"column":4},"end":{"line":82,"column":5}}],"line":80},"16":{"loc":{"start":{"line":88,"column":4},"end":{"line":100,"column":5}},"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":100,"column":5}},{"start":{"line":88,"column":4},"end":{"line":100,"column":5}}],"line":88},"17":{"loc":{"start":{"line":89,"column":8},"end":{"line":90,"column":29}},"type":"if","locations":[{"start":{"line":89,"column":8},"end":{"line":90,"column":29}},{"start":{"line":89,"column":8},"end":{"line":90,"column":29}}],"line":89},"18":{"loc":{"start":{"line":108,"column":54},"end":{"line":108,"column":76}},"type":"default-arg","locations":[{"start":{"line":108,"column":74},"end":{"line":108,"column":76}}],"line":108},"19":{"loc":{"start":{"line":109,"column":4},"end":{"line":110,"column":20}},"type":"if","locations":[{"start":{"line":109,"column":4},"end":{"line":110,"column":20}},{"start":{"line":109,"column":4},"end":{"line":110,"column":20}}],"line":109},"20":{"loc":{"start":{"line":112,"column":4},"end":{"line":113,"column":33}},"type":"if","locations":[{"start":{"line":112,"column":4},"end":{"line":113,"column":33}},{"start":{"line":112,"column":4},"end":{"line":113,"column":33}}],"line":112},"21":{"loc":{"start":{"line":114,"column":4},"end":{"line":129,"column":5}},"type":"if","locations":[{"start":{"line":114,"column":4},"end":{"line":129,"column":5}},{"start":{"line":114,"column":4},"end":{"line":129,"column":5}}],"line":114},"22":{"loc":{"start":{"line":118,"column":12},"end":{"line":124,"column":13}},"type":"if","locations":[{"start":{"line":118,"column":12},"end":{"line":124,"column":13}},{"start":{"line":118,"column":12},"end":{"line":124,"column":13}}],"line":118},"23":{"loc":{"start":{"line":126,"column":8},"end":{"line":127,"column":24}},"type":"if","locations":[{"start":{"line":126,"column":8},"end":{"line":127,"column":24}},{"start":{"line":126,"column":8},"end":{"line":127,"column":24}}],"line":126},"24":{"loc":{"start":{"line":130,"column":127},"end":{"line":130,"column":209}},"type":"cond-expr","locations":[{"start":{"line":130,"column":154},"end":{"line":130,"column":167}},{"start":{"line":130,"column":170},"end":{"line":130,"column":209}}],"line":130},"25":{"loc":{"start":{"line":135,"column":4},"end":{"line":136,"column":22}},"type":"if","locations":[{"start":{"line":135,"column":4},"end":{"line":136,"column":22}},{"start":{"line":135,"column":4},"end":{"line":136,"column":22}}],"line":135},"26":{"loc":{"start":{"line":138,"column":4},"end":{"line":140,"column":5}},"type":"if","locations":[{"start":{"line":138,"column":4},"end":{"line":140,"column":5}},{"start":{"line":138,"column":4},"end":{"line":140,"column":5}}],"line":138},"27":{"loc":{"start":{"line":149,"column":4},"end":{"line":150,"column":28}},"type":"if","locations":[{"start":{"line":149,"column":4},"end":{"line":150,"column":28}},{"start":{"line":149,"column":4},"end":{"line":150,"column":28}}],"line":149},"28":{"loc":{"start":{"line":162,"column":12},"end":{"line":164,"column":13}},"type":"if","locations":[{"start":{"line":162,"column":12},"end":{"line":164,"column":13}},{"start":{"line":162,"column":12},"end":{"line":164,"column":13}}],"line":162},"29":{"loc":{"start":{"line":170,"column":12},"end":{"line":172,"column":13}},"type":"if","locations":[{"start":{"line":170,"column":12},"end":{"line":172,"column":13}},{"start":{"line":170,"column":12},"end":{"line":172,"column":13}}],"line":170},"30":{"loc":{"start":{"line":175,"column":8},"end":{"line":177,"column":9}},"type":"if","locations":[{"start":{"line":175,"column":8},"end":{"line":177,"column":9}},{"start":{"line":175,"column":8},"end":{"line":177,"column":9}}],"line":175}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":107,"8":190,"9":190,"10":190,"11":1,"12":1,"13":140,"14":69,"15":36,"16":33,"17":71,"18":71,"19":26,"20":29,"21":29,"22":29,"23":6,"24":23,"25":29,"26":35,"27":35,"28":5,"29":30,"30":30,"31":0,"32":30,"33":24,"34":6,"35":29,"36":5,"37":24,"38":45,"39":42,"40":139,"41":139,"42":31,"43":108,"44":3,"45":1,"46":1,"47":220,"48":220,"49":75,"50":145,"51":145,"52":71,"53":15,"54":56,"55":75,"56":75,"57":95,"58":95,"59":95,"60":56,"61":74,"62":1,"63":1,"64":197,"65":2,"66":195,"67":195,"68":36,"69":159,"70":51,"71":51,"72":51,"73":71,"74":81,"75":81,"76":81,"77":23,"78":51,"79":28,"80":23,"81":108,"82":1,"83":1,"84":62,"85":62,"86":29,"87":33,"88":33,"89":1,"90":32,"91":32,"92":1,"93":1,"94":8,"95":1,"96":7,"97":20,"98":38,"99":7,"100":7,"101":7,"102":28,"103":28,"104":28,"105":28,"106":17,"107":11,"108":28,"109":28,"110":28,"111":28,"112":16,"113":28,"114":12,"115":28,"116":28,"117":7,"118":1},"f":{"0":107,"1":190,"2":140,"3":29,"4":29,"5":35,"6":139,"7":220,"8":75,"9":95,"10":197,"11":71,"12":81,"13":62,"14":8,"15":20,"16":38,"17":28,"18":28,"19":28},"b":{"0":[190,185],"1":[1],"2":[69,71],"3":[36,33],"4":[26,45],"5":[6,23],"6":[5,30],"7":[0,30],"8":[24,6],"9":[5,24],"10":[24,0],"11":[42,3],"12":[31,108],"13":[139,137],"14":[86,22],"15":[75,145],"16":[71,74],"17":[15,56],"18":[66],"19":[2,195],"20":[36,159],"21":[51,108],"22":[23,48],"23":[28,23],"24":[66,42],"25":[29,33],"26":[1,32],"27":[1,7],"28":[17,11],"29":[16,12],"30":[12,16]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/keywordPreservation.ts","sources":["/home/circleci/repo/src/keywordPreservation.ts"],"names":[],"mappings":"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","sourcesContent":["import { get as getByDotNotation, set as setByDotNotation } from 'dot-prop';\nimport { keywordReplace } from './tools/utils';\nimport { AssetTypes, KeywordMappings } from './types';\nimport { keywordReplaceArrayRegExp, keywordReplaceStringRegExp } from './tools/utils';\nimport { cloneDeep, forEach, isArray } from 'lodash';\nimport APIHandler from './tools/auth0/handlers/default';\n\n/*\n  RFC for Keyword Preservation: https://github.com/auth0/auth0-deploy-cli/issues/688\n  Original Github Issue: https://github.com/auth0/auth0-deploy-cli/issues/328\n*/\n\nexport const doesHaveKeywordMarker = (\n  string: string,\n  keywordMappings: KeywordMappings\n): boolean => {\n  return !Object.keys(keywordMappings).every((keyword) => {\n    const hasArrayMarker = keywordReplaceArrayRegExp(keyword).test(string);\n    const hasStringMarker = keywordReplaceStringRegExp(keyword).test(string);\n\n    return !hasArrayMarker && !hasStringMarker;\n  });\n};\n\nexport const getPreservableFieldsFromAssets = (\n  asset: object,\n  keywordMappings: KeywordMappings,\n  resourceSpecificIdentifiers: Partial<{ [key in AssetTypes]: string | string[] }>,\n  address = ''\n): string[] => {\n  if (typeof asset === 'string') {\n    if (doesHaveKeywordMarker(asset, keywordMappings)) {\n      return [address];\n    }\n    return [];\n  }\n\n  const shouldRenderDot = address !== '';\n\n  if (Array.isArray(asset)) {\n    return asset\n      .map((arrayItem) => {\n        const resourceIdentifiers: string[] = (() => {\n          const identifiers = resourceSpecificIdentifiers[address];\n          if (Array.isArray(identifiers)) {\n            return identifiers;\n          }\n          return [identifiers];\n        })();\n\n        const specificAddress = resourceIdentifiers.reduce(\n          (aggregateAddress, resourceIdentifier) => {\n            resourceSpecificIdentifiers[address];\n            if (resourceIdentifier === undefined) return null; // See if this specific resource type has an identifier\n\n            const identifierFieldValue = arrayItem[resourceIdentifier];\n            if (identifierFieldValue === undefined) return null; // See if this specific array item possess the resource-specific identifier\n\n            if (aggregateAddress === '') {\n              return `${resourceIdentifier}=${identifierFieldValue}`;\n            }\n\n            return `${aggregateAddress}||${resourceIdentifier}=${identifierFieldValue}`;\n          },\n          ''\n        );\n\n        if (specificAddress === null) {\n          return [];\n        }\n\n        return getPreservableFieldsFromAssets(\n          arrayItem,\n          keywordMappings,\n          resourceSpecificIdentifiers,\n          `${address}${shouldRenderDot ? '.' : ''}[${specificAddress}]`\n        );\n      })\n      .flat();\n  }\n  if (typeof asset === 'object') {\n    return Object.keys(asset)\n      .map((key: string): string[] => {\n        const value = asset[key];\n\n        if (value === undefined || value === null) return [];\n\n        return getPreservableFieldsFromAssets(\n          value,\n          keywordMappings,\n          resourceSpecificIdentifiers,\n          `${address}${shouldRenderDot ? '.' : ''}${key}`\n        );\n      })\n      .flat();\n  }\n  return [];\n};\n\n// getAssetsValueByAddress returns a value for an arbitrary data structure when\n// provided an \"address\" of that value. This address is similar to JS object notation\n// with the exception of identifying array items by a unique property instead of order.\n// Example:\n// Object: `{ actions: [ { name: \"action-1\", code: \"...\"}] }`\n// Address: `.actions[name=action-1].code`\nexport const getAssetsValueByAddress = (address: string, assets: any): any => {\n  //Look ahead and see if the address path only contains dots (ex: `tenant.friendly_name`)\n  //if so the address is trivial and can use the dot-prop package to return the value\n\n  const isTrivialAddress = address.indexOf('[') === -1;\n  if (isTrivialAddress) {\n    return getByDotNotation(assets, address);\n  }\n\n  // It is easier to handle an address piece-by-piece by\n  // splitting on the period into separate \"directions\"\n  const directions = address.split(/\\.(?![^\\[]*\\])/g);\n\n  // If the the next directions are the proprietary array syntax (ex: `[name=foo]`)\n  // then perform lookup against unique array-item property\n  if (directions[0].charAt(0) === '[') {\n    if (!isArray(assets)) return undefined;\n\n    const target = assets.find((item: any) => {\n      const parts = directions[0].substring(1).slice(0, -1).split('||');\n\n      return parts.every((part) => {\n        const identifier = part.split('=')[0];\n        const identifierValue = part.split('=')[1];\n\n        return item[identifier] === identifierValue;\n      });\n    });\n\n    return getAssetsValueByAddress(directions.slice(1).join('.'), target);\n  }\n\n  return getAssetsValueByAddress(\n    directions.slice(1).join('.'),\n    getByDotNotation(assets, directions[0])\n  );\n};\n\n// convertAddressToDotNotation will convert the proprietary address into conventional\n// JS object notation. Performing this conversion simplifies the process\n// of updating a specific property for a given asset tree using the dot-prop library\n// returns null if address value does not exist in asset tree\nexport const convertAddressToDotNotation = (\n  assets: any,\n  address: string,\n  finalAddressTrail = ''\n): string | null => {\n  if (assets === null) return null; //Asset does not exist on remote\n\n  const directions = address.split(/\\.(?![^\\[]*\\])/g);\n\n  if (directions[0] === '') return finalAddressTrail;\n\n  if (directions[0].charAt(0) === '[') {\n    const identifiers = directions[0].substring(1).slice(0, -1).split('||');\n\n    let targetIndex = -1;\n\n    assets.forEach((item: any, index: number) => {\n      if (\n        identifiers.every((part) => {\n          const identifier = part.split('=')[0];\n          const identifierValue = part.split('=')[1];\n\n          return item[identifier] === identifierValue;\n        })\n      ) {\n        targetIndex = index;\n      }\n    });\n\n    if (targetIndex === -1) return null; // No object of this address exists in the assets\n\n    return convertAddressToDotNotation(\n      assets[targetIndex],\n      directions.slice(1).join('.'),\n      `${finalAddressTrail}.${targetIndex}`\n    );\n  }\n\n  return convertAddressToDotNotation(\n    getByDotNotation(assets, directions[0]),\n    directions.slice(1).join('.'),\n    finalAddressTrail === '' ? directions[0] : `${finalAddressTrail}.${directions[0]}`\n  );\n};\n\nexport const updateAssetsByAddress = (\n  assets: object,\n  address: string,\n  newValue: string\n): object => {\n  const dotNotationAddress = convertAddressToDotNotation(assets, address);\n\n  if (dotNotationAddress === null) return assets;\n\n  const doesPropertyExist = getByDotNotation(assets, dotNotationAddress) !== undefined;\n\n  if (!doesPropertyExist) {\n    return assets;\n  }\n\n  setByDotNotation(assets, dotNotationAddress, newValue);\n  return assets;\n};\n\n// preserveKeywords is the function that ultimately gets executed during export\n// to attempt to preserve keywords (ex: ##KEYWORD##) in local configuration files\n// from getting overwritten by remote values during export.\nexport const preserveKeywords = ({\n  localAssets,\n  remoteAssets,\n  keywordMappings,\n  auth0Handlers,\n}: {\n  localAssets: object;\n  remoteAssets: object;\n  keywordMappings: KeywordMappings;\n  auth0Handlers: (Pick<APIHandler, 'id' | 'type'> & {\n    identifiers: (string | string[])[];\n  })[];\n}): object => {\n  if (Object.keys(keywordMappings).length === 0) return remoteAssets;\n\n  const resourceSpecificIdentifiers: Partial<{ [key in AssetTypes]: string[] }> =\n    auth0Handlers.reduce((acc, handler): Partial<{ [key in AssetTypes]: string[] }> => {\n      return {\n        ...acc,\n        [handler.type]: handler.identifiers.filter((identifiers) => {\n          return identifiers !== handler.id;\n        })[0],\n      };\n    }, {});\n\n  const addresses = getPreservableFieldsFromAssets(\n    localAssets,\n    keywordMappings,\n    resourceSpecificIdentifiers,\n    ''\n  );\n\n  let updatedRemoteAssets = cloneDeep(remoteAssets);\n\n  addresses.forEach((address) => {\n    const localValue = getAssetsValueByAddress(address, localAssets);\n\n    const remoteAssetsAddress = (() => {\n      const doesAddressHaveKeyword = doesHaveKeywordMarker(address, keywordMappings);\n      if (doesAddressHaveKeyword) {\n        return keywordReplace(address, keywordMappings);\n      }\n      return address;\n    })();\n    const remoteValue = getAssetsValueByAddress(remoteAssetsAddress, remoteAssets);\n\n    const localValueWithReplacement = keywordReplace(localValue, keywordMappings);\n\n    const localAndRemoteValuesAreEqual = (() => {\n      if (typeof remoteValue === 'string') {\n        return localValueWithReplacement === remoteValue;\n      }\n      //TODO: Account for non-string replacements via @@ syntax\n    })();\n\n    if (!localAndRemoteValuesAreEqual) {\n      console.warn(\n        `WARNING! The remote value with address of ${address} has value of \"${remoteValue}\" but will be preserved with \"${localValueWithReplacement}\" due to keyword preservation.`\n      );\n    }\n\n    // Two address possibilities are provided to account for cases when there is a keyword\n    // in the resources's identifier field. When the resource identifier's field is preserved\n    // on the remote assets tree, it loses its identify, so we'll need to try two addresses:\n    // one where the identifier field has a keyword and one where the identifier field has\n    // the literal replaced value.\n    // Example: `customDomains.[domain=##DOMAIN].domain` and `customDomains.[domain=travel0.com].domain`\n    updatedRemoteAssets = updateAssetsByAddress(\n      updatedRemoteAssets,\n      address, //Two possible addresses need to be passed, one with identifier field keyword replaced and one where it is not replaced. Ex: `customDomains.[domain=##DOMAIN].domain` and `customDomains.[domain=travel0.com].domain`\n      localValue\n    );\n    updatedRemoteAssets = updateAssetsByAddress(\n      updatedRemoteAssets,\n      remoteAssetsAddress, //Two possible addresses need to be passed, one with identifier field keyword replaced and one where it is not replaced. Ex: `customDomains.[domain=##DOMAIN].domain` and `customDomains.[domain=travel0.com].domain`\n      localValue\n    );\n  });\n\n  return updatedRemoteAssets;\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4e81bd924c2eb765a706fe9cd9307ad086791f83","contentHash":"30540e102dc7045354f8edf8cedf06e55847d0a1947c783ef2616c0c70b83621"},"/home/circleci/repo/src/context/directory/index.ts":{"path":"/home/circleci/repo/src/context/directory/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":16},"end":{"line":33,"column":1}},"25":{"start":{"line":26,"column":28},"end":{"line":26,"column":110}},"26":{"start":{"line":26,"column":91},"end":{"line":26,"column":106}},"27":{"start":{"line":27,"column":4},"end":{"line":32,"column":7}},"28":{"start":{"line":28,"column":36},"end":{"line":28,"column":97}},"29":{"start":{"line":28,"column":42},"end":{"line":28,"column":70}},"30":{"start":{"line":28,"column":85},"end":{"line":28,"column":95}},"31":{"start":{"line":29,"column":35},"end":{"line":29,"column":100}},"32":{"start":{"line":29,"column":41},"end":{"line":29,"column":73}},"33":{"start":{"line":29,"column":88},"end":{"line":29,"column":98}},"34":{"start":{"line":30,"column":32},"end":{"line":30,"column":116}},"35":{"start":{"line":31,"column":8},"end":{"line":31,"column":78}},"36":{"start":{"line":34,"column":22},"end":{"line":36,"column":1}},"37":{"start":{"line":35,"column":4},"end":{"line":35,"column":62}},"38":{"start":{"line":37,"column":0},"end":{"line":37,"column":62}},"39":{"start":{"line":38,"column":13},"end":{"line":38,"column":42}},"40":{"start":{"line":39,"column":16},"end":{"line":39,"column":38}},"41":{"start":{"line":40,"column":17},"end":{"line":40,"column":69}},"42":{"start":{"line":41,"column":19},"end":{"line":41,"column":61}},"43":{"start":{"line":42,"column":17},"end":{"line":42,"column":57}},"44":{"start":{"line":43,"column":19},"end":{"line":43,"column":57}},"45":{"start":{"line":44,"column":16},"end":{"line":44,"column":38}},"46":{"start":{"line":45,"column":12},"end":{"line":45,"column":25}},"47":{"start":{"line":46,"column":30},"end":{"line":46,"column":66}},"48":{"start":{"line":49,"column":8},"end":{"line":49,"column":48}},"49":{"start":{"line":50,"column":8},"end":{"line":50,"column":29}},"50":{"start":{"line":51,"column":8},"end":{"line":51,"column":68}},"51":{"start":{"line":52,"column":8},"end":{"line":52,"column":60}},"52":{"start":{"line":53,"column":8},"end":{"line":53,"column":47}},"53":{"start":{"line":55,"column":8},"end":{"line":55,"column":25}},"54":{"start":{"line":57,"column":8},"end":{"line":64,"column":10}},"55":{"start":{"line":67,"column":25},"end":{"line":67,"column":57}},"56":{"start":{"line":68,"column":21},"end":{"line":68,"column":43}},"57":{"start":{"line":69,"column":8},"end":{"line":72,"column":9}},"58":{"start":{"line":71,"column":12},"end":{"line":71,"column":23}},"59":{"start":{"line":73,"column":8},"end":{"line":76,"column":11}},"60":{"start":{"line":79,"column":8},"end":{"line":99,"column":11}},"61":{"start":{"line":80,"column":12},"end":{"line":80,"column":76}},"62":{"start":{"line":81,"column":12},"end":{"line":97,"column":13}},"63":{"start":{"line":83,"column":16},"end":{"line":83,"column":79}},"64":{"start":{"line":84,"column":16},"end":{"line":95,"column":19}},"65":{"start":{"line":86,"column":47},"end":{"line":86,"column":79}},"66":{"start":{"line":87,"column":20},"end":{"line":87,"column":69}},"67":{"start":{"line":91,"column":35},"end":{"line":91,"column":54}},"68":{"start":{"line":92,"column":20},"end":{"line":94,"column":23}},"69":{"start":{"line":93,"column":24},"end":{"line":93,"column":43}},"70":{"start":{"line":96,"column":16},"end":{"line":96,"column":23}},"71":{"start":{"line":98,"column":12},"end":{"line":98,"column":102}},"72":{"start":{"line":102,"column":8},"end":{"line":150,"column":11}},"73":{"start":{"line":103,"column":26},"end":{"line":103,"column":111}},"74":{"start":{"line":104,"column":12},"end":{"line":104,"column":63}},"75":{"start":{"line":105,"column":12},"end":{"line":105,"column":46}},"76":{"start":{"line":108,"column":12},"end":{"line":109,"column":60}},"77":{"start":{"line":110,"column":12},"end":{"line":124,"column":13}},"78":{"start":{"line":111,"column":16},"end":{"line":111,"column":84}},"79":{"start":{"line":112,"column":36},"end":{"line":112,"column":66}},"80":{"start":{"line":114,"column":16},"end":{"line":114,"column":38}},"81":{"start":{"line":115,"column":16},"end":{"line":120,"column":19}},"82":{"start":{"line":123,"column":16},"end":{"line":123,"column":43}},"83":{"start":{"line":126,"column":12},"end":{"line":126,"column":76}},"84":{"start":{"line":130,"column":12},"end":{"line":130,"column":71}},"85":{"start":{"line":132,"column":12},"end":{"line":134,"column":13}},"86":{"start":{"line":133,"column":16},"end":{"line":133,"column":80}},"87":{"start":{"line":135,"column":12},"end":{"line":149,"column":17}},"88":{"start":{"line":137,"column":43},"end":{"line":137,"column":75}},"89":{"start":{"line":138,"column":16},"end":{"line":138,"column":65}},"90":{"start":{"line":141,"column":42},"end":{"line":149,"column":14}},"91":{"start":{"line":142,"column":16},"end":{"line":148,"column":17}},"92":{"start":{"line":143,"column":20},"end":{"line":143,"column":45}},"93":{"start":{"line":146,"column":20},"end":{"line":146,"column":54}},"94":{"start":{"line":147,"column":20},"end":{"line":147,"column":65}},"95":{"start":{"line":153,"column":0},"end":{"line":153,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":44},"end":{"line":25,"column":45}},"loc":{"start":{"line":25,"column":89},"end":{"line":33,"column":1}},"line":25},"7":{"name":"adopt","decl":{"start":{"line":26,"column":13},"end":{"line":26,"column":18}},"loc":{"start":{"line":26,"column":26},"end":{"line":26,"column":112}},"line":26},"8":{"name":"(anonymous_8)","decl":{"start":{"line":26,"column":70},"end":{"line":26,"column":71}},"loc":{"start":{"line":26,"column":89},"end":{"line":26,"column":108}},"line":26},"9":{"name":"(anonymous_9)","decl":{"start":{"line":27,"column":36},"end":{"line":27,"column":37}},"loc":{"start":{"line":27,"column":63},"end":{"line":32,"column":5}},"line":27},"10":{"name":"fulfilled","decl":{"start":{"line":28,"column":17},"end":{"line":28,"column":26}},"loc":{"start":{"line":28,"column":34},"end":{"line":28,"column":99}},"line":28},"11":{"name":"rejected","decl":{"start":{"line":29,"column":17},"end":{"line":29,"column":25}},"loc":{"start":{"line":29,"column":33},"end":{"line":29,"column":102}},"line":29},"12":{"name":"step","decl":{"start":{"line":30,"column":17},"end":{"line":30,"column":21}},"loc":{"start":{"line":30,"column":30},"end":{"line":30,"column":118}},"line":30},"13":{"name":"(anonymous_13)","decl":{"start":{"line":34,"column":56},"end":{"line":34,"column":57}},"loc":{"start":{"line":34,"column":71},"end":{"line":36,"column":1}},"line":34},"14":{"name":"(anonymous_14)","decl":{"start":{"line":48,"column":4},"end":{"line":48,"column":5}},"loc":{"start":{"line":48,"column":36},"end":{"line":65,"column":5}},"line":48},"15":{"name":"(anonymous_15)","decl":{"start":{"line":66,"column":4},"end":{"line":66,"column":5}},"loc":{"start":{"line":66,"column":24},"end":{"line":77,"column":5}},"line":66},"16":{"name":"(anonymous_16)","decl":{"start":{"line":78,"column":4},"end":{"line":78,"column":5}},"loc":{"start":{"line":78,"column":69},"end":{"line":100,"column":5}},"line":78},"17":{"name":"(anonymous_17)","decl":{"start":{"line":79,"column":47},"end":{"line":79,"column":48}},"loc":{"start":{"line":79,"column":60},"end":{"line":99,"column":9}},"line":79},"18":{"name":"(anonymous_18)","decl":{"start":{"line":85,"column":28},"end":{"line":85,"column":29}},"loc":{"start":{"line":85,"column":47},"end":{"line":88,"column":17}},"line":85},"19":{"name":"(anonymous_19)","decl":{"start":{"line":90,"column":29},"end":{"line":90,"column":30}},"loc":{"start":{"line":90,"column":51},"end":{"line":95,"column":17}},"line":90},"20":{"name":"(anonymous_20)","decl":{"start":{"line":92,"column":51},"end":{"line":92,"column":52}},"loc":{"start":{"line":92,"column":63},"end":{"line":94,"column":21}},"line":92},"21":{"name":"(anonymous_21)","decl":{"start":{"line":101,"column":4},"end":{"line":101,"column":5}},"loc":{"start":{"line":101,"column":11},"end":{"line":151,"column":5}},"line":101},"22":{"name":"(anonymous_22)","decl":{"start":{"line":102,"column":47},"end":{"line":102,"column":48}},"loc":{"start":{"line":102,"column":60},"end":{"line":150,"column":9}},"line":102},"23":{"name":"(anonymous_23)","decl":{"start":{"line":136,"column":24},"end":{"line":136,"column":25}},"loc":{"start":{"line":136,"column":43},"end":{"line":139,"column":13}},"line":136},"24":{"name":"(anonymous_24)","decl":{"start":{"line":141,"column":21},"end":{"line":141,"column":22}},"loc":{"start":{"line":141,"column":42},"end":{"line":149,"column":14}},"line":141},"25":{"name":"(anonymous_25)","decl":{"start":{"line":141,"column":74},"end":{"line":141,"column":75}},"loc":{"start":{"line":141,"column":87},"end":{"line":149,"column":13}},"line":141}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":25,"column":16},"end":{"line":33,"column":1}},"type":"binary-expr","locations":[{"start":{"line":25,"column":17},"end":{"line":25,"column":21}},{"start":{"line":25,"column":25},"end":{"line":25,"column":39}},{"start":{"line":25,"column":44},"end":{"line":33,"column":1}}],"line":25},"17":{"loc":{"start":{"line":26,"column":35},"end":{"line":26,"column":109}},"type":"cond-expr","locations":[{"start":{"line":26,"column":56},"end":{"line":26,"column":61}},{"start":{"line":26,"column":64},"end":{"line":26,"column":109}}],"line":26},"18":{"loc":{"start":{"line":27,"column":16},"end":{"line":27,"column":34}},"type":"binary-expr","locations":[{"start":{"line":27,"column":16},"end":{"line":27,"column":17}},{"start":{"line":27,"column":22},"end":{"line":27,"column":33}}],"line":27},"19":{"loc":{"start":{"line":30,"column":32},"end":{"line":30,"column":115}},"type":"cond-expr","locations":[{"start":{"line":30,"column":46},"end":{"line":30,"column":67}},{"start":{"line":30,"column":70},"end":{"line":30,"column":115}}],"line":30},"20":{"loc":{"start":{"line":31,"column":51},"end":{"line":31,"column":67}},"type":"binary-expr","locations":[{"start":{"line":31,"column":51},"end":{"line":31,"column":61}},{"start":{"line":31,"column":65},"end":{"line":31,"column":67}}],"line":31},"21":{"loc":{"start":{"line":34,"column":22},"end":{"line":36,"column":1}},"type":"binary-expr","locations":[{"start":{"line":34,"column":23},"end":{"line":34,"column":27}},{"start":{"line":34,"column":31},"end":{"line":34,"column":51}},{"start":{"line":34,"column":56},"end":{"line":36,"column":1}}],"line":34},"22":{"loc":{"start":{"line":35,"column":11},"end":{"line":35,"column":61}},"type":"cond-expr","locations":[{"start":{"line":35,"column":37},"end":{"line":35,"column":40}},{"start":{"line":35,"column":43},"end":{"line":35,"column":61}}],"line":35},"23":{"loc":{"start":{"line":35,"column":12},"end":{"line":35,"column":33}},"type":"binary-expr","locations":[{"start":{"line":35,"column":12},"end":{"line":35,"column":15}},{"start":{"line":35,"column":19},"end":{"line":35,"column":33}}],"line":35},"24":{"loc":{"start":{"line":51,"column":24},"end":{"line":51,"column":67}},"type":"binary-expr","locations":[{"start":{"line":51,"column":24},"end":{"line":51,"column":61}},{"start":{"line":51,"column":65},"end":{"line":51,"column":67}}],"line":51},"25":{"loc":{"start":{"line":58,"column":19},"end":{"line":58,"column":52}},"type":"binary-expr","locations":[{"start":{"line":58,"column":19},"end":{"line":58,"column":46}},{"start":{"line":58,"column":50},"end":{"line":58,"column":52}}],"line":58},"26":{"loc":{"start":{"line":59,"column":21},"end":{"line":59,"column":56}},"type":"binary-expr","locations":[{"start":{"line":59,"column":21},"end":{"line":59,"column":50}},{"start":{"line":59,"column":54},"end":{"line":59,"column":56}}],"line":59},"27":{"loc":{"start":{"line":60,"column":23},"end":{"line":60,"column":60}},"type":"binary-expr","locations":[{"start":{"line":60,"column":23},"end":{"line":60,"column":54}},{"start":{"line":60,"column":58},"end":{"line":60,"column":60}}],"line":60},"28":{"loc":{"start":{"line":61,"column":25},"end":{"line":61,"column":64}},"type":"binary-expr","locations":[{"start":{"line":61,"column":25},"end":{"line":61,"column":58}},{"start":{"line":61,"column":62},"end":{"line":61,"column":64}}],"line":61},"29":{"loc":{"start":{"line":62,"column":29},"end":{"line":62,"column":73}},"type":"binary-expr","locations":[{"start":{"line":62,"column":29},"end":{"line":62,"column":67}},{"start":{"line":62,"column":71},"end":{"line":62,"column":73}}],"line":62},"30":{"loc":{"start":{"line":63,"column":22},"end":{"line":63,"column":58}},"type":"binary-expr","locations":[{"start":{"line":63,"column":22},"end":{"line":63,"column":52}},{"start":{"line":63,"column":56},"end":{"line":63,"column":58}}],"line":63},"31":{"loc":{"start":{"line":69,"column":8},"end":{"line":72,"column":9}},"type":"if","locations":[{"start":{"line":69,"column":8},"end":{"line":72,"column":9}},{"start":{"line":69,"column":8},"end":{"line":72,"column":9}}],"line":69},"32":{"loc":{"start":{"line":78,"column":24},"end":{"line":78,"column":67}},"type":"default-arg","locations":[{"start":{"line":78,"column":31},"end":{"line":78,"column":67}}],"line":78},"33":{"loc":{"start":{"line":81,"column":12},"end":{"line":97,"column":13}},"type":"if","locations":[{"start":{"line":81,"column":12},"end":{"line":97,"column":13}},{"start":{"line":81,"column":12},"end":{"line":97,"column":13}}],"line":81},"34":{"loc":{"start":{"line":86,"column":47},"end":{"line":86,"column":79}},"type":"binary-expr","locations":[{"start":{"line":86,"column":47},"end":{"line":86,"column":73}},{"start":{"line":86,"column":77},"end":{"line":86,"column":79}}],"line":86},"35":{"loc":{"start":{"line":108,"column":12},"end":{"line":109,"column":60}},"type":"binary-expr","locations":[{"start":{"line":108,"column":12},"end":{"line":108,"column":58}},{"start":{"line":109,"column":16},"end":{"line":109,"column":60}}],"line":108},"36":{"loc":{"start":{"line":110,"column":12},"end":{"line":124,"column":13}},"type":"if","locations":[{"start":{"line":110,"column":12},"end":{"line":124,"column":13}},{"start":{"line":110,"column":12},"end":{"line":124,"column":13}}],"line":110},"37":{"loc":{"start":{"line":118,"column":37},"end":{"line":118,"column":85}},"type":"binary-expr","locations":[{"start":{"line":118,"column":37},"end":{"line":118,"column":79}},{"start":{"line":118,"column":83},"end":{"line":118,"column":85}}],"line":118},"38":{"loc":{"start":{"line":130,"column":43},"end":{"line":130,"column":68}},"type":"binary-expr","locations":[{"start":{"line":130,"column":43},"end":{"line":130,"column":62}},{"start":{"line":130,"column":66},"end":{"line":130,"column":68}}],"line":130},"39":{"loc":{"start":{"line":132,"column":12},"end":{"line":134,"column":13}},"type":"if","locations":[{"start":{"line":132,"column":12},"end":{"line":134,"column":13}},{"start":{"line":132,"column":12},"end":{"line":134,"column":13}}],"line":132},"40":{"loc":{"start":{"line":137,"column":43},"end":{"line":137,"column":75}},"type":"binary-expr","locations":[{"start":{"line":137,"column":43},"end":{"line":137,"column":69}},{"start":{"line":137,"column":73},"end":{"line":137,"column":75}}],"line":137}},"s":{"0":1,"1":16,"2":16,"3":16,"4":16,"5":16,"6":22,"7":16,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":1,"15":1,"16":0,"17":1,"18":1,"19":1,"20":16,"21":16,"22":1,"23":1,"24":1,"25":4,"26":0,"27":69,"28":4,"29":4,"30":0,"31":0,"32":0,"33":0,"34":58,"35":69,"36":1,"37":4,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":111,"49":111,"50":111,"51":111,"52":111,"53":111,"54":111,"55":11,"56":11,"57":11,"58":3,"59":11,"60":67,"61":67,"62":67,"63":65,"64":65,"65":1885,"66":1885,"67":1597,"68":1584,"69":1584,"70":52,"71":2,"72":1,"73":1,"74":1,"75":1,"76":1,"77":1,"78":1,"79":1,"80":1,"81":1,"82":0,"83":1,"84":1,"85":1,"86":1,"87":1,"88":29,"89":29,"90":1,"91":1,"92":1,"93":0,"94":0,"95":1},"f":{"0":16,"1":22,"2":0,"3":1,"4":0,"5":1,"6":69,"7":4,"8":0,"9":69,"10":4,"11":0,"12":58,"13":4,"14":111,"15":11,"16":67,"17":67,"18":1885,"19":1597,"20":1584,"21":1,"22":1,"23":29,"24":1,"25":1},"b":{"0":[1,1,1],"1":[1,0],"2":[16,0],"3":[16,0],"4":[16,16],"5":[0,16],"6":[16,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,1],"13":[1,0],"14":[16,0],"15":[16,16],"16":[1,1,1],"17":[4,0],"18":[69,69],"19":[54,4],"20":[69,69],"21":[1,1,1],"22":[4,0],"23":[4,4],"24":[111,71],"25":[111,110],"26":[111,110],"27":[111,110],"28":[111,110],"29":[111,110],"30":[111,110],"31":[3,8],"32":[66],"33":[65,2],"34":[1885,1827],"35":[1,1],"36":[1,0],"37":[1,0],"38":[1,1],"39":[1,0],"40":[29,29]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/index.ts","sources":["/home/circleci/repo/src/context/directory/index.ts"],"names":[],"mappings":"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","sourcesContent":["import * as path from 'path';\nimport { loadFileAndReplaceKeywords, Auth0 } from '../../tools';\nimport pagedClient from '../../tools/auth0/client';\n\nimport cleanAssets from '../../readonly';\nimport log from '../../logger';\nimport handlers, { DirectoryHandler } from './handlers';\nimport { isDirectory, isFile, stripIdentifiers, toConfigFn } from '../../utils';\nimport { Assets, Auth0APIClient, Config, AssetTypes } from '../../types';\nimport { filterOnlyIncludedResourceTypes } from '..';\nimport { preserveKeywords } from '../../keywordPreservation';\n\ntype KeywordMappings = { [key: string]: (string | number)[] | string | number };\n\nexport default class DirectoryContext {\n  basePath: string;\n  filePath: string;\n  config: Config;\n  mappings: KeywordMappings;\n  mgmtClient: Auth0APIClient;\n  assets: Assets;\n  disableKeywordReplacement: boolean;\n\n  constructor(config: Config, mgmtClient: Auth0APIClient) {\n    this.filePath = config.AUTH0_INPUT_FILE;\n    this.config = config;\n    this.mappings = config.AUTH0_KEYWORD_REPLACE_MAPPINGS || {};\n    this.mgmtClient = pagedClient(mgmtClient);\n    this.disableKeywordReplacement = false;\n\n    //@ts-ignore for now\n    this.assets = {};\n    // Get excluded rules\n    this.assets.exclude = {\n      rules: config.AUTH0_EXCLUDED_RULES || [],\n      clients: config.AUTH0_EXCLUDED_CLIENTS || [],\n      databases: config.AUTH0_EXCLUDED_DATABASES || [],\n      connections: config.AUTH0_EXCLUDED_CONNECTIONS || [],\n      resourceServers: config.AUTH0_EXCLUDED_RESOURCE_SERVERS || [],\n      defaults: config.AUTH0_EXCLUDED_DEFAULTS || [],\n    };\n  }\n\n  loadFile(f: string, folder: string) {\n    const basePath = path.join(this.filePath, folder);\n    let toLoad = path.join(basePath, f);\n    if (!isFile(toLoad)) {\n      // try load not relative to yaml file\n      toLoad = f;\n    }\n    return loadFileAndReplaceKeywords(toLoad, {\n      mappings: this.mappings,\n      disableKeywordReplacement: this.disableKeywordReplacement,\n    });\n  }\n\n  async loadAssetsFromLocal(opts = { disableKeywordReplacement: false }): Promise<void> {\n    this.disableKeywordReplacement = opts.disableKeywordReplacement;\n    if (isDirectory(this.filePath)) {\n      /* If this is a directory, look for each file in the directory */\n      log.info(`Processing directory ${this.filePath}`);\n\n      Object.entries(handlers)\n        .filter(([handlerName]: [AssetTypes, DirectoryHandler<any>]) => {\n          const excludedAssetTypes = this.config.AUTH0_EXCLUDED || [];\n          return !excludedAssetTypes.includes(handlerName);\n        })\n        .filter(filterOnlyIncludedResourceTypes(this.config.AUTH0_INCLUDED_ONLY))\n        .forEach(([_name, handler]) => {\n          const parsed = handler.parse(this);\n          Object.entries(parsed).forEach(([k, v]) => {\n            this.assets[k] = v;\n          });\n        });\n      return;\n    }\n    throw new Error(`Not sure what to do with, ${this.filePath} as it is not a directory...`);\n  }\n\n  async dump(): Promise<void> {\n    const auth0 = new Auth0(this.mgmtClient, this.assets, toConfigFn(this.config));\n    log.info('Loading Auth0 Tenant Data');\n    await auth0.loadAssetsFromAuth0();\n\n    const shouldPreserveKeywords =\n      //@ts-ignore because the string=>boolean conversion may not have happened if passed-in as env var\n      this.config.AUTH0_PRESERVE_KEYWORDS === 'true' ||\n      this.config.AUTH0_PRESERVE_KEYWORDS === true;\n    if (shouldPreserveKeywords) {\n      await this.loadAssetsFromLocal({ disableKeywordReplacement: true }); //Need to disable keyword replacement to retrieve the raw keyword markers (ex: ##KEYWORD##)\n      const localAssets = { ...this.assets };\n      //@ts-ignore\n      delete this['assets'];\n\n      this.assets = preserveKeywords({\n        localAssets,\n        remoteAssets: auth0.assets,\n        keywordMappings: this.config.AUTH0_KEYWORD_REPLACE_MAPPINGS || {},\n        auth0Handlers: auth0.handlers,\n      });\n    } else {\n      this.assets = auth0.assets;\n    }\n\n    // Clean known read only fields\n    this.assets = cleanAssets(this.assets, this.config);\n\n    // Copy clients to be used by handlers which require converting client_id to the name\n    // Must copy as the client_id will be stripped if AUTH0_EXPORT_IDENTIFIERS is false\n    //@ts-ignore because assets haven't been typed yet TODO: type assets\n    this.assets.clientsOrig = [...(this.assets.clients || [])];\n\n    // Optionally Strip identifiers\n    if (!this.config.AUTH0_EXPORT_IDENTIFIERS) {\n      this.assets = stripIdentifiers(auth0, this.assets);\n    }\n\n    await Promise.all(\n      Object.entries(handlers)\n        .filter(([handlerName]: [AssetTypes, DirectoryHandler<any>]) => {\n          const excludedAssetTypes = this.config.AUTH0_EXCLUDED || [];\n          return !excludedAssetTypes.includes(handlerName);\n        })\n        .filter(filterOnlyIncludedResourceTypes(this.config.AUTH0_INCLUDED_ONLY))\n        .map(async ([name, handler]) => {\n          try {\n            await handler.dump(this);\n          } catch (err) {\n            log.debug(err.stack);\n            throw new Error(`Problem exporting ${name}`);\n          }\n        })\n    );\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"03b966f35a72d752699dd4d1da59befc53eb1a2a","contentHash":"f55206b5b5309c4c142a266e1670a54cda0039b1e6bc289684f749c8a5480021"},"/home/circleci/repo/src/context/directory/handlers/index.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":16},"end":{"line":6,"column":51}},"4":{"start":{"line":7,"column":16},"end":{"line":7,"column":51}},"5":{"start":{"line":8,"column":16},"end":{"line":8,"column":51}},"6":{"start":{"line":9,"column":18},"end":{"line":9,"column":55}},"7":{"start":{"line":10,"column":17},"end":{"line":10,"column":53}},"8":{"start":{"line":11,"column":24},"end":{"line":11,"column":67}},"9":{"start":{"line":12,"column":22},"end":{"line":12,"column":63}},"10":{"start":{"line":13,"column":20},"end":{"line":13,"column":59}},"11":{"start":{"line":14,"column":25},"end":{"line":14,"column":69}},"12":{"start":{"line":15,"column":23},"end":{"line":15,"column":65}},"13":{"start":{"line":16,"column":23},"end":{"line":16,"column":65}},"14":{"start":{"line":17,"column":26},"end":{"line":17,"column":71}},"15":{"start":{"line":18,"column":26},"end":{"line":18,"column":71}},"16":{"start":{"line":19,"column":34},"end":{"line":19,"column":87}},"17":{"start":{"line":20,"column":34},"end":{"line":20,"column":87}},"18":{"start":{"line":21,"column":42},"end":{"line":21,"column":103}},"19":{"start":{"line":22,"column":46},"end":{"line":22,"column":111}},"20":{"start":{"line":23,"column":27},"end":{"line":23,"column":73}},"21":{"start":{"line":24,"column":16},"end":{"line":24,"column":51}},"22":{"start":{"line":25,"column":21},"end":{"line":25,"column":61}},"23":{"start":{"line":26,"column":18},"end":{"line":26,"column":55}},"24":{"start":{"line":27,"column":24},"end":{"line":27,"column":67}},"25":{"start":{"line":28,"column":19},"end":{"line":28,"column":57}},"26":{"start":{"line":29,"column":27},"end":{"line":29,"column":73}},"27":{"start":{"line":30,"column":19},"end":{"line":30,"column":57}},"28":{"start":{"line":31,"column":21},"end":{"line":31,"column":61}},"29":{"start":{"line":32,"column":18},"end":{"line":32,"column":55}},"30":{"start":{"line":33,"column":24},"end":{"line":33,"column":67}},"31":{"start":{"line":34,"column":17},"end":{"line":34,"column":53}},"32":{"start":{"line":35,"column":26},"end":{"line":65,"column":1}},"33":{"start":{"line":66,"column":0},"end":{"line":66,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":29,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1},"f":{"0":29},"b":{"0":[1,1,1],"1":[29,0],"2":[29,29]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/index.ts","sources":["/home/circleci/repo/src/context/directory/handlers/index.ts"],"names":[],"mappings":";;;;;AAAA,oDAA4B;AAC5B,oDAA4B;AAC5B,oDAA4B;AAC5B,wDAAgC;AAChC,sDAA8B;AAC9B,oEAA4C;AAC5C,gEAAwC;AACxC,4DAAoC;AACpC,sEAA8C;AAC9C,kEAA0C;AAC1C,kEAA0C;AAC1C,wEAAgD;AAChD,wEAAgD;AAChD,wFAAgE;AAChE,wFAAgE;AAChE,wGAAgF;AAChF,gHAAwF;AACxF,0EAAkD;AAClD,oDAA4B;AAC5B,8DAAsC;AACtC,wDAAgC;AAChC,oEAA4C;AAC5C,0DAAkC;AAClC,0EAAkD;AAClD,0DAAkC;AAClC,8DAAsC;AACtC,wDAAgC;AAChC,oEAA4C;AAC5C,sDAA8B;AAU9B,MAAM,iBAAiB,GAEnB;IACF,KAAK,EAAL,eAAK;IACL,YAAY,EAAZ,sBAAY;IACZ,KAAK,EAAL,eAAK;IACL,KAAK,EAAL,eAAK;IACL,SAAS,EAAT,mBAAS;IACT,YAAY,EAAZ,sBAAY;IACZ,eAAe,EAAf,yBAAe;IACf,OAAO,EAAP,iBAAO;IACP,WAAW,EAAX,qBAAW;IACX,MAAM,EAAN,gBAAM;IACN,aAAa,EAAb,uBAAa;IACb,cAAc,EAAd,wBAAc;IACd,eAAe,EAAf,yBAAe;IACf,uBAAuB,EAAvB,iCAAuB;IACvB,uBAAuB,EAAvB,iCAAuB;IACvB,UAAU,EAAV,oBAAU;IACV,+BAA+B,EAA/B,yCAA+B;IAC/B,mCAAmC,EAAnC,6CAAmC;IACnC,gBAAgB,EAAhB,0BAAgB;IAChB,KAAK,EAAL,eAAK;IACL,OAAO,EAAP,iBAAO;IACP,aAAa,EAAb,uBAAa;IACb,QAAQ,EAAR,kBAAQ;IACR,gBAAgB,EAAhB,0BAAgB;IAChB,QAAQ,EAAR,kBAAQ;IACR,UAAU,EAAV,oBAAU;IACV,OAAO,EAAP,iBAAO;IACP,aAAa,EAAb,uBAAa;IACb,MAAM,EAAN,gBAAM;CACP,CAAC;AAEF,kBAAe,iBAAiB,CAAC","sourcesContent":["import pages from './pages';\nimport rules from './rules';\nimport hooks from './hooks';\nimport clients from './clients';\nimport tenant from './tenant';\nimport emailProvider from './emailProvider';\nimport connections from './connections';\nimport databases from './databases';\nimport emailTemplates from './emailTemplates';\nimport clientGrants from './clientGrants';\nimport rulesConfigs from './rulesConfigs';\nimport resourceServers from './resourceServers';\nimport guardianFactors from './guardianFactors';\nimport guardianFactorProviders from './guardianFactorProviders';\nimport guardianFactorTemplates from './guardianFactorTemplates';\nimport guardianPhoneFactorMessageTypes from './guardianPhoneFactorMessageTypes';\nimport guardianPhoneFactorSelectedProvider from './guardianPhoneFactorSelectedProvider';\nimport guardianPolicies from './guardianPolicies';\nimport roles from './roles';\nimport migrations from './migrations';\nimport actions from './actions';\nimport organizations from './organizations';\nimport triggers from './triggers';\nimport attackProtection from './attackProtection';\nimport branding from './branding';\nimport logStreams from './logStreams';\nimport prompts from './prompts';\nimport customDomains from './customDomains';\nimport themes from './themes';\n\nimport DirectoryContext from '..';\nimport { AssetTypes, Asset } from '../../../types';\n\nexport type DirectoryHandler<T> = {\n  dump: (context: DirectoryContext) => void;\n  parse: (context: DirectoryContext) => T;\n};\n\nconst directoryHandlers: {\n  [key in AssetTypes]: DirectoryHandler<{ [key: string]: Asset | Asset[] | null }>;\n} = {\n  rules,\n  rulesConfigs,\n  hooks,\n  pages,\n  databases,\n  clientGrants,\n  resourceServers,\n  clients,\n  connections,\n  tenant,\n  emailProvider,\n  emailTemplates,\n  guardianFactors,\n  guardianFactorProviders,\n  guardianFactorTemplates,\n  migrations,\n  guardianPhoneFactorMessageTypes,\n  guardianPhoneFactorSelectedProvider,\n  guardianPolicies,\n  roles,\n  actions,\n  organizations,\n  triggers,\n  attackProtection,\n  branding,\n  logStreams,\n  prompts,\n  customDomains,\n  themes,\n};\n\nexport default directoryHandlers;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7c8e6ef227d57cafe39e8c9656d44bdcb7de2aca","contentHash":"d13f2993019bd2d1e2d0c629e3967287b21a4d781af014887534218cf97e4509"},"/home/circleci/repo/src/context/directory/handlers/pages.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/pages.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"20":{"start":{"line":21,"column":24},"end":{"line":21,"column":96}},"21":{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":31}},"23":{"start":{"line":24,"column":18},"end":{"line":24,"column":72}},"24":{"start":{"line":25,"column":19},"end":{"line":34,"column":10}},"25":{"start":{"line":26,"column":30},"end":{"line":26,"column":56}},"26":{"start":{"line":27,"column":8},"end":{"line":28,"column":27}},"27":{"start":{"line":28,"column":12},"end":{"line":28,"column":27}},"28":{"start":{"line":29,"column":8},"end":{"line":30,"column":34}},"29":{"start":{"line":30,"column":12},"end":{"line":30,"column":34}},"30":{"start":{"line":31,"column":8},"end":{"line":32,"column":34}},"31":{"start":{"line":32,"column":12},"end":{"line":32,"column":34}},"32":{"start":{"line":33,"column":8},"end":{"line":33,"column":19}},"33":{"start":{"line":35,"column":18},"end":{"line":59,"column":6}},"34":{"start":{"line":36,"column":31},"end":{"line":36,"column":42}},"35":{"start":{"line":37,"column":8},"end":{"line":40,"column":9}},"36":{"start":{"line":38,"column":12},"end":{"line":38,"column":107}},"37":{"start":{"line":39,"column":12},"end":{"line":39,"column":22}},"38":{"start":{"line":41,"column":8},"end":{"line":47,"column":9}},"39":{"start":{"line":43,"column":12},"end":{"line":46,"column":31}},"40":{"start":{"line":48,"column":8},"end":{"line":51,"column":9}},"41":{"start":{"line":49,"column":12},"end":{"line":49,"column":103}},"42":{"start":{"line":50,"column":12},"end":{"line":50,"column":22}},"43":{"start":{"line":52,"column":8},"end":{"line":58,"column":18}},"44":{"start":{"line":60,"column":4},"end":{"line":62,"column":6}},"45":{"start":{"line":65,"column":4},"end":{"line":82,"column":7}},"46":{"start":{"line":66,"column":22},"end":{"line":66,"column":42}},"47":{"start":{"line":67,"column":8},"end":{"line":68,"column":19}},"48":{"start":{"line":68,"column":12},"end":{"line":68,"column":19}},"49":{"start":{"line":69,"column":28},"end":{"line":69,"column":100}},"50":{"start":{"line":70,"column":8},"end":{"line":70,"column":54}},"51":{"start":{"line":71,"column":8},"end":{"line":81,"column":11}},"52":{"start":{"line":72,"column":29},"end":{"line":72,"column":52}},"53":{"start":{"line":73,"column":12},"end":{"line":78,"column":13}},"54":{"start":{"line":74,"column":33},"end":{"line":74,"column":86}},"55":{"start":{"line":75,"column":16},"end":{"line":75,"column":61}},"56":{"start":{"line":76,"column":16},"end":{"line":76,"column":70}},"57":{"start":{"line":77,"column":16},"end":{"line":77,"column":54}},"58":{"start":{"line":79,"column":29},"end":{"line":79,"column":82}},"59":{"start":{"line":80,"column":12},"end":{"line":80,"column":54}},"60":{"start":{"line":84,"column":21},"end":{"line":87,"column":1}},"61":{"start":{"line":88,"column":0},"end":{"line":88,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":63,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":32},"end":{"line":25,"column":33}},"loc":{"start":{"line":25,"column":47},"end":{"line":34,"column":5}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":35,"column":46},"end":{"line":35,"column":47}},"loc":{"start":{"line":35,"column":55},"end":{"line":59,"column":5}},"line":35},"11":{"name":"dump","decl":{"start":{"line":64,"column":9},"end":{"line":64,"column":13}},"loc":{"start":{"line":64,"column":23},"end":{"line":83,"column":1}},"line":64},"12":{"name":"(anonymous_12)","decl":{"start":{"line":65,"column":43},"end":{"line":65,"column":44}},"loc":{"start":{"line":65,"column":56},"end":{"line":82,"column":5}},"line":65},"13":{"name":"(anonymous_13)","decl":{"start":{"line":71,"column":22},"end":{"line":71,"column":23}},"loc":{"start":{"line":71,"column":32},"end":{"line":81,"column":9}},"line":71}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},{"start":{"line":22,"column":4},"end":{"line":23,"column":31}}],"line":22},"9":{"loc":{"start":{"line":27,"column":8},"end":{"line":28,"column":27}},"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":28,"column":27}},{"start":{"line":27,"column":8},"end":{"line":28,"column":27}}],"line":27},"10":{"loc":{"start":{"line":29,"column":8},"end":{"line":30,"column":34}},"type":"if","locations":[{"start":{"line":29,"column":8},"end":{"line":30,"column":34}},{"start":{"line":29,"column":8},"end":{"line":30,"column":34}}],"line":29},"11":{"loc":{"start":{"line":31,"column":8},"end":{"line":32,"column":34}},"type":"if","locations":[{"start":{"line":31,"column":8},"end":{"line":32,"column":34}},{"start":{"line":31,"column":8},"end":{"line":32,"column":34}}],"line":31},"12":{"loc":{"start":{"line":37,"column":8},"end":{"line":40,"column":9}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":40,"column":9}},{"start":{"line":37,"column":8},"end":{"line":40,"column":9}}],"line":37},"13":{"loc":{"start":{"line":41,"column":8},"end":{"line":47,"column":9}},"type":"if","locations":[{"start":{"line":41,"column":8},"end":{"line":47,"column":9}},{"start":{"line":41,"column":8},"end":{"line":47,"column":9}}],"line":41},"14":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":58}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":17}},{"start":{"line":41,"column":21},"end":{"line":41,"column":58}}],"line":41},"15":{"loc":{"start":{"line":48,"column":8},"end":{"line":51,"column":9}},"type":"if","locations":[{"start":{"line":48,"column":8},"end":{"line":51,"column":9}},{"start":{"line":48,"column":8},"end":{"line":51,"column":9}}],"line":48},"16":{"loc":{"start":{"line":67,"column":8},"end":{"line":68,"column":19}},"type":"if","locations":[{"start":{"line":67,"column":8},"end":{"line":68,"column":19}},{"start":{"line":67,"column":8},"end":{"line":68,"column":19}}],"line":67},"17":{"loc":{"start":{"line":73,"column":12},"end":{"line":78,"column":13}},"type":"if","locations":[{"start":{"line":73,"column":12},"end":{"line":78,"column":13}},{"start":{"line":73,"column":12},"end":{"line":78,"column":13}}],"line":73}},"s":{"0":1,"1":0,"2":0,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":2,"11":2,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":61,"21":61,"22":57,"23":3,"24":3,"25":18,"26":18,"27":10,"28":18,"29":10,"30":18,"31":8,"32":18,"33":3,"34":10,"35":10,"36":0,"37":0,"38":10,"39":2,"40":8,"41":0,"42":0,"43":8,"44":3,"45":2,"46":2,"47":2,"48":0,"49":2,"50":2,"51":2,"52":5,"53":5,"54":3,"55":3,"56":3,"57":3,"58":5,"59":5,"60":1,"61":1},"f":{"0":2,"1":0,"2":0,"3":2,"4":0,"5":0,"6":2,"7":3,"8":61,"9":18,"10":10,"11":2,"12":2,"13":5},"b":{"0":[1,1,1],"1":[0,0],"2":[2,2],"3":[2,0],"4":[2,2],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[57,3],"9":[10,8],"10":[10,8],"11":[8,10],"12":[0,10],"13":[2,8],"14":[10,2],"15":[0,8],"16":[0,2],"17":[3,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/pages.ts","sources":["/home/circleci/repo/src/context/directory/handlers/pages.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants, loadFileAndReplaceKeywords } from '../../../tools';\n\nimport log from '../../../logger';\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { Page } from '../../../tools/auth0/handlers/pages';\n\ntype ParsedPages = ParsedAsset<'pages', Page[]>;\n\nfunction parse(context: DirectoryContext): ParsedPages {\n  const pagesFolder = path.join(context.filePath, constants.PAGES_DIRECTORY);\n  if (!existsMustBeDir(pagesFolder)) return { pages: null }; // Skip\n\n  const files: string[] = getFiles(pagesFolder, ['.json', '.html']);\n\n  const sorted: {\n    [key: string]: {\n      meta?: string;\n      html?: string;\n    };\n  } = files.reduce((acc, file) => {\n    const { ext, name } = path.parse(file);\n    if (!acc[name]) acc[name] = {};\n    if (ext === '.json') acc[name].meta = file;\n    if (ext === '.html') acc[name].html = file;\n    return acc;\n  }, {});\n\n  const pages = Object.keys(sorted).flatMap((key): Page[] => {\n    const { meta, html } = sorted[key];\n    if (!meta) {\n      log.warn(`Skipping pages file ${html} as missing the corresponding '.json' file`);\n      return [];\n    }\n    if (!html && ['error_page', 'login'].includes(key)) {\n      //Error pages don't require an HTML template, it is valid to redirect errors to URL\n      return {\n        ...loadJSON(meta, {\n          mappings: context.mappings,\n          disableKeywordReplacement: context.disableKeywordReplacement,\n        }),\n        html: '',\n      };\n    }\n    if (!html) {\n      log.warn(`Skipping pages file ${meta} as missing corresponding '.html' file`);\n      return [];\n    }\n    return {\n      ...loadJSON(meta, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }),\n      html: loadFileAndReplaceKeywords(html, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }),\n    };\n  });\n\n  return {\n    pages,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const pages = context.assets.pages;\n\n  if (!pages) return;\n\n  const pagesFolder = path.join(context.filePath, constants.PAGES_DIRECTORY);\n  fs.ensureDirSync(pagesFolder);\n\n  pages.forEach((page) => {\n    const metadata = { ...page };\n\n    if (page.html !== undefined) {\n      const htmlFile = path.join(pagesFolder, `${page.name}.html`);\n      log.info(`Writing ${htmlFile}`);\n      fs.writeFileSync(htmlFile, page.html);\n      metadata.html = `./${page.name}.html`;\n    }\n\n    const pageFile = path.join(pagesFolder, `${page.name}.json`);\n    dumpJSON(pageFile, metadata);\n  });\n}\n\nconst pagesHandler: DirectoryHandler<ParsedPages> = {\n  parse,\n  dump,\n};\n\nexport default pagesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1acf064d3d7ac0b85c3e7fd3f21c5ccac8eca698","contentHash":"ed91be1e40ed7c40e0bdcf0a96145d669d94ab6374fbb3dc19f9e7133e8b96a0"},"/home/circleci/repo/src/context/directory/handlers/rules.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/rules.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"20":{"start":{"line":21,"column":24},"end":{"line":21,"column":96}},"21":{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":31}},"23":{"start":{"line":24,"column":18},"end":{"line":24,"column":63}},"24":{"start":{"line":25,"column":18},"end":{"line":34,"column":6}},"25":{"start":{"line":26,"column":21},"end":{"line":29,"column":11}},"26":{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},"27":{"start":{"line":31,"column":12},"end":{"line":31,"column":91}},"28":{"start":{"line":33,"column":8},"end":{"line":33,"column":20}},"29":{"start":{"line":35,"column":4},"end":{"line":37,"column":6}},"30":{"start":{"line":40,"column":4},"end":{"line":57,"column":7}},"31":{"start":{"line":41,"column":26},"end":{"line":41,"column":40}},"32":{"start":{"line":42,"column":8},"end":{"line":43,"column":19}},"33":{"start":{"line":43,"column":12},"end":{"line":43,"column":19}},"34":{"start":{"line":45,"column":28},"end":{"line":45,"column":100}},"35":{"start":{"line":46,"column":8},"end":{"line":46,"column":54}},"36":{"start":{"line":47,"column":8},"end":{"line":56,"column":11}},"37":{"start":{"line":49,"column":25},"end":{"line":49,"column":57}},"38":{"start":{"line":50,"column":27},"end":{"line":50,"column":73}},"39":{"start":{"line":51,"column":12},"end":{"line":51,"column":55}},"40":{"start":{"line":52,"column":12},"end":{"line":52,"column":66}},"41":{"start":{"line":54,"column":29},"end":{"line":54,"column":77}},"42":{"start":{"line":55,"column":12},"end":{"line":55,"column":112}},"43":{"start":{"line":59,"column":21},"end":{"line":62,"column":1}},"44":{"start":{"line":63,"column":0},"end":{"line":63,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":38,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":28},"end":{"line":25,"column":29}},"loc":{"start":{"line":25,"column":35},"end":{"line":34,"column":5}},"line":25},"10":{"name":"dump","decl":{"start":{"line":39,"column":9},"end":{"line":39,"column":13}},"loc":{"start":{"line":39,"column":23},"end":{"line":58,"column":1}},"line":39},"11":{"name":"(anonymous_11)","decl":{"start":{"line":40,"column":43},"end":{"line":40,"column":44}},"loc":{"start":{"line":40,"column":56},"end":{"line":57,"column":5}},"line":40},"12":{"name":"(anonymous_12)","decl":{"start":{"line":47,"column":22},"end":{"line":47,"column":23}},"loc":{"start":{"line":47,"column":32},"end":{"line":56,"column":9}},"line":47}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},{"start":{"line":22,"column":4},"end":{"line":23,"column":31}}],"line":22},"9":{"loc":{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},"type":"if","locations":[{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},{"start":{"line":30,"column":8},"end":{"line":32,"column":9}}],"line":30},"10":{"loc":{"start":{"line":42,"column":8},"end":{"line":43,"column":19}},"type":"if","locations":[{"start":{"line":42,"column":8},"end":{"line":43,"column":19}},{"start":{"line":42,"column":8},"end":{"line":43,"column":19}}],"line":42}},"s":{"0":1,"1":0,"2":0,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":2,"11":2,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":63,"21":63,"22":60,"23":2,"24":2,"25":4,"26":4,"27":4,"28":4,"29":2,"30":2,"31":2,"32":2,"33":0,"34":2,"35":2,"36":2,"37":2,"38":2,"39":2,"40":2,"41":2,"42":2,"43":1,"44":1},"f":{"0":2,"1":0,"2":0,"3":2,"4":0,"5":0,"6":2,"7":3,"8":63,"9":4,"10":2,"11":2,"12":2},"b":{"0":[1,1,1],"1":[0,0],"2":[2,2],"3":[2,0],"4":[2,2],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[60,2],"9":[4,0],"10":[0,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/rules.ts","sources":["/home/circleci/repo/src/context/directory/handlers/rules.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAE3C,6DAAkC;AAClC,0CAAyF;AAQzF,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,eAAe,CAAC,CAAC;IAC3E,IAAI,CAAC,IAAA,uBAAe,EAAC,WAAW,CAAC;QAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAElE,MAAM,KAAK,GAAa,IAAA,gBAAQ,EAAC,WAAW,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAEzD,MAAM,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;QAC5B,MAAM,IAAI,qBACL,IAAA,gBAAQ,EAAC,CAAC,EAAE;YACb,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAC,CACH,CAAC;QACF,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,iBAAS,CAAC,eAAe,CAAC,CAAC;SACxE;QACD,OAAO,IAAI,CAAC;IACd,CAAC,CAAC,CAAC;IAEH,OAAO;QACL,KAAK;KACN,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEjC,IAAI,CAAC,KAAK;YAAE,OAAO,CAAC,wBAAwB;QAE5C,sBAAsB;QACtB,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,eAAe,CAAC,CAAC;QAC3E,kBAAE,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QAC9B,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;YACrB,sBAAsB;YACtB,MAAM,IAAI,GAAG,IAAA,gBAAQ,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACjC,MAAM,MAAM,GAAG,cAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,IAAI,KAAK,CAAC,CAAC;YACpD,gBAAG,CAAC,IAAI,CAAC,WAAW,MAAM,EAAE,CAAC,CAAC;YAC9B,kBAAE,CAAC,aAAa,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YAEtC,yBAAyB;YACzB,MAAM,QAAQ,GAAG,cAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,IAAI,OAAO,CAAC,CAAC;YACxD,IAAA,gBAAQ,EAAC,QAAQ,kCAAO,IAAI,KAAE,MAAM,EAAE,KAAK,IAAI,KAAK,IAAG,CAAC;QAC1D,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,YAAY,GAAkC;IAClD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,YAAY,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport log from '../../../logger';\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON, sanitize } from '../../../utils';\n\nimport { DirectoryHandler } from './index';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedRules = ParsedAsset<'rules', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedRules {\n  const rulesFolder = path.join(context.filePath, constants.RULES_DIRECTORY);\n  if (!existsMustBeDir(rulesFolder)) return { rules: null }; // Skip\n\n  const files: string[] = getFiles(rulesFolder, ['.json']);\n\n  const rules = files.map((f) => {\n    const rule = {\n      ...loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }),\n    };\n    if (rule.script) {\n      rule.script = context.loadFile(rule.script, constants.RULES_DIRECTORY);\n    }\n    return rule;\n  });\n\n  return {\n    rules,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { rules } = context.assets;\n\n  if (!rules) return; // Skip, nothing to dump\n\n  // Create Rules folder\n  const rulesFolder = path.join(context.filePath, constants.RULES_DIRECTORY);\n  fs.ensureDirSync(rulesFolder);\n  rules.forEach((rule) => {\n    // Dump script to file\n    const name = sanitize(rule.name);\n    const ruleJS = path.join(rulesFolder, `${name}.js`);\n    log.info(`Writing ${ruleJS}`);\n    fs.writeFileSync(ruleJS, rule.script);\n\n    // Dump template metadata\n    const ruleFile = path.join(rulesFolder, `${name}.json`);\n    dumpJSON(ruleFile, { ...rule, script: `./${name}.js` });\n  });\n}\n\nconst rulesHandler: DirectoryHandler<ParsedRules> = {\n  parse,\n  dump,\n};\n\nexport default rulesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2e6a9abb27c7a4599dfb540f86c7b25635e48c71","contentHash":"044f330bf8ac8157d107f702274986860ea0fe075dfcd3aa3cb71e2c8f752fde"},"/home/circleci/repo/src/context/directory/handlers/hooks.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/hooks.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":19,"column":17},"end":{"line":19,"column":60}},"20":{"start":{"line":21,"column":24},"end":{"line":21,"column":96}},"21":{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":31}},"23":{"start":{"line":24,"column":18},"end":{"line":24,"column":63}},"24":{"start":{"line":25,"column":18},"end":{"line":35,"column":6}},"25":{"start":{"line":26,"column":21},"end":{"line":29,"column":11}},"26":{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},"27":{"start":{"line":31,"column":12},"end":{"line":31,"column":91}},"28":{"start":{"line":33,"column":8},"end":{"line":33,"column":64}},"29":{"start":{"line":34,"column":8},"end":{"line":34,"column":20}},"30":{"start":{"line":36,"column":4},"end":{"line":38,"column":6}},"31":{"start":{"line":41,"column":4},"end":{"line":60,"column":7}},"32":{"start":{"line":42,"column":22},"end":{"line":42,"column":42}},"33":{"start":{"line":43,"column":8},"end":{"line":44,"column":19}},"34":{"start":{"line":44,"column":12},"end":{"line":44,"column":19}},"35":{"start":{"line":46,"column":28},"end":{"line":46,"column":100}},"36":{"start":{"line":47,"column":8},"end":{"line":47,"column":54}},"37":{"start":{"line":48,"column":8},"end":{"line":59,"column":11}},"38":{"start":{"line":51,"column":12},"end":{"line":51,"column":45}},"39":{"start":{"line":52,"column":25},"end":{"line":52,"column":57}},"40":{"start":{"line":53,"column":29},"end":{"line":53,"column":75}},"41":{"start":{"line":54,"column":12},"end":{"line":54,"column":57}},"42":{"start":{"line":55,"column":12},"end":{"line":55,"column":68}},"43":{"start":{"line":57,"column":29},"end":{"line":57,"column":77}},"44":{"start":{"line":58,"column":12},"end":{"line":58,"column":112}},"45":{"start":{"line":62,"column":21},"end":{"line":65,"column":1}},"46":{"start":{"line":66,"column":0},"end":{"line":66,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":39,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":28},"end":{"line":25,"column":29}},"loc":{"start":{"line":25,"column":35},"end":{"line":35,"column":5}},"line":25},"10":{"name":"dump","decl":{"start":{"line":40,"column":9},"end":{"line":40,"column":13}},"loc":{"start":{"line":40,"column":23},"end":{"line":61,"column":1}},"line":40},"11":{"name":"(anonymous_11)","decl":{"start":{"line":41,"column":43},"end":{"line":41,"column":44}},"loc":{"start":{"line":41,"column":56},"end":{"line":60,"column":5}},"line":41},"12":{"name":"(anonymous_12)","decl":{"start":{"line":48,"column":22},"end":{"line":48,"column":23}},"loc":{"start":{"line":48,"column":32},"end":{"line":59,"column":9}},"line":48}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},{"start":{"line":22,"column":4},"end":{"line":23,"column":31}}],"line":22},"9":{"loc":{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},"type":"if","locations":[{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},{"start":{"line":30,"column":8},"end":{"line":32,"column":9}}],"line":30},"10":{"loc":{"start":{"line":43,"column":8},"end":{"line":44,"column":19}},"type":"if","locations":[{"start":{"line":43,"column":8},"end":{"line":44,"column":19}},{"start":{"line":43,"column":8},"end":{"line":44,"column":19}}],"line":43},"11":{"loc":{"start":{"line":51,"column":24},"end":{"line":51,"column":44}},"type":"binary-expr","locations":[{"start":{"line":51,"column":24},"end":{"line":51,"column":33}},{"start":{"line":51,"column":37},"end":{"line":51,"column":44}}],"line":51}},"s":{"0":1,"1":0,"2":0,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":2,"11":2,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":62,"21":62,"22":59,"23":2,"24":2,"25":4,"26":4,"27":4,"28":4,"29":4,"30":2,"31":2,"32":2,"33":2,"34":0,"35":2,"36":2,"37":2,"38":3,"39":3,"40":3,"41":3,"42":3,"43":3,"44":3,"45":1,"46":1},"f":{"0":2,"1":0,"2":0,"3":2,"4":0,"5":0,"6":2,"7":3,"8":62,"9":4,"10":2,"11":2,"12":3},"b":{"0":[1,1,1],"1":[0,0],"2":[2,2],"3":[2,0],"4":[2,2],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[59,2],"9":[4,0],"10":[0,2],"11":[3,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/hooks.ts","sources":["/home/circleci/repo/src/context/directory/handlers/hooks.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAE3C,0CAAyF;AACzF,6DAAkC;AAOlC,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,eAAe,CAAC,CAAC;IAC3E,IAAI,CAAC,IAAA,uBAAe,EAAC,WAAW,CAAC;QAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAElE,MAAM,KAAK,GAAG,IAAA,gBAAQ,EAAC,WAAW,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAE/C,MAAM,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;QAC5B,MAAM,IAAI,qBACL,IAAA,gBAAQ,EAAC,CAAC,EAAE;YACb,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAC,CACH,CAAC;QACF,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,iBAAS,CAAC,eAAe,CAAC,CAAC;SACxE;QAED,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;QAExD,OAAO,IAAI,CAAC;IACd,CAAC,CAAC,CAAC;IAEH,OAAO;QACL,KAAK;KACN,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,KAAK,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;QAEnC,IAAI,CAAC,KAAK;YAAE,OAAO;QAEnB,sBAAsB;QACtB,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,eAAe,CAAC,CAAC;QAC3E,kBAAE,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QAC9B,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;YACrB,sBAAsB;YACtB,wDAAwD;YACxD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,EAAE,CAAC;YACjC,MAAM,IAAI,GAAG,IAAA,gBAAQ,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACjC,MAAM,QAAQ,GAAG,cAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,IAAI,KAAK,CAAC,CAAC;YACtD,gBAAG,CAAC,IAAI,CAAC,WAAW,QAAQ,EAAE,CAAC,CAAC;YAChC,kBAAE,CAAC,aAAa,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YAExC,yBAAyB;YACzB,MAAM,QAAQ,GAAG,cAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,IAAI,OAAO,CAAC,CAAC;YACxD,IAAA,gBAAQ,EAAC,QAAQ,kCAAO,IAAI,KAAE,MAAM,EAAE,KAAK,IAAI,KAAK,IAAG,CAAC;QAC1D,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,YAAY,GAAkC;IAClD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,YAAY,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON, sanitize } from '../../../utils';\nimport log from '../../../logger';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedHooks = ParsedAsset<'hooks', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedHooks {\n  const hooksFolder = path.join(context.filePath, constants.HOOKS_DIRECTORY);\n  if (!existsMustBeDir(hooksFolder)) return { hooks: null }; // Skip\n\n  const files = getFiles(hooksFolder, ['.json']);\n\n  const hooks = files.map((f) => {\n    const hook = {\n      ...loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }),\n    };\n    if (hook.script) {\n      hook.script = context.loadFile(hook.script, constants.HOOKS_DIRECTORY);\n    }\n\n    hook.name = hook.name.toLowerCase().replace(/\\s/g, '-');\n\n    return hook;\n  });\n\n  return {\n    hooks,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const hooks = context.assets.hooks;\n\n  if (!hooks) return;\n\n  // Create Hooks folder\n  const hooksFolder = path.join(context.filePath, constants.HOOKS_DIRECTORY);\n  fs.ensureDirSync(hooksFolder);\n  hooks.forEach((hook) => {\n    // Dump script to file\n    // For cases when hook does not have `meta['hook-name']`\n    hook.name = hook.name || hook.id;\n    const name = sanitize(hook.name);\n    const hookCode = path.join(hooksFolder, `${name}.js`);\n    log.info(`Writing ${hookCode}`);\n    fs.writeFileSync(hookCode, hook.script);\n\n    // Dump template metadata\n    const hookFile = path.join(hooksFolder, `${name}.json`);\n    dumpJSON(hookFile, { ...hook, script: `./${name}.js` });\n  });\n}\n\nconst hooksHandler: DirectoryHandler<ParsedHooks> = {\n  parse,\n  dump,\n};\n\nexport default hooksHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"02f0c12afce4f3c052d22cf303f26d4992332965","contentHash":"2c568b0dd73990b7960502fbe62cd3f744493d8d7901235b6d6b324fb477551e"},"/home/circleci/repo/src/context/directory/handlers/clients.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/clients.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"20":{"start":{"line":21,"column":26},"end":{"line":21,"column":100}},"21":{"start":{"line":22,"column":4},"end":{"line":23,"column":33}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":33}},"23":{"start":{"line":24,"column":23},"end":{"line":24,"column":70}},"24":{"start":{"line":25,"column":20},"end":{"line":42,"column":49}},"25":{"start":{"line":27,"column":23},"end":{"line":30,"column":10}},"26":{"start":{"line":31,"column":8},"end":{"line":39,"column":9}},"27":{"start":{"line":32,"column":33},"end":{"line":32,"column":93}},"28":{"start":{"line":33,"column":12},"end":{"line":38,"column":13}},"29":{"start":{"line":34,"column":16},"end":{"line":37,"column":19}},"30":{"start":{"line":40,"column":8},"end":{"line":40,"column":22}},"31":{"start":{"line":42,"column":23},"end":{"line":42,"column":48}},"32":{"start":{"line":43,"column":4},"end":{"line":45,"column":6}},"33":{"start":{"line":48,"column":4},"end":{"line":66,"column":7}},"34":{"start":{"line":49,"column":28},"end":{"line":49,"column":42}},"35":{"start":{"line":50,"column":8},"end":{"line":51,"column":19}},"36":{"start":{"line":51,"column":12},"end":{"line":51,"column":19}},"37":{"start":{"line":52,"column":30},"end":{"line":52,"column":104}},"38":{"start":{"line":53,"column":8},"end":{"line":53,"column":56}},"39":{"start":{"line":54,"column":8},"end":{"line":65,"column":11}},"40":{"start":{"line":55,"column":31},"end":{"line":55,"column":65}},"41":{"start":{"line":56,"column":31},"end":{"line":56,"column":87}},"42":{"start":{"line":57,"column":12},"end":{"line":63,"column":13}},"43":{"start":{"line":58,"column":29},"end":{"line":58,"column":53}},"44":{"start":{"line":59,"column":40},"end":{"line":59,"column":114}},"45":{"start":{"line":60,"column":16},"end":{"line":60,"column":68}},"46":{"start":{"line":61,"column":16},"end":{"line":61,"column":72}},"47":{"start":{"line":62,"column":16},"end":{"line":62,"column":84}},"48":{"start":{"line":64,"column":12},"end":{"line":64,"column":86}},"49":{"start":{"line":68,"column":23},"end":{"line":71,"column":1}},"50":{"start":{"line":72,"column":0},"end":{"line":72,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":46,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":26,"column":13},"end":{"line":26,"column":14}},"loc":{"start":{"line":26,"column":20},"end":{"line":41,"column":5}},"line":26},"10":{"name":"(anonymous_10)","decl":{"start":{"line":42,"column":16},"end":{"line":42,"column":17}},"loc":{"start":{"line":42,"column":23},"end":{"line":42,"column":48}},"line":42},"11":{"name":"dump","decl":{"start":{"line":47,"column":9},"end":{"line":47,"column":13}},"loc":{"start":{"line":47,"column":23},"end":{"line":67,"column":1}},"line":47},"12":{"name":"(anonymous_12)","decl":{"start":{"line":48,"column":43},"end":{"line":48,"column":44}},"loc":{"start":{"line":48,"column":56},"end":{"line":66,"column":5}},"line":48},"13":{"name":"(anonymous_13)","decl":{"start":{"line":54,"column":24},"end":{"line":54,"column":25}},"loc":{"start":{"line":54,"column":36},"end":{"line":65,"column":9}},"line":54}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":33}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":33}},{"start":{"line":22,"column":4},"end":{"line":23,"column":33}}],"line":22},"9":{"loc":{"start":{"line":31,"column":8},"end":{"line":39,"column":9}},"type":"if","locations":[{"start":{"line":31,"column":8},"end":{"line":39,"column":9}},{"start":{"line":31,"column":8},"end":{"line":39,"column":9}}],"line":31},"10":{"loc":{"start":{"line":33,"column":12},"end":{"line":38,"column":13}},"type":"if","locations":[{"start":{"line":33,"column":12},"end":{"line":38,"column":13}},{"start":{"line":33,"column":12},"end":{"line":38,"column":13}}],"line":33},"11":{"loc":{"start":{"line":50,"column":8},"end":{"line":51,"column":19}},"type":"if","locations":[{"start":{"line":50,"column":8},"end":{"line":51,"column":19}},{"start":{"line":50,"column":8},"end":{"line":51,"column":19}}],"line":50},"12":{"loc":{"start":{"line":57,"column":12},"end":{"line":63,"column":13}},"type":"if","locations":[{"start":{"line":57,"column":12},"end":{"line":63,"column":13}},{"start":{"line":57,"column":12},"end":{"line":63,"column":13}}],"line":57}},"s":{"0":1,"1":0,"2":0,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":2,"11":2,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":59,"21":59,"22":56,"23":2,"24":2,"25":4,"26":4,"27":1,"28":1,"29":1,"30":4,"31":4,"32":2,"33":2,"34":2,"35":2,"36":0,"37":2,"38":2,"39":2,"40":5,"41":5,"42":5,"43":1,"44":1,"45":1,"46":1,"47":1,"48":5,"49":1,"50":1},"f":{"0":2,"1":0,"2":0,"3":2,"4":0,"5":0,"6":2,"7":3,"8":59,"9":4,"10":4,"11":2,"12":2,"13":5},"b":{"0":[1,1,1],"1":[0,0],"2":[2,2],"3":[2,0],"4":[2,2],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[56,2],"9":[1,3],"10":[1,0],"11":[0,2],"12":[1,4]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/clients.ts","sources":["/home/circleci/repo/src/context/directory/handlers/clients.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAAuE;AAEvE,6DAAkC;AAClC,0CAQwB;AAQxB,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,aAAa,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,iBAAiB,CAAC,CAAC;IAC/E,IAAI,CAAC,IAAA,uBAAe,EAAC,aAAa,CAAC;QAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAEtE,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,aAAa,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAEtD,MAAM,OAAO,GAAG,UAAU;SACvB,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;QACT,MAAM,MAAM,GAAG,IAAA,gBAAQ,EAAC,CAAC,EAAE;YACzB,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAC,CAAC;QAEH,IAAI,MAAM,CAAC,iBAAiB,EAAE;YAC5B,MAAM,YAAY,GAAG,cAAI,CAAC,IAAI,CAAC,aAAa,EAAE,MAAM,CAAC,iBAAiB,CAAC,CAAC;YAExE,IAAI,IAAA,cAAM,EAAC,YAAY,CAAC,EAAE;gBACxB,MAAM,CAAC,iBAAiB,GAAG,IAAA,kCAA0B,EAAC,YAAY,EAAE;oBAClE,QAAQ,EAAE,OAAO,CAAC,QAAQ;oBAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;iBAC7D,CAAC,CAAC;aACJ;SACF;QAED,OAAO,MAAM,CAAC;IAChB,CAAC,CAAC;SACD,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,2BAA2B;IAExE,OAAO;QACL,OAAO;KACR,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,OAAO,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEnC,IAAI,CAAC,OAAO;YAAE,OAAO,CAAC,wBAAwB;QAE9C,MAAM,aAAa,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,iBAAiB,CAAC,CAAC;QAC/E,kBAAE,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;QAEhC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,EAAE;YACzB,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YACzC,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,UAAU,OAAO,CAAC,CAAC;YAElE,IAAI,MAAM,CAAC,iBAAiB,EAAE;gBAC5B,MAAM,IAAI,GAAG,MAAM,CAAC,iBAAiB,CAAC;gBACtC,MAAM,eAAe,GAAG,cAAI,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,UAAU,yBAAyB,CAAC,CAAC;gBAEzF,gBAAG,CAAC,IAAI,CAAC,WAAW,eAAe,EAAE,CAAC,CAAC;gBACvC,kBAAE,CAAC,aAAa,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;gBAExC,MAAM,CAAC,iBAAiB,GAAG,KAAK,UAAU,yBAAyB,CAAC;aACrE;YACD,IAAA,gBAAQ,EAAC,UAAU,EAAE,IAAA,yBAAiB,EAAC,MAAM,CAAC,CAAC,CAAC;QAClD,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,cAAc,GAAoC;IACtD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,cAAc,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants, loadFileAndReplaceKeywords } from '../../../tools';\n\nimport log from '../../../logger';\nimport {\n  isFile,\n  getFiles,\n  existsMustBeDir,\n  dumpJSON,\n  loadJSON,\n  sanitize,\n  clearClientArrays,\n} from '../../../utils';\nimport { ParsedAsset } from '../../../types';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Client } from '../../../tools/auth0/handlers/clients';\n\ntype ParsedClients = ParsedAsset<'clients', Client[]>;\n\nfunction parse(context: DirectoryContext): ParsedClients {\n  const clientsFolder = path.join(context.filePath, constants.CLIENTS_DIRECTORY);\n  if (!existsMustBeDir(clientsFolder)) return { clients: null }; // Skip\n\n  const foundFiles = getFiles(clientsFolder, ['.json']);\n\n  const clients = foundFiles\n    .map((f) => {\n      const client = loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      });\n\n      if (client.custom_login_page) {\n        const htmlFileName = path.join(clientsFolder, client.custom_login_page);\n\n        if (isFile(htmlFileName)) {\n          client.custom_login_page = loadFileAndReplaceKeywords(htmlFileName, {\n            mappings: context.mappings,\n            disableKeywordReplacement: context.disableKeywordReplacement,\n          });\n        }\n      }\n\n      return client;\n    })\n    .filter((p) => Object.keys(p).length > 0); // Filter out empty clients\n\n  return {\n    clients,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { clients } = context.assets;\n\n  if (!clients) return; // Skip, nothing to dump\n\n  const clientsFolder = path.join(context.filePath, constants.CLIENTS_DIRECTORY);\n  fs.ensureDirSync(clientsFolder);\n\n  clients.forEach((client) => {\n    const clientName = sanitize(client.name);\n    const clientFile = path.join(clientsFolder, `${clientName}.json`);\n\n    if (client.custom_login_page) {\n      const html = client.custom_login_page;\n      const customLoginHtml = path.join(clientsFolder, `${clientName}_custom_login_page.html`);\n\n      log.info(`Writing ${customLoginHtml}`);\n      fs.writeFileSync(customLoginHtml, html);\n\n      client.custom_login_page = `./${clientName}_custom_login_page.html`;\n    }\n    dumpJSON(clientFile, clearClientArrays(client));\n  });\n}\n\nconst clientsHandler: DirectoryHandler<ParsedClients> = {\n  parse,\n  dump,\n};\n\nexport default clientsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"04133330348b9c2750830f56d967924e41262873","contentHash":"767bafbdd927c1c34504f35de44cd21b9b9ff2d5ba5fd0cb8edd23373c0671bf"},"/home/circleci/repo/src/context/directory/handlers/tenant.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/tenant.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":14}},"14":{"start":{"line":13,"column":4},"end":{"line":14,"column":20}},"15":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"16":{"start":{"line":14,"column":8},"end":{"line":14,"column":20}},"17":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"18":{"start":{"line":16,"column":8},"end":{"line":19,"column":9}},"19":{"start":{"line":16,"column":21},"end":{"line":16,"column":22}},"20":{"start":{"line":16,"column":28},"end":{"line":16,"column":59}},"21":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"22":{"start":{"line":18,"column":16},"end":{"line":18,"column":34}},"23":{"start":{"line":20,"column":4},"end":{"line":20,"column":13}},"24":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"25":{"start":{"line":23,"column":4},"end":{"line":23,"column":62}},"26":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"27":{"start":{"line":26,"column":15},"end":{"line":26,"column":47}},"28":{"start":{"line":27,"column":16},"end":{"line":27,"column":41}},"29":{"start":{"line":28,"column":36},"end":{"line":28,"column":81}},"30":{"start":{"line":30,"column":23},"end":{"line":30,"column":60}},"31":{"start":{"line":31,"column":4},"end":{"line":32,"column":32}},"32":{"start":{"line":32,"column":8},"end":{"line":32,"column":32}},"33":{"start":{"line":33,"column":23},"end":{"line":33,"column":69}},"34":{"start":{"line":34,"column":4},"end":{"line":36,"column":5}},"35":{"start":{"line":35,"column":8},"end":{"line":35,"column":32}},"36":{"start":{"line":38,"column":15},"end":{"line":41,"column":6}},"37":{"start":{"line":41,"column":54},"end":{"line":41,"column":56}},"38":{"start":{"line":41,"column":67},"end":{"line":41,"column":124}},"39":{"start":{"line":42,"column":4},"end":{"line":42,"column":42}},"40":{"start":{"line":43,"column":29},"end":{"line":43,"column":132}},"41":{"start":{"line":44,"column":4},"end":{"line":47,"column":6}},"42":{"start":{"line":50,"column":4},"end":{"line":58,"column":7}},"43":{"start":{"line":51,"column":27},"end":{"line":51,"column":41}},"44":{"start":{"line":52,"column":8},"end":{"line":53,"column":19}},"45":{"start":{"line":53,"column":12},"end":{"line":53,"column":19}},"46":{"start":{"line":54,"column":8},"end":{"line":54,"column":46}},"47":{"start":{"line":55,"column":27},"end":{"line":55,"column":79}},"48":{"start":{"line":56,"column":8},"end":{"line":56,"column":50}},"49":{"start":{"line":57,"column":8},"end":{"line":57,"column":15}},"50":{"start":{"line":60,"column":22},"end":{"line":63,"column":1}},"51":{"start":{"line":64,"column":0},"end":{"line":64,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":38},"end":{"line":11,"column":39}},"loc":{"start":{"line":11,"column":54},"end":{"line":21,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":22,"column":56},"end":{"line":22,"column":57}},"loc":{"start":{"line":22,"column":71},"end":{"line":24,"column":1}},"line":22},"9":{"name":"parse","decl":{"start":{"line":29,"column":9},"end":{"line":29,"column":14}},"loc":{"start":{"line":29,"column":24},"end":{"line":48,"column":1}},"line":29},"10":{"name":"dump","decl":{"start":{"line":49,"column":9},"end":{"line":49,"column":13}},"loc":{"start":{"line":49,"column":23},"end":{"line":59,"column":1}},"line":49},"11":{"name":"(anonymous_11)","decl":{"start":{"line":50,"column":43},"end":{"line":50,"column":44}},"loc":{"start":{"line":50,"column":56},"end":{"line":58,"column":5}},"line":50}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":14},"end":{"line":11,"column":18}},{"start":{"line":11,"column":22},"end":{"line":11,"column":33}},{"start":{"line":11,"column":38},"end":{"line":21,"column":1}}],"line":11},"6":{"loc":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"type":"if","locations":[{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},{"start":{"line":13,"column":21},"end":{"line":14,"column":20}}],"line":13},"7":{"loc":{"start":{"line":13,"column":25},"end":{"line":13,"column":87}},"type":"binary-expr","locations":[{"start":{"line":13,"column":25},"end":{"line":13,"column":67}},{"start":{"line":13,"column":71},"end":{"line":13,"column":87}}],"line":13},"8":{"loc":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"type":"if","locations":[{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},{"start":{"line":15,"column":4},"end":{"line":19,"column":9}}],"line":15},"9":{"loc":{"start":{"line":15,"column":8},"end":{"line":15,"column":71}},"type":"binary-expr","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":17}},{"start":{"line":15,"column":21},"end":{"line":15,"column":71}}],"line":15},"10":{"loc":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},{"start":{"line":17,"column":12},"end":{"line":18,"column":34}}],"line":17},"11":{"loc":{"start":{"line":17,"column":16},"end":{"line":17,"column":90}},"type":"binary-expr","locations":[{"start":{"line":17,"column":16},"end":{"line":17,"column":35}},{"start":{"line":17,"column":39},"end":{"line":17,"column":90}}],"line":17},"12":{"loc":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":22,"column":23},"end":{"line":22,"column":27}},{"start":{"line":22,"column":31},"end":{"line":22,"column":51}},{"start":{"line":22,"column":56},"end":{"line":24,"column":1}}],"line":22},"13":{"loc":{"start":{"line":23,"column":11},"end":{"line":23,"column":61}},"type":"cond-expr","locations":[{"start":{"line":23,"column":37},"end":{"line":23,"column":40}},{"start":{"line":23,"column":43},"end":{"line":23,"column":61}}],"line":23},"14":{"loc":{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},"type":"binary-expr","locations":[{"start":{"line":23,"column":12},"end":{"line":23,"column":15}},{"start":{"line":23,"column":19},"end":{"line":23,"column":33}}],"line":23},"15":{"loc":{"start":{"line":31,"column":4},"end":{"line":32,"column":32}},"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":32,"column":32}},{"start":{"line":31,"column":4},"end":{"line":32,"column":32}}],"line":31},"16":{"loc":{"start":{"line":34,"column":4},"end":{"line":36,"column":5}},"type":"if","locations":[{"start":{"line":34,"column":4},"end":{"line":36,"column":5}},{"start":{"line":34,"column":4},"end":{"line":36,"column":5}}],"line":34},"17":{"loc":{"start":{"line":52,"column":8},"end":{"line":53,"column":19}},"type":"if","locations":[{"start":{"line":52,"column":8},"end":{"line":53,"column":19}},{"start":{"line":52,"column":8},"end":{"line":53,"column":19}}],"line":52}},"s":{"0":1,"1":0,"2":0,"3":3,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":3,"11":3,"12":1,"13":5,"14":5,"15":14,"16":12,"17":5,"18":5,"19":5,"20":5,"21":0,"22":0,"23":5,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":56,"31":56,"32":0,"33":56,"34":56,"35":51,"36":5,"37":5,"38":5,"39":5,"40":5,"41":5,"42":3,"43":3,"44":3,"45":0,"46":3,"47":3,"48":3,"49":3,"50":1,"51":1},"f":{"0":3,"1":0,"2":0,"3":3,"4":0,"5":0,"6":3,"7":5,"8":1,"9":56,"10":3,"11":3},"b":{"0":[1,1,1],"1":[0,0],"2":[3,3],"3":[3,0],"4":[3,3],"5":[1,1,1],"6":[12,2],"7":[14,14],"8":[5,0],"9":[5,5],"10":[0,0],"11":[0,0],"12":[1,1,1],"13":[0,1],"14":[1,1],"15":[0,56],"16":[51,5],"17":[0,3]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/tenant.ts","sources":["/home/circleci/repo/src/context/directory/handlers/tenant.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,0CAA+F;AAC/F,kFAA+E;AAe/E,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAC/C,IAAI,CAAC,IAAA,uBAAe,EAAC,UAAU,CAAC;QAAE,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAElE,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,UAAU,EAAE,aAAa,CAAC,CAAC;IAExD,IAAI,CAAC,IAAA,cAAM,EAAC,UAAU,CAAC,EAAE;QACvB,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;KACzB;IACD,8BAA8B;IAC9B,MAAM,KAQF,IAAA,gBAAQ,EAAC,UAAU,EAAE;QACvB,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,EAXI,EACJ,gBAAgB,EAChB,qBAAqB,OASrB,EARG,MAAM,cAHL,6CAIL,CAOC,CAAC;IAEH,IAAA,wBAAgB,EAAC,MAAM,CAAC,CAAC;IAEzB,MAAM,gBAAgB,GAAG,IAAA,qDAAyB,EAAC,EAAE,gBAAgB,EAAE,qBAAqB,EAAE,CAAC,CAAC;IAEhG,OAAO;QACL,YAAY;QACZ,MAAM,kCACD,MAAM,GACN,gBAAgB,CACpB;KACF,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAElC,IAAI,CAAC,MAAM;YAAE,OAAO,CAAC,wBAAwB;QAE7C,IAAA,wBAAgB,EAAC,MAAM,CAAC,CAAC;QAEzB,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;QAC9D,IAAA,gBAAQ,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;QAC7B,OAAO;IACT,CAAC;CAAA;AAED,MAAM,aAAa,GAAmC;IACpD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,aAAa,CAAC","sourcesContent":["import path from 'path';\nimport { existsMustBeDir, isFile, dumpJSON, loadJSON, clearTenantFlags } from '../../../utils';\nimport { sessionDurationsToMinutes } from '../../../sessionDurationsToMinutes';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedTenant = ParsedAsset<\n  'tenant',\n  {\n    session_lifetime: number;\n    idle_session_lifetime: number;\n  } & {\n    [key: string]: Asset;\n  }\n>;\n\nfunction parse(context: DirectoryContext): ParsedTenant {\n  const baseFolder = path.join(context.filePath);\n  if (!existsMustBeDir(baseFolder)) return { tenant: null }; // Skip\n\n  const tenantFile = path.join(baseFolder, 'tenant.json');\n\n  if (!isFile(tenantFile)) {\n    return { tenant: null };\n  }\n  /* eslint-disable camelcase */\n  const {\n    session_lifetime,\n    idle_session_lifetime,\n    ...tenant\n  }: {\n    session_lifetime?: number;\n    idle_session_lifetime?: number;\n    [key: string]: any;\n  } = loadJSON(tenantFile, {\n    mappings: context.mappings,\n    disableKeywordReplacement: context.disableKeywordReplacement,\n  });\n\n  clearTenantFlags(tenant);\n\n  const sessionDurations = sessionDurationsToMinutes({ session_lifetime, idle_session_lifetime });\n\n  return {\n    //@ts-ignore\n    tenant: {\n      ...tenant,\n      ...sessionDurations,\n    },\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { tenant } = context.assets;\n\n  if (!tenant) return; // Skip, nothing to dump\n\n  clearTenantFlags(tenant);\n\n  const tenantFile = path.join(context.filePath, 'tenant.json');\n  dumpJSON(tenantFile, tenant);\n  return;\n}\n\nconst tenantHandler: DirectoryHandler<ParsedTenant> = {\n  parse,\n  dump,\n};\n\nexport default tenantHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"307b31e644630974b570e7c009933991de5423e5","contentHash":"7adf80b650b087ef0761564303446403183d34cc8e638c94d0aae6634e3efb6f"},"/home/circleci/repo/src/context/directory/handlers/emailProvider.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/emailProvider.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":19,"column":19},"end":{"line":19,"column":44}},"20":{"start":{"line":21,"column":25},"end":{"line":21,"column":107}},"21":{"start":{"line":22,"column":4},"end":{"line":23,"column":39}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":39}},"23":{"start":{"line":24,"column":25},"end":{"line":24,"column":75}},"24":{"start":{"line":25,"column":4},"end":{"line":32,"column":5}},"25":{"start":{"line":26,"column":8},"end":{"line":31,"column":10}},"26":{"start":{"line":33,"column":4},"end":{"line":33,"column":35}},"27":{"start":{"line":36,"column":4},"end":{"line":52,"column":7}},"28":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"29":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"30":{"start":{"line":39,"column":30},"end":{"line":47,"column":12}},"31":{"start":{"line":41,"column":37},"end":{"line":41,"column":123}},"32":{"start":{"line":42,"column":12},"end":{"line":45,"column":13}},"33":{"start":{"line":44,"column":16},"end":{"line":44,"column":91}},"34":{"start":{"line":46,"column":12},"end":{"line":46,"column":48}},"35":{"start":{"line":48,"column":29},"end":{"line":48,"column":111}},"36":{"start":{"line":49,"column":8},"end":{"line":49,"column":55}},"37":{"start":{"line":50,"column":34},"end":{"line":50,"column":84}},"38":{"start":{"line":51,"column":8},"end":{"line":51,"column":64}},"39":{"start":{"line":54,"column":29},"end":{"line":57,"column":1}},"40":{"start":{"line":58,"column":0},"end":{"line":58,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":34,"column":1}},"line":20},"9":{"name":"dump","decl":{"start":{"line":35,"column":9},"end":{"line":35,"column":13}},"loc":{"start":{"line":35,"column":23},"end":{"line":53,"column":1}},"line":35},"10":{"name":"(anonymous_10)","decl":{"start":{"line":36,"column":43},"end":{"line":36,"column":44}},"loc":{"start":{"line":36,"column":56},"end":{"line":52,"column":5}},"line":36},"11":{"name":"(anonymous_11)","decl":{"start":{"line":39,"column":31},"end":{"line":39,"column":32}},"loc":{"start":{"line":39,"column":37},"end":{"line":47,"column":9}},"line":39}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":39}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":39}},{"start":{"line":22,"column":4},"end":{"line":23,"column":39}}],"line":22},"9":{"loc":{"start":{"line":25,"column":4},"end":{"line":32,"column":5}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":32,"column":5}},{"start":{"line":25,"column":4},"end":{"line":32,"column":5}}],"line":25},"10":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37},"11":{"loc":{"start":{"line":41,"column":37},"end":{"line":41,"column":123}},"type":"binary-expr","locations":[{"start":{"line":41,"column":38},"end":{"line":41,"column":116}},{"start":{"line":41,"column":121},"end":{"line":41,"column":123}}],"line":41},"12":{"loc":{"start":{"line":41,"column":38},"end":{"line":41,"column":116}},"type":"cond-expr","locations":[{"start":{"line":41,"column":96},"end":{"line":41,"column":102}},{"start":{"line":41,"column":105},"end":{"line":41,"column":116}}],"line":41},"13":{"loc":{"start":{"line":41,"column":38},"end":{"line":41,"column":93}},"type":"binary-expr","locations":[{"start":{"line":41,"column":38},"end":{"line":41,"column":76}},{"start":{"line":41,"column":80},"end":{"line":41,"column":93}}],"line":41},"14":{"loc":{"start":{"line":42,"column":12},"end":{"line":45,"column":13}},"type":"if","locations":[{"start":{"line":42,"column":12},"end":{"line":45,"column":13}},{"start":{"line":42,"column":12},"end":{"line":45,"column":13}}],"line":42}},"s":{"0":1,"1":0,"2":0,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":2,"11":2,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":55,"21":55,"22":51,"23":3,"24":3,"25":3,"26":0,"27":2,"28":2,"29":0,"30":2,"31":2,"32":2,"33":1,"34":1,"35":2,"36":2,"37":2,"38":2,"39":1,"40":1},"f":{"0":2,"1":0,"2":0,"3":2,"4":0,"5":0,"6":2,"7":2,"8":55,"9":2,"10":2,"11":2},"b":{"0":[1,1,1],"1":[0,0],"2":[2,2],"3":[2,0],"4":[2,2],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[51,3],"9":[3,0],"10":[0,2],"11":[2,0],"12":[0,2],"13":[2,2],"14":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/emailProvider.ts","sources":["/home/circleci/repo/src/context/directory/handlers/emailProvider.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAE3C,0CAA6E;AAC7E,6CAAuD;AAOvD,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,YAAY,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,yBAAyB,CAAC,CAAC;IACtF,IAAI,CAAC,IAAA,uBAAe,EAAC,YAAY,CAAC;QAAE,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAE3E,MAAM,YAAY,GAAG,cAAI,CAAC,IAAI,CAAC,YAAY,EAAE,eAAe,CAAC,CAAC;IAE9D,IAAI,IAAA,cAAM,EAAC,YAAY,CAAC,EAAE;QACxB,OAAO;YACL,aAAa,EAAE,IAAA,gBAAQ,EAAC,YAAY,EAAE;gBACpC,QAAQ,EAAE,OAAO,CAAC,QAAQ;gBAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;aAC7D,CAAC;SACH,CAAC;KACH;IAED,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC;AACjC,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,aAAa;YAAE,OAAO,CAAC,wBAAwB;QAEnE,MAAM,aAAa,GAAwC,CAAC,GAAG,EAAE;;YAC/D,MAAM,gBAAgB,GAAG,CAAA,MAAA,OAAO,CAAC,MAAM,CAAC,OAAO,0CAAE,QAAQ,KAAI,EAAE,CAAC;YAChE,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,eAAe,CAAC,EAAE;gBAC/C,6DAA6D;gBAC7D,OAAO,IAAA,gCAAqB,EAAC,OAAO,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;aAC5D;YACD,OAAO,OAAO,CAAC,MAAM,CAAC,aAAa,CAAC;QACtC,CAAC,CAAC,EAAE,CAAC;QAEL,MAAM,YAAY,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,yBAAyB,CAAC,CAAC;QACtF,kBAAE,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;QAE/B,MAAM,iBAAiB,GAAG,cAAI,CAAC,IAAI,CAAC,YAAY,EAAE,eAAe,CAAC,CAAC;QACnE,IAAA,gBAAQ,EAAC,iBAAiB,EAAE,aAAa,CAAC,CAAC;IAC7C,CAAC;CAAA;AAED,MAAM,oBAAoB,GAA0C;IAClE,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,oBAAoB,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport { existsMustBeDir, isFile, dumpJSON, loadJSON } from '../../../utils';\nimport { emailProviderDefaults } from '../../defaults';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedEmailProvider = ParsedAsset<'emailProvider', Asset>;\n\nfunction parse(context: DirectoryContext): ParsedEmailProvider {\n  const emailsFolder = path.join(context.filePath, constants.EMAIL_TEMPLATES_DIRECTORY);\n  if (!existsMustBeDir(emailsFolder)) return { emailProvider: null }; // Skip\n\n  const providerFile = path.join(emailsFolder, 'provider.json');\n\n  if (isFile(providerFile)) {\n    return {\n      emailProvider: loadJSON(providerFile, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }),\n    };\n  }\n\n  return { emailProvider: null };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  if (!context.assets.emailProvider) return; // Skip, nothing to dump\n\n  const emailProvider: typeof context.assets.emailProvider = (() => {\n    const excludedDefaults = context.assets.exclude?.defaults || [];\n    if (!excludedDefaults.includes('emailProvider')) {\n      // Add placeholder for credentials as they cannot be exported\n      return emailProviderDefaults(context.assets.emailProvider);\n    }\n    return context.assets.emailProvider;\n  })();\n\n  const emailsFolder = path.join(context.filePath, constants.EMAIL_TEMPLATES_DIRECTORY);\n  fs.ensureDirSync(emailsFolder);\n\n  const emailProviderFile = path.join(emailsFolder, 'provider.json');\n  dumpJSON(emailProviderFile, emailProvider);\n}\n\nconst emailProviderHandler: DirectoryHandler<ParsedEmailProvider> = {\n  parse,\n  dump,\n};\n\nexport default emailProviderHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8a375c1a1c990d08435d05ab71c5ead869b900e2","contentHash":"216842e98eaa16e7427421b67c593f1b879283d00cd82b2ff166cc9201add725"},"/home/circleci/repo/src/context/directory/handlers/connections.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/connections.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"20":{"start":{"line":21,"column":32},"end":{"line":21,"column":117}},"21":{"start":{"line":22,"column":30},"end":{"line":22,"column":88}},"22":{"start":{"line":23,"column":4},"end":{"line":24,"column":37}},"23":{"start":{"line":24,"column":8},"end":{"line":24,"column":37}},"24":{"start":{"line":25,"column":23},"end":{"line":25,"column":74}},"25":{"start":{"line":26,"column":24},"end":{"line":45,"column":49}},"26":{"start":{"line":28,"column":27},"end":{"line":31,"column":10}},"27":{"start":{"line":32,"column":8},"end":{"line":42,"column":9}},"28":{"start":{"line":33,"column":12},"end":{"line":33,"column":70}},"29":{"start":{"line":34,"column":33},"end":{"line":34,"column":102}},"30":{"start":{"line":35,"column":12},"end":{"line":37,"column":13}},"31":{"start":{"line":36,"column":16},"end":{"line":36,"column":195}},"32":{"start":{"line":38,"column":12},"end":{"line":41,"column":15}},"33":{"start":{"line":43,"column":8},"end":{"line":43,"column":26}},"34":{"start":{"line":45,"column":23},"end":{"line":45,"column":48}},"35":{"start":{"line":46,"column":4},"end":{"line":48,"column":6}},"36":{"start":{"line":51,"column":4},"end":{"line":74,"column":7}},"37":{"start":{"line":52,"column":45},"end":{"line":52,"column":59}},"38":{"start":{"line":53,"column":8},"end":{"line":54,"column":19}},"39":{"start":{"line":54,"column":12},"end":{"line":54,"column":19}},"40":{"start":{"line":55,"column":34},"end":{"line":55,"column":112}},"41":{"start":{"line":56,"column":8},"end":{"line":56,"column":60}},"42":{"start":{"line":58,"column":8},"end":{"line":73,"column":11}},"43":{"start":{"line":59,"column":37},"end":{"line":61,"column":15}},"44":{"start":{"line":62,"column":35},"end":{"line":62,"column":79}},"45":{"start":{"line":63,"column":12},"end":{"line":70,"column":13}},"46":{"start":{"line":64,"column":16},"end":{"line":64,"column":80}},"47":{"start":{"line":65,"column":29},"end":{"line":65,"column":64}},"48":{"start":{"line":66,"column":44},"end":{"line":66,"column":108}},"49":{"start":{"line":67,"column":16},"end":{"line":67,"column":72}},"50":{"start":{"line":68,"column":16},"end":{"line":68,"column":76}},"51":{"start":{"line":69,"column":16},"end":{"line":69,"column":81}},"52":{"start":{"line":71,"column":35},"end":{"line":71,"column":99}},"53":{"start":{"line":72,"column":12},"end":{"line":72,"column":68}},"54":{"start":{"line":76,"column":27},"end":{"line":79,"column":1}},"55":{"start":{"line":80,"column":0},"end":{"line":80,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":49,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":27,"column":13},"end":{"line":27,"column":14}},"loc":{"start":{"line":27,"column":20},"end":{"line":44,"column":5}},"line":27},"10":{"name":"(anonymous_10)","decl":{"start":{"line":45,"column":16},"end":{"line":45,"column":17}},"loc":{"start":{"line":45,"column":23},"end":{"line":45,"column":48}},"line":45},"11":{"name":"dump","decl":{"start":{"line":50,"column":9},"end":{"line":50,"column":13}},"loc":{"start":{"line":50,"column":23},"end":{"line":75,"column":1}},"line":50},"12":{"name":"(anonymous_12)","decl":{"start":{"line":51,"column":43},"end":{"line":51,"column":44}},"loc":{"start":{"line":51,"column":56},"end":{"line":74,"column":5}},"line":51},"13":{"name":"(anonymous_13)","decl":{"start":{"line":58,"column":28},"end":{"line":58,"column":29}},"loc":{"start":{"line":58,"column":44},"end":{"line":73,"column":9}},"line":58}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":32},"end":{"line":21,"column":117}},"type":"binary-expr","locations":[{"start":{"line":21,"column":32},"end":{"line":21,"column":74}},{"start":{"line":21,"column":78},"end":{"line":21,"column":117}}],"line":21},"9":{"loc":{"start":{"line":23,"column":4},"end":{"line":24,"column":37}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":24,"column":37}},{"start":{"line":23,"column":4},"end":{"line":24,"column":37}}],"line":23},"10":{"loc":{"start":{"line":32,"column":8},"end":{"line":42,"column":9}},"type":"if","locations":[{"start":{"line":32,"column":8},"end":{"line":42,"column":9}},{"start":{"line":32,"column":8},"end":{"line":42,"column":9}}],"line":32},"11":{"loc":{"start":{"line":35,"column":12},"end":{"line":37,"column":13}},"type":"if","locations":[{"start":{"line":35,"column":12},"end":{"line":37,"column":13}},{"start":{"line":35,"column":12},"end":{"line":37,"column":13}}],"line":35},"12":{"loc":{"start":{"line":53,"column":8},"end":{"line":54,"column":19}},"type":"if","locations":[{"start":{"line":53,"column":8},"end":{"line":54,"column":19}},{"start":{"line":53,"column":8},"end":{"line":54,"column":19}}],"line":53},"13":{"loc":{"start":{"line":59,"column":83},"end":{"line":61,"column":13}},"type":"binary-expr","locations":[{"start":{"line":59,"column":83},"end":{"line":59,"column":109}},{"start":{"line":59,"column":113},"end":{"line":61,"column":13}}],"line":59},"14":{"loc":{"start":{"line":60,"column":97},"end":{"line":60,"column":114}},"type":"binary-expr","locations":[{"start":{"line":60,"column":97},"end":{"line":60,"column":108}},{"start":{"line":60,"column":112},"end":{"line":60,"column":114}}],"line":60},"15":{"loc":{"start":{"line":63,"column":12},"end":{"line":70,"column":13}},"type":"if","locations":[{"start":{"line":63,"column":12},"end":{"line":70,"column":13}},{"start":{"line":63,"column":12},"end":{"line":70,"column":13}}],"line":63}},"s":{"0":1,"1":0,"2":0,"3":3,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":3,"11":3,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":58,"21":58,"22":58,"23":52,"24":4,"25":4,"26":6,"27":6,"28":2,"29":2,"30":2,"31":1,"32":1,"33":5,"34":5,"35":3,"36":3,"37":3,"38":3,"39":0,"40":3,"41":3,"42":3,"43":5,"44":5,"45":5,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":5,"53":5,"54":1,"55":1},"f":{"0":3,"1":0,"2":0,"3":3,"4":0,"5":0,"6":3,"7":3,"8":58,"9":6,"10":5,"11":3,"12":3,"13":5},"b":{"0":[1,1,1],"1":[0,0],"2":[3,3],"3":[3,0],"4":[3,3],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[58,57],"9":[52,4],"10":[2,4],"11":[1,1],"12":[0,3],"13":[5,5],"14":[5,5],"15":[1,4]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/connections.ts","sources":["/home/circleci/repo/src/context/directory/handlers/connections.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants, loadFileAndReplaceKeywords } from '../../../tools';\n\nimport log from '../../../logger';\nimport {\n  isFile,\n  getFiles,\n  existsMustBeDir,\n  dumpJSON,\n  loadJSON,\n  sanitize,\n  ensureProp,\n  mapClientID2NameSorted,\n} from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedConnections = ParsedAsset<'connections', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedConnections {\n  const connectionDirectory =\n    context.config.AUTH0_CONNECTIONS_DIRECTORY || constants.CONNECTIONS_DIRECTORY;\n  const connectionsFolder = path.join(context.filePath, connectionDirectory);\n  if (!existsMustBeDir(connectionsFolder)) return { connections: null }; // Skip\n\n  const foundFiles = getFiles(connectionsFolder, ['.json']);\n\n  const connections = foundFiles\n    .map((f) => {\n      const connection = loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      });\n\n      if (connection.strategy === 'email') {\n        ensureProp(connection, 'options.email.body');\n        const htmlFileName = path.join(connectionsFolder, connection.options.email.body);\n\n        if (!isFile(htmlFileName)) {\n          throw new Error(\n            `Passwordless email template purportedly located at ${htmlFileName} does not exist for connection. Ensure the existence of this file to proceed with deployment.`\n          );\n        }\n        connection.options.email.body = loadFileAndReplaceKeywords(htmlFileName, {\n          mappings: context.mappings,\n          disableKeywordReplacement: context.disableKeywordReplacement,\n        });\n      }\n\n      return connection;\n    })\n    .filter((p) => Object.keys(p).length > 0); // Filter out empty connections\n\n  return {\n    connections,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { connections, clientsOrig } = context.assets;\n\n  if (!connections) return; // Skip, nothing to dump\n\n  const connectionsFolder = path.join(context.filePath, constants.CONNECTIONS_DIRECTORY);\n  fs.ensureDirSync(connectionsFolder);\n\n  // Convert enabled_clients from id to name\n  connections.forEach((connection) => {\n    const dumpedConnection = {\n      ...connection,\n      ...(connection.enabled_clients && {\n        enabled_clients: mapClientID2NameSorted(connection.enabled_clients, clientsOrig || []),\n      }),\n    };\n\n    const connectionName = sanitize(dumpedConnection.name);\n\n    if (dumpedConnection.strategy === 'email') {\n      ensureProp(dumpedConnection, 'options.email.body');\n      const html = dumpedConnection.options.email.body;\n      const emailConnectionHtml = path.join(connectionsFolder, `${connectionName}.html`);\n\n      log.info(`Writing ${emailConnectionHtml}`);\n      fs.writeFileSync(emailConnectionHtml, html);\n\n      dumpedConnection.options.email.body = `./${connectionName}.html`;\n    }\n\n    const connectionFile = path.join(connectionsFolder, `${connectionName}.json`);\n    dumpJSON(connectionFile, dumpedConnection);\n  });\n}\n\nconst connectionsHandler: DirectoryHandler<ParsedConnections> = {\n  parse,\n  dump,\n};\n\nexport default connectionsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4d31b35cb4291a8fbae026e7bbb97d9f000cbdc2","contentHash":"eddab0805148474cafb08dd55d07dcb4b2cebe79027964bc3bca67e9ce54a31e"},"/home/circleci/repo/src/context/directory/handlers/databases.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/databases.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"20":{"start":{"line":21,"column":21},"end":{"line":21,"column":65}},"21":{"start":{"line":22,"column":21},"end":{"line":30,"column":8}},"22":{"start":{"line":23,"column":8},"end":{"line":29,"column":9}},"23":{"start":{"line":24,"column":12},"end":{"line":24,"column":64}},"24":{"start":{"line":27,"column":12},"end":{"line":27,"column":107}},"25":{"start":{"line":28,"column":12},"end":{"line":28,"column":22}},"26":{"start":{"line":31,"column":4},"end":{"line":34,"column":5}},"27":{"start":{"line":32,"column":8},"end":{"line":32,"column":92}},"28":{"start":{"line":33,"column":8},"end":{"line":33,"column":18}},"29":{"start":{"line":35,"column":21},"end":{"line":35,"column":199}},"30":{"start":{"line":37,"column":4},"end":{"line":47,"column":5}},"31":{"start":{"line":38,"column":8},"end":{"line":46,"column":11}},"32":{"start":{"line":39,"column":12},"end":{"line":45,"column":13}},"33":{"start":{"line":41,"column":16},"end":{"line":41,"column":90}},"34":{"start":{"line":44,"column":16},"end":{"line":44,"column":145}},"35":{"start":{"line":48,"column":4},"end":{"line":48,"column":20}},"36":{"start":{"line":51,"column":27},"end":{"line":51,"column":114}},"37":{"start":{"line":52,"column":4},"end":{"line":53,"column":35}},"38":{"start":{"line":53,"column":8},"end":{"line":53,"column":35}},"39":{"start":{"line":54,"column":20},"end":{"line":57,"column":51}},"40":{"start":{"line":56,"column":20},"end":{"line":56,"column":58}},"41":{"start":{"line":57,"column":23},"end":{"line":57,"column":50}},"42":{"start":{"line":58,"column":22},"end":{"line":63,"column":49}},"43":{"start":{"line":59,"column":20},"end":{"line":62,"column":6}},"44":{"start":{"line":63,"column":23},"end":{"line":63,"column":48}},"45":{"start":{"line":64,"column":4},"end":{"line":66,"column":6}},"46":{"start":{"line":69,"column":4},"end":{"line":103,"column":7}},"47":{"start":{"line":70,"column":30},"end":{"line":70,"column":44}},"48":{"start":{"line":71,"column":8},"end":{"line":72,"column":19}},"49":{"start":{"line":72,"column":12},"end":{"line":72,"column":19}},"50":{"start":{"line":73,"column":32},"end":{"line":73,"column":119}},"51":{"start":{"line":74,"column":8},"end":{"line":74,"column":58}},"52":{"start":{"line":75,"column":8},"end":{"line":102,"column":11}},"53":{"start":{"line":76,"column":29},"end":{"line":76,"column":103}},"54":{"start":{"line":77,"column":12},"end":{"line":77,"column":55}},"55":{"start":{"line":78,"column":38},"end":{"line":82,"column":13}},"56":{"start":{"line":79,"column":16},"end":{"line":80,"column":29}},"57":{"start":{"line":80,"column":20},"end":{"line":80,"column":29}},"58":{"start":{"line":81,"column":16},"end":{"line":81,"column":46}},"59":{"start":{"line":83,"column":30},"end":{"line":99,"column":22}},"60":{"start":{"line":91,"column":43},"end":{"line":91,"column":78}},"61":{"start":{"line":92,"column":43},"end":{"line":92,"column":84}},"62":{"start":{"line":93,"column":24},"end":{"line":93,"column":71}},"63":{"start":{"line":95,"column":24},"end":{"line":95,"column":77}},"64":{"start":{"line":96,"column":24},"end":{"line":96,"column":58}},"65":{"start":{"line":97,"column":24},"end":{"line":97,"column":39}},"66":{"start":{"line":100,"column":33},"end":{"line":100,"column":79}},"67":{"start":{"line":101,"column":12},"end":{"line":101,"column":59}},"68":{"start":{"line":105,"column":25},"end":{"line":108,"column":1}},"69":{"start":{"line":109,"column":0},"end":{"line":109,"column":35}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"getDatabase","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":20}},"loc":{"start":{"line":20,"column":42},"end":{"line":49,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":22,"column":22},"end":{"line":22,"column":23}},"loc":{"start":{"line":22,"column":28},"end":{"line":30,"column":5}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":38,"column":63},"end":{"line":38,"column":64}},"loc":{"start":{"line":38,"column":83},"end":{"line":46,"column":9}},"line":38},"11":{"name":"parse","decl":{"start":{"line":50,"column":9},"end":{"line":50,"column":14}},"loc":{"start":{"line":50,"column":24},"end":{"line":67,"column":1}},"line":50},"12":{"name":"(anonymous_12)","decl":{"start":{"line":56,"column":13},"end":{"line":56,"column":14}},"loc":{"start":{"line":56,"column":20},"end":{"line":56,"column":58}},"line":56},"13":{"name":"(anonymous_13)","decl":{"start":{"line":57,"column":16},"end":{"line":57,"column":17}},"loc":{"start":{"line":57,"column":23},"end":{"line":57,"column":50}},"line":57},"14":{"name":"(anonymous_14)","decl":{"start":{"line":59,"column":13},"end":{"line":59,"column":14}},"loc":{"start":{"line":59,"column":20},"end":{"line":62,"column":6}},"line":59},"15":{"name":"(anonymous_15)","decl":{"start":{"line":63,"column":16},"end":{"line":63,"column":17}},"loc":{"start":{"line":63,"column":23},"end":{"line":63,"column":48}},"line":63},"16":{"name":"dump","decl":{"start":{"line":68,"column":9},"end":{"line":68,"column":13}},"loc":{"start":{"line":68,"column":23},"end":{"line":104,"column":1}},"line":68},"17":{"name":"(anonymous_17)","decl":{"start":{"line":69,"column":43},"end":{"line":69,"column":44}},"loc":{"start":{"line":69,"column":56},"end":{"line":103,"column":5}},"line":69},"18":{"name":"(anonymous_18)","decl":{"start":{"line":75,"column":26},"end":{"line":75,"column":27}},"loc":{"start":{"line":75,"column":40},"end":{"line":102,"column":9}},"line":75},"19":{"name":"(anonymous_19)","decl":{"start":{"line":78,"column":38},"end":{"line":78,"column":39}},"loc":{"start":{"line":78,"column":56},"end":{"line":82,"column":13}},"line":78},"20":{"name":"(anonymous_20)","decl":{"start":{"line":89,"column":32},"end":{"line":89,"column":33}},"loc":{"start":{"line":89,"column":61},"end":{"line":98,"column":21}},"line":89}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":31,"column":4},"end":{"line":34,"column":5}},"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":34,"column":5}},{"start":{"line":31,"column":4},"end":{"line":34,"column":5}}],"line":31},"9":{"loc":{"start":{"line":35,"column":127},"end":{"line":35,"column":194}},"type":"binary-expr","locations":[{"start":{"line":35,"column":127},"end":{"line":35,"column":149}},{"start":{"line":35,"column":153},"end":{"line":35,"column":194}}],"line":35},"10":{"loc":{"start":{"line":37,"column":4},"end":{"line":47,"column":5}},"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":47,"column":5}},{"start":{"line":37,"column":4},"end":{"line":47,"column":5}}],"line":37},"11":{"loc":{"start":{"line":39,"column":12},"end":{"line":45,"column":13}},"type":"if","locations":[{"start":{"line":39,"column":12},"end":{"line":45,"column":13}},{"start":{"line":39,"column":12},"end":{"line":45,"column":13}}],"line":39},"12":{"loc":{"start":{"line":52,"column":4},"end":{"line":53,"column":35}},"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":53,"column":35}},{"start":{"line":52,"column":4},"end":{"line":53,"column":35}}],"line":52},"13":{"loc":{"start":{"line":71,"column":8},"end":{"line":72,"column":19}},"type":"if","locations":[{"start":{"line":71,"column":8},"end":{"line":72,"column":19}},{"start":{"line":71,"column":8},"end":{"line":72,"column":19}}],"line":71},"14":{"loc":{"start":{"line":79,"column":16},"end":{"line":80,"column":29}},"type":"if","locations":[{"start":{"line":79,"column":16},"end":{"line":80,"column":29}},{"start":{"line":79,"column":16},"end":{"line":80,"column":29}}],"line":79},"15":{"loc":{"start":{"line":81,"column":23},"end":{"line":81,"column":45}},"type":"cond-expr","locations":[{"start":{"line":81,"column":39},"end":{"line":81,"column":40}},{"start":{"line":81,"column":43},"end":{"line":81,"column":45}}],"line":81},"16":{"loc":{"start":{"line":83,"column":88},"end":{"line":85,"column":13}},"type":"binary-expr","locations":[{"start":{"line":83,"column":88},"end":{"line":83,"column":112}},{"start":{"line":83,"column":116},"end":{"line":85,"column":13}}],"line":83},"17":{"loc":{"start":{"line":84,"column":95},"end":{"line":84,"column":127}},"type":"binary-expr","locations":[{"start":{"line":84,"column":95},"end":{"line":84,"column":121}},{"start":{"line":84,"column":125},"end":{"line":84,"column":127}}],"line":84},"18":{"loc":{"start":{"line":85,"column":80},"end":{"line":99,"column":17}},"type":"binary-expr","locations":[{"start":{"line":85,"column":80},"end":{"line":85,"column":110}},{"start":{"line":85,"column":114},"end":{"line":99,"column":17}}],"line":85}},"s":{"0":1,"1":0,"2":0,"3":4,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":4,"11":4,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":4,"21":4,"22":4,"23":4,"24":1,"25":1,"26":4,"27":0,"28":0,"29":4,"30":4,"31":2,"32":14,"33":0,"34":14,"35":4,"36":60,"37":60,"38":56,"39":4,"40":4,"41":4,"42":4,"43":4,"44":4,"45":4,"46":4,"47":4,"48":4,"49":0,"50":4,"51":4,"52":4,"53":4,"54":4,"55":4,"56":6,"57":0,"58":6,"59":4,"60":8,"61":8,"62":8,"63":8,"64":8,"65":8,"66":4,"67":4,"68":1,"69":1},"f":{"0":4,"1":0,"2":0,"3":4,"4":0,"5":0,"6":4,"7":3,"8":4,"9":4,"10":14,"11":60,"12":4,"13":4,"14":4,"15":4,"16":4,"17":4,"18":4,"19":6,"20":8},"b":{"0":[1,1,1],"1":[0,0],"2":[4,4],"3":[4,0],"4":[4,4],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[0,4],"9":[4,0],"10":[2,2],"11":[0,14],"12":[56,4],"13":[0,4],"14":[0,6],"15":[6,0],"16":[4,4],"17":[4,4],"18":[4,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/databases.ts","sources":["/home/circleci/repo/src/context/directory/handlers/databases.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants, loadFileAndReplaceKeywords } from '../../../tools';\n\nimport log from '../../../logger';\nimport {\n  isDirectory,\n  existsMustBeDir,\n  dumpJSON,\n  loadJSON,\n  sanitize,\n  mapClientID2NameSorted,\n} from '../../../utils';\n\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, KeywordMappings, ParsedAsset } from '../../../types';\n\ntype ParsedDatabases = ParsedAsset<'databases', Asset[]>;\n\ntype DatabaseMetadata = {\n  options?: {\n    customScripts?: {\n      change_password: string;\n      create: string;\n      delete: string;\n      get_user: string;\n      login: string;\n      verify: string;\n    };\n  };\n};\n\nfunction getDatabase(\n  folder: string,\n  mappingOpts: { mappings: KeywordMappings; disableKeywordReplacement: boolean }\n): {} {\n  const metaFile = path.join(folder, 'database.json');\n\n  const metaData: DatabaseMetadata | {} = (() => {\n    try {\n      return loadJSON(metaFile, mappingOpts);\n    } catch (err) {\n      log.warn(`Skipping database folder ${folder} as cannot find or read ${metaFile}`);\n      return {};\n    }\n  })();\n\n  if (!metaData) {\n    log.warn(`Skipping database folder ${folder} as ${metaFile} is empty`);\n    return {};\n  }\n\n  const database = {\n    ...metaData,\n    options: {\n      //@ts-ignore because this code exists currently, but still needs to be understood if it is correct or not\n      ...metaData.options,\n      //@ts-ignore because this code exists currently, but still needs to be understood if it is correct or not\n      ...(metaData.customScripts && { customScripts: metaData.customScripts }),\n    },\n  };\n\n  // If any customScripts configured then load content of files\n  if (database.options.customScripts) {\n    Object.entries(database.options.customScripts).forEach(([name, script]: [string, string]) => {\n      if (!constants.DATABASE_SCRIPTS.includes(name)) {\n        // skip invalid keys in customScripts object\n        log.warn('Skipping invalid database configuration: ' + name);\n      } else {\n        database.options.customScripts[name] = loadFileAndReplaceKeywords(\n          path.join(folder, script),\n          mappingOpts\n        );\n      }\n    });\n  }\n\n  return database;\n}\n\nfunction parse(context: DirectoryContext): ParsedDatabases {\n  const databaseFolder = path.join(context.filePath, constants.DATABASE_CONNECTIONS_DIRECTORY);\n  if (!existsMustBeDir(databaseFolder)) return { databases: null }; // Skip\n\n  const folders = fs\n    .readdirSync(databaseFolder)\n    .map((f) => path.join(databaseFolder, f))\n    .filter((f) => isDirectory(f));\n\n  const databases = folders\n    .map((f) =>\n      getDatabase(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      })\n    )\n    .filter((p) => Object.keys(p).length > 1);\n\n  return {\n    databases,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { databases } = context.assets;\n\n  if (!databases) return; // Skip, nothing to dump\n\n  const databasesFolder = path.join(context.filePath, constants.DATABASE_CONNECTIONS_DIRECTORY);\n  fs.ensureDirSync(databasesFolder);\n\n  databases.forEach((database) => {\n    const dbFolder = path.join(databasesFolder, sanitize(database.name));\n    fs.ensureDirSync(dbFolder);\n\n    const sortCustomScripts = (name1: string, name2: string): 1 | 0 | -1 => {\n      if (name1 === name2) return 0;\n      return name1 > name2 ? 1 : -1;\n    };\n\n    const formatted = {\n      ...database,\n      ...(database.enabled_clients && {\n        enabled_clients: mapClientID2NameSorted(\n          database.enabled_clients,\n          context.assets.clientsOrig || []\n        ),\n      }),\n      options: {\n        ...database.options,\n        // customScripts option only written if there are scripts\n        ...(database.options.customScripts && {\n          customScripts: Object.entries(database.options.customScripts)\n            //@ts-ignore because we'll fix this in subsequent PR\n            .sort(sortCustomScripts)\n            .reduce((scripts, [name, script]) => {\n              // Dump custom script to file\n              const scriptName = sanitize(`${name}.js`);\n              const scriptFile = path.join(dbFolder, scriptName);\n              log.info(`Writing ${scriptFile}`);\n              //@ts-ignore because we'll fix this in subsequent PR\n              fs.writeFileSync(scriptFile, script);\n              scripts[name] = `./${scriptName}`;\n              return scripts;\n            }, {}),\n        }),\n      },\n    };\n\n    const databaseFile = path.join(dbFolder, 'database.json');\n    dumpJSON(databaseFile, formatted);\n  });\n}\n\nconst databasesHandler: DirectoryHandler<ParsedDatabases> = {\n  parse,\n  dump,\n};\n\nexport default databasesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"edd91cb18b6163e1df9ed0e5bd8e5de7c0ff4a60","contentHash":"844de9774a54b87aada04ab21b86a27b810ceae1af67b5efc718b91260d25056"},"/home/circleci/repo/src/context/directory/handlers/emailTemplates.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/emailTemplates.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"20":{"start":{"line":20,"column":13},"end":{"line":20,"column":26}},"21":{"start":{"line":22,"column":25},"end":{"line":22,"column":107}},"22":{"start":{"line":23,"column":4},"end":{"line":24,"column":40}},"23":{"start":{"line":24,"column":8},"end":{"line":24,"column":40}},"24":{"start":{"line":25,"column":22},"end":{"line":25,"column":130}},"25":{"start":{"line":25,"column":83},"end":{"line":25,"column":129}},"26":{"start":{"line":26,"column":27},"end":{"line":50,"column":6}},"27":{"start":{"line":27,"column":21},"end":{"line":30,"column":10}},"28":{"start":{"line":31,"column":33},"end":{"line":41,"column":12}},"29":{"start":{"line":32,"column":12},"end":{"line":36,"column":13}},"30":{"start":{"line":33,"column":46},"end":{"line":33,"column":90}},"31":{"start":{"line":34,"column":16},"end":{"line":35,"column":49}},"32":{"start":{"line":35,"column":20},"end":{"line":35,"column":49}},"33":{"start":{"line":37,"column":32},"end":{"line":37,"column":112}},"34":{"start":{"line":38,"column":12},"end":{"line":39,"column":35}},"35":{"start":{"line":39,"column":16},"end":{"line":39,"column":35}},"36":{"start":{"line":40,"column":12},"end":{"line":40,"column":24}},"37":{"start":{"line":42,"column":8},"end":{"line":45,"column":9}},"38":{"start":{"line":43,"column":12},"end":{"line":43,"column":121}},"39":{"start":{"line":44,"column":12},"end":{"line":44,"column":22}},"40":{"start":{"line":46,"column":8},"end":{"line":49,"column":18}},"41":{"start":{"line":51,"column":4},"end":{"line":53,"column":6}},"42":{"start":{"line":56,"column":4},"end":{"line":72,"column":7}},"43":{"start":{"line":57,"column":31},"end":{"line":57,"column":60}},"44":{"start":{"line":58,"column":8},"end":{"line":59,"column":19}},"45":{"start":{"line":59,"column":12},"end":{"line":59,"column":19}},"46":{"start":{"line":61,"column":32},"end":{"line":61,"column":114}},"47":{"start":{"line":62,"column":8},"end":{"line":62,"column":58}},"48":{"start":{"line":63,"column":8},"end":{"line":71,"column":11}},"49":{"start":{"line":65,"column":33},"end":{"line":65,"column":98}},"50":{"start":{"line":66,"column":12},"end":{"line":66,"column":61}},"51":{"start":{"line":67,"column":12},"end":{"line":67,"column":74}},"52":{"start":{"line":69,"column":33},"end":{"line":69,"column":98}},"53":{"start":{"line":70,"column":12},"end":{"line":70,"column":133}},"54":{"start":{"line":74,"column":30},"end":{"line":77,"column":1}},"55":{"start":{"line":78,"column":0},"end":{"line":78,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":21,"column":9},"end":{"line":21,"column":14}},"loc":{"start":{"line":21,"column":24},"end":{"line":54,"column":1}},"line":21},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":76},"end":{"line":25,"column":77}},"loc":{"start":{"line":25,"column":83},"end":{"line":25,"column":129}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":26,"column":45},"end":{"line":26,"column":46}},"loc":{"start":{"line":26,"column":59},"end":{"line":50,"column":5}},"line":26},"11":{"name":"(anonymous_11)","decl":{"start":{"line":31,"column":34},"end":{"line":31,"column":35}},"loc":{"start":{"line":31,"column":40},"end":{"line":41,"column":9}},"line":31},"12":{"name":"dump","decl":{"start":{"line":55,"column":9},"end":{"line":55,"column":13}},"loc":{"start":{"line":55,"column":23},"end":{"line":73,"column":1}},"line":55},"13":{"name":"(anonymous_13)","decl":{"start":{"line":56,"column":43},"end":{"line":56,"column":44}},"loc":{"start":{"line":56,"column":56},"end":{"line":72,"column":5}},"line":56},"14":{"name":"(anonymous_14)","decl":{"start":{"line":63,"column":31},"end":{"line":63,"column":32}},"loc":{"start":{"line":63,"column":45},"end":{"line":71,"column":9}},"line":63}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":23,"column":4},"end":{"line":24,"column":40}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":24,"column":40}},{"start":{"line":23,"column":4},"end":{"line":24,"column":40}}],"line":23},"9":{"loc":{"start":{"line":32,"column":12},"end":{"line":36,"column":13}},"type":"if","locations":[{"start":{"line":32,"column":12},"end":{"line":36,"column":13}},{"start":{"line":32,"column":12},"end":{"line":36,"column":13}}],"line":32},"10":{"loc":{"start":{"line":34,"column":16},"end":{"line":35,"column":49}},"type":"if","locations":[{"start":{"line":34,"column":16},"end":{"line":35,"column":49}},{"start":{"line":34,"column":16},"end":{"line":35,"column":49}}],"line":34},"11":{"loc":{"start":{"line":38,"column":12},"end":{"line":39,"column":35}},"type":"if","locations":[{"start":{"line":38,"column":12},"end":{"line":39,"column":35}},{"start":{"line":38,"column":12},"end":{"line":39,"column":35}}],"line":38},"12":{"loc":{"start":{"line":42,"column":8},"end":{"line":45,"column":9}},"type":"if","locations":[{"start":{"line":42,"column":8},"end":{"line":45,"column":9}},{"start":{"line":42,"column":8},"end":{"line":45,"column":9}}],"line":42},"13":{"loc":{"start":{"line":58,"column":8},"end":{"line":59,"column":19}},"type":"if","locations":[{"start":{"line":58,"column":8},"end":{"line":59,"column":19}},{"start":{"line":58,"column":8},"end":{"line":59,"column":19}}],"line":58}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":54,"22":54,"23":51,"24":3,"25":7,"26":3,"27":4,"28":4,"29":4,"30":2,"31":2,"32":2,"33":2,"34":2,"35":2,"36":0,"37":4,"38":0,"39":0,"40":4,"41":3,"42":1,"43":1,"44":1,"45":0,"46":1,"47":1,"48":1,"49":2,"50":2,"51":2,"52":2,"53":2,"54":1,"55":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":3,"8":54,"9":7,"10":4,"11":4,"12":1,"13":1,"14":2},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[51,3],"9":[2,2],"10":[2,0],"11":[2,0],"12":[0,4],"13":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/emailTemplates.ts","sources":["/home/circleci/repo/src/context/directory/handlers/emailTemplates.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants, loadFileAndReplaceKeywords } from '../../../tools';\n\nimport log from '../../../logger';\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\nimport { existsSync } from 'fs';\n\ntype ParsedEmailTemplates = ParsedAsset<'emailTemplates', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedEmailTemplates {\n  const emailsFolder = path.join(context.filePath, constants.EMAIL_TEMPLATES_DIRECTORY);\n  if (!existsMustBeDir(emailsFolder)) return { emailTemplates: null }; // Skip\n\n  const jsonFiles = getFiles(emailsFolder, ['.json']).filter(\n    (f) => path.basename(f) !== 'provider.json'\n  );\n\n  const emailTemplates = jsonFiles.flatMap((filePath: string) => {\n    const meta: { body: string | undefined } = loadJSON(filePath, {\n      mappings: context.mappings,\n      disableKeywordReplacement: context.disableKeywordReplacement,\n    });\n\n    const templateFilePath = (() => {\n      if (meta.body !== undefined) {\n        const explicitlyDefinedPath = path.join(emailsFolder, meta.body);\n        if (existsSync(explicitlyDefinedPath)) return explicitlyDefinedPath;\n      }\n\n      const defaultPath = path.join(emailsFolder, path.parse(filePath).name + '.html');\n\n      if (existsSync(defaultPath)) return defaultPath;\n      return null;\n    })();\n\n    if (templateFilePath === null) {\n      log.warn(\n        `Skipping email template file ${meta.body} as missing the corresponding '.json' file`\n      );\n      return [];\n    }\n\n    return {\n      ...meta,\n      body: loadFileAndReplaceKeywords(templateFilePath, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }),\n    };\n  });\n\n  return {\n    emailTemplates,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const emailTemplates = context.assets.emailTemplates;\n\n  if (!emailTemplates) return; // Skip, nothing to dump\n\n  // Create Templates folder\n  const templatesFolder = path.join(context.filePath, constants.EMAIL_TEMPLATES_DIRECTORY);\n  fs.ensureDirSync(templatesFolder);\n  emailTemplates.forEach((template) => {\n    // Dump template html to file\n    const templateHtml = path.join(templatesFolder, `${template.template}.html`);\n    log.info(`Writing ${templateHtml}`);\n    fs.writeFileSync(templateHtml, template.body);\n\n    // Dump template metadata\n    const templateFile = path.join(templatesFolder, `${template.template}.json`);\n    dumpJSON(templateFile, { ...template, body: `./${template.template}.html` });\n  });\n}\n\nconst emailTemplatesHandler: DirectoryHandler<ParsedEmailTemplates> = {\n  parse,\n  dump,\n};\n\nexport default emailTemplatesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"09d3018c2238522ef7cb84228e5eeac2e36205b1","contentHash":"7814c139a0cf37a432fd0ba2c77800296c8b558495cc9689baad89564d845a15"},"/home/circleci/repo/src/context/directory/handlers/clientGrants.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/clientGrants.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":25},"end":{"line":20,"column":106}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":38}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":38}},"22":{"start":{"line":23,"column":23},"end":{"line":23,"column":69}},"23":{"start":{"line":24,"column":25},"end":{"line":29,"column":49}},"24":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"25":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"26":{"start":{"line":30,"column":4},"end":{"line":32,"column":6}},"27":{"start":{"line":35,"column":4},"end":{"line":77,"column":7}},"28":{"start":{"line":36,"column":33},"end":{"line":36,"column":47}},"29":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"30":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"31":{"start":{"line":39,"column":29},"end":{"line":39,"column":110}},"32":{"start":{"line":40,"column":8},"end":{"line":40,"column":55}},"33":{"start":{"line":41,"column":8},"end":{"line":42,"column":19}},"34":{"start":{"line":42,"column":12},"end":{"line":42,"column":19}},"35":{"start":{"line":43,"column":35},"end":{"line":46,"column":10}},"36":{"start":{"line":47,"column":27},"end":{"line":50,"column":10}},"37":{"start":{"line":52,"column":8},"end":{"line":76,"column":11}},"38":{"start":{"line":53,"column":30},"end":{"line":53,"column":54}},"39":{"start":{"line":54,"column":12},"end":{"line":56,"column":13}},"40":{"start":{"line":55,"column":16},"end":{"line":55,"column":122}},"41":{"start":{"line":57,"column":31},"end":{"line":64,"column":16}},"42":{"start":{"line":58,"column":41},"end":{"line":60,"column":18}},"43":{"start":{"line":59,"column":20},"end":{"line":59,"column":64}},"44":{"start":{"line":61,"column":16},"end":{"line":62,"column":43}},"45":{"start":{"line":62,"column":20},"end":{"line":62,"column":43}},"46":{"start":{"line":63,"column":16},"end":{"line":63,"column":45}},"47":{"start":{"line":65,"column":28},"end":{"line":72,"column":16}},"48":{"start":{"line":66,"column":38},"end":{"line":68,"column":18}},"49":{"start":{"line":67,"column":20},"end":{"line":67,"column":72}},"50":{"start":{"line":69,"column":16},"end":{"line":70,"column":42}},"51":{"start":{"line":70,"column":20},"end":{"line":70,"column":42}},"52":{"start":{"line":71,"column":16},"end":{"line":71,"column":42}},"53":{"start":{"line":73,"column":25},"end":{"line":73,"column":74}},"54":{"start":{"line":74,"column":30},"end":{"line":74,"column":79}},"55":{"start":{"line":75,"column":12},"end":{"line":75,"column":56}},"56":{"start":{"line":79,"column":28},"end":{"line":82,"column":1}},"57":{"start":{"line":83,"column":0},"end":{"line":83,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":13},"end":{"line":25,"column":14}},"loc":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":29,"column":16},"end":{"line":29,"column":17}},"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"line":29},"11":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":78,"column":1}},"line":34},"12":{"name":"(anonymous_12)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":77,"column":5}},"line":35},"13":{"name":"(anonymous_13)","decl":{"start":{"line":52,"column":29},"end":{"line":52,"column":30}},"loc":{"start":{"line":52,"column":40},"end":{"line":76,"column":9}},"line":52},"14":{"name":"(anonymous_14)","decl":{"start":{"line":57,"column":32},"end":{"line":57,"column":33}},"loc":{"start":{"line":57,"column":38},"end":{"line":64,"column":13}},"line":57},"15":{"name":"(anonymous_15)","decl":{"start":{"line":58,"column":57},"end":{"line":58,"column":58}},"loc":{"start":{"line":58,"column":69},"end":{"line":60,"column":17}},"line":58},"16":{"name":"(anonymous_16)","decl":{"start":{"line":65,"column":29},"end":{"line":65,"column":30}},"loc":{"start":{"line":65,"column":35},"end":{"line":72,"column":13}},"line":65},"17":{"name":"(anonymous_17)","decl":{"start":{"line":66,"column":62},"end":{"line":66,"column":63}},"loc":{"start":{"line":66,"column":82},"end":{"line":68,"column":17}},"line":66}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":38}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":38}},{"start":{"line":21,"column":4},"end":{"line":22,"column":38}}],"line":21},"9":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37},"10":{"loc":{"start":{"line":41,"column":8},"end":{"line":42,"column":19}},"type":"if","locations":[{"start":{"line":41,"column":8},"end":{"line":42,"column":19}},{"start":{"line":41,"column":8},"end":{"line":42,"column":19}}],"line":41},"11":{"loc":{"start":{"line":54,"column":12},"end":{"line":56,"column":13}},"type":"if","locations":[{"start":{"line":54,"column":12},"end":{"line":56,"column":13}},{"start":{"line":54,"column":12},"end":{"line":56,"column":13}}],"line":54},"12":{"loc":{"start":{"line":61,"column":16},"end":{"line":62,"column":43}},"type":"if","locations":[{"start":{"line":61,"column":16},"end":{"line":62,"column":43}},{"start":{"line":61,"column":16},"end":{"line":62,"column":43}}],"line":61},"13":{"loc":{"start":{"line":69,"column":16},"end":{"line":70,"column":42}},"type":"if","locations":[{"start":{"line":69,"column":16},"end":{"line":70,"column":42}},{"start":{"line":69,"column":16},"end":{"line":70,"column":42}}],"line":69}},"s":{"0":1,"1":2,"2":0,"3":2,"4":2,"5":2,"6":0,"7":0,"8":0,"9":0,"10":4,"11":2,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":60,"20":60,"21":57,"22":2,"23":2,"24":4,"25":4,"26":2,"27":2,"28":2,"29":2,"30":0,"31":2,"32":2,"33":2,"34":1,"35":1,"36":1,"37":1,"38":3,"39":3,"40":0,"41":3,"42":3,"43":4,"44":3,"45":0,"46":3,"47":3,"48":3,"49":4,"50":3,"51":0,"52":3,"53":3,"54":3,"55":3,"56":1,"57":1},"f":{"0":2,"1":2,"2":0,"3":2,"4":2,"5":0,"6":4,"7":2,"8":60,"9":4,"10":4,"11":2,"12":2,"13":3,"14":3,"15":4,"16":3,"17":4},"b":{"0":[1,1,1],"1":[2,0],"2":[2,2],"3":[2,2],"4":[2,2],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[57,2],"9":[0,2],"10":[1,1],"11":[0,3],"12":[0,3],"13":[0,3]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/clientGrants.ts","sources":["/home/circleci/repo/src/context/directory/handlers/clientGrants.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport {\n  getFiles,\n  existsMustBeDir,\n  dumpJSON,\n  loadJSON,\n  sanitize,\n  convertClientIdToName,\n} from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { ClientGrant } from '../../../tools/auth0/handlers/clientGrants';\n\ntype ParsedClientGrants = ParsedAsset<'clientGrants', ClientGrant[]>;\n\nfunction parse(context: DirectoryContext): ParsedClientGrants {\n  const grantsFolder = path.join(context.filePath, constants.CLIENTS_GRANTS_DIRECTORY);\n  if (!existsMustBeDir(grantsFolder)) return { clientGrants: null }; // Skip\n\n  const foundFiles = getFiles(grantsFolder, ['.json']);\n\n  const clientGrants = foundFiles\n    .map((f) =>\n      loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      })\n    )\n    .filter((p) => Object.keys(p).length > 0); // Filter out empty grants\n\n  return {\n    clientGrants,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { clientGrants } = context.assets;\n\n  if (!clientGrants) return; // Skip, nothing to dump\n\n  const grantsFolder = path.join(context.filePath, constants.CLIENTS_GRANTS_DIRECTORY);\n  fs.ensureDirSync(grantsFolder);\n\n  if (clientGrants.length === 0) return;\n\n  const allResourceServers = await context.mgmtClient.resourceServers.getAll({\n    paginate: true,\n    include_totals: true,\n  });\n\n  const allClients = await context.mgmtClient.clients.getAll({\n    paginate: true,\n    include_totals: true,\n  });\n\n  // Convert client_id to the client name for readability\n  clientGrants.forEach((grant: ClientGrant) => {\n    const dumpGrant = { ...grant };\n\n    if (context.assets.clientsOrig) {\n      dumpGrant.client_id = convertClientIdToName(dumpGrant.client_id, context.assets.clientsOrig);\n    }\n\n    const clientName = (() => {\n      const associatedClient = allClients.find((client) => {\n        return client.client_id === grant.client_id;\n      });\n\n      if (associatedClient === undefined) return grant.client_id;\n\n      return associatedClient.name;\n    })();\n\n    const apiName = (() => {\n      const associatedAPI = allResourceServers.find((resourceServer) => {\n        return resourceServer.identifier === grant.audience;\n      });\n\n      if (associatedAPI === undefined) return grant.audience;\n\n      return associatedAPI.name;\n    })();\n\n    const name = sanitize(`${clientName}-${apiName}`);\n    const grantFile = path.join(grantsFolder, `${name}.json`);\n\n    dumpJSON(grantFile, dumpGrant);\n  });\n}\n\nconst clientGrantsHandler: DirectoryHandler<ParsedClientGrants> = {\n  parse,\n  dump,\n};\n\nexport default clientGrantsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ee2617d02b7ba3c6ad2425caadc41a20a643dc7d","contentHash":"299c4fc3c931844d150053e7366fe6d0ba93e8d1939ffc3d2ee011ab839c8bc1"},"/home/circleci/repo/src/context/directory/handlers/rulesConfigs.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/rulesConfigs.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":16},"end":{"line":16,"column":41}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":19,"column":31},"end":{"line":19,"column":111}},"19":{"start":{"line":20,"column":4},"end":{"line":21,"column":38}},"20":{"start":{"line":21,"column":8},"end":{"line":21,"column":38}},"21":{"start":{"line":22,"column":23},"end":{"line":22,"column":75}},"22":{"start":{"line":23,"column":25},"end":{"line":28,"column":49}},"23":{"start":{"line":24,"column":20},"end":{"line":27,"column":6}},"24":{"start":{"line":28,"column":23},"end":{"line":28,"column":48}},"25":{"start":{"line":29,"column":4},"end":{"line":31,"column":6}},"26":{"start":{"line":34,"column":4},"end":{"line":37,"column":7}},"27":{"start":{"line":36,"column":8},"end":{"line":36,"column":15}},"28":{"start":{"line":39,"column":28},"end":{"line":42,"column":1}},"29":{"start":{"line":43,"column":0},"end":{"line":43,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":18,"column":9},"end":{"line":18,"column":14}},"loc":{"start":{"line":18,"column":24},"end":{"line":32,"column":1}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":24,"column":13},"end":{"line":24,"column":14}},"loc":{"start":{"line":24,"column":20},"end":{"line":27,"column":6}},"line":24},"10":{"name":"(anonymous_10)","decl":{"start":{"line":28,"column":16},"end":{"line":28,"column":17}},"loc":{"start":{"line":28,"column":23},"end":{"line":28,"column":48}},"line":28},"11":{"name":"dump","decl":{"start":{"line":33,"column":9},"end":{"line":33,"column":13}},"loc":{"start":{"line":33,"column":16},"end":{"line":38,"column":1}},"line":33},"12":{"name":"(anonymous_12)","decl":{"start":{"line":34,"column":43},"end":{"line":34,"column":44}},"loc":{"start":{"line":34,"column":56},"end":{"line":37,"column":5}},"line":34}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":20,"column":4},"end":{"line":21,"column":38}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":21,"column":38}},{"start":{"line":20,"column":4},"end":{"line":21,"column":38}}],"line":20}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":62,"19":62,"20":62,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1,"8":62,"9":0,"10":0,"11":0,"12":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,1],"7":[1,1],"8":[62,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/rulesConfigs.ts","sources":["/home/circleci/repo/src/context/directory/handlers/rulesConfigs.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,0CAA2C;AAE3C,0CAAqE;AAOrE,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,kBAAkB,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,uBAAuB,CAAC,CAAC;IAC1F,IAAI,CAAC,IAAA,uBAAe,EAAC,kBAAkB,CAAC;QAAE,OAAO,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAEhF,MAAM,UAAU,GAAa,IAAA,gBAAQ,EAAC,kBAAkB,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAErE,MAAM,YAAY,GAAG,UAAU;SAC5B,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CACT,IAAA,gBAAQ,EAAC,CAAC,EAAE;QACV,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CACH;SACA,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,gCAAgC;IAE7E,OAAO;QACL,YAAY;KACb,CAAC;AACJ,CAAC;AAED,SAAe,IAAI;;QACjB,+DAA+D;QAC/D,OAAO;IACT,CAAC;CAAA;AAED,MAAM,mBAAmB,GAAyC;IAChE,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,mBAAmB,CAAC","sourcesContent":["import path from 'path';\nimport { constants } from '../../../tools';\n\nimport { getFiles, existsMustBeDir, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedRulesConfigs = ParsedAsset<'rulesConfigs', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedRulesConfigs {\n  const rulesConfigsFolder = path.join(context.filePath, constants.RULES_CONFIGS_DIRECTORY);\n  if (!existsMustBeDir(rulesConfigsFolder)) return { rulesConfigs: null }; // Skip\n\n  const foundFiles: string[] = getFiles(rulesConfigsFolder, ['.json']);\n\n  const rulesConfigs = foundFiles\n    .map((f) =>\n      loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      })\n    )\n    .filter((p) => Object.keys(p).length > 0); // Filter out empty rulesConfigs\n\n  return {\n    rulesConfigs,\n  };\n}\n\nasync function dump(): Promise<void> {\n  // do not export rulesConfigs as its values cannot be extracted\n  return;\n}\n\nconst rulesConfigsHandler: DirectoryHandler<ParsedRulesConfigs> = {\n  parse,\n  dump,\n};\n\nexport default rulesConfigsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"097d5cc3f246c2b2b71d301943137230432d3117","contentHash":"d6983d4ff2664c05bd474f1b6e7e758c273148cc7d14d1510d642120ace9d4bd"},"/home/circleci/repo/src/context/directory/handlers/resourceServers.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/resourceServers.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":34},"end":{"line":20,"column":117}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":41}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":41}},"22":{"start":{"line":23,"column":23},"end":{"line":23,"column":78}},"23":{"start":{"line":24,"column":28},"end":{"line":29,"column":49}},"24":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"25":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"26":{"start":{"line":30,"column":4},"end":{"line":32,"column":6}},"27":{"start":{"line":35,"column":4},"end":{"line":45,"column":7}},"28":{"start":{"line":36,"column":36},"end":{"line":36,"column":50}},"29":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"30":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"31":{"start":{"line":39,"column":38},"end":{"line":39,"column":121}},"32":{"start":{"line":40,"column":8},"end":{"line":40,"column":64}},"33":{"start":{"line":41,"column":8},"end":{"line":44,"column":11}},"34":{"start":{"line":42,"column":39},"end":{"line":42,"column":135}},"35":{"start":{"line":43,"column":12},"end":{"line":43,"column":70}},"36":{"start":{"line":47,"column":31},"end":{"line":50,"column":1}},"37":{"start":{"line":51,"column":0},"end":{"line":51,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":13},"end":{"line":25,"column":14}},"loc":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":29,"column":16},"end":{"line":29,"column":17}},"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"line":29},"11":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":46,"column":1}},"line":34},"12":{"name":"(anonymous_12)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":45,"column":5}},"line":35},"13":{"name":"(anonymous_13)","decl":{"start":{"line":41,"column":32},"end":{"line":41,"column":33}},"loc":{"start":{"line":41,"column":52},"end":{"line":44,"column":9}},"line":41}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":41}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":41}},{"start":{"line":21,"column":4},"end":{"line":22,"column":41}}],"line":21},"9":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":59,"20":59,"21":59,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1,"37":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":2,"8":59,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[59,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/resourceServers.ts","sources":["/home/circleci/repo/src/context/directory/handlers/resourceServers.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAC3C,0CAAyF;AAQzF,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,qBAAqB,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,0BAA0B,CAAC,CAAC;IAChG,IAAI,CAAC,IAAA,uBAAe,EAAC,qBAAqB,CAAC;QAAE,OAAO,EAAE,eAAe,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAEtF,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,qBAAqB,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAE9D,MAAM,eAAe,GAAG,UAAU;SAC/B,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CACT,IAAA,gBAAQ,EAAC,CAAC,EAAE;QACV,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CACH;SACA,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,mCAAmC;IAEhF,OAAO;QACL,eAAe;KAChB,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,eAAe,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE3C,IAAI,CAAC,eAAe;YAAE,OAAO,CAAC,wBAAwB;QAEtD,MAAM,qBAAqB,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,0BAA0B,CAAC,CAAC;QAChG,kBAAE,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC;QAExC,eAAe,CAAC,OAAO,CAAC,CAAC,cAAc,EAAE,EAAE;YACzC,MAAM,kBAAkB,GAAG,cAAI,CAAC,IAAI,CAClC,qBAAqB,EACrB,IAAA,gBAAQ,EAAC,GAAG,cAAc,CAAC,IAAI,OAAO,CAAC,CACxC,CAAC;YACF,IAAA,gBAAQ,EAAC,kBAAkB,EAAE,cAAc,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,sBAAsB,GAA4C;IACtE,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,sBAAsB,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON, sanitize } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { ResourceServer } from '../../../tools/auth0/handlers/resourceServers';\n\ntype ParsedResourceServers = ParsedAsset<'resourceServers', ResourceServer[]>;\n\nfunction parse(context: DirectoryContext): ParsedResourceServers {\n  const resourceServersFolder = path.join(context.filePath, constants.RESOURCE_SERVERS_DIRECTORY);\n  if (!existsMustBeDir(resourceServersFolder)) return { resourceServers: null }; // Skip\n\n  const foundFiles = getFiles(resourceServersFolder, ['.json']);\n\n  const resourceServers = foundFiles\n    .map((f) =>\n      loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      })\n    )\n    .filter((p) => Object.keys(p).length > 0); // Filter out empty resourceServers\n\n  return {\n    resourceServers,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { resourceServers } = context.assets;\n\n  if (!resourceServers) return; // Skip, nothing to dump\n\n  const resourceServersFolder = path.join(context.filePath, constants.RESOURCE_SERVERS_DIRECTORY);\n  fs.ensureDirSync(resourceServersFolder);\n\n  resourceServers.forEach((resourceServer) => {\n    const resourceServerFile = path.join(\n      resourceServersFolder,\n      sanitize(`${resourceServer.name}.json`)\n    );\n    dumpJSON(resourceServerFile, resourceServer);\n  });\n}\n\nconst resourceServersHandler: DirectoryHandler<ParsedResourceServers> = {\n  parse,\n  dump,\n};\n\nexport default resourceServersHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3d48e59e2f1facfebfdf1c82184118f441caf7ff","contentHash":"3368c10039800e8fb0351a6f1e1bfee3d225824a08e5c30736b269f9436e49a6"},"/home/circleci/repo/src/context/directory/handlers/guardianFactors.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/guardianFactors.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":26},"end":{"line":20,"column":147}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":41}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":41}},"22":{"start":{"line":23,"column":23},"end":{"line":23,"column":70}},"23":{"start":{"line":24,"column":28},"end":{"line":29,"column":49}},"24":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"25":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"26":{"start":{"line":30,"column":4},"end":{"line":32,"column":6}},"27":{"start":{"line":35,"column":4},"end":{"line":45,"column":7}},"28":{"start":{"line":36,"column":36},"end":{"line":36,"column":50}},"29":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"30":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"31":{"start":{"line":39,"column":30},"end":{"line":39,"column":151}},"32":{"start":{"line":40,"column":8},"end":{"line":40,"column":56}},"33":{"start":{"line":41,"column":8},"end":{"line":44,"column":11}},"34":{"start":{"line":42,"column":31},"end":{"line":42,"column":88}},"35":{"start":{"line":43,"column":12},"end":{"line":43,"column":54}},"36":{"start":{"line":47,"column":31},"end":{"line":50,"column":1}},"37":{"start":{"line":51,"column":0},"end":{"line":51,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":13},"end":{"line":25,"column":14}},"loc":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":29,"column":16},"end":{"line":29,"column":17}},"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"line":29},"11":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":46,"column":1}},"line":34},"12":{"name":"(anonymous_12)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":45,"column":5}},"line":35},"13":{"name":"(anonymous_13)","decl":{"start":{"line":41,"column":32},"end":{"line":41,"column":33}},"loc":{"start":{"line":41,"column":44},"end":{"line":44,"column":9}},"line":41}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":41}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":41}},{"start":{"line":21,"column":4},"end":{"line":22,"column":41}}],"line":21},"9":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":54,"20":54,"21":53,"22":1,"23":1,"24":2,"25":2,"26":1,"27":1,"28":1,"29":1,"30":0,"31":1,"32":1,"33":1,"34":2,"35":2,"36":1,"37":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":2,"8":54,"9":2,"10":2,"11":1,"12":1,"13":2},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[53,1],"9":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/guardianFactors.ts","sources":["/home/circleci/repo/src/context/directory/handlers/guardianFactors.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAE3C,0CAA+E;AAO/E,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,aAAa,GAAG,cAAI,CAAC,IAAI,CAC7B,OAAO,CAAC,QAAQ,EAChB,iBAAS,CAAC,kBAAkB,EAC5B,iBAAS,CAAC,0BAA0B,CACrC,CAAC;IACF,IAAI,CAAC,IAAA,uBAAe,EAAC,aAAa,CAAC;QAAE,OAAO,EAAE,eAAe,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAE9E,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,aAAa,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAEtD,MAAM,eAAe,GAAG,UAAU;SAC/B,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CACT,IAAA,gBAAQ,EAAC,CAAC,EAAE;QACV,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CACH;SACA,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,mCAAmC;IAEhF,OAAO;QACL,eAAe;KAChB,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,eAAe,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE3C,IAAI,CAAC,eAAe;YAAE,OAAO,CAAC,wBAAwB;QAEtD,MAAM,aAAa,GAAG,cAAI,CAAC,IAAI,CAC7B,OAAO,CAAC,QAAQ,EAChB,iBAAS,CAAC,kBAAkB,EAC5B,iBAAS,CAAC,0BAA0B,CACrC,CAAC;QACF,kBAAE,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;QAEhC,eAAe,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,EAAE;YACjC,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,aAAa,EAAE,GAAG,MAAM,CAAC,IAAI,OAAO,CAAC,CAAC;YACnE,IAAA,gBAAQ,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,sBAAsB,GAA4C;IACtE,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,sBAAsB,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianFactors = ParsedAsset<'guardianFactors', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedGuardianFactors {\n  const factorsFolder = path.join(\n    context.filePath,\n    constants.GUARDIAN_DIRECTORY,\n    constants.GUARDIAN_FACTORS_DIRECTORY\n  );\n  if (!existsMustBeDir(factorsFolder)) return { guardianFactors: null }; // Skip\n\n  const foundFiles = getFiles(factorsFolder, ['.json']);\n\n  const guardianFactors = foundFiles\n    .map((f) =>\n      loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      })\n    )\n    .filter((p) => Object.keys(p).length > 0); // Filter out empty guardianFactors\n\n  return {\n    guardianFactors,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { guardianFactors } = context.assets;\n\n  if (!guardianFactors) return; // Skip, nothing to dump\n\n  const factorsFolder = path.join(\n    context.filePath,\n    constants.GUARDIAN_DIRECTORY,\n    constants.GUARDIAN_FACTORS_DIRECTORY\n  );\n  fs.ensureDirSync(factorsFolder);\n\n  guardianFactors.forEach((factor) => {\n    const factorFile = path.join(factorsFolder, `${factor.name}.json`);\n    dumpJSON(factorFile, factor);\n  });\n}\n\nconst guardianFactorsHandler: DirectoryHandler<ParsedGuardianFactors> = {\n  parse,\n  dump,\n};\n\nexport default guardianFactorsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3d640b5de08b322eca4c07c22a9416c37544637d","contentHash":"b2966e6bf6f17a8a11681b007de4b56ab4500518069cb4973d0ae8f8b7d746af"},"/home/circleci/repo/src/context/directory/handlers/guardianFactorProviders.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/guardianFactorProviders.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":34},"end":{"line":20,"column":157}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":49}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":49}},"22":{"start":{"line":23,"column":23},"end":{"line":23,"column":78}},"23":{"start":{"line":24,"column":36},"end":{"line":29,"column":49}},"24":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"25":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"26":{"start":{"line":30,"column":4},"end":{"line":32,"column":6}},"27":{"start":{"line":35,"column":4},"end":{"line":45,"column":7}},"28":{"start":{"line":36,"column":44},"end":{"line":36,"column":58}},"29":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"30":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"31":{"start":{"line":39,"column":38},"end":{"line":39,"column":161}},"32":{"start":{"line":40,"column":8},"end":{"line":40,"column":64}},"33":{"start":{"line":41,"column":8},"end":{"line":44,"column":11}},"34":{"start":{"line":42,"column":39},"end":{"line":42,"column":139}},"35":{"start":{"line":43,"column":12},"end":{"line":43,"column":70}},"36":{"start":{"line":47,"column":39},"end":{"line":50,"column":1}},"37":{"start":{"line":51,"column":0},"end":{"line":51,"column":49}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":13},"end":{"line":25,"column":14}},"loc":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":29,"column":16},"end":{"line":29,"column":17}},"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"line":29},"11":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":46,"column":1}},"line":34},"12":{"name":"(anonymous_12)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":45,"column":5}},"line":35},"13":{"name":"(anonymous_13)","decl":{"start":{"line":41,"column":40},"end":{"line":41,"column":41}},"loc":{"start":{"line":41,"column":60},"end":{"line":44,"column":9}},"line":41}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":49}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":49}},{"start":{"line":21,"column":4},"end":{"line":22,"column":49}}],"line":21},"9":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":54,"20":54,"21":53,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":0,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":2,"8":54,"9":1,"10":1,"11":1,"12":1,"13":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[53,1],"9":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/guardianFactorProviders.ts","sources":["/home/circleci/repo/src/context/directory/handlers/guardianFactorProviders.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAE3C,0CAA+E;AAO/E,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,qBAAqB,GAAG,cAAI,CAAC,IAAI,CACrC,OAAO,CAAC,QAAQ,EAChB,iBAAS,CAAC,kBAAkB,EAC5B,iBAAS,CAAC,4BAA4B,CACvC,CAAC;IACF,IAAI,CAAC,IAAA,uBAAe,EAAC,qBAAqB,CAAC;QAAE,OAAO,EAAE,uBAAuB,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAE9F,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,qBAAqB,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAE9D,MAAM,uBAAuB,GAAG,UAAU;SACvC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CACT,IAAA,gBAAQ,EAAC,CAAC,EAAE;QACV,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CACH;SACA,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,yCAAyC;IAEtF,OAAO;QACL,uBAAuB;KACxB,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,uBAAuB,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEnD,IAAI,CAAC,uBAAuB;YAAE,OAAO,CAAC,wBAAwB;QAE9D,MAAM,qBAAqB,GAAG,cAAI,CAAC,IAAI,CACrC,OAAO,CAAC,QAAQ,EAChB,iBAAS,CAAC,kBAAkB,EAC5B,iBAAS,CAAC,4BAA4B,CACvC,CAAC;QACF,kBAAE,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC;QAExC,uBAAuB,CAAC,OAAO,CAAC,CAAC,cAAc,EAAE,EAAE;YACjD,MAAM,kBAAkB,GAAG,cAAI,CAAC,IAAI,CAClC,qBAAqB,EACrB,GAAG,cAAc,CAAC,IAAI,IAAI,cAAc,CAAC,QAAQ,OAAO,CACzD,CAAC;YACF,IAAA,gBAAQ,EAAC,kBAAkB,EAAE,cAAc,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,8BAA8B,GAAoD;IACtF,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,8BAA8B,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianFactorProviders = ParsedAsset<'guardianFactorProviders', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedGuardianFactorProviders {\n  const factorProvidersFolder = path.join(\n    context.filePath,\n    constants.GUARDIAN_DIRECTORY,\n    constants.GUARDIAN_PROVIDERS_DIRECTORY\n  );\n  if (!existsMustBeDir(factorProvidersFolder)) return { guardianFactorProviders: null }; // Skip\n\n  const foundFiles = getFiles(factorProvidersFolder, ['.json']);\n\n  const guardianFactorProviders = foundFiles\n    .map((f) =>\n      loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      })\n    )\n    .filter((p) => Object.keys(p).length > 0); // Filter out empty factorProvidersFolder\n\n  return {\n    guardianFactorProviders,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { guardianFactorProviders } = context.assets;\n\n  if (!guardianFactorProviders) return; // Skip, nothing to dump\n\n  const factorProvidersFolder = path.join(\n    context.filePath,\n    constants.GUARDIAN_DIRECTORY,\n    constants.GUARDIAN_PROVIDERS_DIRECTORY\n  );\n  fs.ensureDirSync(factorProvidersFolder);\n\n  guardianFactorProviders.forEach((factorProvider) => {\n    const factorProviderFile = path.join(\n      factorProvidersFolder,\n      `${factorProvider.name}-${factorProvider.provider}.json`\n    );\n    dumpJSON(factorProviderFile, factorProvider);\n  });\n}\n\nconst guardianFactorProvidersHandler: DirectoryHandler<ParsedGuardianFactorProviders> = {\n  parse,\n  dump,\n};\n\nexport default guardianFactorProvidersHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"64ca76e8750fac3bc8dd37776c5a19cda67f2074","contentHash":"ede8c1112e3373f04a43bf60334156ba3be18b4420d148e5f6cb56cee15d500d"},"/home/circleci/repo/src/context/directory/handlers/guardianFactorTemplates.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/guardianFactorTemplates.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":34},"end":{"line":20,"column":157}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":49}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":49}},"22":{"start":{"line":23,"column":23},"end":{"line":23,"column":78}},"23":{"start":{"line":24,"column":36},"end":{"line":29,"column":49}},"24":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"25":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"26":{"start":{"line":30,"column":4},"end":{"line":32,"column":6}},"27":{"start":{"line":35,"column":4},"end":{"line":45,"column":7}},"28":{"start":{"line":36,"column":44},"end":{"line":36,"column":58}},"29":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"30":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"31":{"start":{"line":39,"column":38},"end":{"line":39,"column":161}},"32":{"start":{"line":40,"column":8},"end":{"line":40,"column":64}},"33":{"start":{"line":41,"column":8},"end":{"line":44,"column":11}},"34":{"start":{"line":42,"column":40},"end":{"line":42,"column":114}},"35":{"start":{"line":43,"column":12},"end":{"line":43,"column":72}},"36":{"start":{"line":47,"column":39},"end":{"line":50,"column":1}},"37":{"start":{"line":51,"column":0},"end":{"line":51,"column":49}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":13},"end":{"line":25,"column":14}},"loc":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":29,"column":16},"end":{"line":29,"column":17}},"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"line":29},"11":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":46,"column":1}},"line":34},"12":{"name":"(anonymous_12)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":45,"column":5}},"line":35},"13":{"name":"(anonymous_13)","decl":{"start":{"line":41,"column":40},"end":{"line":41,"column":41}},"loc":{"start":{"line":41,"column":61},"end":{"line":44,"column":9}},"line":41}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":49}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":49}},{"start":{"line":21,"column":4},"end":{"line":22,"column":49}}],"line":21},"9":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":54,"20":54,"21":53,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":0,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":2,"8":54,"9":1,"10":1,"11":1,"12":1,"13":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[53,1],"9":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/guardianFactorTemplates.ts","sources":["/home/circleci/repo/src/context/directory/handlers/guardianFactorTemplates.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAE3C,0CAA+E;AAO/E,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,qBAAqB,GAAG,cAAI,CAAC,IAAI,CACrC,OAAO,CAAC,QAAQ,EAChB,iBAAS,CAAC,kBAAkB,EAC5B,iBAAS,CAAC,4BAA4B,CACvC,CAAC;IACF,IAAI,CAAC,IAAA,uBAAe,EAAC,qBAAqB,CAAC;QAAE,OAAO,EAAE,uBAAuB,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAE9F,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,qBAAqB,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAE9D,MAAM,uBAAuB,GAAG,UAAU;SACvC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CACT,IAAA,gBAAQ,EAAC,CAAC,EAAE;QACV,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CACH;SACA,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,2CAA2C;IAExF,OAAO;QACL,uBAAuB;KACxB,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,uBAAuB,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEnD,IAAI,CAAC,uBAAuB;YAAE,OAAO,CAAC,wBAAwB;QAE9D,MAAM,qBAAqB,GAAG,cAAI,CAAC,IAAI,CACrC,OAAO,CAAC,QAAQ,EAChB,iBAAS,CAAC,kBAAkB,EAC5B,iBAAS,CAAC,4BAA4B,CACvC,CAAC;QACF,kBAAE,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC;QAExC,uBAAuB,CAAC,OAAO,CAAC,CAAC,eAAe,EAAE,EAAE;YAClD,MAAM,mBAAmB,GAAG,cAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE,GAAG,eAAe,CAAC,IAAI,OAAO,CAAC,CAAC;YAC7F,IAAA,gBAAQ,EAAC,mBAAmB,EAAE,eAAe,CAAC,CAAC;QACjD,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,8BAA8B,GAAoD;IACtF,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,8BAA8B,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianFactorTemplates = ParsedAsset<'guardianFactorTemplates', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedGuardianFactorTemplates {\n  const factorTemplatesFolder = path.join(\n    context.filePath,\n    constants.GUARDIAN_DIRECTORY,\n    constants.GUARDIAN_TEMPLATES_DIRECTORY\n  );\n  if (!existsMustBeDir(factorTemplatesFolder)) return { guardianFactorTemplates: null }; // Skip\n\n  const foundFiles = getFiles(factorTemplatesFolder, ['.json']);\n\n  const guardianFactorTemplates = foundFiles\n    .map((f) =>\n      loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      })\n    )\n    .filter((p) => Object.keys(p).length > 0); // Filter out empty guardianFactorTemplates\n\n  return {\n    guardianFactorTemplates,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { guardianFactorTemplates } = context.assets;\n\n  if (!guardianFactorTemplates) return; // Skip, nothing to dump\n\n  const factorTemplatesFolder = path.join(\n    context.filePath,\n    constants.GUARDIAN_DIRECTORY,\n    constants.GUARDIAN_TEMPLATES_DIRECTORY\n  );\n  fs.ensureDirSync(factorTemplatesFolder);\n\n  guardianFactorTemplates.forEach((factorTemplates) => {\n    const factorTemplatesFile = path.join(factorTemplatesFolder, `${factorTemplates.name}.json`);\n    dumpJSON(factorTemplatesFile, factorTemplates);\n  });\n}\n\nconst guardianFactorTemplatesHandler: DirectoryHandler<ParsedGuardianFactorTemplates> = {\n  parse,\n  dump,\n};\n\nexport default guardianFactorTemplatesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"08727367e9d839ac11696ae136431bfc58d52954","contentHash":"ea563a15e97a5fb8794cc268c3fbf27dd2edd96d7d16c39054ae2bda554b3159"},"/home/circleci/repo/src/context/directory/handlers/guardianPhoneFactorMessageTypes.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/guardianPhoneFactorMessageTypes.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":27},"end":{"line":20,"column":102}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":57}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":57}},"22":{"start":{"line":23,"column":17},"end":{"line":23,"column":84}},"23":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"24":{"start":{"line":25,"column":8},"end":{"line":25,"column":57}},"25":{"start":{"line":27,"column":4},"end":{"line":32,"column":6}},"26":{"start":{"line":35,"column":4},"end":{"line":43,"column":7}},"27":{"start":{"line":36,"column":52},"end":{"line":36,"column":66}},"28":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"29":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"30":{"start":{"line":39,"column":31},"end":{"line":39,"column":106}},"31":{"start":{"line":40,"column":8},"end":{"line":40,"column":57}},"32":{"start":{"line":41,"column":21},"end":{"line":41,"column":88}},"33":{"start":{"line":42,"column":8},"end":{"line":42,"column":69}},"34":{"start":{"line":45,"column":42},"end":{"line":48,"column":1}},"35":{"start":{"line":49,"column":0},"end":{"line":49,"column":52}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":44,"column":1}},"line":34},"10":{"name":"(anonymous_10)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":43,"column":5}},"line":35}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":57}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":57}},{"start":{"line":21,"column":4},"end":{"line":22,"column":57}}],"line":21},"9":{"loc":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},{"start":{"line":24,"column":4},"end":{"line":26,"column":5}}],"line":24},"10":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":54,"20":54,"21":48,"22":6,"23":6,"24":5,"25":1,"26":1,"27":1,"28":1,"29":0,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":2,"8":54,"9":1,"10":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[48,6],"9":[5,1],"10":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/guardianPhoneFactorMessageTypes.ts","sources":["/home/circleci/repo/src/context/directory/handlers/guardianPhoneFactorMessageTypes.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAC3C,0CAA6E;AAO7E,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,kBAAkB,CAAC,CAAC;IACjF,IAAI,CAAC,IAAA,uBAAe,EAAC,cAAc,CAAC;QAAE,OAAO,EAAE,+BAA+B,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAE/F,MAAM,IAAI,GAAG,cAAI,CAAC,IAAI,CAAC,cAAc,EAAE,8BAA8B,CAAC,CAAC;IAEvE,IAAI,CAAC,IAAA,cAAM,EAAC,IAAI,CAAC,EAAE;QACjB,OAAO,EAAE,+BAA+B,EAAE,IAAI,EAAE,CAAC;KAClD;IAED,OAAO;QACL,+BAA+B,EAAE,IAAA,gBAAQ,EAAC,IAAI,EAAE;YAC9C,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAC;KACH,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,+BAA+B,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE3D,IAAI,CAAC,+BAA+B;YAAE,OAAO,CAAC,wBAAwB;QAEtE,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,kBAAkB,CAAC,CAAC;QACjF,kBAAE,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;QAEjC,MAAM,IAAI,GAAG,cAAI,CAAC,IAAI,CAAC,cAAc,EAAE,8BAA8B,CAAC,CAAC;QACvE,IAAA,gBAAQ,EAAC,IAAI,EAAE,+BAA+B,CAAC,CAAC;IAClD,CAAC;CAAA;AAED,MAAM,iCAAiC,GAAuD;IAC5F,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,iCAAiC,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { existsMustBeDir, dumpJSON, loadJSON, isFile } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianFactorMessageTypes = ParsedAsset<'guardianPhoneFactorMessageTypes', Asset>;\n\nfunction parse(context: DirectoryContext): ParsedGuardianFactorMessageTypes {\n  const guardianFolder = path.join(context.filePath, constants.GUARDIAN_DIRECTORY);\n  if (!existsMustBeDir(guardianFolder)) return { guardianPhoneFactorMessageTypes: null }; // Skip\n\n  const file = path.join(guardianFolder, 'phoneFactorMessageTypes.json');\n\n  if (!isFile(file)) {\n    return { guardianPhoneFactorMessageTypes: null };\n  }\n\n  return {\n    guardianPhoneFactorMessageTypes: loadJSON(file, {\n      mappings: context.mappings,\n      disableKeywordReplacement: context.disableKeywordReplacement,\n    }),\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { guardianPhoneFactorMessageTypes } = context.assets;\n\n  if (!guardianPhoneFactorMessageTypes) return; // Skip, nothing to dump\n\n  const guardianFolder = path.join(context.filePath, constants.GUARDIAN_DIRECTORY);\n  fs.ensureDirSync(guardianFolder);\n\n  const file = path.join(guardianFolder, 'phoneFactorMessageTypes.json');\n  dumpJSON(file, guardianPhoneFactorMessageTypes);\n}\n\nconst guardianFactorMessageTypesHandler: DirectoryHandler<ParsedGuardianFactorMessageTypes> = {\n  parse,\n  dump,\n};\n\nexport default guardianFactorMessageTypesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"08e03385b37240280e7cf62065f16a6b36b93fdf","contentHash":"9c9cebe358f3bb79debe158c8c8a0adaf35c5c0018a02e1c3452b29fb772c382"},"/home/circleci/repo/src/context/directory/handlers/guardianPhoneFactorSelectedProvider.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/guardianPhoneFactorSelectedProvider.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":27},"end":{"line":20,"column":102}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":61}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":61}},"22":{"start":{"line":23,"column":17},"end":{"line":23,"column":88}},"23":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"24":{"start":{"line":25,"column":8},"end":{"line":25,"column":61}},"25":{"start":{"line":27,"column":4},"end":{"line":32,"column":6}},"26":{"start":{"line":35,"column":4},"end":{"line":43,"column":7}},"27":{"start":{"line":36,"column":56},"end":{"line":36,"column":70}},"28":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"29":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"30":{"start":{"line":39,"column":31},"end":{"line":39,"column":106}},"31":{"start":{"line":40,"column":8},"end":{"line":40,"column":57}},"32":{"start":{"line":41,"column":21},"end":{"line":41,"column":92}},"33":{"start":{"line":42,"column":8},"end":{"line":42,"column":73}},"34":{"start":{"line":45,"column":46},"end":{"line":48,"column":1}},"35":{"start":{"line":49,"column":0},"end":{"line":49,"column":56}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":44,"column":1}},"line":34},"10":{"name":"(anonymous_10)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":43,"column":5}},"line":35}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":61}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":61}},{"start":{"line":21,"column":4},"end":{"line":22,"column":61}}],"line":21},"9":{"loc":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},{"start":{"line":24,"column":4},"end":{"line":26,"column":5}}],"line":24},"10":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":54,"20":54,"21":48,"22":6,"23":6,"24":5,"25":1,"26":1,"27":1,"28":1,"29":0,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":2,"8":54,"9":1,"10":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[48,6],"9":[5,1],"10":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/guardianPhoneFactorSelectedProvider.ts","sources":["/home/circleci/repo/src/context/directory/handlers/guardianPhoneFactorSelectedProvider.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAC3C,0CAA6E;AAU7E,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,kBAAkB,CAAC,CAAC;IACjF,IAAI,CAAC,IAAA,uBAAe,EAAC,cAAc,CAAC;QAAE,OAAO,EAAE,mCAAmC,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAEnG,MAAM,IAAI,GAAG,cAAI,CAAC,IAAI,CAAC,cAAc,EAAE,kCAAkC,CAAC,CAAC;IAE3E,IAAI,CAAC,IAAA,cAAM,EAAC,IAAI,CAAC,EAAE;QACjB,OAAO,EAAE,mCAAmC,EAAE,IAAI,EAAE,CAAC;KACtD;IAED,OAAO;QACL,mCAAmC,EAAE,IAAA,gBAAQ,EAAC,IAAI,EAAE;YAClD,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAC;KACH,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,mCAAmC,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE/D,IAAI,CAAC,mCAAmC;YAAE,OAAO,CAAC,wBAAwB;QAE1E,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,kBAAkB,CAAC,CAAC;QACjF,kBAAE,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;QAEjC,MAAM,IAAI,GAAG,cAAI,CAAC,IAAI,CAAC,cAAc,EAAE,kCAAkC,CAAC,CAAC;QAC3E,IAAA,gBAAQ,EAAC,IAAI,EAAE,mCAAmC,CAAC,CAAC;IACtD,CAAC;CAAA;AAED,MAAM,qCAAqC,GACzC;IACE,KAAK;IACL,IAAI;CACL,CAAC;AAEJ,kBAAe,qCAAqC,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { existsMustBeDir, dumpJSON, loadJSON, isFile } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianFactorSelectedProvider = ParsedAsset<\n  'guardianPhoneFactorSelectedProvider',\n  Asset\n>;\n\nfunction parse(context: DirectoryContext): ParsedGuardianFactorSelectedProvider {\n  const guardianFolder = path.join(context.filePath, constants.GUARDIAN_DIRECTORY);\n  if (!existsMustBeDir(guardianFolder)) return { guardianPhoneFactorSelectedProvider: null }; // Skip\n\n  const file = path.join(guardianFolder, 'phoneFactorSelectedProvider.json');\n\n  if (!isFile(file)) {\n    return { guardianPhoneFactorSelectedProvider: null };\n  }\n\n  return {\n    guardianPhoneFactorSelectedProvider: loadJSON(file, {\n      mappings: context.mappings,\n      disableKeywordReplacement: context.disableKeywordReplacement,\n    }),\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { guardianPhoneFactorSelectedProvider } = context.assets;\n\n  if (!guardianPhoneFactorSelectedProvider) return; // Skip, nothing to dump\n\n  const guardianFolder = path.join(context.filePath, constants.GUARDIAN_DIRECTORY);\n  fs.ensureDirSync(guardianFolder);\n\n  const file = path.join(guardianFolder, 'phoneFactorSelectedProvider.json');\n  dumpJSON(file, guardianPhoneFactorSelectedProvider);\n}\n\nconst guardianFactorSelectedProviderHandler: DirectoryHandler<ParsedGuardianFactorSelectedProvider> =\n  {\n    parse,\n    dump,\n  };\n\nexport default guardianFactorSelectedProviderHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4ba1fb0ba7cd46f3edcb606971d8db118125e9e4","contentHash":"f991e585726c542fa6d474fca1fd63b945480825e22f35aebd0c1724b1a6ab0c"},"/home/circleci/repo/src/context/directory/handlers/guardianPolicies.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/guardianPolicies.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":27},"end":{"line":20,"column":102}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":42}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":42}},"22":{"start":{"line":23,"column":17},"end":{"line":23,"column":69}},"23":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"24":{"start":{"line":25,"column":8},"end":{"line":25,"column":42}},"25":{"start":{"line":27,"column":4},"end":{"line":32,"column":6}},"26":{"start":{"line":35,"column":4},"end":{"line":43,"column":7}},"27":{"start":{"line":36,"column":37},"end":{"line":36,"column":51}},"28":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"29":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"30":{"start":{"line":39,"column":31},"end":{"line":39,"column":106}},"31":{"start":{"line":40,"column":8},"end":{"line":40,"column":57}},"32":{"start":{"line":41,"column":21},"end":{"line":41,"column":73}},"33":{"start":{"line":42,"column":8},"end":{"line":42,"column":54}},"34":{"start":{"line":45,"column":32},"end":{"line":48,"column":1}},"35":{"start":{"line":49,"column":0},"end":{"line":49,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":44,"column":1}},"line":34},"10":{"name":"(anonymous_10)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":43,"column":5}},"line":35}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":42}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":42}},{"start":{"line":21,"column":4},"end":{"line":22,"column":42}}],"line":21},"9":{"loc":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},{"start":{"line":24,"column":4},"end":{"line":26,"column":5}}],"line":24},"10":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":54,"20":54,"21":48,"22":6,"23":6,"24":5,"25":1,"26":1,"27":1,"28":1,"29":0,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":2,"8":54,"9":1,"10":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[48,6],"9":[5,1],"10":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/guardianPolicies.ts","sources":["/home/circleci/repo/src/context/directory/handlers/guardianPolicies.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAC3C,0CAA6E;AAO7E,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,kBAAkB,CAAC,CAAC;IACjF,IAAI,CAAC,IAAA,uBAAe,EAAC,cAAc,CAAC;QAAE,OAAO,EAAE,gBAAgB,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAEhF,MAAM,IAAI,GAAG,cAAI,CAAC,IAAI,CAAC,cAAc,EAAE,eAAe,CAAC,CAAC;IAExD,IAAI,CAAC,IAAA,cAAM,EAAC,IAAI,CAAC,EAAE;QACjB,OAAO,EAAE,gBAAgB,EAAE,IAAI,EAAE,CAAC;KACnC;IAED,OAAO;QACL,gBAAgB,EAAE,IAAA,gBAAQ,EAAC,IAAI,EAAE;YAC/B,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAC;KACH,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,gBAAgB,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE5C,IAAI,CAAC,gBAAgB;YAAE,OAAO,CAAC,wBAAwB;QAEvD,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,kBAAkB,CAAC,CAAC;QACjF,kBAAE,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;QAEjC,MAAM,IAAI,GAAG,cAAI,CAAC,IAAI,CAAC,cAAc,EAAE,eAAe,CAAC,CAAC;QACxD,IAAA,gBAAQ,EAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC;IACnC,CAAC;CAAA;AAED,MAAM,uBAAuB,GAA6C;IACxE,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,uBAAuB,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { existsMustBeDir, dumpJSON, loadJSON, isFile } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedGuardianPolicies = ParsedAsset<'guardianPolicies', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedGuardianPolicies {\n  const guardianFolder = path.join(context.filePath, constants.GUARDIAN_DIRECTORY);\n  if (!existsMustBeDir(guardianFolder)) return { guardianPolicies: null }; // Skip\n\n  const file = path.join(guardianFolder, 'policies.json');\n\n  if (!isFile(file)) {\n    return { guardianPolicies: null };\n  }\n\n  return {\n    guardianPolicies: loadJSON(file, {\n      mappings: context.mappings,\n      disableKeywordReplacement: context.disableKeywordReplacement,\n    }),\n  };\n}\n\nasync function dump(context: DirectoryContext) {\n  const { guardianPolicies } = context.assets;\n\n  if (!guardianPolicies) return; // Skip, nothing to dump\n\n  const guardianFolder = path.join(context.filePath, constants.GUARDIAN_DIRECTORY);\n  fs.ensureDirSync(guardianFolder);\n\n  const file = path.join(guardianFolder, 'policies.json');\n  dumpJSON(file, guardianPolicies);\n}\n\nconst guardianPoliciesHandler: DirectoryHandler<ParsedGuardianPolicies> = {\n  parse,\n  dump,\n};\n\nexport default guardianPoliciesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2182bf73f90cba7e5667542f6633a13f2f4deffd","contentHash":"0ec68f41a2a0b9bdc22d42838560a692a85e2585a7b1bdd05731570205ca7e63"},"/home/circleci/repo/src/context/directory/handlers/roles.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/roles.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":60}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"20":{"start":{"line":21,"column":24},"end":{"line":21,"column":96}},"21":{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":31}},"23":{"start":{"line":24,"column":18},"end":{"line":24,"column":63}},"24":{"start":{"line":25,"column":18},"end":{"line":31,"column":6}},"25":{"start":{"line":26,"column":21},"end":{"line":29,"column":11}},"26":{"start":{"line":30,"column":8},"end":{"line":30,"column":20}},"27":{"start":{"line":32,"column":4},"end":{"line":34,"column":6}},"28":{"start":{"line":37,"column":4},"end":{"line":53,"column":7}},"29":{"start":{"line":38,"column":26},"end":{"line":38,"column":40}},"30":{"start":{"line":40,"column":8},"end":{"line":41,"column":19}},"31":{"start":{"line":41,"column":12},"end":{"line":41,"column":19}},"32":{"start":{"line":42,"column":28},"end":{"line":42,"column":100}},"33":{"start":{"line":43,"column":8},"end":{"line":43,"column":54}},"34":{"start":{"line":44,"column":8},"end":{"line":52,"column":11}},"35":{"start":{"line":45,"column":29},"end":{"line":45,"column":105}},"36":{"start":{"line":46,"column":12},"end":{"line":46,"column":57}},"37":{"start":{"line":48,"column":12},"end":{"line":50,"column":13}},"38":{"start":{"line":49,"column":16},"end":{"line":49,"column":40}},"39":{"start":{"line":51,"column":12},"end":{"line":51,"column":50}},"40":{"start":{"line":55,"column":21},"end":{"line":58,"column":1}},"41":{"start":{"line":59,"column":0},"end":{"line":59,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":35,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":28},"end":{"line":25,"column":29}},"loc":{"start":{"line":25,"column":35},"end":{"line":31,"column":5}},"line":25},"10":{"name":"dump","decl":{"start":{"line":36,"column":9},"end":{"line":36,"column":13}},"loc":{"start":{"line":36,"column":23},"end":{"line":54,"column":1}},"line":36},"11":{"name":"(anonymous_11)","decl":{"start":{"line":37,"column":43},"end":{"line":37,"column":44}},"loc":{"start":{"line":37,"column":56},"end":{"line":53,"column":5}},"line":37},"12":{"name":"(anonymous_12)","decl":{"start":{"line":44,"column":22},"end":{"line":44,"column":23}},"loc":{"start":{"line":44,"column":32},"end":{"line":52,"column":9}},"line":44}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":31}},{"start":{"line":22,"column":4},"end":{"line":23,"column":31}}],"line":22},"9":{"loc":{"start":{"line":40,"column":8},"end":{"line":41,"column":19}},"type":"if","locations":[{"start":{"line":40,"column":8},"end":{"line":41,"column":19}},{"start":{"line":40,"column":8},"end":{"line":41,"column":19}}],"line":40},"10":{"loc":{"start":{"line":40,"column":12},"end":{"line":40,"column":50}},"type":"binary-expr","locations":[{"start":{"line":40,"column":12},"end":{"line":40,"column":18}},{"start":{"line":40,"column":22},"end":{"line":40,"column":50}}],"line":40},"11":{"loc":{"start":{"line":48,"column":12},"end":{"line":50,"column":13}},"type":"if","locations":[{"start":{"line":48,"column":12},"end":{"line":50,"column":13}},{"start":{"line":48,"column":12},"end":{"line":50,"column":13}}],"line":48}},"s":{"0":1,"1":0,"2":0,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":2,"11":2,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":54,"21":54,"22":51,"23":2,"24":2,"25":4,"26":4,"27":2,"28":2,"29":2,"30":2,"31":1,"32":1,"33":1,"34":1,"35":2,"36":2,"37":2,"38":0,"39":2,"40":1,"41":1},"f":{"0":2,"1":0,"2":0,"3":2,"4":0,"5":0,"6":2,"7":3,"8":54,"9":4,"10":2,"11":2,"12":2},"b":{"0":[1,1,1],"1":[0,0],"2":[2,2],"3":[2,0],"4":[2,2],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[51,2],"9":[1,1],"10":[2,2],"11":[0,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/roles.ts","sources":["/home/circleci/repo/src/context/directory/handlers/roles.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAE3C,6DAAkC;AAClC,0CAAyF;AAOzF,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,eAAe,CAAC,CAAC;IAC3E,IAAI,CAAC,IAAA,uBAAe,EAAC,WAAW,CAAC;QAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAElE,MAAM,KAAK,GAAG,IAAA,gBAAQ,EAAC,WAAW,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAE/C,MAAM,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;QAC5B,MAAM,IAAI,qBACL,IAAA,gBAAQ,EAAC,CAAC,EAAE;YACb,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAC,CACH,CAAC;QACF,OAAO,IAAI,CAAC;IACd,CAAC,CAAC,CAAC;IAEH,OAAO;QACL,KAAK;KACN,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEjC,uDAAuD;QACvD,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,WAAW,KAAK,MAAM;YAAE,OAAO,CAAC,wBAAwB;QAE5E,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,eAAe,CAAC,CAAC;QAC3E,kBAAE,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QAE9B,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;YACrB,MAAM,QAAQ,GAAG,cAAI,CAAC,IAAI,CAAC,WAAW,EAAE,IAAA,gBAAQ,EAAC,GAAG,IAAI,CAAC,IAAI,OAAO,CAAC,CAAC,CAAC;YACvE,gBAAG,CAAC,IAAI,CAAC,WAAW,QAAQ,EAAE,CAAC,CAAC;YAEhC,2BAA2B;YAC3B,IAAI,IAAI,CAAC,WAAW,KAAK,IAAI,EAAE;gBAC7B,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;YAED,IAAA,gBAAQ,EAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAC3B,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,YAAY,GAAkC;IAClD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,YAAY,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport log from '../../../logger';\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON, sanitize } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedRoles = ParsedAsset<'roles', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedRoles {\n  const rolesFolder = path.join(context.filePath, constants.ROLES_DIRECTORY);\n  if (!existsMustBeDir(rolesFolder)) return { roles: null }; // Skip\n\n  const files = getFiles(rolesFolder, ['.json']);\n\n  const roles = files.map((f) => {\n    const role = {\n      ...loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }),\n    };\n    return role;\n  });\n\n  return {\n    roles,\n  };\n}\n\nasync function dump(context: DirectoryContext) {\n  const { roles } = context.assets;\n\n  // API returns an empty object if no grants are present\n  if (!roles || roles.constructor === Object) return; // Skip, nothing to dump\n\n  const rolesFolder = path.join(context.filePath, constants.ROLES_DIRECTORY);\n  fs.ensureDirSync(rolesFolder);\n\n  roles.forEach((role) => {\n    const roleFile = path.join(rolesFolder, sanitize(`${role.name}.json`));\n    log.info(`Writing ${roleFile}`);\n\n    // remove empty description\n    if (role.description === null) {\n      delete role.description;\n    }\n\n    dumpJSON(roleFile, role);\n  });\n}\n\nconst rolesHandler: DirectoryHandler<ParsedRoles> = {\n  parse,\n  dump,\n};\n\nexport default rolesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f8405cde250c156f137be655528e8e72155cc854","contentHash":"11defab5cf225aba8306f5b40065f71a3f3a882c8f32050ede90d31af6b83fcb"},"/home/circleci/repo/src/context/directory/handlers/migrations.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/migrations.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":16},"end":{"line":16,"column":41}},"17":{"start":{"line":18,"column":23},"end":{"line":18,"column":60}},"18":{"start":{"line":19,"column":4},"end":{"line":20,"column":36}},"19":{"start":{"line":20,"column":8},"end":{"line":20,"column":36}},"20":{"start":{"line":21,"column":27},"end":{"line":21,"column":77}},"21":{"start":{"line":22,"column":4},"end":{"line":23,"column":36}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":36}},"23":{"start":{"line":25,"column":23},"end":{"line":28,"column":6}},"24":{"start":{"line":29,"column":4},"end":{"line":29,"column":26}},"25":{"start":{"line":32,"column":4},"end":{"line":38,"column":7}},"26":{"start":{"line":33,"column":31},"end":{"line":33,"column":45}},"27":{"start":{"line":34,"column":8},"end":{"line":35,"column":19}},"28":{"start":{"line":35,"column":12},"end":{"line":35,"column":19}},"29":{"start":{"line":36,"column":31},"end":{"line":36,"column":87}},"30":{"start":{"line":37,"column":8},"end":{"line":37,"column":58}},"31":{"start":{"line":40,"column":26},"end":{"line":43,"column":1}},"32":{"start":{"line":44,"column":0},"end":{"line":44,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":17,"column":9},"end":{"line":17,"column":14}},"loc":{"start":{"line":17,"column":24},"end":{"line":30,"column":1}},"line":17},"9":{"name":"dump","decl":{"start":{"line":31,"column":9},"end":{"line":31,"column":13}},"loc":{"start":{"line":31,"column":23},"end":{"line":39,"column":1}},"line":31},"10":{"name":"(anonymous_10)","decl":{"start":{"line":32,"column":43},"end":{"line":32,"column":44}},"loc":{"start":{"line":32,"column":56},"end":{"line":38,"column":5}},"line":32}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":19,"column":4},"end":{"line":20,"column":36}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":20,"column":36}},{"start":{"line":19,"column":4},"end":{"line":20,"column":36}}],"line":19},"9":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":36}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":36}},{"start":{"line":22,"column":4},"end":{"line":23,"column":36}}],"line":22},"10":{"loc":{"start":{"line":34,"column":8},"end":{"line":35,"column":19}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":35,"column":19}},{"start":{"line":34,"column":8},"end":{"line":35,"column":19}}],"line":34},"11":{"loc":{"start":{"line":34,"column":12},"end":{"line":34,"column":63}},"type":"binary-expr","locations":[{"start":{"line":34,"column":12},"end":{"line":34,"column":23}},{"start":{"line":34,"column":27},"end":{"line":34,"column":63}}],"line":34}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":54,"18":54,"19":0,"20":54,"21":54,"22":53,"23":1,"24":1,"25":1,"26":1,"27":1,"28":0,"29":1,"30":1,"31":1,"32":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":1,"8":54,"9":1,"10":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,1],"7":[1,1],"8":[0,54],"9":[53,1],"10":[0,1],"11":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/migrations.ts","sources":["/home/circleci/repo/src/context/directory/handlers/migrations.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,0CAA6E;AAO7E,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAC/C,IAAI,CAAC,IAAA,uBAAe,EAAC,UAAU,CAAC;QAAE,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAEtE,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,UAAU,EAAE,iBAAiB,CAAC,CAAC;IAEhE,IAAI,CAAC,IAAA,cAAM,EAAC,cAAc,CAAC;QAAE,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;IAEzD,8BAA8B;IAC9B,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,cAAc,EAAE;QAC1C,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CAAC;IAEH,OAAO,EAAE,UAAU,EAAE,CAAC;AACxB,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,UAAU,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEtC,IAAI,CAAC,UAAU,IAAI,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,MAAM,KAAK,CAAC;YAAE,OAAO,CAAC,wBAAwB;QAEzF,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAiB,CAAC,CAAC;QACtE,IAAA,gBAAQ,EAAC,cAAc,EAAE,UAAU,CAAC,CAAC;IACvC,CAAC;CAAA;AAED,MAAM,iBAAiB,GAAuC;IAC5D,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,iBAAiB,CAAC","sourcesContent":["import path from 'path';\nimport { existsMustBeDir, isFile, dumpJSON, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedMigrations = ParsedAsset<'migrations', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedMigrations {\n  const baseFolder = path.join(context.filePath);\n  if (!existsMustBeDir(baseFolder)) return { migrations: null }; // Skip\n\n  const migrationsFile = path.join(baseFolder, 'migrations.json');\n\n  if (!isFile(migrationsFile)) return { migrations: null };\n\n  /* eslint-disable camelcase */\n  const migrations = loadJSON(migrationsFile, {\n    mappings: context.mappings,\n    disableKeywordReplacement: context.disableKeywordReplacement,\n  });\n\n  return { migrations };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { migrations } = context.assets;\n\n  if (!migrations || Object.keys(migrations).length === 0) return; // Skip, nothing to dump\n\n  const migrationsFile = path.join(context.filePath, 'migrations.json');\n  dumpJSON(migrationsFile, migrations);\n}\n\nconst migrationsHandler: DirectoryHandler<ParsedMigrations> = {\n  parse,\n  dump,\n};\n\nexport default migrationsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a4fc174e9c91f38954da72a1c9545458616ea424","contentHash":"b8663ef0ce381ddd7212bad767ea0dbc0e7ed39c34f3abb53a47a79797f50998"},"/home/circleci/repo/src/context/directory/handlers/actions.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/actions.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":16,"column":15},"end":{"line":16,"column":47}},"16":{"start":{"line":17,"column":19},"end":{"line":17,"column":55}},"17":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"18":{"start":{"line":19,"column":16},"end":{"line":19,"column":41}},"19":{"start":{"line":20,"column":17},"end":{"line":20,"column":60}},"20":{"start":{"line":21,"column":18},"end":{"line":21,"column":66}},"21":{"start":{"line":23,"column":26},"end":{"line":23,"column":100}},"22":{"start":{"line":24,"column":4},"end":{"line":25,"column":33}},"23":{"start":{"line":25,"column":8},"end":{"line":25,"column":33}},"24":{"start":{"line":26,"column":18},"end":{"line":26,"column":65}},"25":{"start":{"line":27,"column":20},"end":{"line":38,"column":6}},"26":{"start":{"line":28,"column":23},"end":{"line":31,"column":11}},"27":{"start":{"line":32,"column":29},"end":{"line":32,"column":103}},"28":{"start":{"line":33,"column":8},"end":{"line":36,"column":9}},"29":{"start":{"line":34,"column":31},"end":{"line":34,"column":111}},"30":{"start":{"line":34,"column":45},"end":{"line":34,"column":111}},"31":{"start":{"line":35,"column":12},"end":{"line":35,"column":82}},"32":{"start":{"line":37,"column":8},"end":{"line":37,"column":22}},"33":{"start":{"line":39,"column":4},"end":{"line":39,"column":23}},"34":{"start":{"line":42,"column":4},"end":{"line":44,"column":5}},"35":{"start":{"line":43,"column":8},"end":{"line":43,"column":85}},"36":{"start":{"line":43,"column":40},"end":{"line":43,"column":82}},"37":{"start":{"line":45,"column":4},"end":{"line":45,"column":14}},"38":{"start":{"line":48,"column":21},"end":{"line":48,"column":27}},"39":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"40":{"start":{"line":50,"column":8},"end":{"line":50,"column":18}},"41":{"start":{"line":52,"column":23},"end":{"line":52,"column":57}},"42":{"start":{"line":53,"column":25},"end":{"line":53,"column":108}},"43":{"start":{"line":54,"column":4},"end":{"line":54,"column":51}},"44":{"start":{"line":55,"column":21},"end":{"line":55,"column":65}},"45":{"start":{"line":56,"column":4},"end":{"line":56,"column":49}},"46":{"start":{"line":57,"column":4},"end":{"line":57,"column":53}},"47":{"start":{"line":58,"column":4},"end":{"line":58,"column":25}},"48":{"start":{"line":61,"column":4},"end":{"line":71,"column":6}},"49":{"start":{"line":74,"column":4},"end":{"line":96,"column":7}},"50":{"start":{"line":75,"column":28},"end":{"line":75,"column":42}},"51":{"start":{"line":76,"column":8},"end":{"line":77,"column":19}},"52":{"start":{"line":77,"column":12},"end":{"line":77,"column":19}},"53":{"start":{"line":79,"column":32},"end":{"line":85,"column":10}},"54":{"start":{"line":80,"column":12},"end":{"line":83,"column":13}},"55":{"start":{"line":81,"column":16},"end":{"line":81,"column":160}},"56":{"start":{"line":82,"column":16},"end":{"line":82,"column":29}},"57":{"start":{"line":84,"column":12},"end":{"line":84,"column":24}},"58":{"start":{"line":87,"column":30},"end":{"line":87,"column":104}},"59":{"start":{"line":88,"column":8},"end":{"line":88,"column":56}},"60":{"start":{"line":89,"column":8},"end":{"line":95,"column":11}},"61":{"start":{"line":91,"column":25},"end":{"line":91,"column":59}},"62":{"start":{"line":92,"column":31},"end":{"line":92,"column":81}},"63":{"start":{"line":93,"column":12},"end":{"line":93,"column":59}},"64":{"start":{"line":94,"column":12},"end":{"line":94,"column":121}},"65":{"start":{"line":98,"column":23},"end":{"line":101,"column":1}},"66":{"start":{"line":102,"column":0},"end":{"line":102,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":22,"column":9},"end":{"line":22,"column":14}},"loc":{"start":{"line":22,"column":24},"end":{"line":40,"column":1}},"line":22},"9":{"name":"(anonymous_9)","decl":{"start":{"line":27,"column":30},"end":{"line":27,"column":31}},"loc":{"start":{"line":27,"column":40},"end":{"line":38,"column":5}},"line":27},"10":{"name":"(anonymous_10)","decl":{"start":{"line":34,"column":31},"end":{"line":34,"column":32}},"loc":{"start":{"line":34,"column":45},"end":{"line":34,"column":111}},"line":34},"11":{"name":"mapSecrets","decl":{"start":{"line":41,"column":9},"end":{"line":41,"column":19}},"loc":{"start":{"line":41,"column":29},"end":{"line":46,"column":1}},"line":41},"12":{"name":"(anonymous_12)","decl":{"start":{"line":43,"column":27},"end":{"line":43,"column":28}},"loc":{"start":{"line":43,"column":40},"end":{"line":43,"column":82}},"line":43},"13":{"name":"mapActionCode","decl":{"start":{"line":47,"column":9},"end":{"line":47,"column":22}},"loc":{"start":{"line":47,"column":41},"end":{"line":59,"column":1}},"line":47},"14":{"name":"mapToAction","decl":{"start":{"line":60,"column":9},"end":{"line":60,"column":20}},"loc":{"start":{"line":60,"column":39},"end":{"line":72,"column":1}},"line":60},"15":{"name":"dump","decl":{"start":{"line":73,"column":9},"end":{"line":73,"column":13}},"loc":{"start":{"line":73,"column":23},"end":{"line":97,"column":1}},"line":73},"16":{"name":"(anonymous_16)","decl":{"start":{"line":74,"column":43},"end":{"line":74,"column":44}},"loc":{"start":{"line":74,"column":56},"end":{"line":96,"column":5}},"line":74},"17":{"name":"(anonymous_17)","decl":{"start":{"line":79,"column":47},"end":{"line":79,"column":48}},"loc":{"start":{"line":79,"column":59},"end":{"line":85,"column":9}},"line":79},"18":{"name":"(anonymous_18)","decl":{"start":{"line":89,"column":32},"end":{"line":89,"column":33}},"loc":{"start":{"line":89,"column":44},"end":{"line":95,"column":9}},"line":89}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":24,"column":4},"end":{"line":25,"column":33}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":25,"column":33}},{"start":{"line":24,"column":4},"end":{"line":25,"column":33}}],"line":24},"9":{"loc":{"start":{"line":33,"column":8},"end":{"line":36,"column":9}},"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":36,"column":9}},{"start":{"line":33,"column":8},"end":{"line":36,"column":9}}],"line":33},"10":{"loc":{"start":{"line":42,"column":4},"end":{"line":44,"column":5}},"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":44,"column":5}},{"start":{"line":42,"column":4},"end":{"line":44,"column":5}}],"line":42},"11":{"loc":{"start":{"line":42,"column":8},"end":{"line":42,"column":37}},"type":"binary-expr","locations":[{"start":{"line":42,"column":8},"end":{"line":42,"column":15}},{"start":{"line":42,"column":19},"end":{"line":42,"column":37}}],"line":42},"12":{"loc":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},{"start":{"line":49,"column":4},"end":{"line":51,"column":5}}],"line":49},"13":{"loc":{"start":{"line":69,"column":18},"end":{"line":69,"column":64}},"type":"binary-expr","locations":[{"start":{"line":69,"column":18},"end":{"line":69,"column":33}},{"start":{"line":69,"column":37},"end":{"line":69,"column":64}}],"line":69},"14":{"loc":{"start":{"line":76,"column":8},"end":{"line":77,"column":19}},"type":"if","locations":[{"start":{"line":76,"column":8},"end":{"line":77,"column":19}},{"start":{"line":76,"column":8},"end":{"line":77,"column":19}}],"line":76},"15":{"loc":{"start":{"line":80,"column":12},"end":{"line":83,"column":13}},"type":"if","locations":[{"start":{"line":80,"column":12},"end":{"line":83,"column":13}},{"start":{"line":80,"column":12},"end":{"line":83,"column":13}}],"line":80}},"s":{"0":1,"1":0,"2":0,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":2,"11":2,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":53,"22":53,"23":49,"24":3,"25":3,"26":3,"27":3,"28":3,"29":3,"30":3,"31":3,"32":3,"33":3,"34":1,"35":0,"36":0,"37":1,"38":1,"39":1,"40":0,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":2,"50":2,"51":2,"52":0,"53":2,"54":2,"55":1,"56":1,"57":1,"58":2,"59":2,"60":2,"61":1,"62":1,"63":1,"64":1,"65":1,"66":1},"f":{"0":2,"1":0,"2":0,"3":2,"4":0,"5":0,"6":2,"7":3,"8":53,"9":3,"10":3,"11":1,"12":0,"13":1,"14":1,"15":2,"16":2,"17":2,"18":1},"b":{"0":[1,1,1],"1":[0,0],"2":[2,2],"3":[2,0],"4":[2,2],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[49,3],"9":[3,0],"10":[0,1],"11":[1,1],"12":[0,1],"13":[1,0],"14":[0,2],"15":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/actions.ts","sources":["/home/circleci/repo/src/context/directory/handlers/actions.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable consistent-return */\nimport path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\n\nimport { getFiles, existsMustBeDir, loadJSON, sanitize } from '../../../utils';\nimport log from '../../../logger';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\nimport { Action, isMarketplaceAction } from '../../../tools/auth0/handlers/actions';\n\ntype ParsedActions = ParsedAsset<'actions', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedActions {\n  const actionsFolder = path.join(context.filePath, constants.ACTIONS_DIRECTORY);\n\n  if (!existsMustBeDir(actionsFolder)) return { actions: null }; // Skip\n\n  const files = getFiles(actionsFolder, ['.json']);\n  const actions = files.map((file) => {\n    const action = {\n      ...loadJSON(file, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }),\n    };\n    const actionFolder = path.join(constants.ACTIONS_DIRECTORY, `${action.name}`);\n\n    if (action.code) {\n      const toUnixPath = (somePath) =>\n        somePath.replace(/[\\\\/]+/g, '/').replace(/^([a-zA-Z]+:|\\.\\/)/, '');\n      action.code = context.loadFile(toUnixPath(action.code), actionFolder);\n    }\n\n    return action;\n  });\n\n  return { actions };\n}\n\nfunction mapSecrets(secrets) {\n  if (secrets && secrets.length > 0) {\n    return secrets.map((secret) => ({ name: secret.name, value: secret.value }));\n  }\n  return [];\n}\n\nfunction mapActionCode(filePath, action) {\n  const { code } = action;\n\n  if (!code) {\n    return '';\n  }\n\n  const actionName = sanitize(action.name);\n  const actionFolder = path.join(filePath, constants.ACTIONS_DIRECTORY, `${actionName}`);\n  fs.ensureDirSync(actionFolder);\n\n  const codeFile = path.join(actionFolder, 'code.js');\n  log.info(`Writing ${codeFile}`);\n  fs.writeFileSync(codeFile, code);\n\n  return `${codeFile}`;\n}\n\nfunction mapToAction(filePath, action): Partial<Action> {\n  return {\n    name: action.name,\n    code: mapActionCode(filePath, action),\n    runtime: action.runtime,\n    status: action.status,\n    dependencies: action.dependencies,\n    secrets: mapSecrets(action.secrets),\n    supported_triggers: action.supported_triggers,\n    deployed: action.deployed || action.all_changes_deployed,\n    installed_integration_id: action.installed_integration_id,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { actions } = context.assets;\n  if (!actions) return;\n\n  // Marketplace actions are not currently supported for management (See ESD-23225)\n  const filteredActions = actions.filter((action) => {\n    if (isMarketplaceAction(action)) {\n      log.warn(\n        `Skipping export of marketplace action \"${action.name}\". Management of marketplace actions are not currently supported.`\n      );\n      return false;\n    }\n    return true;\n  });\n\n  // Create Actions folder\n  const actionsFolder = path.join(context.filePath, constants.ACTIONS_DIRECTORY);\n  fs.ensureDirSync(actionsFolder);\n  filteredActions.forEach((action) => {\n    // Dump template metadata\n    const name = sanitize(action.name);\n    const actionFile = path.join(actionsFolder, `${name}.json`);\n    log.info(`Writing ${actionFile}`);\n    fs.writeFileSync(actionFile, JSON.stringify(mapToAction(context.filePath, action), null, 2));\n  });\n}\n\nconst actionsHandler: DirectoryHandler<ParsedActions> = {\n  parse,\n  dump,\n};\n\nexport default actionsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8470794c00923b63eb8f7f2c8287bf503a4d82f4","contentHash":"392b40a29c9949ea85b9dd500bec1f40af65b940ae1e3809bdb8e70327691841"},"/home/circleci/repo/src/context/directory/handlers/organizations.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/organizations.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":17},"end":{"line":17,"column":60}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":32},"end":{"line":20,"column":86}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":39}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":39}},"22":{"start":{"line":23,"column":18},"end":{"line":23,"column":71}},"23":{"start":{"line":24,"column":26},"end":{"line":30,"column":6}},"24":{"start":{"line":25,"column":20},"end":{"line":28,"column":11}},"25":{"start":{"line":29,"column":8},"end":{"line":29,"column":19}},"26":{"start":{"line":31,"column":4},"end":{"line":33,"column":6}},"27":{"start":{"line":36,"column":4},"end":{"line":58,"column":7}},"28":{"start":{"line":37,"column":34},"end":{"line":37,"column":48}},"29":{"start":{"line":39,"column":8},"end":{"line":40,"column":19}},"30":{"start":{"line":40,"column":12},"end":{"line":40,"column":19}},"31":{"start":{"line":41,"column":36},"end":{"line":41,"column":90}},"32":{"start":{"line":42,"column":8},"end":{"line":42,"column":62}},"33":{"start":{"line":43,"column":8},"end":{"line":57,"column":11}},"34":{"start":{"line":44,"column":37},"end":{"line":44,"column":129}},"35":{"start":{"line":45,"column":12},"end":{"line":45,"column":65}},"36":{"start":{"line":46,"column":12},"end":{"line":55,"column":13}},"37":{"start":{"line":47,"column":16},"end":{"line":54,"column":19}},"38":{"start":{"line":49,"column":33},"end":{"line":49,"column":66}},"39":{"start":{"line":50,"column":33},"end":{"line":50,"column":59}},"40":{"start":{"line":51,"column":20},"end":{"line":51,"column":46}},"41":{"start":{"line":52,"column":20},"end":{"line":52,"column":43}},"42":{"start":{"line":53,"column":20},"end":{"line":53,"column":32}},"43":{"start":{"line":56,"column":12},"end":{"line":56,"column":66}},"44":{"start":{"line":60,"column":29},"end":{"line":63,"column":1}},"45":{"start":{"line":64,"column":0},"end":{"line":64,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":34,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":24,"column":36},"end":{"line":24,"column":37}},"loc":{"start":{"line":24,"column":43},"end":{"line":30,"column":5}},"line":24},"10":{"name":"dump","decl":{"start":{"line":35,"column":9},"end":{"line":35,"column":13}},"loc":{"start":{"line":35,"column":23},"end":{"line":59,"column":1}},"line":35},"11":{"name":"(anonymous_11)","decl":{"start":{"line":36,"column":43},"end":{"line":36,"column":44}},"loc":{"start":{"line":36,"column":56},"end":{"line":58,"column":5}},"line":36},"12":{"name":"(anonymous_12)","decl":{"start":{"line":43,"column":30},"end":{"line":43,"column":31}},"loc":{"start":{"line":43,"column":48},"end":{"line":57,"column":9}},"line":43},"13":{"name":"(anonymous_13)","decl":{"start":{"line":47,"column":72},"end":{"line":47,"column":73}},"loc":{"start":{"line":47,"column":79},"end":{"line":54,"column":17}},"line":47}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":39}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":39}},{"start":{"line":21,"column":4},"end":{"line":22,"column":39}}],"line":21},"9":{"loc":{"start":{"line":39,"column":8},"end":{"line":40,"column":19}},"type":"if","locations":[{"start":{"line":39,"column":8},"end":{"line":40,"column":19}},{"start":{"line":39,"column":8},"end":{"line":40,"column":19}}],"line":39},"10":{"loc":{"start":{"line":39,"column":12},"end":{"line":39,"column":66}},"type":"binary-expr","locations":[{"start":{"line":39,"column":12},"end":{"line":39,"column":26}},{"start":{"line":39,"column":30},"end":{"line":39,"column":66}}],"line":39},"11":{"loc":{"start":{"line":46,"column":12},"end":{"line":55,"column":13}},"type":"if","locations":[{"start":{"line":46,"column":12},"end":{"line":55,"column":13}},{"start":{"line":46,"column":12},"end":{"line":55,"column":13}}],"line":46},"12":{"loc":{"start":{"line":49,"column":33},"end":{"line":49,"column":66}},"type":"binary-expr","locations":[{"start":{"line":49,"column":33},"end":{"line":49,"column":45}},{"start":{"line":49,"column":49},"end":{"line":49,"column":66}}],"line":49}},"s":{"0":1,"1":0,"2":0,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":2,"11":2,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":52,"20":52,"21":50,"22":1,"23":1,"24":2,"25":2,"26":1,"27":2,"28":2,"29":2,"30":1,"31":1,"32":1,"33":1,"34":2,"35":2,"36":2,"37":2,"38":2,"39":2,"40":2,"41":2,"42":2,"43":2,"44":1,"45":1},"f":{"0":2,"1":0,"2":0,"3":2,"4":0,"5":0,"6":2,"7":3,"8":52,"9":2,"10":2,"11":2,"12":2,"13":2},"b":{"0":[1,1,1],"1":[0,0],"2":[2,2],"3":[2,0],"4":[2,2],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[50,1],"9":[1,1],"10":[2,2],"11":[2,0],"12":[2,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/organizations.ts","sources":["/home/circleci/repo/src/context/directory/handlers/organizations.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAE1B,6DAAkC;AAClC,0CAAyF;AAOzF,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,mBAAmB,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC;IAEzE,IAAI,CAAC,IAAA,uBAAe,EAAC,mBAAmB,CAAC;QAAE,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAElF,MAAM,KAAK,GAAG,IAAA,gBAAQ,EAAC,mBAAmB,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAEvD,MAAM,aAAa,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;QACpC,MAAM,GAAG,qBACJ,IAAA,gBAAQ,EAAC,CAAC,EAAE;YACb,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAC,CACH,CAAC;QACF,OAAO,GAAG,CAAC;IACb,CAAC,CAAC,CAAC;IAEH,OAAO;QACL,aAAa;KACd,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEzC,uDAAuD;QACvD,IAAI,CAAC,aAAa,IAAI,aAAa,CAAC,WAAW,KAAK,MAAM;YAAE,OAAO,CAAC,wBAAwB;QAE5F,MAAM,mBAAmB,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC;QACzE,kBAAE,CAAC,aAAa,CAAC,mBAAmB,CAAC,CAAC;QAEtC,aAAa,CAAC,OAAO,CAAC,CAAC,YAAY,EAAE,EAAE;YACrC,MAAM,gBAAgB,GAAG,cAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,IAAA,gBAAQ,EAAC,GAAG,YAAY,CAAC,IAAI,OAAO,CAAC,CAAC,CAAC;YAC/F,gBAAG,CAAC,IAAI,CAAC,WAAW,gBAAgB,EAAE,CAAC,CAAC;YAExC,IAAI,YAAY,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;gBACvC,YAAY,CAAC,WAAW,GAAG,YAAY,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;oBAC5D,iCAAiC;oBACjC,MAAM,IAAI,GAAG,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC;oBAE/C,MAAM,IAAI,mBACR,IAAI,IACD,CAAC,CACL,CAAC;oBAEF,OAAO,IAAI,CAAC,aAAa,CAAC;oBAC1B,OAAO,IAAI,CAAC,UAAU,CAAC;oBAEvB,OAAO,IAAI,CAAC;gBACd,CAAC,CAAC,CAAC;aACJ;YAED,IAAA,gBAAQ,EAAC,gBAAgB,EAAE,YAAY,CAAC,CAAC;QAC3C,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,oBAAoB,GAA0C;IAClE,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,oBAAoB,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\n\nimport log from '../../../logger';\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON, sanitize } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedOrganizations = ParsedAsset<'organizations', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedOrganizations {\n  const organizationsFolder = path.join(context.filePath, 'organizations');\n\n  if (!existsMustBeDir(organizationsFolder)) return { organizations: null }; // Skip\n\n  const files = getFiles(organizationsFolder, ['.json']);\n\n  const organizations = files.map((f) => {\n    const org = {\n      ...loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }),\n    };\n    return org;\n  });\n\n  return {\n    organizations,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { organizations } = context.assets;\n\n  // API returns an empty object if no grants are present\n  if (!organizations || organizations.constructor === Object) return; // Skip, nothing to dump\n\n  const organizationsFolder = path.join(context.filePath, 'organizations');\n  fs.ensureDirSync(organizationsFolder);\n\n  organizations.forEach((organization) => {\n    const organizationFile = path.join(organizationsFolder, sanitize(`${organization.name}.json`));\n    log.info(`Writing ${organizationFile}`);\n\n    if (organization.connections.length > 0) {\n      organization.connections = organization.connections.map((c) => {\n        // connection is a computed field\n        const name = c.connection && c.connection.name;\n\n        const conn = {\n          name,\n          ...c,\n        };\n\n        delete conn.connection_id;\n        delete conn.connection;\n\n        return conn;\n      });\n    }\n\n    dumpJSON(organizationFile, organization);\n  });\n}\n\nconst organizationsHandler: DirectoryHandler<ParsedOrganizations> = {\n  parse,\n  dump,\n};\n\nexport default organizationsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5bd0e2b42d4738cc13659612c85536c7b810c7a6","contentHash":"a59ba3107334edb3d13dfbd556418a0df8a732726868531a59125599858c7951"},"/home/circleci/repo/src/context/directory/handlers/triggers.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/triggers.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":19,"column":17},"end":{"line":19,"column":60}},"20":{"start":{"line":21,"column":27},"end":{"line":21,"column":102}},"21":{"start":{"line":22,"column":4},"end":{"line":23,"column":34}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":34}},"23":{"start":{"line":24,"column":18},"end":{"line":24,"column":66}},"24":{"start":{"line":25,"column":21},"end":{"line":28,"column":7}},"25":{"start":{"line":29,"column":4},"end":{"line":29,"column":24}},"26":{"start":{"line":32,"column":4},"end":{"line":42,"column":7}},"27":{"start":{"line":33,"column":29},"end":{"line":33,"column":43}},"28":{"start":{"line":34,"column":8},"end":{"line":35,"column":19}},"29":{"start":{"line":35,"column":12},"end":{"line":35,"column":19}},"30":{"start":{"line":37,"column":31},"end":{"line":37,"column":106}},"31":{"start":{"line":38,"column":8},"end":{"line":38,"column":57}},"32":{"start":{"line":39,"column":28},"end":{"line":39,"column":80}},"33":{"start":{"line":40,"column":8},"end":{"line":40,"column":56}},"34":{"start":{"line":41,"column":8},"end":{"line":41,"column":89}},"35":{"start":{"line":44,"column":24},"end":{"line":47,"column":1}},"36":{"start":{"line":48,"column":0},"end":{"line":48,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":14}},"loc":{"start":{"line":20,"column":24},"end":{"line":30,"column":1}},"line":20},"9":{"name":"dump","decl":{"start":{"line":31,"column":9},"end":{"line":31,"column":13}},"loc":{"start":{"line":31,"column":23},"end":{"line":43,"column":1}},"line":31},"10":{"name":"(anonymous_10)","decl":{"start":{"line":32,"column":43},"end":{"line":32,"column":44}},"loc":{"start":{"line":32,"column":56},"end":{"line":42,"column":5}},"line":32}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":34}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":34}},{"start":{"line":22,"column":4},"end":{"line":23,"column":34}}],"line":22},"9":{"loc":{"start":{"line":34,"column":8},"end":{"line":35,"column":19}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":35,"column":19}},{"start":{"line":34,"column":8},"end":{"line":35,"column":19}}],"line":34}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":3,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":51,"21":51,"22":49,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":0,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":3,"8":51,"9":1,"10":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[1,2],"7":[3,3],"8":[49,1],"9":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/triggers.ts","sources":["/home/circleci/repo/src/context/directory/handlers/triggers.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAI3C,0CAAqE;AACrE,6DAAkC;AAKlC,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,kBAAkB,CAAC,CAAC;IAEjF,IAAI,CAAC,IAAA,uBAAe,EAAC,cAAc,CAAC;QAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAExE,MAAM,KAAK,GAAG,IAAA,gBAAQ,EAAC,cAAc,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAElD,MAAM,QAAQ,qBACT,IAAA,gBAAQ,EAAC,KAAK,CAAC,CAAC,CAAC,EAAE;QACpB,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CACH,CAAC;IAEF,OAAO,EAAE,QAAQ,EAAE,CAAC;AACtB,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,QAAQ,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEpC,IAAI,CAAC,QAAQ;YAAE,OAAO;QAEtB,yBAAyB;QACzB,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,kBAAkB,CAAC,CAAC;QACjF,kBAAE,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;QACjC,MAAM,WAAW,GAAG,cAAI,CAAC,IAAI,CAAC,cAAc,EAAE,eAAe,CAAC,CAAC;QAC/D,gBAAG,CAAC,IAAI,CAAC,WAAW,WAAW,EAAE,CAAC,CAAC;QACnC,kBAAE,CAAC,aAAa,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;IACnE,CAAC;CAAA;AAED,MAAM,eAAe,GAAqC;IACxD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,eAAe,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\n\nimport { getFiles, existsMustBeDir, loadJSON } from '../../../utils';\nimport log from '../../../logger';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedTriggers = ParsedAsset<'triggers', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedTriggers {\n  const triggersFolder = path.join(context.filePath, constants.TRIGGERS_DIRECTORY);\n\n  if (!existsMustBeDir(triggersFolder)) return { triggers: null }; // Skip\n\n  const files = getFiles(triggersFolder, ['.json']);\n\n  const triggers = {\n    ...loadJSON(files[0], {\n      mappings: context.mappings,\n      disableKeywordReplacement: context.disableKeywordReplacement,\n    }),\n  };\n\n  return { triggers };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { triggers } = context.assets;\n\n  if (!triggers) return;\n\n  // Create triggers folder\n  const triggersFolder = path.join(context.filePath, constants.TRIGGERS_DIRECTORY);\n  fs.ensureDirSync(triggersFolder);\n  const triggerFile = path.join(triggersFolder, 'triggers.json');\n  log.info(`Writing ${triggerFile}`);\n  fs.writeFileSync(triggerFile, JSON.stringify(triggers, null, 2));\n}\n\nconst triggersHandler: DirectoryHandler<ParsedTriggers> = {\n  parse,\n  dump,\n};\n\nexport default triggersHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"aff577cc7e7b9d19505c3b413a3ad507de82b68b","contentHash":"d2a049cfd2cc6296a85243f42dc5cfe6f99b3e5bb3fdc4e730dff64d1661e7a8"},"/home/circleci/repo/src/context/directory/handlers/attackProtection.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/attackProtection.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":22},"end":{"line":20,"column":98}},"20":{"start":{"line":21,"column":4},"end":{"line":26,"column":6}},"21":{"start":{"line":29,"column":18},"end":{"line":29,"column":57}},"22":{"start":{"line":30,"column":4},"end":{"line":34,"column":5}},"23":{"start":{"line":31,"column":8},"end":{"line":33,"column":10}},"24":{"start":{"line":35,"column":38},"end":{"line":38,"column":6}},"25":{"start":{"line":39,"column":33},"end":{"line":42,"column":6}},"26":{"start":{"line":43,"column":35},"end":{"line":46,"column":6}},"27":{"start":{"line":47,"column":4},"end":{"line":53,"column":6}},"28":{"start":{"line":56,"column":4},"end":{"line":65,"column":7}},"29":{"start":{"line":57,"column":37},"end":{"line":57,"column":51}},"30":{"start":{"line":58,"column":8},"end":{"line":59,"column":19}},"31":{"start":{"line":59,"column":12},"end":{"line":59,"column":19}},"32":{"start":{"line":60,"column":22},"end":{"line":60,"column":61}},"33":{"start":{"line":61,"column":8},"end":{"line":61,"column":58}},"34":{"start":{"line":62,"column":8},"end":{"line":62,"column":107}},"35":{"start":{"line":63,"column":8},"end":{"line":63,"column":97}},"36":{"start":{"line":64,"column":8},"end":{"line":64,"column":101}},"37":{"start":{"line":67,"column":32},"end":{"line":70,"column":1}},"38":{"start":{"line":71,"column":0},"end":{"line":71,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"attackProtectionFiles","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":30}},"loc":{"start":{"line":19,"column":41},"end":{"line":27,"column":1}},"line":19},"9":{"name":"parse","decl":{"start":{"line":28,"column":9},"end":{"line":28,"column":14}},"loc":{"start":{"line":28,"column":24},"end":{"line":54,"column":1}},"line":28},"10":{"name":"dump","decl":{"start":{"line":55,"column":9},"end":{"line":55,"column":13}},"loc":{"start":{"line":55,"column":23},"end":{"line":66,"column":1}},"line":55},"11":{"name":"(anonymous_11)","decl":{"start":{"line":56,"column":43},"end":{"line":56,"column":44}},"loc":{"start":{"line":56,"column":56},"end":{"line":65,"column":5}},"line":56}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":30,"column":4},"end":{"line":34,"column":5}},"type":"if","locations":[{"start":{"line":30,"column":4},"end":{"line":34,"column":5}},{"start":{"line":30,"column":4},"end":{"line":34,"column":5}}],"line":30},"9":{"loc":{"start":{"line":58,"column":8},"end":{"line":59,"column":19}},"type":"if","locations":[{"start":{"line":58,"column":8},"end":{"line":59,"column":19}},{"start":{"line":58,"column":8},"end":{"line":59,"column":19}}],"line":58}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":51,"20":51,"21":50,"22":50,"23":48,"24":2,"25":2,"26":2,"27":2,"28":1,"29":1,"30":1,"31":0,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":2,"8":51,"9":50,"10":1,"11":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[48,2],"9":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/attackProtection.ts","sources":["/home/circleci/repo/src/context/directory/handlers/attackProtection.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAC3C,0CAAqE;AAcrE,SAAS,qBAAqB,CAAC,QAAgB;IAM7C,MAAM,SAAS,GAAG,cAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,iBAAS,CAAC,2BAA2B,CAAC,CAAC;IAE7E,OAAO;QACL,SAAS,EAAE,SAAS;QACpB,yBAAyB,EAAE,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,kCAAkC,CAAC;QACnF,oBAAoB,EAAE,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,6BAA6B,CAAC;QACzE,sBAAsB,EAAE,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,+BAA+B,CAAC;KAC9E,CAAC;AACJ,CAAC;AAED,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,KAAK,GAAG,qBAAqB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAEtD,IAAI,CAAC,IAAA,uBAAe,EAAC,KAAK,CAAC,SAAS,CAAC,EAAE;QACrC,OAAO;YACL,gBAAgB,EAAE,IAAI;SACvB,CAAC;KACH;IAED,MAAM,yBAAyB,GAAG,IAAA,gBAAQ,EAAC,KAAK,CAAC,yBAAyB,EAAE;QAC1E,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CAAC;IACH,MAAM,oBAAoB,GAAG,IAAA,gBAAQ,EAAC,KAAK,CAAC,oBAAoB,EAAE;QAChE,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CAAC;IACH,MAAM,sBAAsB,GAAG,IAAA,gBAAQ,EAAC,KAAK,CAAC,sBAAsB,EAAE;QACpE,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CAAC;IAEH,OAAO;QACL,gBAAgB,EAAE;YAChB,yBAAyB;YACzB,oBAAoB;YACpB,sBAAsB;SACvB;KACF,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,gBAAgB,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAE5C,IAAI,CAAC,gBAAgB;YAAE,OAAO;QAE9B,MAAM,KAAK,GAAG,qBAAqB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QACtD,kBAAE,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QAElC,IAAA,gBAAQ,EAAC,KAAK,CAAC,yBAAyB,EAAE,gBAAgB,CAAC,yBAAyB,CAAC,CAAC;QACtF,IAAA,gBAAQ,EAAC,KAAK,CAAC,oBAAoB,EAAE,gBAAgB,CAAC,oBAAoB,CAAC,CAAC;QAC5E,IAAA,gBAAQ,EAAC,KAAK,CAAC,sBAAsB,EAAE,gBAAgB,CAAC,sBAAsB,CAAC,CAAC;IAClF,CAAC;CAAA;AAED,MAAM,uBAAuB,GAA6C;IACxE,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,uBAAuB,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { dumpJSON, existsMustBeDir, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedAttackProtection = ParsedAsset<\n  'attackProtection',\n  {\n    breachedPasswordDetection: Asset;\n    bruteForceProtection: Asset;\n    suspiciousIpThrottling: Asset;\n  }\n>;\n\nfunction attackProtectionFiles(filePath: string): {\n  directory: string;\n  breachedPasswordDetection: string;\n  bruteForceProtection: string;\n  suspiciousIpThrottling: string;\n} {\n  const directory = path.join(filePath, constants.ATTACK_PROTECTION_DIRECTORY);\n\n  return {\n    directory: directory,\n    breachedPasswordDetection: path.join(directory, 'breached-password-detection.json'),\n    bruteForceProtection: path.join(directory, 'brute-force-protection.json'),\n    suspiciousIpThrottling: path.join(directory, 'suspicious-ip-throttling.json'),\n  };\n}\n\nfunction parse(context: DirectoryContext): ParsedAttackProtection {\n  const files = attackProtectionFiles(context.filePath);\n\n  if (!existsMustBeDir(files.directory)) {\n    return {\n      attackProtection: null,\n    };\n  }\n\n  const breachedPasswordDetection = loadJSON(files.breachedPasswordDetection, {\n    mappings: context.mappings,\n    disableKeywordReplacement: context.disableKeywordReplacement,\n  });\n  const bruteForceProtection = loadJSON(files.bruteForceProtection, {\n    mappings: context.mappings,\n    disableKeywordReplacement: context.disableKeywordReplacement,\n  });\n  const suspiciousIpThrottling = loadJSON(files.suspiciousIpThrottling, {\n    mappings: context.mappings,\n    disableKeywordReplacement: context.disableKeywordReplacement,\n  });\n\n  return {\n    attackProtection: {\n      breachedPasswordDetection,\n      bruteForceProtection,\n      suspiciousIpThrottling,\n    },\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { attackProtection } = context.assets;\n\n  if (!attackProtection) return;\n\n  const files = attackProtectionFiles(context.filePath);\n  fs.ensureDirSync(files.directory);\n\n  dumpJSON(files.breachedPasswordDetection, attackProtection.breachedPasswordDetection);\n  dumpJSON(files.bruteForceProtection, attackProtection.bruteForceProtection);\n  dumpJSON(files.suspiciousIpThrottling, attackProtection.suspiciousIpThrottling);\n}\n\nconst attackProtectionHandler: DirectoryHandler<ParsedAttackProtection> = {\n  parse,\n  dump,\n};\n\nexport default attackProtectionHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a7b28357675790a843189f93bba96249604edfdf","contentHash":"f18a5c7b209bef71031841dbd8353a4677c79b26868a421c8857d4aee3052fb7"},"/home/circleci/repo/src/context/directory/handlers/branding.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/branding.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":30},"end":{"line":20,"column":105}},"20":{"start":{"line":21,"column":25},"end":{"line":21,"column":80}},"21":{"start":{"line":22,"column":4},"end":{"line":23,"column":34}},"22":{"start":{"line":23,"column":8},"end":{"line":23,"column":34}},"23":{"start":{"line":24,"column":29},"end":{"line":32,"column":8}},"24":{"start":{"line":25,"column":8},"end":{"line":30,"column":9}},"25":{"start":{"line":26,"column":12},"end":{"line":29,"column":15}},"26":{"start":{"line":31,"column":8},"end":{"line":31,"column":20}},"27":{"start":{"line":33,"column":36},"end":{"line":33,"column":122}},"28":{"start":{"line":34,"column":4},"end":{"line":35,"column":46}},"29":{"start":{"line":35,"column":8},"end":{"line":35,"column":46}},"30":{"start":{"line":36,"column":37},"end":{"line":36,"column":94}},"31":{"start":{"line":37,"column":22},"end":{"line":47,"column":10}},"32":{"start":{"line":38,"column":27},"end":{"line":41,"column":10}},"33":{"start":{"line":42,"column":8},"end":{"line":45,"column":11}},"34":{"start":{"line":46,"column":8},"end":{"line":46,"column":26}},"35":{"start":{"line":48,"column":4},"end":{"line":50,"column":6}},"36":{"start":{"line":53,"column":4},"end":{"line":60,"column":7}},"37":{"start":{"line":54,"column":29},"end":{"line":54,"column":43}},"38":{"start":{"line":55,"column":8},"end":{"line":56,"column":19}},"39":{"start":{"line":56,"column":12},"end":{"line":56,"column":19}},"40":{"start":{"line":57,"column":8},"end":{"line":57,"column":30}},"41":{"start":{"line":58,"column":8},"end":{"line":59,"column":43}},"42":{"start":{"line":59,"column":12},"end":{"line":59,"column":43}},"43":{"start":{"line":62,"column":30},"end":{"line":80,"column":1}},"44":{"start":{"line":63,"column":4},"end":{"line":64,"column":15}},"45":{"start":{"line":64,"column":8},"end":{"line":64,"column":15}},"46":{"start":{"line":65,"column":46},"end":{"line":65,"column":52}},"47":{"start":{"line":66,"column":36},"end":{"line":66,"column":151}},"48":{"start":{"line":67,"column":4},"end":{"line":67,"column":62}},"49":{"start":{"line":68,"column":4},"end":{"line":79,"column":7}},"50":{"start":{"line":69,"column":23},"end":{"line":69,"column":46}},"51":{"start":{"line":70,"column":8},"end":{"line":75,"column":9}},"52":{"start":{"line":71,"column":12},"end":{"line":71,"column":138}},"53":{"start":{"line":74,"column":12},"end":{"line":74,"column":114}},"54":{"start":{"line":77,"column":8},"end":{"line":77,"column":94}},"55":{"start":{"line":78,"column":8},"end":{"line":78,"column":135}},"56":{"start":{"line":81,"column":21},"end":{"line":94,"column":1}},"57":{"start":{"line":82,"column":4},"end":{"line":83,"column":15}},"58":{"start":{"line":83,"column":8},"end":{"line":83,"column":15}},"59":{"start":{"line":84,"column":25},"end":{"line":84,"column":31}},"60":{"start":{"line":85,"column":37},"end":{"line":89,"column":8}},"61":{"start":{"line":86,"column":28},"end":{"line":86,"column":55}},"62":{"start":{"line":87,"column":8},"end":{"line":87,"column":37}},"63":{"start":{"line":88,"column":8},"end":{"line":88,"column":27}},"64":{"start":{"line":90,"column":30},"end":{"line":90,"column":97}},"65":{"start":{"line":91,"column":4},"end":{"line":91,"column":56}},"66":{"start":{"line":92,"column":29},"end":{"line":92,"column":84}},"67":{"start":{"line":93,"column":4},"end":{"line":93,"column":70}},"68":{"start":{"line":95,"column":24},"end":{"line":98,"column":1}},"69":{"start":{"line":99,"column":0},"end":{"line":99,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":51,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":24,"column":30},"end":{"line":24,"column":31}},"loc":{"start":{"line":24,"column":36},"end":{"line":32,"column":5}},"line":24},"10":{"name":"(anonymous_10)","decl":{"start":{"line":37,"column":51},"end":{"line":37,"column":52}},"loc":{"start":{"line":37,"column":79},"end":{"line":47,"column":5}},"line":37},"11":{"name":"dump","decl":{"start":{"line":52,"column":9},"end":{"line":52,"column":13}},"loc":{"start":{"line":52,"column":23},"end":{"line":61,"column":1}},"line":52},"12":{"name":"(anonymous_12)","decl":{"start":{"line":53,"column":43},"end":{"line":53,"column":44}},"loc":{"start":{"line":53,"column":56},"end":{"line":60,"column":5}},"line":53},"13":{"name":"(anonymous_13)","decl":{"start":{"line":62,"column":30},"end":{"line":62,"column":31}},"loc":{"start":{"line":62,"column":56},"end":{"line":80,"column":1}},"line":62},"14":{"name":"(anonymous_14)","decl":{"start":{"line":68,"column":22},"end":{"line":68,"column":23}},"loc":{"start":{"line":68,"column":46},"end":{"line":79,"column":5}},"line":68},"15":{"name":"(anonymous_15)","decl":{"start":{"line":81,"column":21},"end":{"line":81,"column":22}},"loc":{"start":{"line":81,"column":47},"end":{"line":94,"column":1}},"line":81},"16":{"name":"(anonymous_16)","decl":{"start":{"line":85,"column":38},"end":{"line":85,"column":39}},"loc":{"start":{"line":85,"column":44},"end":{"line":89,"column":5}},"line":85}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":4},"end":{"line":23,"column":34}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":23,"column":34}},{"start":{"line":22,"column":4},"end":{"line":23,"column":34}}],"line":22},"9":{"loc":{"start":{"line":25,"column":8},"end":{"line":30,"column":9}},"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":30,"column":9}},{"start":{"line":25,"column":8},"end":{"line":30,"column":9}}],"line":25},"10":{"loc":{"start":{"line":34,"column":4},"end":{"line":35,"column":46}},"type":"if","locations":[{"start":{"line":34,"column":4},"end":{"line":35,"column":46}},{"start":{"line":34,"column":4},"end":{"line":35,"column":46}}],"line":34},"11":{"loc":{"start":{"line":55,"column":8},"end":{"line":56,"column":19}},"type":"if","locations":[{"start":{"line":55,"column":8},"end":{"line":56,"column":19}},{"start":{"line":55,"column":8},"end":{"line":56,"column":19}}],"line":55},"12":{"loc":{"start":{"line":58,"column":8},"end":{"line":59,"column":43}},"type":"if","locations":[{"start":{"line":58,"column":8},"end":{"line":59,"column":43}},{"start":{"line":58,"column":8},"end":{"line":59,"column":43}}],"line":58},"13":{"loc":{"start":{"line":63,"column":4},"end":{"line":64,"column":15}},"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":64,"column":15}},{"start":{"line":63,"column":4},"end":{"line":64,"column":15}}],"line":63},"14":{"loc":{"start":{"line":63,"column":8},"end":{"line":63,"column":54}},"type":"binary-expr","locations":[{"start":{"line":63,"column":8},"end":{"line":63,"column":24}},{"start":{"line":63,"column":28},"end":{"line":63,"column":54}}],"line":63},"15":{"loc":{"start":{"line":65,"column":24},"end":{"line":65,"column":38}},"type":"default-arg","locations":[{"start":{"line":65,"column":36},"end":{"line":65,"column":38}}],"line":65},"16":{"loc":{"start":{"line":82,"column":4},"end":{"line":83,"column":15}},"type":"if","locations":[{"start":{"line":82,"column":4},"end":{"line":83,"column":15}},{"start":{"line":82,"column":4},"end":{"line":83,"column":15}}],"line":82},"17":{"loc":{"start":{"line":82,"column":8},"end":{"line":82,"column":35}},"type":"binary-expr","locations":[{"start":{"line":82,"column":8},"end":{"line":82,"column":15}},{"start":{"line":82,"column":19},"end":{"line":82,"column":35}}],"line":82}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":50,"20":50,"21":50,"22":47,"23":3,"24":3,"25":2,"26":1,"27":3,"28":3,"29":1,"30":2,"31":2,"32":2,"33":2,"34":2,"35":2,"36":1,"37":1,"38":1,"39":0,"40":1,"41":1,"42":1,"43":1,"44":1,"45":0,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":0,"54":1,"55":1,"56":1,"57":1,"58":0,"59":1,"60":1,"61":1,"62":1,"63":1,"64":1,"65":1,"66":1,"67":1,"68":1,"69":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":2,"8":50,"9":3,"10":2,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[47,3],"9":[2,1],"10":[1,2],"11":[0,1],"12":[1,0],"13":[0,1],"14":[1,1],"15":[0],"16":[0,1],"17":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/branding.ts","sources":["/home/circleci/repo/src/context/directory/handlers/branding.ts"],"names":[],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants, loadFileAndReplaceKeywords } from '../../../tools';\nimport { dumpJSON, existsMustBeDir, getFiles, isFile, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedBranding = ParsedAsset<'branding', Asset>;\n\nfunction parse(context: DirectoryContext): ParsedBranding {\n  const brandingDirectory = path.join(context.filePath, constants.BRANDING_DIRECTORY);\n  const brandingFile = path.join(brandingDirectory, 'branding.json');\n\n  if (!existsMustBeDir(brandingDirectory)) return { branding: null };\n\n  const brandingSettings = (() => {\n    if (isFile(brandingFile)) {\n      return loadJSON(brandingFile, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      });\n    }\n\n    return null;\n  })();\n\n  const brandingTemplatesFolder = path.join(\n    brandingDirectory,\n    constants.BRANDING_TEMPLATES_DIRECTORY\n  );\n\n  if (!existsMustBeDir(brandingTemplatesFolder)) return { branding: brandingSettings };\n\n  const templatesDefinitionFiles = getFiles(brandingTemplatesFolder, ['.json']);\n  const templates = templatesDefinitionFiles.map((templateDefinitionFile) => {\n    const definition = loadJSON(templateDefinitionFile, {\n      mappings: context.mappings,\n      disableKeywordReplacement: context.disableKeywordReplacement,\n    });\n    definition.body = loadFileAndReplaceKeywords(\n      path.join(brandingTemplatesFolder, definition.body),\n      {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }\n    );\n    return definition;\n  }, {});\n\n  return {\n    branding: {\n      ...brandingSettings,\n      templates,\n    },\n  };\n}\n\nasync function dump(context: DirectoryContext) {\n  const { branding } = context.assets;\n\n  if (!branding) return;\n\n  dumpBranding(context);\n\n  if (!!branding.templates) dumpBrandingTemplates(context);\n}\n\nconst dumpBrandingTemplates = ({ filePath, assets }: DirectoryContext): void => {\n  if (!assets.branding || !assets.branding.templates) return;\n\n  const {\n    branding: { templates = [] },\n  } = assets;\n\n  const brandingTemplatesFolder = path.join(\n    filePath,\n    constants.BRANDING_DIRECTORY,\n    constants.BRANDING_TEMPLATES_DIRECTORY\n  );\n  fs.ensureDirSync(brandingTemplatesFolder);\n\n  templates.forEach((templateDefinition) => {\n    const markup = templateDefinition.body;\n    try {\n      fs.writeFileSync(\n        path.join(brandingTemplatesFolder, `${templateDefinition.template}.html`),\n        markup\n      );\n    } catch (e) {\n      throw new Error(\n        `Error writing template file: ${templateDefinition.template}, because: ${e.message}`\n      );\n    }\n\n    // save the location as relative file.\n    templateDefinition.body = `.${path.sep}${templateDefinition.template}.html`;\n    dumpJSON(\n      path.join(brandingTemplatesFolder, `${templateDefinition.template}.json`),\n      templateDefinition\n    );\n  });\n};\n\nconst dumpBranding = ({ filePath, assets }: DirectoryContext): void => {\n  if (!assets || !assets.branding) return;\n\n  const { branding } = assets;\n\n  const brandingWithoutTemplates = (() => {\n    const newBranding = { ...branding };\n    delete newBranding.templates;\n    return newBranding;\n  })();\n\n  const brandingDirectory = path.join(filePath, constants.BRANDING_DIRECTORY);\n\n  fs.ensureDirSync(brandingDirectory);\n\n  const brandingFilePath = path.join(brandingDirectory, 'branding.json');\n\n  dumpJSON(brandingFilePath, brandingWithoutTemplates);\n};\n\nconst brandingHandler: DirectoryHandler<ParsedBranding> = {\n  parse,\n  dump,\n};\n\nexport default brandingHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ccb14e3704c26f4937e8c2d6421c58771a614cca","contentHash":"22ab5e018c06d7eedc417a75d625eb61e7cf63df16bff76498a55c610d89b903"},"/home/circleci/repo/src/context/directory/handlers/logStreams.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/logStreams.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":32},"end":{"line":20,"column":110}},"20":{"start":{"line":21,"column":4},"end":{"line":22,"column":36}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":36}},"22":{"start":{"line":23,"column":23},"end":{"line":23,"column":76}},"23":{"start":{"line":24,"column":23},"end":{"line":29,"column":49}},"24":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"25":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"26":{"start":{"line":30,"column":4},"end":{"line":32,"column":6}},"27":{"start":{"line":35,"column":4},"end":{"line":46,"column":7}},"28":{"start":{"line":36,"column":27},"end":{"line":36,"column":52}},"29":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"30":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"31":{"start":{"line":40,"column":36},"end":{"line":40,"column":114}},"32":{"start":{"line":41,"column":8},"end":{"line":41,"column":62}},"33":{"start":{"line":42,"column":8},"end":{"line":45,"column":11}},"34":{"start":{"line":43,"column":29},"end":{"line":43,"column":118}},"35":{"start":{"line":44,"column":12},"end":{"line":44,"column":55}},"36":{"start":{"line":48,"column":26},"end":{"line":51,"column":1}},"37":{"start":{"line":52,"column":0},"end":{"line":52,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":25,"column":13},"end":{"line":25,"column":14}},"loc":{"start":{"line":25,"column":20},"end":{"line":28,"column":6}},"line":25},"10":{"name":"(anonymous_10)","decl":{"start":{"line":29,"column":16},"end":{"line":29,"column":17}},"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":48}},"line":29},"11":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":47,"column":1}},"line":34},"12":{"name":"(anonymous_12)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":46,"column":5}},"line":35},"13":{"name":"(anonymous_13)","decl":{"start":{"line":42,"column":27},"end":{"line":42,"column":28}},"loc":{"start":{"line":42,"column":42},"end":{"line":45,"column":9}},"line":42}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":22,"column":36}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":22,"column":36}},{"start":{"line":21,"column":4},"end":{"line":22,"column":36}}],"line":21},"9":{"loc":{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":38,"column":19}},{"start":{"line":37,"column":8},"end":{"line":38,"column":19}}],"line":37}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":50,"20":50,"21":50,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1,"37":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":2,"8":50,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[50,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/logStreams.ts","sources":["/home/circleci/repo/src/context/directory/handlers/logStreams.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAC3C,0CAAyF;AAOzF,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,mBAAmB,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,qBAAqB,CAAC,CAAC;IACzF,IAAI,CAAC,IAAA,uBAAe,EAAC,mBAAmB,CAAC;QAAE,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAE/E,MAAM,UAAU,GAAG,IAAA,gBAAQ,EAAC,mBAAmB,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAE5D,MAAM,UAAU,GAAG,UAAU;SAC1B,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CACT,IAAA,gBAAQ,EAAC,CAAC,EAAE;QACV,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAC,CACH;SACA,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,gCAAgC;IAE7E,OAAO;QACL,UAAU;KACX,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC;QAE7C,IAAI,CAAC,UAAU;YAAE,OAAO,CAAC,wBAAwB;QAEjD,sBAAsB;QACtB,MAAM,mBAAmB,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,qBAAqB,CAAC,CAAC;QACzF,kBAAE,CAAC,aAAa,CAAC,mBAAmB,CAAC,CAAC;QACtC,UAAU,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE,EAAE;YAC/B,MAAM,QAAQ,GAAG,cAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,GAAG,IAAA,gBAAQ,EAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpF,IAAA,gBAAQ,EAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;QAChC,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,iBAAiB,GAAuC;IAC5D,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,iBAAiB,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { getFiles, existsMustBeDir, dumpJSON, loadJSON, sanitize } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedLogStreams = ParsedAsset<'logStreams', Asset[]>;\n\nfunction parse(context: DirectoryContext): ParsedLogStreams {\n  const logStreamsDirectory = path.join(context.filePath, constants.LOG_STREAMS_DIRECTORY);\n  if (!existsMustBeDir(logStreamsDirectory)) return { logStreams: null }; // Skip\n\n  const foundFiles = getFiles(logStreamsDirectory, ['.json']);\n\n  const logStreams = foundFiles\n    .map((f) =>\n      loadJSON(f, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      })\n    )\n    .filter((p) => Object.keys(p).length > 0); // Filter out empty rulesConfigs\n\n  return {\n    logStreams,\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const logStreams = context.assets.logStreams;\n\n  if (!logStreams) return; // Skip, nothing to dump\n\n  // Create Rules folder\n  const logStreamsDirectory = path.join(context.filePath, constants.LOG_STREAMS_DIRECTORY);\n  fs.ensureDirSync(logStreamsDirectory);\n  logStreams.forEach((logStream) => {\n    const ruleFile = path.join(logStreamsDirectory, `${sanitize(logStream.name)}.json`);\n    dumpJSON(ruleFile, logStream);\n  });\n}\n\nconst logStreamsHandler: DirectoryHandler<ParsedLogStreams> = {\n  parse,\n  dump,\n};\n\nexport default logStreamsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"53e9d71dc8bb6e61156a2402e4be11e4205f7ede","contentHash":"dfedc1a81d783b4789b0d8c9d4dd6cbf702d8ad642a2bf8b6954768df543be2f"},"/home/circleci/repo/src/context/directory/handlers/prompts.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/prompts.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":14}},"14":{"start":{"line":13,"column":4},"end":{"line":14,"column":20}},"15":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"16":{"start":{"line":14,"column":8},"end":{"line":14,"column":20}},"17":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"18":{"start":{"line":16,"column":8},"end":{"line":19,"column":9}},"19":{"start":{"line":16,"column":21},"end":{"line":16,"column":22}},"20":{"start":{"line":16,"column":28},"end":{"line":16,"column":59}},"21":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"22":{"start":{"line":18,"column":16},"end":{"line":18,"column":34}},"23":{"start":{"line":20,"column":4},"end":{"line":20,"column":13}},"24":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"25":{"start":{"line":23,"column":4},"end":{"line":23,"column":62}},"26":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"27":{"start":{"line":26,"column":15},"end":{"line":26,"column":47}},"28":{"start":{"line":27,"column":19},"end":{"line":27,"column":38}},"29":{"start":{"line":28,"column":16},"end":{"line":28,"column":41}},"30":{"start":{"line":29,"column":16},"end":{"line":29,"column":41}},"31":{"start":{"line":30,"column":28},"end":{"line":32,"column":1}},"32":{"start":{"line":31,"column":4},"end":{"line":31,"column":78}},"33":{"start":{"line":33,"column":31},"end":{"line":35,"column":1}},"34":{"start":{"line":34,"column":4},"end":{"line":34,"column":65}},"35":{"start":{"line":36,"column":26},"end":{"line":38,"column":1}},"36":{"start":{"line":37,"column":4},"end":{"line":37,"column":69}},"37":{"start":{"line":40,"column":29},"end":{"line":40,"column":66}},"38":{"start":{"line":41,"column":4},"end":{"line":42,"column":33}},"39":{"start":{"line":42,"column":8},"end":{"line":42,"column":33}},"40":{"start":{"line":43,"column":28},"end":{"line":51,"column":8}},"41":{"start":{"line":44,"column":36},"end":{"line":44,"column":76}},"42":{"start":{"line":45,"column":8},"end":{"line":46,"column":22}},"43":{"start":{"line":46,"column":12},"end":{"line":46,"column":22}},"44":{"start":{"line":47,"column":8},"end":{"line":50,"column":11}},"45":{"start":{"line":52,"column":23},"end":{"line":60,"column":8}},"46":{"start":{"line":53,"column":31},"end":{"line":53,"column":66}},"47":{"start":{"line":54,"column":8},"end":{"line":55,"column":22}},"48":{"start":{"line":55,"column":12},"end":{"line":55,"column":22}},"49":{"start":{"line":56,"column":8},"end":{"line":59,"column":11}},"50":{"start":{"line":61,"column":4},"end":{"line":63,"column":6}},"51":{"start":{"line":66,"column":4},"end":{"line":81,"column":7}},"52":{"start":{"line":67,"column":28},"end":{"line":67,"column":42}},"53":{"start":{"line":68,"column":8},"end":{"line":69,"column":19}},"54":{"start":{"line":69,"column":12},"end":{"line":69,"column":19}},"55":{"start":{"line":70,"column":31},"end":{"line":70,"column":38}},"56":{"start":{"line":70,"column":58},"end":{"line":70,"column":89}},"57":{"start":{"line":71,"column":33},"end":{"line":71,"column":70}},"58":{"start":{"line":72,"column":8},"end":{"line":72,"column":56}},"59":{"start":{"line":73,"column":8},"end":{"line":74,"column":19}},"60":{"start":{"line":74,"column":12},"end":{"line":74,"column":19}},"61":{"start":{"line":75,"column":36},"end":{"line":75,"column":76}},"62":{"start":{"line":76,"column":8},"end":{"line":76,"column":68}},"63":{"start":{"line":77,"column":8},"end":{"line":78,"column":19}},"64":{"start":{"line":78,"column":12},"end":{"line":78,"column":19}},"65":{"start":{"line":79,"column":31},"end":{"line":79,"column":66}},"66":{"start":{"line":80,"column":8},"end":{"line":80,"column":58}},"67":{"start":{"line":83,"column":23},"end":{"line":86,"column":1}},"68":{"start":{"line":87,"column":0},"end":{"line":87,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":38},"end":{"line":11,"column":39}},"loc":{"start":{"line":11,"column":54},"end":{"line":21,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":22,"column":56},"end":{"line":22,"column":57}},"loc":{"start":{"line":22,"column":71},"end":{"line":24,"column":1}},"line":22},"9":{"name":"(anonymous_9)","decl":{"start":{"line":30,"column":28},"end":{"line":30,"column":29}},"loc":{"start":{"line":30,"column":42},"end":{"line":32,"column":1}},"line":30},"10":{"name":"(anonymous_10)","decl":{"start":{"line":33,"column":31},"end":{"line":33,"column":32}},"loc":{"start":{"line":33,"column":53},"end":{"line":35,"column":1}},"line":33},"11":{"name":"(anonymous_11)","decl":{"start":{"line":36,"column":26},"end":{"line":36,"column":27}},"loc":{"start":{"line":36,"column":48},"end":{"line":38,"column":1}},"line":36},"12":{"name":"parse","decl":{"start":{"line":39,"column":9},"end":{"line":39,"column":14}},"loc":{"start":{"line":39,"column":24},"end":{"line":64,"column":1}},"line":39},"13":{"name":"(anonymous_13)","decl":{"start":{"line":43,"column":29},"end":{"line":43,"column":30}},"loc":{"start":{"line":43,"column":35},"end":{"line":51,"column":5}},"line":43},"14":{"name":"(anonymous_14)","decl":{"start":{"line":52,"column":24},"end":{"line":52,"column":25}},"loc":{"start":{"line":52,"column":30},"end":{"line":60,"column":5}},"line":52},"15":{"name":"dump","decl":{"start":{"line":65,"column":9},"end":{"line":65,"column":13}},"loc":{"start":{"line":65,"column":23},"end":{"line":82,"column":1}},"line":65},"16":{"name":"(anonymous_16)","decl":{"start":{"line":66,"column":43},"end":{"line":66,"column":44}},"loc":{"start":{"line":66,"column":56},"end":{"line":81,"column":5}},"line":66}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":13},"end":{"line":21,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":14},"end":{"line":11,"column":18}},{"start":{"line":11,"column":22},"end":{"line":11,"column":33}},{"start":{"line":11,"column":38},"end":{"line":21,"column":1}}],"line":11},"6":{"loc":{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},"type":"if","locations":[{"start":{"line":13,"column":21},"end":{"line":14,"column":20}},{"start":{"line":13,"column":21},"end":{"line":14,"column":20}}],"line":13},"7":{"loc":{"start":{"line":13,"column":25},"end":{"line":13,"column":87}},"type":"binary-expr","locations":[{"start":{"line":13,"column":25},"end":{"line":13,"column":67}},{"start":{"line":13,"column":71},"end":{"line":13,"column":87}}],"line":13},"8":{"loc":{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},"type":"if","locations":[{"start":{"line":15,"column":4},"end":{"line":19,"column":9}},{"start":{"line":15,"column":4},"end":{"line":19,"column":9}}],"line":15},"9":{"loc":{"start":{"line":15,"column":8},"end":{"line":15,"column":71}},"type":"binary-expr","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":17}},{"start":{"line":15,"column":21},"end":{"line":15,"column":71}}],"line":15},"10":{"loc":{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":18,"column":34}},{"start":{"line":17,"column":12},"end":{"line":18,"column":34}}],"line":17},"11":{"loc":{"start":{"line":17,"column":16},"end":{"line":17,"column":90}},"type":"binary-expr","locations":[{"start":{"line":17,"column":16},"end":{"line":17,"column":35}},{"start":{"line":17,"column":39},"end":{"line":17,"column":90}}],"line":17},"12":{"loc":{"start":{"line":22,"column":22},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":22,"column":23},"end":{"line":22,"column":27}},{"start":{"line":22,"column":31},"end":{"line":22,"column":51}},{"start":{"line":22,"column":56},"end":{"line":24,"column":1}}],"line":22},"13":{"loc":{"start":{"line":23,"column":11},"end":{"line":23,"column":61}},"type":"cond-expr","locations":[{"start":{"line":23,"column":37},"end":{"line":23,"column":40}},{"start":{"line":23,"column":43},"end":{"line":23,"column":61}}],"line":23},"14":{"loc":{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},"type":"binary-expr","locations":[{"start":{"line":23,"column":12},"end":{"line":23,"column":15}},{"start":{"line":23,"column":19},"end":{"line":23,"column":33}}],"line":23},"15":{"loc":{"start":{"line":41,"column":4},"end":{"line":42,"column":33}},"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":42,"column":33}},{"start":{"line":41,"column":4},"end":{"line":42,"column":33}}],"line":41},"16":{"loc":{"start":{"line":45,"column":8},"end":{"line":46,"column":22}},"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":46,"column":22}},{"start":{"line":45,"column":8},"end":{"line":46,"column":22}}],"line":45},"17":{"loc":{"start":{"line":54,"column":8},"end":{"line":55,"column":22}},"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":55,"column":22}},{"start":{"line":54,"column":8},"end":{"line":55,"column":22}}],"line":54},"18":{"loc":{"start":{"line":68,"column":8},"end":{"line":69,"column":19}},"type":"if","locations":[{"start":{"line":68,"column":8},"end":{"line":69,"column":19}},{"start":{"line":68,"column":8},"end":{"line":69,"column":19}}],"line":68},"19":{"loc":{"start":{"line":73,"column":8},"end":{"line":74,"column":19}},"type":"if","locations":[{"start":{"line":73,"column":8},"end":{"line":74,"column":19}},{"start":{"line":73,"column":8},"end":{"line":74,"column":19}}],"line":73},"20":{"loc":{"start":{"line":77,"column":8},"end":{"line":78,"column":19}},"type":"if","locations":[{"start":{"line":77,"column":8},"end":{"line":78,"column":19}},{"start":{"line":77,"column":8},"end":{"line":78,"column":19}}],"line":77}},"s":{"0":1,"1":0,"2":0,"3":3,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":3,"11":3,"12":1,"13":1,"14":1,"15":3,"16":2,"17":1,"18":1,"19":1,"20":1,"21":0,"22":0,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":51,"33":1,"34":4,"35":1,"36":4,"37":50,"38":50,"39":47,"40":3,"41":3,"42":3,"43":1,"44":2,"45":3,"46":3,"47":3,"48":2,"49":1,"50":3,"51":3,"52":3,"53":3,"54":2,"55":1,"56":1,"57":1,"58":1,"59":1,"60":0,"61":1,"62":1,"63":1,"64":0,"65":1,"66":1,"67":1,"68":1},"f":{"0":3,"1":0,"2":0,"3":3,"4":0,"5":0,"6":3,"7":1,"8":1,"9":51,"10":4,"11":4,"12":50,"13":3,"14":3,"15":3,"16":3},"b":{"0":[1,1,1],"1":[0,0],"2":[3,3],"3":[3,0],"4":[3,3],"5":[1,1,1],"6":[2,1],"7":[3,3],"8":[1,0],"9":[1,1],"10":[0,0],"11":[0,0],"12":[1,1,1],"13":[0,1],"14":[1,1],"15":[47,3],"16":[1,2],"17":[2,1],"18":[2,1],"19":[0,1],"20":[0,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/prompts.ts","sources":["/home/circleci/repo/src/context/directory/handlers/prompts.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,uCAAyC;AACzC,0CAA2C;AAC3C,0CAA6E;AAY7E,MAAM,mBAAmB,GAAG,CAAC,QAAgB,EAAE,EAAE;IAC/C,OAAO,cAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,iBAAS,CAAC,iBAAiB,CAAC,CAAC;AAC1D,CAAC,CAAC;AAEF,MAAM,sBAAsB,GAAG,CAAC,gBAAwB,EAAE,EAAE;IAC1D,OAAO,cAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,cAAc,CAAC,CAAC;AACrD,CAAC,CAAC;AAEF,MAAM,iBAAiB,GAAG,CAAC,gBAAwB,EAAE,EAAE;IACrD,OAAO,cAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,kBAAkB,CAAC,CAAC;AACzD,CAAC,CAAC;AAEF,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,gBAAgB,GAAG,mBAAmB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAC/D,IAAI,CAAC,IAAA,uBAAe,EAAC,gBAAgB,CAAC;QAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAEzE,MAAM,eAAe,GAAG,CAAC,GAAG,EAAE;QAC5B,MAAM,mBAAmB,GAAG,sBAAsB,CAAC,gBAAgB,CAAC,CAAC;QACrE,IAAI,CAAC,IAAA,cAAM,EAAC,mBAAmB,CAAC;YAAE,OAAO,EAAE,CAAC;QAC5C,OAAO,IAAA,gBAAQ,EAAC,mBAAmB,EAAE;YACnC,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAmB,CAAC;IACvB,CAAC,CAAC,EAAE,CAAC;IAEL,MAAM,UAAU,GAAG,CAAC,GAAG,EAAE;QACvB,MAAM,cAAc,GAAG,iBAAiB,CAAC,gBAAgB,CAAC,CAAC;QAC3D,IAAI,CAAC,IAAA,cAAM,EAAC,cAAc,CAAC;YAAE,OAAO,EAAE,CAAC;QACvC,OAAO,IAAA,gBAAQ,EAAC,cAAc,EAAE;YAC9B,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAyB,CAAC;IAC7B,CAAC,CAAC,EAAE,CAAC;IAEL,OAAO;QACL,OAAO,kCACF,eAAe,KAClB,UAAU,GACX;KACF,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,OAAO,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEnC,IAAI,CAAC,OAAO;YAAE,OAAO;QAErB,MAAM,EAAE,UAAU,KAAyB,OAAO,EAA3B,eAAe,UAAK,OAAO,EAA5C,cAAkC,CAAU,CAAC;QAEnD,MAAM,gBAAgB,GAAG,mBAAmB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QAC/D,IAAA,wBAAa,EAAC,gBAAgB,CAAC,CAAC;QAEhC,IAAI,CAAC,eAAe;YAAE,OAAO;QAC7B,MAAM,mBAAmB,GAAG,sBAAsB,CAAC,gBAAgB,CAAC,CAAC;QACrE,IAAA,gBAAQ,EAAC,mBAAmB,EAAE,eAAe,CAAC,CAAC;QAE/C,IAAI,CAAC,UAAU;YAAE,OAAO;QACxB,MAAM,cAAc,GAAG,iBAAiB,CAAC,gBAAgB,CAAC,CAAC;QAC3D,IAAA,gBAAQ,EAAC,cAAc,EAAE,UAAU,CAAC,CAAC;IACvC,CAAC;CAAA;AAED,MAAM,cAAc,GAAoC;IACtD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,cAAc,CAAC","sourcesContent":["import path from 'path';\nimport { ensureDirSync } from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { existsMustBeDir, dumpJSON, loadJSON, isFile } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport {\n  Prompts,\n  PromptSettings,\n  AllPromptsByLanguage,\n} from '../../../tools/auth0/handlers/prompts';\n\ntype ParsedPrompts = ParsedAsset<'prompts', Prompts>;\n\nconst getPromptsDirectory = (filePath: string) => {\n  return path.join(filePath, constants.PROMPTS_DIRECTORY);\n};\n\nconst getPromptsSettingsFile = (promptsDirectory: string) => {\n  return path.join(promptsDirectory, 'prompts.json');\n};\n\nconst getCustomTextFile = (promptsDirectory: string) => {\n  return path.join(promptsDirectory, 'custom-text.json');\n};\n\nfunction parse(context: DirectoryContext): ParsedPrompts {\n  const promptsDirectory = getPromptsDirectory(context.filePath);\n  if (!existsMustBeDir(promptsDirectory)) return { prompts: null }; // Skip\n\n  const promptsSettings = (() => {\n    const promptsSettingsFile = getPromptsSettingsFile(promptsDirectory);\n    if (!isFile(promptsSettingsFile)) return {};\n    return loadJSON(promptsSettingsFile, {\n      mappings: context.mappings,\n      disableKeywordReplacement: context.disableKeywordReplacement,\n    }) as PromptSettings;\n  })();\n\n  const customText = (() => {\n    const customTextFile = getCustomTextFile(promptsDirectory);\n    if (!isFile(customTextFile)) return {};\n    return loadJSON(customTextFile, {\n      mappings: context.mappings,\n      disableKeywordReplacement: context.disableKeywordReplacement,\n    }) as AllPromptsByLanguage;\n  })();\n\n  return {\n    prompts: {\n      ...promptsSettings,\n      customText,\n    },\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { prompts } = context.assets;\n\n  if (!prompts) return;\n\n  const { customText, ...promptsSettings } = prompts;\n\n  const promptsDirectory = getPromptsDirectory(context.filePath);\n  ensureDirSync(promptsDirectory);\n\n  if (!promptsSettings) return;\n  const promptsSettingsFile = getPromptsSettingsFile(promptsDirectory);\n  dumpJSON(promptsSettingsFile, promptsSettings);\n\n  if (!customText) return;\n  const customTextFile = getCustomTextFile(promptsDirectory);\n  dumpJSON(customTextFile, customText);\n}\n\nconst promptsHandler: DirectoryHandler<ParsedPrompts> = {\n  parse,\n  dump,\n};\n\nexport default promptsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"163ddf52a585eace908dd2a576b7c1a4a96aa673","contentHash":"d6d45b073115ae8b7a89869ac3b8608e8b10d614109f4e42b498c7d71d43f262"},"/home/circleci/repo/src/context/directory/handlers/customDomains.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/customDomains.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":55}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":19,"column":34},"end":{"line":19,"column":121}},"20":{"start":{"line":19,"column":48},"end":{"line":19,"column":121}},"21":{"start":{"line":20,"column":29},"end":{"line":20,"column":122}},"22":{"start":{"line":20,"column":43},"end":{"line":20,"column":122}},"23":{"start":{"line":22,"column":35},"end":{"line":22,"column":78}},"24":{"start":{"line":23,"column":4},"end":{"line":24,"column":39}},"25":{"start":{"line":24,"column":8},"end":{"line":24,"column":39}},"26":{"start":{"line":25,"column":30},"end":{"line":25,"column":68}},"27":{"start":{"line":26,"column":4},"end":{"line":31,"column":6}},"28":{"start":{"line":34,"column":4},"end":{"line":43,"column":7}},"29":{"start":{"line":35,"column":34},"end":{"line":35,"column":48}},"30":{"start":{"line":36,"column":8},"end":{"line":37,"column":19}},"31":{"start":{"line":37,"column":12},"end":{"line":37,"column":19}},"32":{"start":{"line":39,"column":39},"end":{"line":39,"column":82}},"33":{"start":{"line":40,"column":8},"end":{"line":40,"column":65}},"34":{"start":{"line":41,"column":34},"end":{"line":41,"column":72}},"35":{"start":{"line":42,"column":8},"end":{"line":42,"column":64}},"36":{"start":{"line":45,"column":29},"end":{"line":48,"column":1}},"37":{"start":{"line":49,"column":0},"end":{"line":49,"column":39}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":19,"column":34},"end":{"line":19,"column":35}},"loc":{"start":{"line":19,"column":48},"end":{"line":19,"column":121}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":20,"column":29},"end":{"line":20,"column":30}},"loc":{"start":{"line":20,"column":43},"end":{"line":20,"column":122}},"line":20},"10":{"name":"parse","decl":{"start":{"line":21,"column":9},"end":{"line":21,"column":14}},"loc":{"start":{"line":21,"column":24},"end":{"line":32,"column":1}},"line":21},"11":{"name":"dump","decl":{"start":{"line":33,"column":9},"end":{"line":33,"column":13}},"loc":{"start":{"line":33,"column":23},"end":{"line":44,"column":1}},"line":33},"12":{"name":"(anonymous_12)","decl":{"start":{"line":34,"column":43},"end":{"line":34,"column":44}},"loc":{"start":{"line":34,"column":56},"end":{"line":43,"column":5}},"line":34}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":23,"column":4},"end":{"line":24,"column":39}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":24,"column":39}},{"start":{"line":23,"column":4},"end":{"line":24,"column":39}}],"line":23},"9":{"loc":{"start":{"line":36,"column":8},"end":{"line":37,"column":19}},"type":"if","locations":[{"start":{"line":36,"column":8},"end":{"line":37,"column":19}},{"start":{"line":36,"column":8},"end":{"line":37,"column":19}}],"line":36}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":50,"21":1,"22":0,"23":50,"24":50,"25":50,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1,"37":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":2,"8":50,"9":0,"10":50,"11":0,"12":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[50,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/customDomains.ts","sources":["/home/circleci/repo/src/context/directory/handlers/customDomains.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,wDAA0B;AAC1B,0CAA2C;AAC3C,0CAAqE;AAOrE,MAAM,yBAAyB,GAAG,CAAC,QAAgB,EAAE,EAAE,CACrD,cAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,iBAAS,CAAC,wBAAwB,CAAC,CAAC;AAE1D,MAAM,oBAAoB,GAAG,CAAC,QAAgB,EAAE,EAAE,CAChD,cAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,QAAQ,CAAC,EAAE,qBAAqB,CAAC,CAAC;AAExE,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,sBAAsB,GAAG,yBAAyB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAC3E,IAAI,CAAC,IAAA,uBAAe,EAAC,sBAAsB,CAAC;QAAE,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO;IAErF,MAAM,iBAAiB,GAAG,oBAAoB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAEjE,OAAO;QACL,aAAa,EAAE,IAAA,gBAAQ,EAAC,iBAAiB,EAAE;YACzC,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;SAC7D,CAAC;KACH,CAAC;AACJ,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAEzC,IAAI,CAAC,aAAa;YAAE,OAAO,CAAC,wBAAwB;QAEpD,sBAAsB;QACtB,MAAM,sBAAsB,GAAG,yBAAyB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QAC3E,kBAAE,CAAC,aAAa,CAAC,sBAAsB,CAAC,CAAC;QAEzC,MAAM,iBAAiB,GAAG,oBAAoB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QACjE,IAAA,gBAAQ,EAAC,iBAAiB,EAAE,aAAa,CAAC,CAAC;IAC7C,CAAC;CAAA;AAED,MAAM,oBAAoB,GAA0C;IAClE,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,oBAAoB,CAAC","sourcesContent":["import path from 'path';\nimport fs from 'fs-extra';\nimport { constants } from '../../../tools';\nimport { existsMustBeDir, dumpJSON, loadJSON } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { Asset, ParsedAsset } from '../../../types';\n\ntype ParsedCustomDomains = ParsedAsset<'customDomains', Asset[]>;\n\nconst getCustomDomainsDirectory = (filePath: string) =>\n  path.join(filePath, constants.CUSTOM_DOMAINS_DIRECTORY);\n\nconst getCustomDomainsFile = (filePath: string) =>\n  path.join(getCustomDomainsDirectory(filePath), 'custom-domains.json');\n\nfunction parse(context: DirectoryContext): ParsedCustomDomains {\n  const customDomainsDirectory = getCustomDomainsDirectory(context.filePath);\n  if (!existsMustBeDir(customDomainsDirectory)) return { customDomains: null }; // Skip\n\n  const customDomainsFile = getCustomDomainsFile(context.filePath);\n\n  return {\n    customDomains: loadJSON(customDomainsFile, {\n      mappings: context.mappings,\n      disableKeywordReplacement: context.disableKeywordReplacement,\n    }),\n  };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { customDomains } = context.assets;\n\n  if (!customDomains) return; // Skip, nothing to dump\n\n  // Create Rules folder\n  const customDomainsDirectory = getCustomDomainsDirectory(context.filePath);\n  fs.ensureDirSync(customDomainsDirectory);\n\n  const customDomainsFile = getCustomDomainsFile(context.filePath);\n  dumpJSON(customDomainsFile, customDomains);\n}\n\nconst customDomainsHandler: DirectoryHandler<ParsedCustomDomains> = {\n  parse,\n  dump,\n};\n\nexport default customDomainsHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b52496d92ff11ca43ee4c034bdc18eecb602ec7d","contentHash":"43fffa9047fca65002a6102e7f9ec83c68e4caf8e33c393427e8d394dad76dde"},"/home/circleci/repo/src/context/directory/handlers/themes.ts":{"path":"/home/circleci/repo/src/context/directory/handlers/themes.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":19},"end":{"line":16,"column":38}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":41}},"18":{"start":{"line":18,"column":16},"end":{"line":18,"column":41}},"19":{"start":{"line":20,"column":23},"end":{"line":20,"column":96}},"20":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":32}},"22":{"start":{"line":24,"column":34},"end":{"line":24,"column":78}},"23":{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},"24":{"start":{"line":26,"column":8},"end":{"line":26,"column":30}},"25":{"start":{"line":28,"column":19},"end":{"line":31,"column":7}},"26":{"start":{"line":28,"column":71},"end":{"line":31,"column":6}},"27":{"start":{"line":32,"column":4},"end":{"line":32,"column":22}},"28":{"start":{"line":35,"column":4},"end":{"line":45,"column":7}},"29":{"start":{"line":36,"column":27},"end":{"line":36,"column":41}},"30":{"start":{"line":37,"column":8},"end":{"line":39,"column":9}},"31":{"start":{"line":38,"column":12},"end":{"line":38,"column":19}},"32":{"start":{"line":40,"column":27},"end":{"line":40,"column":100}},"33":{"start":{"line":41,"column":8},"end":{"line":41,"column":50}},"34":{"start":{"line":42,"column":8},"end":{"line":44,"column":11}},"35":{"start":{"line":43,"column":12},"end":{"line":43,"column":111}},"36":{"start":{"line":47,"column":22},"end":{"line":50,"column":1}},"37":{"start":{"line":51,"column":0},"end":{"line":51,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"parse","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":14}},"loc":{"start":{"line":19,"column":24},"end":{"line":33,"column":1}},"line":19},"9":{"name":"(anonymous_9)","decl":{"start":{"line":28,"column":45},"end":{"line":28,"column":46}},"loc":{"start":{"line":28,"column":71},"end":{"line":31,"column":6}},"line":28},"10":{"name":"dump","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":13}},"loc":{"start":{"line":34,"column":23},"end":{"line":46,"column":1}},"line":34},"11":{"name":"(anonymous_11)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":56},"end":{"line":45,"column":5}},"line":35},"12":{"name":"(anonymous_12)","decl":{"start":{"line":42,"column":23},"end":{"line":42,"column":24}},"loc":{"start":{"line":42,"column":47},"end":{"line":44,"column":9}},"line":42}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},{"start":{"line":21,"column":4},"end":{"line":23,"column":5}}],"line":21},"9":{"loc":{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},{"start":{"line":25,"column":4},"end":{"line":27,"column":5}}],"line":25},"10":{"loc":{"start":{"line":37,"column":8},"end":{"line":39,"column":9}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":39,"column":9}},{"start":{"line":37,"column":8},"end":{"line":39,"column":9}}],"line":37},"11":{"loc":{"start":{"line":43,"column":74},"end":{"line":43,"column":84}},"type":"cond-expr","locations":[{"start":{"line":43,"column":78},"end":{"line":43,"column":79}},{"start":{"line":43,"column":82},"end":{"line":43,"column":84}}],"line":43}},"s":{"0":1,"1":0,"2":0,"3":2,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":2,"11":2,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":50,"20":50,"21":48,"22":2,"23":2,"24":0,"25":2,"26":3,"27":2,"28":2,"29":2,"30":2,"31":0,"32":2,"33":2,"34":2,"35":3,"36":1,"37":1},"f":{"0":2,"1":0,"2":0,"3":2,"4":0,"5":0,"6":2,"7":1,"8":50,"9":3,"10":2,"11":2,"12":3},"b":{"0":[1,1,1],"1":[0,0],"2":[2,2],"3":[2,0],"4":[2,2],"5":[1,1,1],"6":[0,1],"7":[1,1],"8":[48,2],"9":[0,2],"10":[0,2],"11":[1,2]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/context/directory/handlers/themes.ts","sources":["/home/circleci/repo/src/context/directory/handlers/themes.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,uCAAyC;AACzC,0CAA+E;AAK/E,0CAA2C;AAI3C,SAAS,KAAK,CAAC,OAAyB;IACtC,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,gBAAgB,CAAC,CAAC;IAC3E,IAAI,CAAC,IAAA,uBAAe,EAAC,UAAU,CAAC,EAAE;QAChC,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;KACzB;IAED,MAAM,qBAAqB,GAAG,IAAA,gBAAQ,EAAC,UAAU,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAC9D,IAAI,CAAC,qBAAqB,CAAC,MAAM,EAAE;QACjC,OAAO,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC;KACvB;IAED,MAAM,MAAM,GAAG,qBAAqB,CAAC,GAAG,CACtC,CAAC,oBAAoB,EAAE,EAAE,CACvB,IAAA,gBAAQ,EAAC,oBAAoB,EAAE;QAC7B,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,yBAAyB,EAAE,OAAO,CAAC,yBAAyB;KAC7D,CAAU,CACd,CAAC;IACF,OAAO,EAAE,MAAM,EAAE,CAAC;AACpB,CAAC;AAED,SAAe,IAAI,CAAC,OAAyB;;QAC3C,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC;QAClC,IAAI,CAAC,MAAM,EAAE;YACX,OAAO;SACR;QAED,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,iBAAS,CAAC,gBAAgB,CAAC,CAAC;QAC3E,IAAA,wBAAa,EAAC,UAAU,CAAC,CAAC;QAE1B,MAAM,CAAC,OAAO,CAAC,CAAC,eAAe,EAAE,CAAC,EAAE,EAAE;YACpC,IAAA,gBAAQ,EAAC,cAAI,CAAC,IAAI,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,eAAe,CAAC,CAAC;QAC9E,CAAC,CAAC,CAAC;IACL,CAAC;CAAA;AAED,MAAM,aAAa,GAAmC;IACpD,KAAK;IACL,IAAI;CACL,CAAC;AAEF,kBAAe,aAAa,CAAC","sourcesContent":["import path from 'path';\nimport { ensureDirSync } from 'fs-extra';\nimport { getFiles, dumpJSON, loadJSON, existsMustBeDir } from '../../../utils';\nimport { DirectoryHandler } from '.';\nimport DirectoryContext from '..';\nimport { ParsedAsset } from '../../../types';\nimport { Theme } from '../../../tools/auth0/handlers/themes';\nimport { constants } from '../../../tools';\n\ntype ParsedThemes = ParsedAsset<'themes', Theme[]>;\n\nfunction parse(context: DirectoryContext): ParsedThemes {\n  const baseFolder = path.join(context.filePath, constants.THEMES_DIRECTORY);\n  if (!existsMustBeDir(baseFolder)) {\n    return { themes: null };\n  }\n\n  const themeDefinitionsFiles = getFiles(baseFolder, ['.json']);\n  if (!themeDefinitionsFiles.length) {\n    return { themes: [] };\n  }\n\n  const themes = themeDefinitionsFiles.map(\n    (themeDefinitionsFile) =>\n      loadJSON(themeDefinitionsFile, {\n        mappings: context.mappings,\n        disableKeywordReplacement: context.disableKeywordReplacement,\n      }) as Theme\n  );\n  return { themes };\n}\n\nasync function dump(context: DirectoryContext): Promise<void> {\n  const { themes } = context.assets;\n  if (!themes) {\n    return;\n  }\n\n  const baseFolder = path.join(context.filePath, constants.THEMES_DIRECTORY);\n  ensureDirSync(baseFolder);\n\n  themes.forEach((themeDefinition, i) => {\n    dumpJSON(path.join(baseFolder, `theme${i ? i : ''}.json`), themeDefinition);\n  });\n}\n\nconst themesHandler: DirectoryHandler<ParsedThemes> = {\n  parse,\n  dump,\n};\n\nexport default themesHandler;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c3a75eefc5099532990fc995a4f8a130c8d3c679","contentHash":"4ff4e5fda3ff84a2181622d197ae4c5d947f5b8529b8ebc96be825e83d5d92ea"},"/home/circleci/repo/src/index.ts":{"path":"/home/circleci/repo/src/index.ts","statementMap":{"0":{"start":{"line":3,"column":16},"end":{"line":11,"column":1}},"1":{"start":{"line":4,"column":28},"end":{"line":4,"column":110}},"2":{"start":{"line":4,"column":91},"end":{"line":4,"column":106}},"3":{"start":{"line":5,"column":4},"end":{"line":10,"column":7}},"4":{"start":{"line":6,"column":36},"end":{"line":6,"column":97}},"5":{"start":{"line":6,"column":42},"end":{"line":6,"column":70}},"6":{"start":{"line":6,"column":85},"end":{"line":6,"column":95}},"7":{"start":{"line":7,"column":35},"end":{"line":7,"column":100}},"8":{"start":{"line":7,"column":41},"end":{"line":7,"column":73}},"9":{"start":{"line":7,"column":88},"end":{"line":7,"column":98}},"10":{"start":{"line":8,"column":32},"end":{"line":8,"column":116}},"11":{"start":{"line":9,"column":8},"end":{"line":9,"column":78}},"12":{"start":{"line":12,"column":22},"end":{"line":14,"column":1}},"13":{"start":{"line":13,"column":4},"end":{"line":13,"column":62}},"14":{"start":{"line":15,"column":0},"end":{"line":15,"column":62}},"15":{"start":{"line":16,"column":0},"end":{"line":16,"column":39}},"16":{"start":{"line":17,"column":23},"end":{"line":17,"column":46}},"17":{"start":{"line":18,"column":15},"end":{"line":18,"column":32}},"18":{"start":{"line":19,"column":17},"end":{"line":19,"column":53}},"19":{"start":{"line":20,"column":16},"end":{"line":20,"column":51}},"20":{"start":{"line":21,"column":17},"end":{"line":21,"column":62}},"21":{"start":{"line":22,"column":17},"end":{"line":22,"column":62}},"22":{"start":{"line":24,"column":4},"end":{"line":45,"column":7}},"23":{"start":{"line":26,"column":24},"end":{"line":26,"column":35}},"24":{"start":{"line":27,"column":22},"end":{"line":27,"column":38}},"25":{"start":{"line":28,"column":8},"end":{"line":36,"column":9}},"26":{"start":{"line":29,"column":41},"end":{"line":29,"column":93}},"27":{"start":{"line":30,"column":12},"end":{"line":33,"column":13}},"28":{"start":{"line":32,"column":16},"end":{"line":32,"column":90}},"29":{"start":{"line":34,"column":12},"end":{"line":34,"column":56}},"30":{"start":{"line":35,"column":12},"end":{"line":35,"column":44}},"31":{"start":{"line":37,"column":8},"end":{"line":37,"column":59}},"32":{"start":{"line":38,"column":8},"end":{"line":40,"column":9}},"33":{"start":{"line":39,"column":12},"end":{"line":39,"column":48}},"34":{"start":{"line":41,"column":8},"end":{"line":43,"column":9}},"35":{"start":{"line":42,"column":12},"end":{"line":42,"column":48}},"36":{"start":{"line":44,"column":8},"end":{"line":44,"column":62}},"37":{"start":{"line":48,"column":0},"end":{"line":78,"column":1}},"38":{"start":{"line":50,"column":19},"end":{"line":50,"column":42}},"39":{"start":{"line":51,"column":4},"end":{"line":51,"column":61}},"40":{"start":{"line":52,"column":4},"end":{"line":57,"column":5}},"41":{"start":{"line":53,"column":8},"end":{"line":53,"column":41}},"42":{"start":{"line":55,"column":8},"end":{"line":55,"column":41}},"43":{"start":{"line":56,"column":8},"end":{"line":56,"column":40}},"44":{"start":{"line":58,"column":4},"end":{"line":77,"column":7}},"45":{"start":{"line":59,"column":20},"end":{"line":59,"column":35}},"46":{"start":{"line":61,"column":24},"end":{"line":61,"column":35}},"47":{"start":{"line":62,"column":8},"end":{"line":67,"column":9}},"48":{"start":{"line":63,"column":12},"end":{"line":63,"column":136}},"49":{"start":{"line":66,"column":12},"end":{"line":66,"column":73}},"50":{"start":{"line":68,"column":20},"end":{"line":68,"column":53}},"51":{"start":{"line":69,"column":8},"end":{"line":69,"column":36}},"52":{"start":{"line":70,"column":8},"end":{"line":72,"column":9}},"53":{"start":{"line":71,"column":12},"end":{"line":71,"column":48}},"54":{"start":{"line":73,"column":8},"end":{"line":75,"column":9}},"55":{"start":{"line":74,"column":12},"end":{"line":74,"column":147}},"56":{"start":{"line":76,"column":8},"end":{"line":76,"column":24}},"57":{"start":{"line":80,"column":0},"end":{"line":86,"column":2}},"58":{"start":{"line":87,"column":0},"end":{"line":87,"column":32}},"59":{"start":{"line":88,"column":0},"end":{"line":88,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":44},"end":{"line":3,"column":45}},"loc":{"start":{"line":3,"column":89},"end":{"line":11,"column":1}},"line":3},"1":{"name":"adopt","decl":{"start":{"line":4,"column":13},"end":{"line":4,"column":18}},"loc":{"start":{"line":4,"column":26},"end":{"line":4,"column":112}},"line":4},"2":{"name":"(anonymous_2)","decl":{"start":{"line":4,"column":70},"end":{"line":4,"column":71}},"loc":{"start":{"line":4,"column":89},"end":{"line":4,"column":108}},"line":4},"3":{"name":"(anonymous_3)","decl":{"start":{"line":5,"column":36},"end":{"line":5,"column":37}},"loc":{"start":{"line":5,"column":63},"end":{"line":10,"column":5}},"line":5},"4":{"name":"fulfilled","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":26}},"loc":{"start":{"line":6,"column":34},"end":{"line":6,"column":99}},"line":6},"5":{"name":"rejected","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":25}},"loc":{"start":{"line":7,"column":33},"end":{"line":7,"column":102}},"line":7},"6":{"name":"step","decl":{"start":{"line":8,"column":17},"end":{"line":8,"column":21}},"loc":{"start":{"line":8,"column":30},"end":{"line":8,"column":118}},"line":8},"7":{"name":"(anonymous_7)","decl":{"start":{"line":12,"column":56},"end":{"line":12,"column":57}},"loc":{"start":{"line":12,"column":71},"end":{"line":14,"column":1}},"line":12},"8":{"name":"run","decl":{"start":{"line":23,"column":9},"end":{"line":23,"column":12}},"loc":{"start":{"line":23,"column":21},"end":{"line":46,"column":1}},"line":23},"9":{"name":"(anonymous_9)","decl":{"start":{"line":24,"column":43},"end":{"line":24,"column":44}},"loc":{"start":{"line":24,"column":56},"end":{"line":45,"column":5}},"line":24},"10":{"name":"(anonymous_10)","decl":{"start":{"line":59,"column":14},"end":{"line":59,"column":15}},"loc":{"start":{"line":59,"column":20},"end":{"line":59,"column":35}},"line":59},"11":{"name":"(anonymous_11)","decl":{"start":{"line":60,"column":15},"end":{"line":60,"column":16}},"loc":{"start":{"line":60,"column":26},"end":{"line":77,"column":5}},"line":60}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":16},"end":{"line":11,"column":1}},"type":"binary-expr","locations":[{"start":{"line":3,"column":17},"end":{"line":3,"column":21}},{"start":{"line":3,"column":25},"end":{"line":3,"column":39}},{"start":{"line":3,"column":44},"end":{"line":11,"column":1}}],"line":3},"1":{"loc":{"start":{"line":4,"column":35},"end":{"line":4,"column":109}},"type":"cond-expr","locations":[{"start":{"line":4,"column":56},"end":{"line":4,"column":61}},{"start":{"line":4,"column":64},"end":{"line":4,"column":109}}],"line":4},"2":{"loc":{"start":{"line":5,"column":16},"end":{"line":5,"column":34}},"type":"binary-expr","locations":[{"start":{"line":5,"column":16},"end":{"line":5,"column":17}},{"start":{"line":5,"column":22},"end":{"line":5,"column":33}}],"line":5},"3":{"loc":{"start":{"line":8,"column":32},"end":{"line":8,"column":115}},"type":"cond-expr","locations":[{"start":{"line":8,"column":46},"end":{"line":8,"column":67}},{"start":{"line":8,"column":70},"end":{"line":8,"column":115}}],"line":8},"4":{"loc":{"start":{"line":9,"column":51},"end":{"line":9,"column":67}},"type":"binary-expr","locations":[{"start":{"line":9,"column":51},"end":{"line":9,"column":61}},{"start":{"line":9,"column":65},"end":{"line":9,"column":67}}],"line":9},"5":{"loc":{"start":{"line":12,"column":22},"end":{"line":14,"column":1}},"type":"binary-expr","locations":[{"start":{"line":12,"column":23},"end":{"line":12,"column":27}},{"start":{"line":12,"column":31},"end":{"line":12,"column":51}},{"start":{"line":12,"column":56},"end":{"line":14,"column":1}}],"line":12},"6":{"loc":{"start":{"line":13,"column":11},"end":{"line":13,"column":61}},"type":"cond-expr","locations":[{"start":{"line":13,"column":37},"end":{"line":13,"column":40}},{"start":{"line":13,"column":43},"end":{"line":13,"column":61}}],"line":13},"7":{"loc":{"start":{"line":13,"column":12},"end":{"line":13,"column":33}},"type":"binary-expr","locations":[{"start":{"line":13,"column":12},"end":{"line":13,"column":15}},{"start":{"line":13,"column":19},"end":{"line":13,"column":33}}],"line":13},"8":{"loc":{"start":{"line":28,"column":8},"end":{"line":36,"column":9}},"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":36,"column":9}},{"start":{"line":28,"column":8},"end":{"line":36,"column":9}}],"line":28},"9":{"loc":{"start":{"line":30,"column":12},"end":{"line":33,"column":13}},"type":"if","locations":[{"start":{"line":30,"column":12},"end":{"line":33,"column":13}},{"start":{"line":30,"column":12},"end":{"line":33,"column":13}}],"line":30},"10":{"loc":{"start":{"line":38,"column":8},"end":{"line":40,"column":9}},"type":"if","locations":[{"start":{"line":38,"column":8},"end":{"line":40,"column":9}},{"start":{"line":38,"column":8},"end":{"line":40,"column":9}}],"line":38},"11":{"loc":{"start":{"line":38,"column":12},"end":{"line":38,"column":76}},"type":"binary-expr","locations":[{"start":{"line":38,"column":12},"end":{"line":38,"column":50}},{"start":{"line":38,"column":54},"end":{"line":38,"column":76}}],"line":38},"12":{"loc":{"start":{"line":41,"column":8},"end":{"line":43,"column":9}},"type":"if","locations":[{"start":{"line":41,"column":8},"end":{"line":43,"column":9}},{"start":{"line":41,"column":8},"end":{"line":43,"column":9}}],"line":41},"13":{"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":77}},"type":"binary-expr","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":48}},{"start":{"line":41,"column":52},"end":{"line":41,"column":77}}],"line":41},"14":{"loc":{"start":{"line":48,"column":0},"end":{"line":78,"column":1}},"type":"if","locations":[{"start":{"line":48,"column":0},"end":{"line":78,"column":1}},{"start":{"line":48,"column":0},"end":{"line":78,"column":1}}],"line":48},"15":{"loc":{"start":{"line":52,"column":4},"end":{"line":57,"column":5}},"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":57,"column":5}},{"start":{"line":52,"column":4},"end":{"line":57,"column":5}}],"line":52},"16":{"loc":{"start":{"line":62,"column":8},"end":{"line":67,"column":9}},"type":"if","locations":[{"start":{"line":62,"column":8},"end":{"line":67,"column":9}},{"start":{"line":62,"column":8},"end":{"line":67,"column":9}}],"line":62},"17":{"loc":{"start":{"line":62,"column":12},"end":{"line":62,"column":37}},"type":"binary-expr","locations":[{"start":{"line":62,"column":12},"end":{"line":62,"column":22}},{"start":{"line":62,"column":26},"end":{"line":62,"column":37}}],"line":62},"18":{"loc":{"start":{"line":68,"column":20},"end":{"line":68,"column":53}},"type":"binary-expr","locations":[{"start":{"line":68,"column":20},"end":{"line":68,"column":33}},{"start":{"line":68,"column":37},"end":{"line":68,"column":53}}],"line":68},"19":{"loc":{"start":{"line":70,"column":8},"end":{"line":72,"column":9}},"type":"if","locations":[{"start":{"line":70,"column":8},"end":{"line":72,"column":9}},{"start":{"line":70,"column":8},"end":{"line":72,"column":9}}],"line":70},"20":{"loc":{"start":{"line":70,"column":12},"end":{"line":70,"column":61}},"type":"binary-expr","locations":[{"start":{"line":70,"column":12},"end":{"line":70,"column":46}},{"start":{"line":70,"column":50},"end":{"line":70,"column":61}}],"line":70},"21":{"loc":{"start":{"line":73,"column":8},"end":{"line":75,"column":9}},"type":"if","locations":[{"start":{"line":73,"column":8},"end":{"line":75,"column":9}},{"start":{"line":73,"column":8},"end":{"line":75,"column":9}}],"line":73},"22":{"loc":{"start":{"line":73,"column":12},"end":{"line":73,"column":79}},"type":"binary-expr","locations":[{"start":{"line":73,"column":12},"end":{"line":73,"column":35}},{"start":{"line":73,"column":39},"end":{"line":73,"column":79}}],"line":73}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":4,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":1,"58":1,"59":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":4,"8":0,"9":0,"10":0,"11":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[4,0],"7":[4,4],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,1],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/index.ts","sources":["/home/circleci/repo/src/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;AACA,+CAAyC;AAEzC,iCAA8C;AAC9C,sDAA2B;AAC3B,oDAA4B;AAG5B,+DAA0C;AAC1C,+DAA0C;AAE1C,SAAe,GAAG,CAAC,MAAiB;;QAClC,cAAc;QACd,MAAM,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAE5B,MAAM,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC;QAE/B,IAAI,KAAK,EAAE;YACT,MAAM,oBAAoB,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;YAElF,IAAI,oBAAoB,GAAG,EAAE,EAAE;gBAC7B,mDAAmD;gBACnD,MAAM,IAAI,KAAK,CAAC,wDAAwD,CAAC,CAAC;aAC3E;YAED,OAAO,CAAC,GAAG,CAAC,uBAAuB,GAAG,KAAK,CAAC;YAC5C,IAAA,wBAAS,GAAE,CAAC;SACb;QAED,gBAAG,CAAC,KAAK,CAAC,iBAAiB,OAAO,EAAE,CAAC,CAAC;QACtC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,YAAY,IAAI,MAAM,EAAE;YACpE,MAAM,IAAA,gBAAS,EAAC,MAAM,CAAC,CAAC;SACzB;QACD,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,eAAe,IAAI,MAAM,EAAE;YACrE,MAAM,IAAA,gBAAS,EAAC,MAAM,CAAC,CAAC;SACzB;QACD,gBAAG,CAAC,KAAK,CAAC,oBAAoB,OAAO,EAAE,CAAC,CAAC;IAC3C,CAAC;CAAA;AAED,gCAAgC;AAChC,IAAI,OAAO,CAAC,IAAI,KAAK,MAAM,EAAE;IAC3B,kBAAkB;IAClB,MAAM,MAAM,GAAG,IAAA,gBAAS,GAAE,CAAC;IAE3B,gBAAG,CAAC,KAAK,CAAC,gCAAgC,CAAC,CAAC;IAE5C,IAAI,MAAM,CAAC,KAAK,EAAE;QAChB,gBAAG,CAAC,KAAK,GAAG,OAAO,CAAC;QACpB,gBAAgB;QAChB,OAAO,CAAC,GAAG,CAAC,WAAW,GAAG,MAAM,CAAC;QACjC,OAAO,CAAC,GAAG,CAAC,SAAS,GAAG,OAAO,CAAC;KACjC;IAED,GAAG,CAAC,MAAM,CAAC;SACR,IAAI,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;SAC3B,KAAK,CAAC,CAAC,KAAyE,EAAE,EAAE;QACnF,MAAM,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC5B,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,KAAK,EAAE;YAC7B,gBAAG,CAAC,KAAK,CACP,2BAA2B,OAAO,iBAAiB,KAAK,CAAC,KAAK,yBAAyB,KAAK,CAAC,IAAI,EAAE,CACpG,CAAC;SACH;aAAM;YACL,gBAAG,CAAC,KAAK,CAAC,2BAA2B,OAAO,EAAE,CAAC,CAAC;SACjD;QAED,MAAM,GAAG,GAAG,KAAK,CAAC,OAAO,IAAI,KAAK,CAAC,QAAQ,EAAE,CAAC;QAC9C,gBAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAEf,IAAI,OAAO,CAAC,GAAG,CAAC,WAAW,KAAK,MAAM,IAAI,KAAK,CAAC,KAAK,EAAE;YACrD,gBAAG,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;SACxB;QAED,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,CAAC,QAAQ,CAAC,0BAA0B,CAAC,EAAE;YACvE,gBAAG,CAAC,IAAI,CACN,+GAA+G,CAChH,CAAC;SACH;QACD,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IAClB,CAAC,CAAC,CAAC;CACN;AAED,8CAA8C;AAC9C,kBAAe;IACb,MAAM,EAAE,gBAAS;IACjB,IAAI,EAAE,gBAAS;IACf,MAAM,EAAE,gBAAS;IACjB,MAAM,EAAE,gBAAS;IACjB,KAAK,EAAL,eAAK;CACN,CAAC;AAEW,QAAA,IAAI,GAAG,gBAAS,CAAC;AACjB,QAAA,MAAM,GAAG,gBAAS,CAAC","sourcesContent":["#!/usr/bin/env node\nimport { bootstrap } from 'global-agent';\n\nimport { getParams, CliParams } from './args';\nimport log from './logger';\nimport tools from './tools';\nimport { Stage } from './tools/auth0';\n\nimport importCMD from './commands/import';\nimport exportCMD from './commands/export';\n\nasync function run(params: CliParams): Promise<void> {\n  // Run command\n  const command = params._[0];\n\n  const proxy = params.proxy_url;\n\n  if (proxy) {\n    const MAJOR_NODEJS_VERSION = parseInt(process.version.slice(1).split('.')[0], 10);\n\n    if (MAJOR_NODEJS_VERSION < 10) {\n      // `global-agent` works with Node.js v10 and above.\n      throw new Error('The --proxy_url option is only supported on Node >= 10');\n    }\n\n    process.env.GLOBAL_AGENT_HTTP_PROXY = proxy;\n    bootstrap();\n  }\n\n  log.debug(`Start command ${command}`);\n  if (['deploy', 'import'].includes(command) && 'input_file' in params) {\n    await importCMD(params);\n  }\n  if (['dump', 'export'].includes(command) && 'output_folder' in params) {\n    await exportCMD(params);\n  }\n  log.debug(`Finished command ${command}`);\n}\n\n// Only run if from command line\nif (require.main === module) {\n  // Load cli params\n  const params = getParams();\n\n  log.debug('Starting Auth0 Deploy CLI Tool');\n\n  if (params.debug) {\n    log.level = 'debug';\n    // Set for tools\n    process.env.AUTH0_DEBUG = 'true';\n    process.env.AUTH0_LOG = 'debug';\n  }\n\n  run(params)\n    .then(() => process.exit(0))\n    .catch((error: { type?: string; stage?: Stage; message?: string; stack?: string }) => {\n      const command = params._[0];\n      if (error.type || error.stage) {\n        log.error(\n          `Problem running command ${command} during stage ${error.stage} when processing type ${error.type}`\n        );\n      } else {\n        log.error(`Problem running command ${command}`);\n      }\n\n      const msg = error.message || error.toString();\n      log.error(msg);\n\n      if (process.env.AUTH0_DEBUG === 'true' && error.stack) {\n        log.debug(error.stack);\n      }\n\n      if (typeof msg === 'string' && msg.includes('Payload validation error')) {\n        log.info(\n          'Please refer to the Auth0 Management API docs for expected payloads: https://auth0.com/docs/api/management/v2'\n        );\n      }\n      process.exit(1);\n    });\n}\n\n// Export commands to be used programmatically\nexport default {\n  deploy: importCMD,\n  dump: exportCMD,\n  import: importCMD,\n  export: exportCMD,\n  tools,\n};\n\nexport const dump = exportCMD;\nexport const deploy = importCMD;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e7599a307814a1c8a937f0759a879685faa49b9a","contentHash":"bf30311c714c196d804779561efde55007442a1bc94ce87ebaeb8ef9a9c4d104"},"/home/circleci/repo/src/args.ts":{"path":"/home/circleci/repo/src/args.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"4":{"start":{"line":7,"column":16},"end":{"line":7,"column":49}},"5":{"start":{"line":9,"column":17},"end":{"line":91,"column":19}},"6":{"start":{"line":93,"column":4},"end":{"line":93,"column":21}},"7":{"start":{"line":95,"column":0},"end":{"line":95,"column":30}},"8":{"start":{"line":96,"column":0},"end":{"line":98,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"getParams","decl":{"start":{"line":8,"column":9},"end":{"line":8,"column":18}},"loc":{"start":{"line":8,"column":21},"end":{"line":94,"column":1}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":1,"8":1},"f":{"0":1,"1":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/args.ts","sources":["/home/circleci/repo/src/args.ts"],"names":[],"mappings":";;;;;;AAAA,kDAA0B;AA8B1B,SAAS,SAAS;IAChB,MAAM,IAAI,GAAG,eAAK;SACf,aAAa,CAAC,CAAC,EAAE,uBAAuB,CAAC;SACzC,KAAK,CAAC,kBAAkB,CAAC;SACzB,MAAM,CAAC,OAAO,EAAE;QACf,KAAK,EAAE,GAAG;QACV,QAAQ,EAAE,+BAA+B;QACzC,IAAI,EAAE,SAAS;QACf,OAAO,EAAE,KAAK;KACf,CAAC;SACD,MAAM,CAAC,WAAW,EAAE;QACnB,KAAK,EAAE,GAAG;QACV,QAAQ,EAAE,uEAAuE;QACjF,IAAI,EAAE,QAAQ;KACf,CAAC;SACD,OAAO,CAAC,CAAC,QAAQ,EAAE,QAAQ,CAAC,EAAE,sBAAsB,EAAE;QACrD,UAAU,EAAE;YACV,KAAK,EAAE,GAAG;YACV,QAAQ,EACN,qIAAqI;YACvI,IAAI,EAAE,QAAQ;YACd,YAAY,EAAE,IAAI;SACnB;QACD,WAAW,EAAE;YACX,KAAK,EAAE,GAAG;YACV,QAAQ,EAAE,8BAA8B;YACxC,IAAI,EAAE,QAAQ;SACf;QACD,GAAG,EAAE;YACH,QAAQ,EAAE,6DAA6D;YACvE,OAAO,EAAE,IAAI;YACb,OAAO,EAAE,IAAI;SACd;QACD,MAAM,EAAE;YACN,KAAK,EAAE,GAAG;YACV,QAAQ,EACN,6HAA6H;YAC/H,IAAI,EAAE,QAAQ;SACf;KACF,CAAC;SACD,OAAO,CAAC,CAAC,QAAQ,EAAE,MAAM,CAAC,EAAE,mCAAmC,EAAE;QAChE,aAAa,EAAE;YACb,KAAK,EAAE,GAAG;YACV,QAAQ,EAAE,uBAAuB;YACjC,IAAI,EAAE,QAAQ;YACd,YAAY,EAAE,IAAI;SACnB;QACD,MAAM,EAAE;YACN,KAAK,EAAE,GAAG;YACV,QAAQ,EAAE,oBAAoB;YAC9B,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE,CAAC,MAAM,EAAE,WAAW,CAAC;YAC9B,YAAY,EAAE,IAAI;SACnB;QACD,WAAW,EAAE;YACX,KAAK,EAAE,GAAG;YACV,QAAQ,EAAE,8BAA8B;YACxC,IAAI,EAAE,QAAQ;SACf;QACD,MAAM,EAAE;YACN,KAAK,EAAE,GAAG;YACV,QAAQ,EACN,6HAA6H;YAC/H,IAAI,EAAE,QAAQ;SACf;QACD,GAAG,EAAE;YACH,QAAQ,EAAE,6DAA6D;YACvE,OAAO,EAAE,IAAI;YACb,OAAO,EAAE,IAAI;SACd;QACD,UAAU,EAAE;YACV,KAAK,EAAE,GAAG;YACV,QAAQ,EAAE,+CAA+C;YACzD,IAAI,EAAE,SAAS;YACf,OAAO,EAAE,KAAK;SACf;KACF,CAAC;SACD,OAAO,CACN,oDAAoD,EACpD,4CAA4C,CAC7C;SACA,OAAO,CACN,yDAAyD,EACzD,iDAAiD,CAClD;SACA,OAAO,CAAC,yCAAyC,EAAE,uBAAuB,CAAC;SAC3E,OAAO,CAAC,2CAA2C,EAAE,uBAAuB,CAAC;SAC7E,OAAO,CACN,kDAAkD,EAClD,4CAA4C,CAC7C;SACA,OAAO,CACN,uDAAuD,EACvD,iDAAiD,CAClD;SACA,OAAO,CAAC,yCAAyC,EAAE,uBAAuB,CAAC;SAC3E,OAAO,CAAC,2CAA2C,EAAE,uBAAuB,CAAC;SAC7E,QAAQ,CACP,kHAAkH,CACnH;SACA,IAAI,CAAC,IAAI,CAAC,CAAC;IACd,yIAAyI;IACzI,OAAO,IAAI,CAAC,IAAI,CAAC;AACnB,CAAC;AAMQ,8BAAS;AAJlB,kBAAe;IACb,SAAS;CACV,CAAC","sourcesContent":["import yargs from 'yargs';\nimport { Config } from './types';\n\ntype SharedParams = {\n  proxy_url?: string;\n  debug?: boolean;\n  config_file?: string;\n  env?: boolean;\n  secret?: string;\n  base_path?: string; // Necessary when package imported as Node module\n  config?: Partial<Config>;\n};\n\ntype ImportSpecificParams = {\n  input_file: string;\n};\n\ntype ExportSpecificParams = {\n  format: 'yaml' | 'directory';\n  output_folder: string;\n  export_ids?: boolean;\n};\n\nexport type ExportParams = ExportSpecificParams & SharedParams;\nexport type ImportParams = ImportSpecificParams & SharedParams;\n\nexport type CliParams = (ExportParams | ImportParams) & {\n  _: ['export' | 'import' | 'deploy' | 'dump'];\n};\n\nfunction getParams(): CliParams {\n  const args = yargs\n    .demandCommand(1, 'A command is required')\n    .usage('Auth0 Deploy CLI')\n    .option('debug', {\n      alias: 'd',\n      describe: 'Dump extra debug information.',\n      type: 'boolean',\n      default: false,\n    })\n    .option('proxy_url', {\n      alias: 'p',\n      describe: 'A url for proxying requests, only set this if you are behind a proxy.',\n      type: 'string',\n    })\n    .command(['import', 'deploy'], 'Deploy Configuration', {\n      input_file: {\n        alias: 'i',\n        describe:\n          'The updates to deploy. Either a JSON file, or directory that contains the correct file layout. See README and online for more info.',\n        type: 'string',\n        demandOption: true,\n      },\n      config_file: {\n        alias: 'c',\n        describe: 'The JSON configuration file.',\n        type: 'string',\n      },\n      env: {\n        describe: 'Override the mappings in config with environment variables.',\n        boolean: true,\n        default: true,\n      },\n      secret: {\n        alias: 'x',\n        describe:\n          'The client secret, this allows you to encrypt the secret in your build configuration instead of storing it in a config file',\n        type: 'string',\n      },\n    })\n    .command(['export', 'dump'], 'Export Auth0 Tenant Configuration', {\n      output_folder: {\n        alias: 'o',\n        describe: 'The output directory.',\n        type: 'string',\n        demandOption: true,\n      },\n      format: {\n        alias: 'f',\n        describe: 'The output format.',\n        type: 'string',\n        choices: ['yaml', 'directory'],\n        demandOption: true,\n      },\n      config_file: {\n        alias: 'c',\n        describe: 'The JSON configuration file.',\n        type: 'string',\n      },\n      secret: {\n        alias: 'x',\n        describe:\n          'The client secret, this allows you to encrypt the secret in your build configuration instead of storing it in a config file',\n        type: 'string',\n      },\n      env: {\n        describe: 'Override the mappings in config with environment variables.',\n        boolean: true,\n        default: true,\n      },\n      export_ids: {\n        alias: 'e',\n        describe: 'Export identifier field for each object type.',\n        type: 'boolean',\n        default: false,\n      },\n    })\n    .example(\n      '$0 export -c config.json -f yaml -o path/to/export',\n      'Dump Auth0 config to folder in YAML format'\n    )\n    .example(\n      '$0 export -c config.json -f directory -o path/to/export',\n      'Dump Auth0 config to folder in directory format'\n    )\n    .example('$0 import -c config.json -i tenant.yaml', 'Deploy Auth0 via YAML')\n    .example('$0 import -c config.json -i path/to/files', 'Deploy Auth0 via Path')\n    .example(\n      '$0 dump -c config.json -f yaml -o path/to/export',\n      'Dump Auth0 config to folder in YAML format'\n    )\n    .example(\n      '$0 dump -c config.json -f directory -o path/to/export',\n      'Dump Auth0 config to folder in directory format'\n    )\n    .example('$0 deploy -c config.json -i tenant.yaml', 'Deploy Auth0 via YAML')\n    .example('$0 deploy -c config.json -i path/to/files', 'Deploy Auth0 via Path')\n    .epilogue(\n      'See README (https://github.com/auth0/auth0-deploy-cli) for more in-depth information on configuration and setup.'\n    )\n    .wrap(null);\n  //@ts-ignore because we know these types are either ExportParams or ImportParams. TODO: fix more native way of inferring types from yargs\n  return args.argv;\n}\n\nexport default {\n  getParams,\n};\n\nexport { getParams };\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8599b89a00afb32530e1cbcd303edabc5de965b5","contentHash":"3cc2397a38ac794e984762b875fc2e9cabbbe1e6db5190824d030d7711668a7b"},"/home/circleci/repo/src/commands/import.ts":{"path":"/home/circleci/repo/src/commands/import.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":16},"end":{"line":15,"column":49}},"16":{"start":{"line":16,"column":24},"end":{"line":16,"column":51}},"17":{"start":{"line":17,"column":16},"end":{"line":17,"column":35}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":54}},"19":{"start":{"line":19,"column":18},"end":{"line":19,"column":39}},"20":{"start":{"line":21,"column":4},"end":{"line":46,"column":7}},"21":{"start":{"line":22,"column":161},"end":{"line":22,"column":167}},"22":{"start":{"line":23,"column":8},"end":{"line":27,"column":9}},"23":{"start":{"line":24,"column":12},"end":{"line":24,"column":48}},"24":{"start":{"line":25,"column":29},"end":{"line":25,"column":88}},"25":{"start":{"line":26,"column":12},"end":{"line":26,"column":104}},"26":{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},"27":{"start":{"line":29,"column":12},"end":{"line":29,"column":45}},"28":{"start":{"line":31,"column":26},"end":{"line":31,"column":154}},"29":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"30":{"start":{"line":35,"column":12},"end":{"line":35,"column":57}},"31":{"start":{"line":37,"column":8},"end":{"line":37,"column":45}},"32":{"start":{"line":39,"column":24},"end":{"line":39,"column":90}},"33":{"start":{"line":40,"column":8},"end":{"line":40,"column":44}},"34":{"start":{"line":41,"column":23},"end":{"line":41,"column":59}},"35":{"start":{"line":42,"column":8},"end":{"line":42,"column":62}},"36":{"start":{"line":42,"column":36},"end":{"line":42,"column":60}},"37":{"start":{"line":44,"column":8},"end":{"line":44,"column":78}},"38":{"start":{"line":45,"column":8},"end":{"line":45,"column":51}},"39":{"start":{"line":48,"column":0},"end":{"line":48,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"importCMD","decl":{"start":{"line":20,"column":9},"end":{"line":20,"column":18}},"loc":{"start":{"line":20,"column":27},"end":{"line":47,"column":1}},"line":20},"9":{"name":"(anonymous_9)","decl":{"start":{"line":21,"column":43},"end":{"line":21,"column":44}},"loc":{"start":{"line":21,"column":56},"end":{"line":46,"column":5}},"line":21},"10":{"name":"(anonymous_10)","decl":{"start":{"line":42,"column":27},"end":{"line":42,"column":28}},"loc":{"start":{"line":42,"column":36},"end":{"line":42,"column":60}},"line":42}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":22,"column":109},"end":{"line":22,"column":133}},"type":"default-arg","locations":[{"start":{"line":22,"column":128},"end":{"line":22,"column":133}}],"line":22},"9":{"loc":{"start":{"line":23,"column":8},"end":{"line":27,"column":9}},"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":27,"column":9}},{"start":{"line":23,"column":8},"end":{"line":27,"column":9}}],"line":23},"10":{"loc":{"start":{"line":25,"column":29},"end":{"line":25,"column":88}},"type":"binary-expr","locations":[{"start":{"line":25,"column":29},"end":{"line":25,"column":82}},{"start":{"line":25,"column":86},"end":{"line":25,"column":88}}],"line":25},"11":{"loc":{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},{"start":{"line":28,"column":8},"end":{"line":30,"column":9}}],"line":28},"12":{"loc":{"start":{"line":31,"column":137},"end":{"line":31,"column":152}},"type":"binary-expr","locations":[{"start":{"line":31,"column":137},"end":{"line":31,"column":146}},{"start":{"line":31,"column":150},"end":{"line":31,"column":152}}],"line":31},"13":{"loc":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},{"start":{"line":34,"column":8},"end":{"line":36,"column":9}}],"line":34}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":2,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":2,"8":0,"9":0,"10":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[1,1],"7":[2,2],"8":[0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/commands/import.ts","sources":["/home/circleci/repo/src/commands/import.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,kDAA0B;AAC1B,oDAAiD;AACjD,oCAAiD;AACjD,uDAA4B;AAC5B,wCAA0C;AAG1C,SAA8B,SAAS,CAAC,MAAoB;;QAC1D,MAAM,EACJ,UAAU,EAAE,SAAS,EACrB,SAAS,EAAE,QAAQ,EACnB,WAAW,EAAE,UAAU,EACvB,MAAM,EAAE,SAAS,EACjB,GAAG,EAAE,gBAAgB,GAAG,KAAK,EAC7B,MAAM,EAAE,YAAY,GACrB,GAAG,MAAM,CAAC;QAEX,IAAI,gBAAgB,EAAE;YACpB,eAAK,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YAE1B,MAAM,QAAQ,GAAG,eAAK,CAAC,GAAG,CAAC,gCAAgC,CAAC,IAAI,EAAE,CAAC;YACnE,eAAK,CAAC,GAAG,CAAC,gCAAgC,EAAE,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;SACnF;QAED,IAAI,UAAU,EAAE;YACd,eAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SACxB;QAED,MAAM,SAAS,mBACb,gBAAgB,EAAE,SAAS,EAC3B,eAAe,EAAE,QAAQ,EACzB,8BAA8B,EAAE,EAAE,IAC/B,CAAC,SAAS,IAAI,EAAE,CAAC,CACrB,CAAC;QAEF,sGAAsG;QACtG,wDAAwD;QACxD,IAAI,YAAY,EAAE;YAChB,SAAS,CAAC,mBAAmB,GAAG,YAAY,CAAC;SAC9C;QAED,eAAK,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAE3B,yBAAyB;QACzB,MAAM,OAAO,GAAG,MAAM,IAAA,sBAAY,EAAC,eAAK,CAAC,GAAG,EAAE,EAAE,QAAQ,CAAC,CAAC;QAC1D,MAAM,OAAO,CAAC,mBAAmB,EAAE,CAAC;QAEpC,MAAM,MAAM,GAAG,IAAA,6BAAa,GAAE,CAAC;QAC/B,MAAM,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,eAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;QAE5C,iGAAiG;QACjG,MAAM,IAAA,cAAW,EAAC,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;QAE9D,gBAAG,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;IAChC,CAAC;CAAA;AA/CD,4BA+CC","sourcesContent":["import nconf from 'nconf';\nimport { configFactory } from '../configFactory';\nimport { deploy as toolsDeploy } from '../tools';\nimport log from '../logger';\nimport { setupContext } from '../context';\nimport { ImportParams } from '../args';\n\nexport default async function importCMD(params: ImportParams) {\n  const {\n    input_file: inputFile,\n    base_path: basePath,\n    config_file: configFile,\n    config: configObj,\n    env: shouldInheritEnv = false,\n    secret: clientSecret,\n  } = params;\n\n  if (shouldInheritEnv) {\n    nconf.env().use('memory');\n\n    const mappings = nconf.get('AUTH0_KEYWORD_REPLACE_MAPPINGS') || {};\n    nconf.set('AUTH0_KEYWORD_REPLACE_MAPPINGS', Object.assign(mappings, process.env));\n  }\n\n  if (configFile) {\n    nconf.file(configFile);\n  }\n\n  const overrides = {\n    AUTH0_INPUT_FILE: inputFile,\n    AUTH0_BASE_PATH: basePath,\n    AUTH0_KEYWORD_REPLACE_MAPPINGS: {},\n    ...(configObj || {}),\n  };\n\n  // Prepare configuration by initializing nconf, then passing that as the provider to the config object\n  // Allow passed in secret to override the configured one\n  if (clientSecret) {\n    overrides.AUTH0_CLIENT_SECRET = clientSecret;\n  }\n\n  nconf.overrides(overrides);\n\n  // Setup context and load\n  const context = await setupContext(nconf.get(), 'import');\n  await context.loadAssetsFromLocal();\n\n  const config = configFactory();\n  config.setProvider((key) => nconf.get(key));\n\n  //@ts-ignore because context and assets still need to be typed TODO: type assets and type context\n  await toolsDeploy(context.assets, context.mgmtClient, config);\n\n  log.info('Import Successful');\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"0269ddc5c0eb9328359d674e73acd64e5003f99c","contentHash":"adb47cafb8a8b660669f4e80a97599e0a4ca79869a5c2f26ca3e2b2c70abf8dc"},"/home/circleci/repo/src/configFactory.ts":{"path":"/home/circleci/repo/src/configFactory.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":4,"column":22},"end":{"line":23,"column":1}},"3":{"start":{"line":5,"column":21},"end":{"line":5,"column":23}},"4":{"start":{"line":6,"column":26},"end":{"line":6,"column":30}},"5":{"start":{"line":7,"column":19},"end":{"line":15,"column":5}},"6":{"start":{"line":8,"column":8},"end":{"line":10,"column":9}},"7":{"start":{"line":9,"column":12},"end":{"line":9,"column":33}},"8":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"9":{"start":{"line":12,"column":12},"end":{"line":12,"column":73}},"10":{"start":{"line":14,"column":8},"end":{"line":14,"column":36}},"11":{"start":{"line":16,"column":4},"end":{"line":18,"column":6}},"12":{"start":{"line":17,"column":8},"end":{"line":17,"column":43}},"13":{"start":{"line":19,"column":4},"end":{"line":21,"column":6}},"14":{"start":{"line":20,"column":8},"end":{"line":20,"column":30}},"15":{"start":{"line":22,"column":4},"end":{"line":22,"column":18}},"16":{"start":{"line":24,"column":0},"end":{"line":24,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":22},"end":{"line":4,"column":23}},"loc":{"start":{"line":4,"column":28},"end":{"line":23,"column":1}},"line":4},"1":{"name":"getConfig","decl":{"start":{"line":7,"column":28},"end":{"line":7,"column":37}},"loc":{"start":{"line":7,"column":43},"end":{"line":15,"column":5}},"line":7},"2":{"name":"setProvider","decl":{"start":{"line":16,"column":34},"end":{"line":16,"column":45}},"loc":{"start":{"line":16,"column":64},"end":{"line":18,"column":5}},"line":16},"3":{"name":"setValue","decl":{"start":{"line":19,"column":31},"end":{"line":19,"column":39}},"loc":{"start":{"line":19,"column":52},"end":{"line":21,"column":5}},"line":19}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":8},"end":{"line":10,"column":9}},"type":"if","locations":[{"start":{"line":8,"column":8},"end":{"line":10,"column":9}},{"start":{"line":8,"column":8},"end":{"line":10,"column":9}}],"line":8},"1":{"loc":{"start":{"line":8,"column":12},"end":{"line":8,"column":37}},"type":"binary-expr","locations":[{"start":{"line":8,"column":12},"end":{"line":8,"column":20}},{"start":{"line":8,"column":24},"end":{"line":8,"column":37}}],"line":8},"2":{"loc":{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},"type":"if","locations":[{"start":{"line":11,"column":8},"end":{"line":13,"column":9}},{"start":{"line":11,"column":8},"end":{"line":13,"column":9}}],"line":11}},"s":{"0":1,"1":1,"2":1,"3":2,"4":2,"5":2,"6":0,"7":0,"8":0,"9":0,"10":0,"11":2,"12":0,"13":2,"14":0,"15":2,"16":1},"f":{"0":2,"1":0,"2":0,"3":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/configFactory.ts","sources":["/home/circleci/repo/src/configFactory.ts"],"names":[],"mappings":";;;AAIO,MAAM,aAAa,GAAG,GAAG,EAAE;IAChC,MAAM,QAAQ,GAAoB,EAAE,CAAC;IACrC,IAAI,eAAe,GAA0B,IAAI,CAAC;IAElD,MAAM,MAAM,GAAG,SAAS,SAAS,CAAC,GAAiB;QACjD,IAAI,QAAQ,IAAI,QAAQ,CAAC,GAAG,CAAC,EAAE;YAC7B,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC;SACtB;QAED,IAAI,CAAC,eAAe,EAAE;YACpB,MAAM,IAAI,KAAK,CAAC,2CAA2C,CAAC,CAAC;SAC9D;QAED,OAAO,eAAe,CAAC,GAAG,CAAC,CAAC;IAC9B,CAAC,CAAC;IAEF,MAAM,CAAC,WAAW,GAAG,SAAS,WAAW,CAAC,gBAAgC;QACxE,eAAe,GAAG,gBAAgB,CAAC;IACrC,CAAC,CAAC;IAEF,MAAM,CAAC,QAAQ,GAAG,SAAS,QAAQ,CAAC,GAAiB,EAAE,KAAU;QAC/D,QAAQ,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;IACxB,CAAC,CAAC;IAEF,OAAO,MAAM,CAAC;AAChB,CAAC,CAAC;AAzBW,QAAA,aAAa,iBAyBxB","sourcesContent":["import { Config } from './types';\n\nexport type ConfigFunction = (arg0: keyof Config) => any; // TODO: refactor configFactory function to allow for more precise typing\n\nexport const configFactory = () => {\n  const settings: Partial<Config> = {};\n  let currentProvider: ConfigFunction | null = null;\n\n  const config = function getConfig(key: keyof Config) {\n    if (settings && settings[key]) {\n      return settings[key];\n    }\n\n    if (!currentProvider) {\n      throw new Error('A configuration provider has not been set');\n    }\n\n    return currentProvider(key);\n  };\n\n  config.setProvider = function setProvider(providerFunction: ConfigFunction) {\n    currentProvider = providerFunction;\n  };\n\n  config.setValue = function setValue(key: keyof Config, value: any) {\n    settings[key] = value;\n  };\n\n  return config;\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4f90fd28f525d43408c9dc2c77fba5856126d016","contentHash":"03d100c64eedc8ffbbe962c71a45a31ec57ec2b23d8d860134959b0d8144f1e6"},"/home/circleci/repo/src/commands/export.ts":{"path":"/home/circleci/repo/src/commands/export.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"13":{"start":{"line":12,"column":4},"end":{"line":12,"column":62}},"14":{"start":{"line":14,"column":0},"end":{"line":14,"column":62}},"15":{"start":{"line":15,"column":15},"end":{"line":15,"column":47}},"16":{"start":{"line":16,"column":16},"end":{"line":16,"column":49}},"17":{"start":{"line":17,"column":17},"end":{"line":17,"column":51}},"18":{"start":{"line":18,"column":17},"end":{"line":18,"column":54}},"19":{"start":{"line":19,"column":16},"end":{"line":19,"column":35}},"20":{"start":{"line":20,"column":16},"end":{"line":20,"column":43}},"21":{"start":{"line":22,"column":4},"end":{"line":53,"column":7}},"22":{"start":{"line":23,"column":190},"end":{"line":23,"column":196}},"23":{"start":{"line":24,"column":8},"end":{"line":26,"column":9}},"24":{"start":{"line":25,"column":12},"end":{"line":25,"column":48}},"25":{"start":{"line":27,"column":8},"end":{"line":29,"column":9}},"26":{"start":{"line":28,"column":12},"end":{"line":28,"column":45}},"27":{"start":{"line":30,"column":26},"end":{"line":30,"column":121}},"28":{"start":{"line":33,"column":8},"end":{"line":35,"column":9}},"29":{"start":{"line":34,"column":12},"end":{"line":34,"column":57}},"30":{"start":{"line":37,"column":8},"end":{"line":39,"column":9}},"31":{"start":{"line":38,"column":12},"end":{"line":38,"column":59}},"32":{"start":{"line":41,"column":8},"end":{"line":44,"column":9}},"33":{"start":{"line":42,"column":12},"end":{"line":42,"column":62}},"34":{"start":{"line":43,"column":12},"end":{"line":43,"column":48}},"35":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"36":{"start":{"line":46,"column":12},"end":{"line":46,"column":90}},"37":{"start":{"line":48,"column":8},"end":{"line":48,"column":45}},"38":{"start":{"line":50,"column":24},"end":{"line":50,"column":88}},"39":{"start":{"line":51,"column":8},"end":{"line":51,"column":29}},"40":{"start":{"line":52,"column":8},"end":{"line":52,"column":51}},"41":{"start":{"line":55,"column":0},"end":{"line":55,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":56},"end":{"line":11,"column":57}},"loc":{"start":{"line":11,"column":71},"end":{"line":13,"column":1}},"line":11},"8":{"name":"exportCMD","decl":{"start":{"line":21,"column":9},"end":{"line":21,"column":18}},"loc":{"start":{"line":21,"column":27},"end":{"line":54,"column":1}},"line":21},"9":{"name":"(anonymous_9)","decl":{"start":{"line":22,"column":43},"end":{"line":22,"column":44}},"loc":{"start":{"line":22,"column":56},"end":{"line":53,"column":5}},"line":22}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":22},"end":{"line":13,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":23},"end":{"line":11,"column":27}},{"start":{"line":11,"column":31},"end":{"line":11,"column":51}},{"start":{"line":11,"column":56},"end":{"line":13,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":11},"end":{"line":12,"column":61}},"type":"cond-expr","locations":[{"start":{"line":12,"column":37},"end":{"line":12,"column":40}},{"start":{"line":12,"column":43},"end":{"line":12,"column":61}}],"line":12},"7":{"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":33}},"type":"binary-expr","locations":[{"start":{"line":12,"column":12},"end":{"line":12,"column":15}},{"start":{"line":12,"column":19},"end":{"line":12,"column":33}}],"line":12},"8":{"loc":{"start":{"line":23,"column":160},"end":{"line":23,"column":184}},"type":"default-arg","locations":[{"start":{"line":23,"column":179},"end":{"line":23,"column":184}}],"line":23},"9":{"loc":{"start":{"line":24,"column":8},"end":{"line":26,"column":9}},"type":"if","locations":[{"start":{"line":24,"column":8},"end":{"line":26,"column":9}},{"start":{"line":24,"column":8},"end":{"line":26,"column":9}}],"line":24},"10":{"loc":{"start":{"line":27,"column":8},"end":{"line":29,"column":9}},"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":29,"column":9}},{"start":{"line":27,"column":8},"end":{"line":29,"column":9}}],"line":27},"11":{"loc":{"start":{"line":30,"column":104},"end":{"line":30,"column":119}},"type":"binary-expr","locations":[{"start":{"line":30,"column":104},"end":{"line":30,"column":113}},{"start":{"line":30,"column":117},"end":{"line":30,"column":119}}],"line":30},"12":{"loc":{"start":{"line":33,"column":8},"end":{"line":35,"column":9}},"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":35,"column":9}},{"start":{"line":33,"column":8},"end":{"line":35,"column":9}}],"line":33},"13":{"loc":{"start":{"line":37,"column":8},"end":{"line":39,"column":9}},"type":"if","locations":[{"start":{"line":37,"column":8},"end":{"line":39,"column":9}},{"start":{"line":37,"column":8},"end":{"line":39,"column":9}}],"line":37},"14":{"loc":{"start":{"line":41,"column":8},"end":{"line":44,"column":9}},"type":"if","locations":[{"start":{"line":41,"column":8},"end":{"line":44,"column":9}},{"start":{"line":41,"column":8},"end":{"line":44,"column":9}}],"line":41},"15":{"loc":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},{"start":{"line":45,"column":8},"end":{"line":47,"column":9}}],"line":45}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":4,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":4,"8":0,"9":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[1,3],"7":[4,4],"8":[0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"inputSourceMap":{"version":3,"file":"/home/circleci/repo/src/commands/export.ts","sources":["/home/circleci/repo/src/commands/export.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,gDAAwB;AACxB,kDAA0B;AAC1B,oDAA4B;AAE5B,uDAA4B;AAC5B,oCAAuC;AACvC,4CAAgD;AAIhD,SAA8B,SAAS,CAAC,MAAoB;;QAC1D,MAAM,EACJ,aAAa,EAAE,YAAY,EAC3B,SAAS,EAAE,QAAQ,EACnB,WAAW,EAAE,UAAU,EACvB,MAAM,EAAE,SAAS,EACjB,UAAU,EAAE,SAAS,EACrB,MAAM,EAAE,YAAY,EACpB,GAAG,EAAE,gBAAgB,GAAG,KAAK,GAC9B,GAAG,MAAM,CAAC;QAEX,IAAI,gBAAgB,EAAE;YACpB,eAAK,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;SAC3B;QAED,IAAI,UAAU,EAAE;YACd,eAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SACxB;QAED,MAAM,SAAS,mBACb,gBAAgB,EAAE,YAAY,EAC9B,eAAe,EAAE,QAAQ,IACtB,CAAC,SAAS,IAAI,EAAE,CAAC,CACrB,CAAC;QAEF,sGAAsG;QACtG,wDAAwD;QACxD,IAAI,YAAY,EAAE;YAChB,SAAS,CAAC,mBAAmB,GAAG,YAAY,CAAC;SAC9C;QAED,4DAA4D;QAC5D,IAAI,SAAS,EAAE;YACb,SAAS,CAAC,wBAAwB,GAAG,SAAS,CAAC;SAChD;QAED,sBAAsB;QACtB,IAAI,CAAC,IAAA,mBAAW,EAAC,YAAY,CAAC,EAAE;YAC9B,gBAAG,CAAC,IAAI,CAAC,YAAY,YAAY,EAAE,CAAC,CAAC;YACrC,gBAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SAC3B;QAED,IAAI,MAAM,CAAC,MAAM,KAAK,MAAM,EAAE;YAC5B,SAAS,CAAC,gBAAgB,GAAG,cAAI,CAAC,IAAI,CAAC,YAAY,EAAE,aAAa,CAAC,CAAC;SACrE;QAED,eAAK,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAE3B,yBAAyB;QACzB,MAAM,OAAO,GAAG,MAAM,IAAA,oBAAY,EAAC,eAAK,CAAC,GAAG,EAAE,EAAE,QAAQ,CAAC,CAAC;QAC1D,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;QACrB,gBAAG,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;IAChC,CAAC;CAAA;AApDD,4BAoDC","sourcesContent":["import path from 'path';\nimport nconf from 'nconf';\nimport mkdirp from 'mkdirp';\n\nimport log from '../logger';\nimport { isDirectory } from '../utils';\nimport { setupContext } from '../context/index';\nimport { Config } from '../types';\nimport { ExportParams } from '../args';\n\nexport default async function exportCMD(params: ExportParams) {\n  const {\n    output_folder: outputFolder,\n    base_path: basePath,\n    config_file: configFile,\n    config: configObj,\n    export_ids: exportIds,\n    secret: clientSecret,\n    env: shouldInheritEnv = false,\n  } = params;\n\n  if (shouldInheritEnv) {\n    nconf.env().use('memory');\n  }\n\n  if (configFile) {\n    nconf.file(configFile);\n  }\n\n  const overrides: Partial<Config> = {\n    AUTH0_INPUT_FILE: outputFolder,\n    AUTH0_BASE_PATH: basePath,\n    ...(configObj || {}),\n  };\n\n  // Prepare configuration by initializing nconf, then passing that as the provider to the config object\n  // Allow passed in secret to override the configured one\n  if (clientSecret) {\n    overrides.AUTH0_CLIENT_SECRET = clientSecret;\n  }\n\n  // Allow passed in export_ids to override the configured one\n  if (exportIds) {\n    overrides.AUTH0_EXPORT_IDENTIFIERS = exportIds;\n  }\n\n  // Check output folder\n  if (!isDirectory(outputFolder)) {\n    log.info(`Creating ${outputFolder}`);\n    mkdirp.sync(outputFolder);\n  }\n\n  if (params.format === 'yaml') {\n    overrides.AUTH0_INPUT_FILE = path.join(outputFolder, 'tenant.yaml');\n  }\n\n  nconf.overrides(overrides);\n\n  // Setup context and load\n  const context = await setupContext(nconf.get(), 'export');\n  await context.dump();\n  log.info('Export Successful');\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"822972b9842fc1df3169bd9d3c5ed3abcb5ec685","contentHash":"c6c8825078c9ecf5a83daf16cdb735c835b999968eaf29f1e638921692d8ba1c"}}